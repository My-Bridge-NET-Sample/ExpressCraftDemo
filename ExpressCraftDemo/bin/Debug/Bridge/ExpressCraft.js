/**
 * @version 1.0.0.0
 * @copyright Copyright Â©  2017
 * @compiler Bridge.NET 16.2.1
 */
Bridge.assembly("ExpressCraft", function ($asm, globals) {
    "use strict";

    Bridge.define("ExpressCraft.Control", {
        statics: {
            fields: {
                ControlClass: null,
                cva: null
            },
            ctors: {
                init: function () {
                    this.ControlClass = "control";
                }
            },
            methods: {
                BaseClass: function (add, ac) {
                    if (add === void 0) { add = true; }
                    if (ac === void 0) { ac = true; }
                    return ac ? (add ? " control" : ExpressCraft.Control.ControlClass) : "";
                },
                GetImageString: function (s) {
                    return System.String.format("url('data:image/png;base64,{0}') no-repeat", s);
                },
                GetPdfString: function (s) {
                    return System.String.format("data:application/pdf;base64,{0}", s);
                },
                GetImageStringURI: function (s, useResourceURL) {
                    if (useResourceURL === void 0) { useResourceURL = true; }
                    return System.String.format("url('{0}{1}') no-repeat", useResourceURL ? ExpressCraft.Settings.ResourceURL : "", s);
                },
                Div: function (ac) {
                    var $t;
                    if (ac === void 0) { ac = true; }
                    return ($t = document.createElement("div"), $t.className = ExpressCraft.Control.BaseClass(false, ac), $t);
                },
                Div$1: function (cn, ac) {
                    var $t;
                    if (ac === void 0) { ac = true; }
                    return ($t = document.createElement("div"), $t.className = System.String.concat(cn, ExpressCraft.Control.BaseClass(true, ac)), $t);
                },
                Span: function (ac) {
                    var $t;
                    if (ac === void 0) { ac = true; }
                    return ($t = document.createElement("span"), $t.className = ExpressCraft.Control.BaseClass(false, ac), $t);
                },
                Span$1: function (cn, ac) {
                    var $t;
                    if (ac === void 0) { ac = true; }
                    return ($t = document.createElement("span"), $t.className = System.String.concat(cn, ExpressCraft.Control.BaseClass(true, ac)), $t);
                },
                Label$2: function (Caption, X, Y, IsBold, IsTiny, ac) {
                    var $t;
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (ac === void 0) { ac = true; }
                    var lbl = ($t = document.createElement("span"), $t.className = ExpressCraft.Control.BaseClass(false, ac), $t);

                    lbl.innerHTML = ExpressCraft.Helper.HtmlEscape$1(Caption);
                    ExpressCraft.Helper.SetLocation(lbl, X, Y);
                    ExpressCraft.Control.SetBT(lbl, IsBold, IsTiny);

                    return lbl;
                },
                Label$4: function (Caption, X, Y, width, height, IsBold, IsTiny, classr, Alignment, Forecolor, ac) {
                    var $t;
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (classr === void 0) { classr = ""; }
                    if (Alignment === void 0) { Alignment = 3; }
                    if (Forecolor === void 0) { Forecolor = null; }
                    if (ac === void 0) { ac = true; }
                    var lbl = ($t = document.createElement("span"), $t.className = System.String.concat(classr, ExpressCraft.Control.BaseClass(!System.String.isNullOrWhiteSpace(classr), ac)), $t);

                    lbl.innerHTML = ExpressCraft.Helper.HtmlEscape$1(Caption);
                    ExpressCraft.Helper.SetBounds$1(lbl, X, Y, width, height);
                    if (Alignment !== "left") {
                        lbl.style.textAlign = Alignment;
                    }
                    ExpressCraft.Control.SetBT(lbl, IsBold, IsTiny);
                    if (Forecolor != null) {
                        lbl.style.color = Forecolor;
                    }

                    return lbl;
                },
                Label$3: function (Caption, X, Y, width, IsBold, IsTiny, classr, Alignment, Forecolor, ac) {
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (classr === void 0) { classr = ""; }
                    if (Alignment === void 0) { Alignment = 3; }
                    if (Forecolor === void 0) { Forecolor = null; }
                    if (ac === void 0) { ac = true; }
                    var lbl = document.createElement("span");
                    lbl.className = System.String.concat(classr, ExpressCraft.Control.BaseClass(!System.String.isNullOrWhiteSpace(classr), ac));
                    lbl.textContent = Caption;
                    lbl.style.left = ExpressCraft.Helper.ToPx(Bridge.box(X, System.Single, System.Single.format, System.Single.getHashCode));
                    lbl.style.top = ExpressCraft.Helper.ToPx(Bridge.box(Y, System.Single, System.Single.format, System.Single.getHashCode));
                    lbl.style.width = ExpressCraft.Helper.ToPx(Bridge.box(width, System.Single, System.Single.format, System.Single.getHashCode));

                    if (Alignment !== "left") {
                        if (Alignment === "right") {
                            lbl.style.direction = "rtl";
                        } else {
                            lbl.style.textAlign = Alignment;
                        }
                    }
                    ExpressCraft.Control.SetBT(lbl, IsBold, IsTiny);
                    if (Forecolor != null) {
                        lbl.style.color = Forecolor;
                    }

                    return lbl;
                },
                Label$5: function (c, X, Y, width, height, IsBold, IsTiny, classr, ac) {
                    var $t;
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (classr === void 0) { classr = ""; }
                    if (ac === void 0) { ac = true; }
                    var lbl = ($t = document.createElement("span"), $t.className = System.String.concat(classr, ExpressCraft.Control.BaseClass(!System.String.isNullOrWhiteSpace(classr), ac)), $t);

                    lbl.innerHTML = ExpressCraft.Helper.HtmlEscape$1(c);
                    ExpressCraft.Helper.SetBounds$1(lbl, X, Y, width, height);
                    ExpressCraft.Control.SetBT(lbl, IsBold, IsTiny);

                    return lbl;
                },
                Label$1: function (c, X, Y, width, IsBold, IsTiny, classr, ac) {
                    var $t;
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (classr === void 0) { classr = ""; }
                    if (ac === void 0) { ac = true; }
                    var lbl = ($t = document.createElement("span"), $t.className = System.String.concat(classr, ExpressCraft.Control.BaseClass(!System.String.isNullOrWhiteSpace(classr), ac)), $t);

                    lbl.innerHTML = ExpressCraft.Helper.HtmlEscape$1(c);
                    ExpressCraft.Helper.SetLocation(lbl, X, Y);
                    lbl.style.width = ExpressCraft.Helper.ToPx(Bridge.box(width, System.Int32));
                    ExpressCraft.Control.SetBT(lbl, IsBold, IsTiny);

                    return lbl;
                },
                Label: function (c, X, Y, IsBold, IsTiny, ac) {
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (ac === void 0) { ac = true; }
                    return ExpressCraft.Control.Label$2(c, X, Y, IsBold, IsTiny, ac);
                },
                DivLabel: function (Caption, X, Y, width, IsBold, IsTiny, classr, Alignment, Forecolor, ac) {
                    if (IsBold === void 0) { IsBold = false; }
                    if (IsTiny === void 0) { IsTiny = false; }
                    if (classr === void 0) { classr = ""; }
                    if (Alignment === void 0) { Alignment = 3; }
                    if (Forecolor === void 0) { Forecolor = null; }
                    if (ac === void 0) { ac = true; }
                    var lbl = document.createElement("div");
                    lbl.className = System.String.concat(classr, ExpressCraft.Control.BaseClass(!System.String.isNullOrWhiteSpace(classr), ac));
                    lbl.textContent = Caption;
                    lbl.style.left = ExpressCraft.Helper.ToPx(Bridge.box(X, System.Single, System.Single.format, System.Single.getHashCode));
                    lbl.style.top = ExpressCraft.Helper.ToPx(Bridge.box(Y, System.Single, System.Single.format, System.Single.getHashCode));
                    lbl.style.width = ExpressCraft.Helper.ToPx(Bridge.box(width, System.Single, System.Single.format, System.Single.getHashCode));

                    if (Alignment !== "left") {
                        if (Alignment === "right") {
                            lbl.style.direction = "rtl";
                        } else {
                            lbl.style.textAlign = Alignment;
                        }
                    }
                    if (IsBold) {
                        lbl.style.fontWeight = "bold";
                    }
                    if (IsTiny) {
                        lbl.style.fontSize = "6.75pt";
                    }
                    if (Forecolor != null) {
                        lbl.style.color = Forecolor;
                    }

                    return lbl;
                },
                SetBT: function (lbl, IsBold, IsTiny) {
                    if (IsBold) {
                        lbl.style.fontWeight = "bold";
                    }
                    if (IsTiny) {
                        lbl.style.fontSize = "6.75pt";
                    }
                },
                ComboBox: function (cn, ct, ac) {
                    var $t;
                    if (ac === void 0) { ac = true; }
                    var combo = ($t = document.createElement("select"), $t.className = System.String.concat(cn, ExpressCraft.Control.BaseClass(true, ac)), $t);
                    if (ct === ExpressCraft.ComboBoxTypes.Default) {
                    }
                    return combo;
                },
                Button: function (cn, bt, ac) {
                    var $t;
                    if (ac === void 0) { ac = true; }
                    return ($t = document.createElement("button"), $t.className = System.String.concat(cn, ExpressCraft.Control.BaseClass(true, ac)), $t.type = bt, $t);
                },
                Input: function (cn, it, ac) {
                    if (ac === void 0) { ac = true; }
                    var input = document.createElement("input");
                    input.className = System.String.concat(cn, ExpressCraft.Control.BaseClass(!System.String.isNullOrWhiteSpace(cn), ac));
                    var ty = it;
                    if (Bridge.Browser.isIE && (Bridge.referenceEquals(ty, "text") || Bridge.referenceEquals(ty, "date") || Bridge.referenceEquals(ty, "color") || Bridge.referenceEquals(ty, 19) || Bridge.referenceEquals(ty, 3) || Bridge.referenceEquals(ty, 2))) {
                        return input;
                    }
                    input.type = it;

                    return input;
                },
                /**
                 * Returns Text Metrics for a given string
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Control
                 * @memberof ExpressCraft.Control
                 * @param   {string}         t    the string
                 * @param   {string}         f    the font used
                 * @return  {TextMetrics}         TextMetrics
                 */
                GetTextMetrics: function (t, f) {
                    var $t;
                    if (Bridge.referenceEquals(f, "")) {
                        f = "8.25pt Tahoma";
                    }
                    var c = (ExpressCraft.Control.cva || (($t = document.createElement("canvas"), ExpressCraft.Control.cva = $t, $t))).getContext("2d");
                    c.font = f;
                    return c.measureText(t);
                },
                /**
                 * Returns text width
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Control
                 * @memberof ExpressCraft.Control
                 * @param   {string}    t    the string
                 * @param   {string}    f    the font used
                 * @return  {number}         double
                 */
                GetTextWidth: function (t, f) {
                    return ExpressCraft.Control.GetTextMetrics(t, f).width;
                },
                op_Implicit: function (control) {
                    if (ExpressCraft.Settings.AutoRender && !control.HasRendered) {
                        control.Render();
                    }
                    return control.Content;
                }
            }
        },
        fields: {
            Content: null,
            Name: null,
            HasRendered: false,
            _toolTip: null,
            _OnMouseEnterToolTip: null,
            _OnMouseLeaveToolTip: null,
            OnResize: null,
            OnLoaded: null,
            ContextMenu: null,
            LinkedForm: null
        },
        props: {
            ToolTip: {
                get: function () {
                    return this._toolTip;
                },
                set: function (value) {
                    if (!Bridge.referenceEquals(this._toolTip, value)) {
                        if (value != null) {
                            if (value.AttachedControl != null && !Bridge.referenceEquals(value.AttachedControl, this)) {
                                value = null;
                            } else {
                                value.AttachedControl = this;
                            }
                        }
                        this._toolTip = value;

                        if (this._toolTip != null && (!ExpressCraft.Helper.IsEmpty(this._toolTip.Heading) || !ExpressCraft.Helper.IsEmpty(this._toolTip.Description))) {
                            this._OnMouseEnterToolTip = Bridge.fn.bind(this, $asm.$.ExpressCraft.Control.f1);
                            this._OnMouseLeaveToolTip = Bridge.fn.bind(this, $asm.$.ExpressCraft.Control.f2);

                            this.Content.addEventListener("mouseenter", this._OnMouseEnterToolTip);
                            this.Content.addEventListener("mouseleave", this._OnMouseLeaveToolTip);
                            return;
                        }

                        if (!Bridge.staticEquals(this._OnMouseEnterToolTip, null)) {
                            this.Content.removeEventListener("mouseenter", this._OnMouseEnterToolTip);
                            this._OnMouseEnterToolTip = null;
                        }
                        if (!Bridge.staticEquals(this._OnMouseLeaveToolTip, null)) {
                            this.Content.removeEventListener("mouseleave", this._OnMouseLeaveToolTip);
                            this._OnMouseLeaveToolTip = null;
                        }
                    }
                }
            },
            Style: {
                get: function () {
                    return this.Content.style;
                }
            },
            ClassList: {
                get: function () {
                    return this.Content.classList;
                }
            },
            Width: {
                get: function () {
                    return this.Content.style.width;
                },
                set: function (value) {
                    var x = ExpressCraft.Helper.ToHtmlValue(value);
                    x = ExpressCraft.Vector2.pf(x);
                    if (!Bridge.referenceEquals(this.Content.style.width, x)) {
                        this.Content.style.width = x;
                        this.OnSizeChanged();
                    }
                }
            },
            Height: {
                get: function () {
                    return this.Content.style.height;
                },
                set: function (value) {
                    var x = ExpressCraft.Helper.ToHtmlValue(value);
                    x = ExpressCraft.Vector2.pf(x);
                    if (!Bridge.referenceEquals(x, this.Content.style.height)) {
                        this.Content.style.height = x;
                        this.OnSizeChanged();
                    }
                }
            },
            Left: {
                get: function () {
                    return this.Content.style.left;
                },
                set: function (value) {
                    var x = ExpressCraft.Helper.ToHtmlValue(value);
                    x = ExpressCraft.Vector2.pf(x);
                    if (!Bridge.referenceEquals(x, this.Content.style.left)) {
                        this.Content.style.left = x;
                        this.OnLocationChanged();
                    }
                }
            },
            Top: {
                get: function () {
                    return this.Content.style.top;
                },
                set: function (value) {
                    var x = ExpressCraft.Helper.ToHtmlValue(value);
                    x = ExpressCraft.Vector2.pf(x);
                    if (!Bridge.referenceEquals(this.Content.style.top, x)) {
                        this.Content.style.top = x;
                        this.OnLocationChanged();
                    }
                }
            },
            Size: {
                get: function () {
                    return new ExpressCraft.Vector2.$ctor1(this.Width, this.Height);
                },
                set: function (value) {
                    this.Width = value.X;
                    this.Height = value.Y;
                }
            },
            Location: {
                get: function () {
                    return new ExpressCraft.Vector2.$ctor1(this.Left, this.Top);
                },
                set: function (value) {
                    this.Left = value.X;
                    this.Top = value.Y;
                }
            },
            Bounds: {
                get: function () {
                    return new ExpressCraft.Vector4.$ctor1(this.Left, this.Top, this.Width, this.Height);
                },
                set: function (value) {
                    this.Left = value.X;
                    this.Top = value.Y;
                    this.Width = value.Z;
                    this.Height = value.M;
                }
            }
        },
        ctors: {
            init: function () {
                this.HasRendered = false;
            },
            $ctor1: function (ac) {
                if (ac === void 0) { ac = true; }

                this.$initialize();
                this.Content = ExpressCraft.Control.Div(ac);
            },
            ctor: function (element) {
                this.$initialize();
                this.Content = element;
            },
            $ctor5: function (cn, ac) {
                if (ac === void 0) { ac = true; }

                this.$initialize();
                this.Content = ExpressCraft.Control.Div$1(cn, ac);
            },
            $ctor2: function (cn, bt, ac) {
                if (ac === void 0) { ac = true; }

                this.$initialize();
                this.Content = ExpressCraft.Control.Button(cn, bt, ac);
            },
            $ctor4: function (cn, ct, ac) {
                if (ac === void 0) { ac = true; }

                this.$initialize();
                this.Content = ExpressCraft.Control.ComboBox(cn, ct, ac);
            },
            $ctor3: function (cn, it, ac) {
                if (ac === void 0) { ac = true; }

                this.$initialize();
                this.Content = ExpressCraft.Control.Input(cn, it, ac);
            }
        },
        methods: {
            SetAttribute: function (name, value) {
                this.Content.setAttribute(name, ExpressCraft.Helper.ToStr(value));

                return this;
            },
            GetAttribute: function (name) {
                return this.Content.getAttribute(name);
            },
            GetAttributei: function (name) {
                return parseInt(this.Content.getAttribute(name));
            },
            GetAttributef: function (name) {
                return parseFloat(this.Content.getAttribute(name));
            },
            OnLocationChanged: function () { },
            OnSizeChanged: function () { },
            Render: function () {
                this.HasRendered = true;
            },
            Focus: function () {
                Bridge.global.setTimeout(Bridge.fn.bind(this, $asm.$.ExpressCraft.Control.f3), 0);
            },
            ChangeState: function (s, sf) {
                if (sf === void 0) { sf = "disabled"; }
                if (s) {
                    this.Content.classList.remove(sf);
                } else {
                    this.Content.classList.add(sf);
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.Control", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.Control, {
        f1: function (ev) {
            if (!(Bridge.is(this, ExpressCraft.ToolTipControl))) {
                ExpressCraft.Form.ActiveToolTip = this._toolTip;
            }
        },
        f2: function (ev) {
            if (!(Bridge.is(this, ExpressCraft.ToolTipControl))) {
                ExpressCraft.Form.ActiveToolTip = null;
            }
        },
        f3: function () {
            this.Content.focus();
        }
    });

    Bridge.define("ExpressCraft.AceModeTypes", {
        $kind: "enum",
        statics: {
            fields: {
                abap: 0,
                abc: 1,
                actionscript: 2,
                ada: 3,
                apache_conf: 4,
                asciidoc: 5,
                assembly_x86: 6,
                autohotkey: 7,
                batchfile: 8,
                bro: 9,
                c_cpp: 10,
                c9search: 11,
                cirru: 12,
                clojure: 13,
                cobol: 14,
                coffee: 15,
                coldfusion: 16,
                csharp: 17,
                css: 18,
                curly: 19,
                d: 20,
                dart: 21,
                diff: 22,
                dockerfile: 23,
                dot: 24,
                drools: 25,
                dummy: 26,
                dummysyntax: 27,
                eiffel: 28,
                ejs: 29,
                elixir: 30,
                elm: 31,
                erlang: 32,
                forth: 33,
                fortran: 34,
                ftl: 35,
                gcode: 36,
                gherkin: 37,
                gitignore: 38,
                glsl: 39,
                gobstones: 40,
                golang: 41,
                groovy: 42,
                haml: 43,
                handlebars: 44,
                haskell: 45,
                haskell_cabal: 46,
                haxe: 47,
                hjson: 48,
                html: 49,
                html_elixir: 50,
                html_ruby: 51,
                ini: 52,
                io: 53,
                jack: 54,
                jade: 55,
                java: 56,
                javascript: 57,
                json: 58,
                jsoniq: 59,
                jsp: 60,
                jsx: 61,
                julia: 62,
                kotlin: 63,
                latex: 64,
                less: 65,
                liquid: 66,
                lisp: 67,
                livescript: 68,
                logiql: 69,
                lsl: 70,
                lua: 71,
                luapage: 72,
                lucene: 73,
                makefile: 74,
                markdown: 75,
                mask: 76,
                matlab: 77,
                maze: 78,
                mel: 79,
                mushcode: 80,
                mysql: 81,
                nix: 82,
                nsis: 83,
                objectivec: 84,
                ocaml: 85,
                pascal: 86,
                perl: 87,
                pgsql: 88,
                php: 89,
                powershell: 90,
                praat: 91,
                prolog: 92,
                properties: 93,
                protobuf: 94,
                python: 95,
                r: 96,
                razor: 97,
                rdoc: 98,
                rhtml: 99,
                rst: 100,
                ruby: 101,
                rust: 102,
                sass: 103,
                scad: 104,
                scala: 105,
                scheme: 106,
                scss: 107,
                sh: 108,
                sjs: 109,
                smarty: 110,
                snippets: 111,
                soy_template: 112,
                space: 113,
                sql: 114,
                sqlserver: 115,
                stylus: 116,
                svg: 117,
                swift: 118,
                tcl: 119,
                tex: 120,
                text: 121,
                textile: 122,
                toml: 123,
                tsx: 124,
                twig: 125,
                typescript: 126,
                vala: 127,
                vbscript: 128,
                velocity: 129,
                verilog: 130,
                vhdl: 131,
                wollok: 132,
                xml: 133,
                xquery: 134,
                yaml: 135,
                django: 136
            }
        }
    });

    Bridge.define("ExpressCraft.AceThemeTypes", {
        $kind: "enum",
        statics: {
            fields: {
                label: 0,
                chrome: 1,
                clouds: 2,
                crimson_editor: 3,
                dawn: 4,
                dreamweaver: 5,
                eclipse: 6,
                github: 7,
                solarized_light: 8,
                textmate: 9,
                tomorrow: 10,
                xcode: 11,
                clouds_midnight: 12,
                cobalt: 13,
                idle_fingers: 14,
                kr_theme: 15,
                merbivore: 16,
                merbivore_soft: 17,
                mono_industrial: 18,
                monokai: 19,
                pastel_on_dark: 20,
                solarized_dark: 21,
                terminal: 22,
                tomorrow_night: 23,
                tomorrow_night_blue: 24,
                tomorrow_night_bright: 25,
                tomorrow_night_eighties: 26,
                twilight: 27,
                vibrant_ink: 28
            }
        }
    });

    Bridge.define("ExpressCraft.App", {
        main: function Main () {
            ExpressCraft.Settings.Setup();
        }
    });

    Bridge.define("ExpressCraft.Application", {
        statics: {
            fields: {
                MainForm: null,
                _applicationDefition: 0
            },
            props: {
                AplicationDefition: {
                    get: function () {
                        return ExpressCraft.Application._applicationDefition;
                    }
                }
            },
            ctors: {
                init: function () {
                    this._applicationDefition = ExpressCraft.ApplicationDefitnion.BridgeConsole;
                }
            },
            methods: {
                Close: function () {
                    if (ExpressCraft.Application.MainForm != null) {
                        ExpressCraft.Application.MainForm.Close();
                    }
                    window.close();
                    window.location.reload();
                },
                Run: function (_Mainform) {
                    ExpressCraft.Application.MainForm = _Mainform;
                    ExpressCraft.Application.MainForm.ShowStartNewLevel();
                }
            }
        }
    });

    Bridge.define("ExpressCraft.ApplicationDefitnion", {
        $kind: "enum",
        statics: {
            fields: {
                None: 0,
                BrowserConsole: 1,
                BridgeConsole: 2,
                ExpressCraftConsole: 3
            }
        }
    });

    Bridge.define("ExpressCraft.BarcodeQuaggaJS", {
        statics: {
            fields: {
                ExternalQuaggaJS: null
            },
            ctors: {
                init: function () {
                    this.ExternalQuaggaJS = new ExpressCraft.ExternalPlugin("https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js");
                }
            },
            methods: {
                Setup: function () {
                    ExpressCraft.BarcodeQuaggaJS.ExternalQuaggaJS.Setup(true, true);
                },
                DecodeSingle: function (source, onDetect, onNoDetect, locate, reader, sourceIsBase64) {
                    if (onNoDetect === void 0) { onNoDetect = null; }
                    if (locate === void 0) { locate = true; }
                    if (reader === void 0) { reader = 3; }
                    if (sourceIsBase64 === void 0) { sourceIsBase64 = false; }
                    if (!ExpressCraft.BarcodeQuaggaJS.ExternalQuaggaJS.SetupCompleted) {
                        return;
                    }

                    if (Bridge.staticEquals(onDetect, null)) {
                        return;
                    }

                    var codeName = System.Enum.format(ExpressCraft.BarcodeQuaggaJS.Readers, reader, "G").toLowerCase();
                    if (System.String.startsWith(codeName, "_")) {
                        codeName = codeName.substr(1);
                    }
                    if (sourceIsBase64 && !System.String.startsWith(source, "data:image")) {
                        source = System.String.concat("data:image/jpg;base64,", source);
                    }
                    Quagga.decodeSingle({
                        decoder: {
                            readers: [codeName] // List of active readers
                        },
                        locate: locate,
                        src: source
                    }, function(ond, onnd) {
                        return function(result){
                            if(result.codeResult) {
                                ond(result.codeResult.code);
                            } else {
                                if(onnd != null)
                                {
                                    onnd();
                                }
                            }
                        }
                    }(onDetect, onNoDetect));
                }
            }
        }
    });

    Bridge.define("ExpressCraft.BarcodeQuaggaJS.Readers", {
        $kind: "enum",
        statics: {
            fields: {
                Code_128_Reader: 0,
                Ean_Reader: 1,
                Ean_8_Reader: 2,
                Code_39_Reader: 3,
                Code_39_Vin_Reader: 4,
                Codabar_Reader: 5,
                Upc_Reader: 6,
                Upc_e_Reader: 7,
                I2of5_Reader: 8,
                _2of5_Reader: 9,
                Code_93_Reader: 10
            }
        }
    });

    Bridge.define("ExpressCraft.Color", {
        $kind: "struct",
        statics: {
            fields: {
                Empty: null,
                StateKnownColorValid: 0,
                StateARGBValueValid: 0,
                StateValueMask: 0,
                StateNameValid: 0,
                NotDefinedValue: System.Int64(0),
                ARGBAlphaShift: 0,
                ARGBRedShift: 0,
                ARGBGreenShift: 0,
                ARGBBlueShift: 0,
                q: 0
            },
            props: {
                Transparent: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Transparent);
                    }
                },
                AliceBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.AliceBlue);
                    }
                },
                AntiqueWhite: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.AntiqueWhite);
                    }
                },
                Aqua: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Aqua);
                    }
                },
                Aquamarine: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Aquamarine);
                    }
                },
                Azure: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Azure);
                    }
                },
                Beige: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Beige);
                    }
                },
                Bisque: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Bisque);
                    }
                },
                Black: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Black);
                    }
                },
                BlanchedAlmond: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.BlanchedAlmond);
                    }
                },
                Blue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Blue);
                    }
                },
                BlueViolet: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.BlueViolet);
                    }
                },
                Brown: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Brown);
                    }
                },
                BurlyWood: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.BurlyWood);
                    }
                },
                CadetBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.CadetBlue);
                    }
                },
                Chartreuse: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Chartreuse);
                    }
                },
                Chocolate: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Chocolate);
                    }
                },
                Coral: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Coral);
                    }
                },
                CornflowerBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.CornflowerBlue);
                    }
                },
                Cornsilk: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Cornsilk);
                    }
                },
                Crimson: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Crimson);
                    }
                },
                Cyan: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Cyan);
                    }
                },
                DarkBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkBlue);
                    }
                },
                DarkCyan: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkCyan);
                    }
                },
                DarkGoldenrod: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkGoldenrod);
                    }
                },
                DarkGray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkGray);
                    }
                },
                DarkGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkGreen);
                    }
                },
                DarkKhaki: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkKhaki);
                    }
                },
                DarkMagenta: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkMagenta);
                    }
                },
                DarkOliveGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkOliveGreen);
                    }
                },
                DarkOrange: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkOrange);
                    }
                },
                DarkOrchid: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkOrchid);
                    }
                },
                DarkRed: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkRed);
                    }
                },
                DarkSalmon: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkSalmon);
                    }
                },
                DarkSeaGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkSeaGreen);
                    }
                },
                DarkSlateBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkSlateBlue);
                    }
                },
                DarkSlateGray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkSlateGray);
                    }
                },
                DarkTurquoise: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkTurquoise);
                    }
                },
                DarkViolet: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DarkViolet);
                    }
                },
                DeepPink: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DeepPink);
                    }
                },
                DeepSkyBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DeepSkyBlue);
                    }
                },
                DimGray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DimGray);
                    }
                },
                DodgerBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.DodgerBlue);
                    }
                },
                Firebrick: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Firebrick);
                    }
                },
                FloralWhite: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.FloralWhite);
                    }
                },
                ForestGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.ForestGreen);
                    }
                },
                Fuchsia: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Fuchsia);
                    }
                },
                Gainsboro: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Gainsboro);
                    }
                },
                GhostWhite: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.GhostWhite);
                    }
                },
                Gold: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Gold);
                    }
                },
                Goldenrod: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Goldenrod);
                    }
                },
                Gray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Gray);
                    }
                },
                Green: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Green);
                    }
                },
                GreenYellow: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.GreenYellow);
                    }
                },
                Honeydew: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Honeydew);
                    }
                },
                HotPink: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.HotPink);
                    }
                },
                IndianRed: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.IndianRed);
                    }
                },
                Indigo: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Indigo);
                    }
                },
                Ivory: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Ivory);
                    }
                },
                Khaki: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Khaki);
                    }
                },
                Lavender: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Lavender);
                    }
                },
                LavenderBlush: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LavenderBlush);
                    }
                },
                LawnGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LawnGreen);
                    }
                },
                LemonChiffon: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LemonChiffon);
                    }
                },
                LightBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightBlue);
                    }
                },
                LightCoral: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightCoral);
                    }
                },
                LightCyan: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightCyan);
                    }
                },
                LightGoldenrodYellow: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightGoldenrodYellow);
                    }
                },
                LightGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightGreen);
                    }
                },
                LightGray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightGray);
                    }
                },
                LightPink: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightPink);
                    }
                },
                LightSalmon: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightSalmon);
                    }
                },
                LightSeaGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightSeaGreen);
                    }
                },
                LightSkyBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightSkyBlue);
                    }
                },
                LightSlateGray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightSlateGray);
                    }
                },
                LightSteelBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightSteelBlue);
                    }
                },
                LightYellow: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LightYellow);
                    }
                },
                Lime: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Lime);
                    }
                },
                LimeGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.LimeGreen);
                    }
                },
                Linen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Linen);
                    }
                },
                Magenta: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Magenta);
                    }
                },
                Maroon: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Maroon);
                    }
                },
                MediumAquamarine: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumAquamarine);
                    }
                },
                MediumBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumBlue);
                    }
                },
                MediumOrchid: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumOrchid);
                    }
                },
                MediumPurple: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumPurple);
                    }
                },
                MediumSeaGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumSeaGreen);
                    }
                },
                MediumSlateBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumSlateBlue);
                    }
                },
                MediumSpringGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumSpringGreen);
                    }
                },
                MediumTurquoise: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumTurquoise);
                    }
                },
                MediumVioletRed: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MediumVioletRed);
                    }
                },
                MidnightBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MidnightBlue);
                    }
                },
                MintCream: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MintCream);
                    }
                },
                MistyRose: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.MistyRose);
                    }
                },
                Moccasin: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Moccasin);
                    }
                },
                NavajoWhite: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.NavajoWhite);
                    }
                },
                Navy: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Navy);
                    }
                },
                OldLace: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.OldLace);
                    }
                },
                Olive: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Olive);
                    }
                },
                OliveDrab: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.OliveDrab);
                    }
                },
                Orange: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Orange);
                    }
                },
                OrangeRed: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.OrangeRed);
                    }
                },
                Orchid: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Orchid);
                    }
                },
                PaleGoldenrod: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PaleGoldenrod);
                    }
                },
                PaleGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PaleGreen);
                    }
                },
                PaleTurquoise: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PaleTurquoise);
                    }
                },
                PaleVioletRed: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PaleVioletRed);
                    }
                },
                PapayaWhip: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PapayaWhip);
                    }
                },
                PeachPuff: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PeachPuff);
                    }
                },
                Peru: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Peru);
                    }
                },
                Pink: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Pink);
                    }
                },
                Plum: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Plum);
                    }
                },
                PowderBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.PowderBlue);
                    }
                },
                Purple: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Purple);
                    }
                },
                Red: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Red);
                    }
                },
                RosyBrown: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.RosyBrown);
                    }
                },
                RoyalBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.RoyalBlue);
                    }
                },
                SaddleBrown: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SaddleBrown);
                    }
                },
                Salmon: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Salmon);
                    }
                },
                SandyBrown: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SandyBrown);
                    }
                },
                SeaGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SeaGreen);
                    }
                },
                SeaShell: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SeaShell);
                    }
                },
                Sienna: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Sienna);
                    }
                },
                Silver: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Silver);
                    }
                },
                SkyBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SkyBlue);
                    }
                },
                SlateBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SlateBlue);
                    }
                },
                SlateGray: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SlateGray);
                    }
                },
                Snow: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Snow);
                    }
                },
                SpringGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SpringGreen);
                    }
                },
                SteelBlue: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.SteelBlue);
                    }
                },
                Tan: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Tan);
                    }
                },
                Teal: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Teal);
                    }
                },
                Thistle: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Thistle);
                    }
                },
                Tomato: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Tomato);
                    }
                },
                Turquoise: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Turquoise);
                    }
                },
                Violet: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Violet);
                    }
                },
                Wheat: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Wheat);
                    }
                },
                White: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.White);
                    }
                },
                WhiteSmoke: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.WhiteSmoke);
                    }
                },
                Yellow: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.Yellow);
                    }
                },
                YellowGreen: {
                    get: function () {
                        return new ExpressCraft.Color.$ctor1(ExpressCraft.KnownColor.YellowGreen);
                    }
                }
            },
            ctors: {
                init: function () {
                    this.Empty = new ExpressCraft.Color();
                    this.ARGBAlphaShift = 24;
                    this.ARGBRedShift = 16;
                    this.ARGBGreenShift = 8;
                    this.ARGBBlueShift = 0;
                    this.q = 255.0;
                },
                ctor: function () {
                    ExpressCraft.Color.Empty = new ExpressCraft.Color.ctor();
                    ExpressCraft.Color.StateKnownColorValid = 1;
                    ExpressCraft.Color.StateARGBValueValid = 2;
                    ExpressCraft.Color.StateValueMask = ExpressCraft.Color.StateARGBValueValid;
                    ExpressCraft.Color.StateNameValid = 8;
                    ExpressCraft.Color.NotDefinedValue = System.Int64(0);
                }
            },
            methods: {
                CheckByte: function (value) {
                    if ((value < 0) || (value > 255)) {
                        throw new System.ArgumentException("InvalidEx2BoundArgument");
                    }
                },
                MakeArgb: function (alpha, red, green, blue) {
                    return System.Int64.clip64(Bridge.Int.clipu64((((red << 16) | (green << 8)) | blue) | (alpha << 24)).and(System.UInt64(System.Int64([-1,0]))));
                },
                FromArgb: function (argb) {
                    return new ExpressCraft.Color.$ctor2(System.Int64(argb).and((System.Int64([-1,0]))), ExpressCraft.Color.StateARGBValueValid, null, 0);
                },
                FromArgb$3: function (alpha, red, green, blue) {
                    ExpressCraft.Color.CheckByte(alpha);
                    ExpressCraft.Color.CheckByte(red);
                    ExpressCraft.Color.CheckByte(green);
                    ExpressCraft.Color.CheckByte(blue);
                    return new ExpressCraft.Color.$ctor2(ExpressCraft.Color.MakeArgb((alpha & 255), (red & 255), (green & 255), (blue & 255)), ExpressCraft.Color.StateARGBValueValid, null, 0);
                },
                FromArgb$1: function (alpha, baseColor) {
                    ExpressCraft.Color.CheckByte(alpha);
                    return new ExpressCraft.Color.$ctor2(ExpressCraft.Color.MakeArgb((alpha & 255), baseColor.R, baseColor.G, baseColor.B), ExpressCraft.Color.StateARGBValueValid, null, 0);
                },
                FromArgb$2: function (red, green, blue) {
                    return ExpressCraft.Color.FromArgb$3(255, red, green, blue);
                },
                IsEnumValid: function (enumValue, value, minValue, maxValue) {
                    return ((value >= minValue) && (value <= maxValue));
                },
                FromKnownColor: function (color) {
                    return new ExpressCraft.Color.$ctor1(color);
                },
                FromHex: function (value) {
                    if (System.String.startsWith(value, "#")) {
                        return ExpressCraft.Color.FromHex(value.substr(1));
                    } else {
                        return ExpressCraft.Color.FromArgb(parseInt(value));
                    }
                },
                op_Implicit$1: function (color) {
                    return color.ToHex();
                },
                op_Implicit: function (hexValue) {
                    return ExpressCraft.Color.FromHex(hexValue);
                },
                op_Equality: function (left, right) {
                    if (((left.value.ne(right.value)) || (left.state !== right.state)) || (left.knownColor !== right.knownColor)) {
                        return false;
                    }
                    return ((Bridge.referenceEquals(left.name, right.name)) || (((left.name != null) && (right.name != null)) && System.String.equals(left.name, right.name)));
                },
                op_Inequality: function (left, right) {
                    return !(ExpressCraft.Color.op_Equality(left.$clone(), right.$clone()));
                },
                getDefaultValue: function () { return new ExpressCraft.Color(); }
            }
        },
        fields: {
            name: null,
            value: System.Int64(0),
            knownColor: 0,
            state: 0
        },
        props: {
            R: {
                get: function () {
                    return System.Int64.clipu8((this.Value.shr(16)).and(System.Int64(255)));
                }
            },
            G: {
                get: function () {
                    return System.Int64.clipu8((this.Value.shr(8)).and(System.Int64(255)));
                }
            },
            B: {
                get: function () {
                    return System.Int64.clipu8(this.Value.and(System.Int64(255)));
                }
            },
            A: {
                get: function () {
                    return System.Int64.clipu8((this.Value.shr(24)).and(System.Int64(255)));
                }
            },
            IsKnownColor: {
                get: function () {
                    return ((this.state & ExpressCraft.Color.StateKnownColorValid) > 0);
                }
            },
            IsEmpty: {
                get: function () {
                    return (this.state === 0);
                }
            },
            IsNamedColor: {
                get: function () {
                    if ((this.state & ExpressCraft.Color.StateNameValid) === 0) {
                        return this.IsKnownColor;
                    }
                    return true;
                }
            },
            IsSystemColor: {
                get: function () {
                    if (!this.IsKnownColor) {
                        return false;
                    }
                    if (this.knownColor > 26) {
                        return (this.knownColor > 167);
                    }
                    return true;
                }
            },
            NameAndARGBValue: {
                get: function () {
                    return System.String.format("{{Name={0}, ARGB=({1}, {2}, {3}, {4})}}", this.Name, Bridge.box(this.A, System.Byte), Bridge.box(this.R, System.Byte), Bridge.box(this.G, System.Byte), Bridge.box(this.B, System.Byte));
                }
            },
            Name: {
                get: function () {
                    if ((this.state & ExpressCraft.Color.StateNameValid) !== 0) {
                        return this.name;
                    }
                    if (!this.IsKnownColor) {
                        return System.Convert.toStringInBase(this.value, 16, 11);
                    }
                    var str = ExpressCraft.KnownColorTable.KnownColorToName(this.knownColor);
                    if (str != null) {
                        return str;
                    }
                    return this.knownColor.toString();
                }
            },
            Value: {
                get: function () {
                    if ((this.state & ExpressCraft.Color.StateValueMask) !== 0) {
                        return this.value;
                    }
                    if (this.IsKnownColor) {
                        return System.Int64(ExpressCraft.KnownColorTable.KnownColorToArgb(this.knownColor));
                    }
                    return ExpressCraft.Color.NotDefinedValue;
                }
            }
        },
        ctors: {
            $ctor1: function (knownColor) {
                this.$initialize();
                this.value = System.Int64(0);
                this.state = ExpressCraft.Color.StateKnownColorValid;
                this.name = null;
                this.knownColor = Bridge.Int.sxs(knownColor & 65535);
            },
            $ctor2: function (value, state, name, knownColor) {
                this.$initialize();
                this.value = value;
                this.state = state;
                this.name = name;
                this.knownColor = Bridge.Int.sxs(knownColor & 65535);
            },
            ctor: function () {
                this.$initialize();
            }
        },
        methods: {
            componentToHex: function (value) {
                var x = value.toString(16);
                return System.String.concat((x.length === 1 ? "0" : ""), x);
            },
            ToHex: function () {
                if (this.A !== 255) {
                    return System.String.format("#{0}{1}{2}{3}", this.componentToHex(this.A), this.componentToHex(this.R), this.componentToHex(this.G), this.componentToHex(this.B)); // "#" + (155).toString(16) + (102).toString(16) + (102).toString(16);
                } else {
                    return System.String.format("#{0}{1}{2}", this.componentToHex(this.R), this.componentToHex(this.G), this.componentToHex(this.B)); // "#" + (155).toString(16) + (102).toString(16) + (102).toString(16);
                }
            },
            GetBrightness: function () {
                var z = this.R / ExpressCraft.Color.q;
                var x = this.G / ExpressCraft.Color.q;
                var c = this.B / ExpressCraft.Color.q;
                var v = z;
                var b = z;
                if (x > v) {
                    v = x;
                }
                if (c > v) {
                    v = c;
                }
                if (x < b) {
                    b = x;
                }
                if (c < b) {
                    b = c;
                }
                return ((v + b) / 2.0);
            },
            GetHue: function () {
                if ((this.R === this.G) && (this.G === this.B)) {
                    return 0.0;
                }
                var z = this.R / ExpressCraft.Color.q;
                var x = this.G / ExpressCraft.Color.q;
                var c = this.B / ExpressCraft.Color.q;
                var v = 0.0;
                var b = z;
                var n = z;
                if (x > b) {
                    b = x;
                }
                if (c > b) {
                    b = c;
                }
                if (x < n) {
                    n = x;
                }
                if (c < n) {
                    n = c;
                }
                var num6 = b - n;
                if (z === b) {
                    v = (x - c) / num6;
                } else if (x === b) {
                    v = 2.0 + ((c - z) / num6);
                } else if (c === b) {
                    v = 4.0 + ((z - x) / num6);
                }
                v *= 60.0;
                if (v < 0.0) {
                    v += 360.0;
                }
                return v;
            },
            GetSaturation: function () {
                var z = this.R / ExpressCraft.Color.q;
                var x = this.G / ExpressCraft.Color.q;
                var c = this.B / ExpressCraft.Color.q;
                var v = 0.0;
                var b = z;
                var n = z;
                if (x > b) {
                    b = x;
                }
                if (c > b) {
                    b = c;
                }
                if (x < n) {
                    n = x;
                }
                if (c < n) {
                    n = c;
                }
                if (b === n) {
                    return v;
                }
                var m = (b + n) / 2.0;
                if (m <= 0.5) {
                    return ((b - n) / (b + n));
                }
                return ((b - n) / ((2.0 - b) - n));
            },
            ToArgb: function () {
                return System.Int64.clip32(this.Value);
            },
            ToKnownColor: function () {
                return this.knownColor;
            },
            toString: function () {
                var builder = new System.Text.StringBuilder("", 32);
                builder.append(Bridge.Reflection.getTypeName(Bridge.getType(this)));
                builder.append(" [");
                if ((this.state & ExpressCraft.Color.StateNameValid) !== 0) {
                    builder.append(this.Name);
                } else if ((this.state & ExpressCraft.Color.StateKnownColorValid) !== 0) {
                    builder.append(this.Name);
                } else if ((this.state & ExpressCraft.Color.StateValueMask) !== 0) {
                    builder.appendFormat("A={0}, R={1}, G={2}, B={3}", Bridge.box(this.A, System.Byte), Bridge.box(this.R, System.Byte), Bridge.box(this.G, System.Byte), Bridge.box(this.B, System.Byte));
                } else {
                    builder.append("Empty");
                }
                builder.append("]");
                return builder.toString();
            },
            equals: function (obj) {
                if (Bridge.is(obj, ExpressCraft.Color)) {
                    var color = System.Nullable.getValue(Bridge.cast(Bridge.unbox(obj), ExpressCraft.Color));
                    if (((this.value.equals(color.value)) && (this.state === color.state)) && (this.knownColor === color.knownColor)) {
                        return ((Bridge.referenceEquals(this.name, color.name)) || (((this.name != null) && (color.name != null)) && System.String.equals(this.name, this.name)));
                    }
                }
                return false;
            },
            getHashCode: function () {
                return ((Bridge.getHashCode(this.value) ^ Bridge.getHashCode(this.state)) ^ Bridge.getHashCode(this.knownColor));
            },
            $clone: function (to) {
                var s = to || new ExpressCraft.Color();
                s.name = this.name;
                s.value = this.value;
                s.knownColor = this.knownColor;
                s.state = this.state;
                return s;
            }
        }
    });

    Bridge.define("ExpressCraft.ComboBoxTypes", {
        $kind: "enum",
        statics: {
            fields: {
                Default: 0
            }
        }
    });

    Bridge.define("ExpressCraft.ConsoleLogType", {
        $kind: "enum",
        statics: {
            fields: {
                Log: 0,
                Debug: 1,
                Error: 2
            }
        }
    });

    Bridge.define("ExpressCraft.ContextItem", {
        fields: {
            Caption: null,
            OnItemClick: null,
            BeginGroup: false,
            Enabled: false
        },
        ctors: {
            init: function () {
                this.Caption = "";
                this.BeginGroup = false;
                this.Enabled = true;
            },
            ctor: function () {
                this.$initialize();
            },
            $ctor2: function (caption, beginGroup) {
                if (beginGroup === void 0) { beginGroup = false; }

                this.$initialize();
                this.Caption = caption;
                this.BeginGroup = beginGroup;
            },
            $ctor1: function (caption, _OnItemClick, beginGroup) {
                if (beginGroup === void 0) { beginGroup = false; }

                this.$initialize();
                this.Caption = caption;
                this.BeginGroup = beginGroup;
                this.OnItemClick = _OnItemClick;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumn", {
        fields: {
            FieldName: null,
            DataType: 0
        },
        methods: {
            GetDisplayValue$1: function (rowIndex, formatString) {
                switch (this.DataType) {
                    default: 
                    case ExpressCraft.DataType.Object: 
                        return System.String.format(formatString, (Bridge.cast(this, ExpressCraft.DataColumnObject).Cells.getItem(rowIndex)));
                    case ExpressCraft.DataType.DateTime: 
                        var obj = Bridge.cast(this, ExpressCraft.DataColumnDateTime).Cells.getItem(rowIndex);
                        if (obj == null) {
                            return "";
                        }
                        if (Bridge.is(obj, System.DateTime)) {
                            return System.String.format(formatString, Bridge.box(Bridge.cast(obj, System.DateTime), System.DateTime, System.DateTime.format));
                        }
                        var d = { };
                        if (System.DateTime.tryParse(obj, null, d)) {
                            return System.String.format(formatString, Bridge.box(d.v, System.DateTime, System.DateTime.format));
                        }
                        var str = Bridge.as(obj, System.String);
                        if (System.String.isNullOrWhiteSpace(str)) {
                            return "";
                        }
                        return System.String.format(formatString, str);
                    case ExpressCraft.DataType.String: 
                        return System.String.format(formatString, Bridge.cast(this, ExpressCraft.DataColumnString).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Integer: 
                        return System.String.format(formatString, Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnInteger).Cells.getItem(rowIndex), System.Int32, System.Nullable.toString, System.Nullable.getHashCode));
                    case ExpressCraft.DataType.Long: 
                        return System.String.format(formatString, Bridge.cast(this, ExpressCraft.DataColumnLong).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Float: 
                        return System.String.format(formatString, Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnFloat).Cells.getItem(rowIndex), System.Single, System.Nullable.toStringFn(System.Single.format), System.Nullable.getHashCodeFn(System.Single.getHashCode)));
                    case ExpressCraft.DataType.Double: 
                        return System.String.format(formatString, Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnDouble).Cells.getItem(rowIndex), System.Double, System.Nullable.toStringFn(System.Double.format), System.Nullable.getHashCodeFn(System.Double.getHashCode)));
                    case ExpressCraft.DataType.Decimal: 
                        return System.String.format(formatString, Bridge.cast(this, ExpressCraft.DataColumnDecimal).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Byte: 
                        return System.String.format(formatString, Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnByte).Cells.getItem(rowIndex), System.Byte, System.Nullable.toString, System.Nullable.getHashCode));
                    case ExpressCraft.DataType.Short: 
                        return System.String.format(formatString, Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnShort).Cells.getItem(rowIndex), System.Int16, System.Nullable.toString, System.Nullable.getHashCode));
                    case ExpressCraft.DataType.Bool: 
                        return System.String.format(formatString, Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnBool).Cells.getItem(rowIndex), System.Boolean, System.Nullable.toStringFn(System.Boolean.toString), System.Nullable.getHashCode));
                }
            },
            GetDisplayValue: function (rowIndex) {
                switch (this.DataType) {
                    default: 
                    case ExpressCraft.DataType.Object: 
                        return System.Convert.toString(Bridge.cast(this, ExpressCraft.DataColumnObject).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.DateTime: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnDateTime).Cells.getItem(rowIndex), System.DateTime, System.Nullable.toStringFn(System.DateTime.format), System.Nullable.getHashCode));
                    case ExpressCraft.DataType.String: 
                        return Bridge.cast(this, ExpressCraft.DataColumnString).Cells.getItem(rowIndex);
                    case ExpressCraft.DataType.Integer: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnInteger).Cells.getItem(rowIndex), System.Int32, System.Nullable.toString, System.Nullable.getHashCode));
                    case ExpressCraft.DataType.Long: 
                        return System.Convert.toString(Bridge.cast(this, ExpressCraft.DataColumnLong).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Float: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnFloat).Cells.getItem(rowIndex), System.Single, System.Nullable.toStringFn(System.Single.format), System.Nullable.getHashCodeFn(System.Single.getHashCode)));
                    case ExpressCraft.DataType.Double: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnDouble).Cells.getItem(rowIndex), System.Double, System.Nullable.toStringFn(System.Double.format), System.Nullable.getHashCodeFn(System.Double.getHashCode)));
                    case ExpressCraft.DataType.Decimal: 
                        return System.Convert.toString(Bridge.cast(this, ExpressCraft.DataColumnDecimal).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Byte: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnByte).Cells.getItem(rowIndex), System.Byte, System.Nullable.toString, System.Nullable.getHashCode));
                    case ExpressCraft.DataType.Bool: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnBool).Cells.getItem(rowIndex), System.Boolean, System.Nullable.toStringFn(System.Boolean.toString), System.Nullable.getHashCode));
                    case ExpressCraft.DataType.Short: 
                        return System.Convert.toString(Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnShort).Cells.getItem(rowIndex), System.Int16, System.Nullable.toString, System.Nullable.getHashCode));
                }
            },
            GetCellValue: function (rowIndex) {
                switch (this.DataType) {
                    default: 
                    case ExpressCraft.DataType.Object: 
                        return Bridge.cast(this, ExpressCraft.DataColumnObject).Cells.getItem(rowIndex);
                    case ExpressCraft.DataType.DateTime: 
                        return Bridge.box(Bridge.cast(this, ExpressCraft.DataColumnDateTime).Cells.getItem(rowIndex), System.DateTime, System.Nullable.toStringFn(System.DateTime.format), System.Nullable.getHashCode);
                    case ExpressCraft.DataType.String: 
                        return Bridge.cast(this, ExpressCraft.DataColumnString).Cells.getItem(rowIndex);
                    case ExpressCraft.DataType.Integer: 
                        return Bridge.box((Bridge.cast(this, ExpressCraft.DataColumnInteger).Cells.getItem(rowIndex)), System.Int32, System.Nullable.toString, System.Nullable.getHashCode);
                    case ExpressCraft.DataType.Long: 
                        return (Bridge.cast(this, ExpressCraft.DataColumnLong).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Float: 
                        return Bridge.box((Bridge.cast(this, ExpressCraft.DataColumnFloat).Cells.getItem(rowIndex)), System.Single, System.Nullable.toStringFn(System.Single.format), System.Nullable.getHashCodeFn(System.Single.getHashCode));
                    case ExpressCraft.DataType.Double: 
                        return Bridge.box((Bridge.cast(this, ExpressCraft.DataColumnDouble).Cells.getItem(rowIndex)), System.Double, System.Nullable.toStringFn(System.Double.format), System.Nullable.getHashCodeFn(System.Double.getHashCode));
                    case ExpressCraft.DataType.Decimal: 
                        return (Bridge.cast(this, ExpressCraft.DataColumnDecimal).Cells.getItem(rowIndex));
                    case ExpressCraft.DataType.Byte: 
                        return Bridge.box((Bridge.cast(this, ExpressCraft.DataColumnByte).Cells.getItem(rowIndex)), System.Byte, System.Nullable.toString, System.Nullable.getHashCode);
                    case ExpressCraft.DataType.Bool: 
                        return Bridge.box((Bridge.cast(this, ExpressCraft.DataColumnBool).Cells.getItem(rowIndex)), System.Boolean, System.Nullable.toStringFn(System.Boolean.toString), System.Nullable.getHashCode);
                    case ExpressCraft.DataType.Short: 
                        return Bridge.box((Bridge.cast(this, ExpressCraft.DataColumnShort).Cells.getItem(rowIndex)), System.Int16, System.Nullable.toString, System.Nullable.getHashCode);
                }
            }
        }
    });

    Bridge.define("ExpressCraft.DataItem", {
        fields: {
            Text: null,
            Value: null
        },
        ctors: {
            $ctor1: function (text, value) {
                this.$initialize();
                this.Text = text;
                this.Value = value;
            },
            ctor: function (text) {
                this.$initialize();
                this.Text = text;
                this.Value = text;
            }
        }
    });

    Bridge.define("ExpressCraft.DataRow", {
        fields: {
            ParentTable: null,
            RowIndex: 0,
            batchData: null
        },
        ctors: {
            init: function () {
                this.RowIndex = -1;
            },
            ctor: function () {
                this.$initialize();
            },
            $ctor2: function (columnLength) {
                this.$initialize();
                this.ParentTable = null;
                this.RowIndex = -1;
                this.batchData = System.Array.init(columnLength, null, System.Object);
            },
            $ctor1: function (parentTable, rowIndex) {
                if (rowIndex === void 0) { rowIndex = -1; }

                this.$initialize();
                this.ParentTable = parentTable;
                this.RowIndex = rowIndex;
                if (rowIndex === -1) {
                    this.batchData = System.Array.init(parentTable.ColumnCount, null, System.Object);
                }
            }
        },
        methods: {
            getItem: function (columnIndex) {
                return this.GetValue(columnIndex);
            },
            setItem: function (columnIndex, value) {
                this.SetValue(columnIndex, value);
            },
            GetOfflineDataRow: function () {
                var dr = new ExpressCraft.DataRow.$ctor2(this.ParentTable.ColumnCount);
                var data = System.Array.init(this.ParentTable.ColumnCount, null, System.Object);
                for (var i = 0; i < this.ParentTable.ColumnCount; i = (i + 1) | 0) {
                    data[System.Array.index(i, data)] = this.getItem(i);
                }
                dr.batchData = data;
                return dr;
            },
            SetValue$1: function (fieldName, value) {
                for (var i = 0; i < this.ParentTable.ColumnCount; i = (i + 1) | 0) {
                    if (Bridge.referenceEquals(this.ParentTable.Columns.getItem(i).FieldName, fieldName)) {
                        if (this.RowIndex === -1) {
                            if (!Bridge.referenceEquals(this.batchData[System.Array.index(i, this.batchData)], value)) {
                                this.batchData[System.Array.index(i, this.batchData)] = value;
                                this.ParentTable.RequireOnDataChangeEvent();
                            }

                            return;
                        }
                        var col = this.ParentTable.Columns.getItem(i);
                        if (!Bridge.referenceEquals(col.Cells.items[this.RowIndex], value)) {
                            col.Cells.items[this.RowIndex] = Bridge.unbox(value);
                            this.ParentTable.RequireOnDataChangeEvent();
                        }
                        return;
                    }
                }
            },
            SetValue: function (columnIndex, value) {
                if (this.RowIndex === -1) {
                    if (!Bridge.referenceEquals(this.batchData[System.Array.index(columnIndex, this.batchData)], value)) {
                        this.batchData[System.Array.index(columnIndex, this.batchData)] = value;
                        this.ParentTable.RequireOnDataChangeEvent();
                    }

                    return;
                }
                var col = this.ParentTable.Columns.getItem(columnIndex);
                if (!Bridge.referenceEquals(col.Cells.items[this.RowIndex], value)) {
                    col.Cells.items[this.RowIndex] = Bridge.unbox(value);
                    this.ParentTable.RequireOnDataChangeEvent();
                }
            },
            GetValue$1: function (fieldName) {
                for (var i = 0; i < this.ParentTable.ColumnCount; i = (i + 1) | 0) {
                    if (Bridge.referenceEquals(this.ParentTable.Columns.getItem(i).FieldName, fieldName)) {
                        if (this.RowIndex === -1) {
                            return this.batchData[System.Array.index(i, this.batchData)];
                        }
                        var col = this.ParentTable.Columns.getItem(i);
                        return col.Cells.items[this.RowIndex];
                    }
                }
                return null;
            },
            GetValue: function (columnIndex) {
                if (this.RowIndex === -1) {
                    return this.batchData[System.Array.index(columnIndex, this.batchData)];
                }
                var col = this.ParentTable.Columns.getItem(columnIndex);
                return col.Cells.items[this.RowIndex];
            }
        }
    });

    Bridge.define("ExpressCraft.DataTable", {
        fields: {
            Columns: null,
            _inDataChange: false,
            _requestedOnDataChange: false,
            _ColCount: 0,
            _RowCount: 0,
            NewRows: null
        },
        events: {
            OnDataSourceChanged: null
        },
        props: {
            ColumnCount: {
                get: function () {
                    return this._ColCount;
                }
            },
            RowCount: {
                get: function () {
                    return this._RowCount;
                }
            }
        },
        ctors: {
            init: function () {
                this.Columns = new (System.Collections.Generic.List$1(ExpressCraft.DataColumn))();
                this._inDataChange = false;
                this._requestedOnDataChange = false;
                this.NewRows = new (System.Collections.Generic.List$1(ExpressCraft.DataRow))();
            }
        },
        methods: {
            getItem: function (rowIndex) {
                return new ExpressCraft.DataRow.$ctor1(this, rowIndex);
            },
            RequireOnDataChangeEvent: function () {
                if (!this._inDataChange) {
                    this._requestedOnDataChange = false;
                    if (!Bridge.staticEquals(this.OnDataSourceChanged, null)) {
                        this.OnDataSourceChanged(this, null);
                    }
                } else {
                    this._requestedOnDataChange = true;
                }
            },
            ClearRows: function () {
                this._RowCount = 0;
                for (var i = 0; i < this.Columns.Count; i = (i + 1) | 0) {
                    this.ClearCells(this.Columns.getItem(i));
                }
            },
            ClearCells$1: function (T, _column) {
                var _col = _column;
                _col.Cells = new (System.Collections.Generic.List$1(T))();
            },
            ClearCells: function (_column) {
                switch (_column.DataType) {
                    default: 
                    case ExpressCraft.DataType.Object: 
                        this.ClearCells$1(System.Object, _column);
                        break;
                    case ExpressCraft.DataType.DateTime: 
                        this.ClearCells$1(System.Nullable$1(System.DateTime), _column);
                        break;
                    case ExpressCraft.DataType.String: 
                        this.ClearCells$1(System.String, _column);
                        break;
                    case ExpressCraft.DataType.Integer: 
                        this.ClearCells$1(System.Nullable$1(System.Int32), _column);
                        break;
                    case ExpressCraft.DataType.Long: 
                        this.ClearCells$1(System.Nullable$1(System.Int64), _column);
                        break;
                    case ExpressCraft.DataType.Float: 
                        this.ClearCells$1(System.Nullable$1(System.Single), _column);
                        break;
                    case ExpressCraft.DataType.Double: 
                        this.ClearCells$1(System.Nullable$1(System.Double), _column);
                        break;
                    case ExpressCraft.DataType.Decimal: 
                        this.ClearCells$1(System.Nullable$1(System.Decimal), _column);
                        break;
                    case ExpressCraft.DataType.Bool: 
                        this.ClearCells$1(System.Nullable$1(System.Boolean), _column);
                        break;
                    case ExpressCraft.DataType.Byte: 
                        this.ClearCells$1(System.Nullable$1(System.Byte), _column);
                        break;
                    case ExpressCraft.DataType.Short: 
                        this.ClearCells$1(System.Nullable$1(System.Int16), _column);
                        break;
                }
                this.RequireOnDataChangeEvent();
            },
            GetColumnByDataType: function (type) {
                if (type === void 0) { type = 0; }
                switch (type) {
                    default: 
                    case ExpressCraft.DataType.Object: 
                        return new ExpressCraft.DataColumnObject();
                    case ExpressCraft.DataType.DateTime: 
                        return new ExpressCraft.DataColumnDateTime();
                    case ExpressCraft.DataType.String: 
                        return new ExpressCraft.DataColumnString();
                    case ExpressCraft.DataType.Integer: 
                        return new ExpressCraft.DataColumnInteger();
                    case ExpressCraft.DataType.Long: 
                        return new ExpressCraft.DataColumnLong();
                    case ExpressCraft.DataType.Float: 
                        return new ExpressCraft.DataColumnFloat();
                    case ExpressCraft.DataType.Double: 
                        return new ExpressCraft.DataColumnDouble();
                    case ExpressCraft.DataType.Decimal: 
                        return new ExpressCraft.DataColumnDecimal();
                    case ExpressCraft.DataType.Bool: 
                        return new ExpressCraft.DataColumnBool();
                    case ExpressCraft.DataType.Byte: 
                        return new ExpressCraft.DataColumnByte();
                    case ExpressCraft.DataType.Short: 
                        return new ExpressCraft.DataColumnShort();
                }
            },
            AddColumn: function (fieldName, type) {
                if (type === void 0) { type = 0; }
                var col = this.GetColumnByDataType(type);
                col.FieldName = fieldName;

                this.Columns.add(col);
                this._ColCount = this.Columns.Count;

                this.RequireOnDataChangeEvent();
            },
            BeginNewRow: function (EstimatedNewRows) {
                this.NewRows = new (System.Collections.Generic.List$1(ExpressCraft.DataRow))(EstimatedNewRows);
                this.BeginDataUpdate();
            },
            AddRow: function () {
                var dr = new ExpressCraft.DataRow.$ctor1(this, Bridge.identity(this._RowCount, (this._RowCount = (this._RowCount + 1) | 0)));
                var colLength = this.Columns.Count;
                for (var x = 0; x < colLength; x = (x + 1) | 0) {
                    var col = this.Columns.getItem(x);
                    col.Cells.add(null);
                }

                this.RequireOnDataChangeEvent();

                return dr;
            },
            AddRow$1: function (row) {
                if (row === void 0) { row = []; }
                if (row.length === this.ColumnCount) {
                    this._RowCount = (this._RowCount + 1) | 0;
                    var colLength = this.Columns.Count;
                    for (var x = 0; x < colLength; x = (x + 1) | 0) {
                        var col = this.Columns.getItem(x);
                        col.Cells.add(Bridge.unbox(row[System.Array.index(x, row)]));
                    }
                    this.RequireOnDataChangeEvent();
                }
            },
            NewRow: function () {
                var dr = new ExpressCraft.DataRow.$ctor1(this);

                this.NewRows.add(dr);

                return dr;
            },
            AcceptNewRows: function () {
                var $t, $t1, $t2;
                if (this.NewRows == null || this.NewRows.Count === 0) {
                    return;
                }
                var colLength = this.Columns.Count;
                var rowLength = this.NewRows.Count;
                var colN1 = (colLength - 1) | 0;

                for (var x = 0; x < colLength; x = (x + 1) | 0) {
                    var col = this.Columns.getItem(x);
                    var DataCells = System.Array.init(rowLength, null, System.Object);

                    if (x === 0) {
                        for (var y = 0; y < rowLength; y = (y + 1) | 0) {
                            this.NewRows.getItem(y).RowIndex = Bridge.identity(this._RowCount, (this._RowCount = (this._RowCount + 1) | 0));
                            DataCells[System.Array.index(y, DataCells)] = ($t = this.NewRows.getItem(y).batchData)[System.Array.index(x, $t)];
                        }
                    } else if (x === colN1) {
                        for (var y1 = 0; y1 < rowLength; y1 = (y1 + 1) | 0) {
                            DataCells[System.Array.index(y1, DataCells)] = ($t1 = this.NewRows.getItem(y1).batchData)[System.Array.index(x, $t1)];
                            this.NewRows.getItem(y1).batchData = null;
                        }
                    } else {
                        for (var y2 = 0; y2 < rowLength; y2 = (y2 + 1) | 0) {
                            DataCells[System.Array.index(y2, DataCells)] = ($t2 = this.NewRows.getItem(y2).batchData)[System.Array.index(x, $t2)];
                        }
                    }
                    col.Cells.addRange(Bridge.unbox(DataCells));
                }
                this.NewRows.clear();

                this.EndDataUpdate();
            },
            BeginDataUpdate: function () {
                this._inDataChange = true;
                this._requestedOnDataChange = false;
            },
            EndDataUpdate: function () {
                this._inDataChange = false;
                if (this._requestedOnDataChange) {
                    this._requestedOnDataChange = false;
                    if (!Bridge.staticEquals(this.OnDataSourceChanged, null)) {
                        this.OnDataSourceChanged(this, null);
                    }
                }
            },
            RejectNewRows: function () {
                this.NewRows.clear();
                this._inDataChange = false;
            }
        }
    });

    Bridge.define("ExpressCraft.DataType", {
        $kind: "enum",
        statics: {
            fields: {
                Object: 0,
                DateTime: 1,
                String: 2,
                Integer: 3,
                Long: 4,
                Float: 5,
                Double: 6,
                Decimal: 7,
                Bool: 8,
                Byte: 9,
                Short: 10
            }
        }
    });

    Bridge.define("ExpressCraft.DateControl.DisplayMode", {
        $kind: "enum",
        statics: {
            fields: {
                Day: 0,
                Month: 1,
                Year: 2
            }
        }
    });

    Bridge.define("ExpressCraft.DialogResult", {
        fields: {
            ResultEnum: 0,
            CallBack: null
        },
        ctors: {
            init: function () {
                this.ResultEnum = ExpressCraft.DialogResultEnum.None;
            },
            ctor: function (resultEnum, callBack) {
                this.$initialize();
                this.ResultEnum = resultEnum;
                this.CallBack = callBack;
            }
        },
        methods: {
            InvokeIfResult: function (resultEnum) {
                if (resultEnum === this.ResultEnum && !Bridge.staticEquals(this.CallBack, null)) {
                    this.CallBack();
                }
            }
        }
    });

    Bridge.define("ExpressCraft.DialogResultEnum", {
        $kind: "enum",
        statics: {
            fields: {
                None: 0,
                OK: 1,
                Cancel: 2,
                Abort: 3,
                Send: 4,
                Ignore: 5,
                Yes: 6,
                No: 7
            }
        }
    });

    Bridge.define("ExpressCraft.ExternalPlugin", {
        fields: {
            SourceUrl: null,
            SetupCompleted: false,
            InLoad: false,
            OnReady: null
        },
        ctors: {
            init: function () {
                this.SetupCompleted = false;
                this.InLoad = false;
            },
            ctor: function (sourceUrl) {
                this.$initialize();
                this.SourceUrl = sourceUrl;
            }
        },
        methods: {
            Setup: function (async, defer) {
                var $t;
                if (async === void 0) { async = false; }
                if (defer === void 0) { defer = false; }
                if (!this.SetupCompleted) {
                    if (this.InLoad) {
                        return;
                    }
                    this.InLoad = true;
                    var script = ($t = document.createElement("script"), $t.onload = Bridge.fn.bind(this, $asm.$.ExpressCraft.ExternalPlugin.f1), $t.src = this.SourceUrl, $t);
                    if (async) {
                        script.async = async;
                    }
                    if (defer) {
                        script.defer = defer;
                    }
                    document.head.appendChild(script);
                }
            },
            UsageCheck: function () {
                if (!this.SetupCompleted) {
                    throw new System.Exception(System.String.concat("'", this.SourceUrl, "' requires to be setup!"));
                }
                if (this.InLoad) {
                    throw new System.Exception(System.String.concat("'", this.SourceUrl, "' is currently loading, Please try again in a few seconds!"));
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.ExternalPlugin", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.ExternalPlugin, {
        f1: function (ele) {
            this.SetupCompleted = true;
            this.InLoad = false;
            if (!Bridge.staticEquals(this.OnReady, null)) {
                this.OnReady();
            }
        }
    });

    Bridge.define("ExpressCraft.Firebase", {
        statics: {
            fields: {
                ExternalFireBase: null,
                DisplayName: null,
                PhotoURL: null,
                UserSignedIn: false
            },
            ctors: {
                init: function () {
                    this.ExternalFireBase = new ExpressCraft.ExternalPlugin("https://www.gstatic.com/firebasejs/3.6.8/firebase.js");
                }
            },
            methods: {
                Setup: function (OnReady) {
                    if (OnReady === void 0) { OnReady = null; }
                    ExpressCraft.Firebase.ExternalFireBase.OnReady = OnReady;
                    ExpressCraft.Firebase.ExternalFireBase.Setup();
                },
                InitializeApp: function (ApiKey, AuthDomain, DatabaseURL, ProjectId, StorageBucket, MessagingSenderId) {
                    ExpressCraft.Firebase.ExternalFireBase.UsageCheck();
                    if (System.String.isNullOrWhiteSpace(ApiKey)) {
                        throw new System.Exception(System.String.format("Invalid Firebase {0} !", "ApiKey"));
                    }
                    if (System.String.isNullOrWhiteSpace(AuthDomain)) {
                        throw new System.Exception(System.String.format("Invalid Firebase {0}!", "AuthDomain"));
                    }
                    if (System.String.isNullOrWhiteSpace(DatabaseURL)) {
                        throw new System.Exception(System.String.format("Invalid Firebase {0}!", "DatabaseURL"));
                    }
                    if (System.String.isNullOrWhiteSpace(ProjectId)) {
                        throw new System.Exception(System.String.format("Invalid Firebase {0}!", "ProjectId"));
                    }
                    if (System.String.isNullOrWhiteSpace(StorageBucket)) {
                        throw new System.Exception(System.String.format("Invalid Firebase {0}!", "StorageBucket"));
                    }
                    if (System.String.isNullOrWhiteSpace(MessagingSenderId)) {
                        throw new System.Exception(System.String.format("Invalid Firebase {0}!", "MessagingSenderId"));
                    }

                    			firebase.initializeApp({apiKey: ApiKey, authDomain: AuthDomain, databaseURL: DatabaseURL, projectId : ProjectId, storageBucket: StorageBucket, messagingSenderId: MessagingSenderId });
                    			firebase.auth().onAuthStateChanged(function(user) {
                    				if (user) {
                    					this.UserSignedIn = true;
                    					this.DisplayName = user.displayName;
                    					this.PhotoURL = user.photoURL;
                    				}else{
                    					this.UserSignedIn = false;
                    				}
                    			});
                    			
                },
                SignIn: function () {
                    			firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider());
                    			
                },
                SignOut: function () {
                    			firebase.auth().signOut();
                    			
                },
                DatabaseRef: function (name) {
                    var dataRef = firebase.database().ref(name);
                    dataRef.off();
                    return dataRef;
                },
                IsSignedInWithFirebase: function () {
                    return 
			if(firebase.auth().currentUser)
			{
				return true;
			}else
			{
				return false;
			};
                }
            }
        }
    });

    Bridge.define("ExpressCraft.FixedSplitterPosition", {
        $kind: "enum",
        statics: {
            fields: {
                Panel1: 0,
                Panel2: 1,
                None: 2
            }
        }
    });

    Bridge.define("ExpressCraft.FormButtonType", {
        $kind: "enum",
        statics: {
            fields: {
                Close: 0,
                Maximize: 1,
                Minimize: 2,
                Restore: 3,
                Help: 4,
                Menu: 5
            }
        }
    });

    Bridge.define("ExpressCraft.FormCollection", {
        fields: {
            FormOwner: null,
            VisibleForms: null
        },
        ctors: {
            init: function () {
                this.VisibleForms = new (System.Collections.Generic.List$1(ExpressCraft.Form))();
            },
            ctor: function (formOwner) {
                this.$initialize();
                this.FormOwner = formOwner;
            }
        }
    });

    Bridge.define("ExpressCraft.FormStartPosition", {
        $kind: "enum",
        statics: {
            fields: {
                Manual: 0,
                Center: 1,
                WindowsDefaultLocation: 2
            }
        }
    });

    Bridge.define("ExpressCraft.Gmail", {
        statics: {
            fields: {
                ExternalGmail: null,
                ClientId: null,
                GoogleAuth: null,
                _oneTimeCall: null,
                _hasRan: false
            },
            ctors: {
                init: function () {
                    this.ExternalGmail = new ExpressCraft.ExternalPlugin("https://apis.google.com/js/api.js");
                    this._oneTimeCall = new (System.Collections.Generic.List$1(Function))();
                    this._hasRan = false;
                }
            },
            methods: {
                Authorize: function () {
                    if (!ExpressCraft.Gmail.ExternalGmail.SetupCompleted) {
                        return;
                    }

                    if (ExpressCraft.Gmail.IsSignedIn()) {
                        return;
                    }
                    try {
                        ExpressCraft.Gmail.GoogleAuth = gapi.auth2.getAuthInstance()
                        gapi.auth2.getAuthInstance().signIn();
                        ExpressCraft.Gmail._hasRan = false;
                        ExpressCraft.Gmail.PushEventsTimeCall();
                        window.focus();
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                },
                PushEventsTimeCall: function () {
                    var $t;
                    if (ExpressCraft.Gmail._hasRan) {
                        return;
                    }
                    ExpressCraft.Gmail._hasRan = true;

                    try {
                        $t = Bridge.getEnumerator(ExpressCraft.Gmail._oneTimeCall);
                        try {
                            while ($t.moveNext()) {
                                var callpump = $t.Current;
                                if (!Bridge.staticEquals(callpump, null)) {
                                    callpump();
                                }
                            }
                        } finally {
                            if (Bridge.is($t, System.IDisposable)) {
                                $t.System$IDisposable$dispose();
                            }
                        }}
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                    ExpressCraft.Gmail._oneTimeCall = new (System.Collections.Generic.List$1(Function))();
                },
                OnSignedIn: function (method) {
                    if (Bridge.staticEquals(method, null)) {
                        return;
                    }

                    if (ExpressCraft.Gmail._hasRan) {
                        try {
                            method();
                        }
                        catch ($e1) {
                            $e1 = System.Exception.create($e1);
                        }
                    } else {
                        ExpressCraft.Gmail._oneTimeCall.add(method);
                    }
                },
                IsSignedIn: function () {
                    if (!ExpressCraft.Gmail.ExternalGmail.SetupCompleted) {
                        throw new System.Exception("Setup for gmail is not ready yet!");
                    }
                    if (ExpressCraft.Gmail.GoogleAuth == null) {
                        throw new System.ArgumentNullException("GoogleAuth");
                    }
                    var signedIn = false;

                    			signedIn = ExpressCraft.Gmail.GoogleAuth.isSignedIn.get();
                    			

                    return signedIn;
                },
                AccessToken: function () {
                    if (!ExpressCraft.Gmail.ExternalGmail.SetupCompleted) {
                        throw new System.Exception("Setup for gmail is not ready yet!");
                    }
                    if (ExpressCraft.Gmail.GoogleAuth == null) {
                        throw new System.ArgumentNullException("GoogleAuth");
                    }

                    var access_token = "";

                    			access_token = ExpressCraft.Gmail.GoogleAuth.currentUser.Ab.Zi.access_token;
                    			

                    return access_token;
                },
                Fullname: function () {
                    if (!ExpressCraft.Gmail.ExternalGmail.SetupCompleted) {
                        throw new System.Exception("Setup for gmail is not ready yet!");
                    }
                    if (ExpressCraft.Gmail.GoogleAuth == null) {
                        throw new System.ArgumentNullException("GoogleAuth");
                    }

                    var fullname = "";

                    			fullname = ExpressCraft.Gmail.GoogleAuth.currentUser.Ab.w3.ig;
                    			

                    return fullname;
                },
                Email: function () {
                    if (!ExpressCraft.Gmail.ExternalGmail.SetupCompleted) {
                        throw new System.Exception("Setup for gmail is not ready yet!");
                    }
                    if (ExpressCraft.Gmail.GoogleAuth == null) {
                        throw new System.ArgumentNullException("GoogleAuth");
                    }

                    var email = "";

                    			email = ExpressCraft.Gmail.GoogleAuth.currentUser.Ab.w3.U3;
                    			

                    return email;
                },
                GetContentTypeFromFileName: function (filename) {
                    if (System.String.isNullOrWhiteSpace(filename)) {
                        return "application/octet-stream";
                    }

                    filename = filename.toLowerCase();

                    if (System.String.endsWith(filename, ".pdf")) {
                        return "application/pdf";
                    } else {
                        if (System.String.endsWith(filename, ".png")) {
                            return "image/png";
                        } else {
                            if (System.String.endsWith(filename, ".jpg") || System.String.endsWith(filename, ".jpeg")) {
                                return "image/jpeg";
                            } else {
                                return "application/octet-stream";
                            }
                        }
                    }
                },
                SendEmail: function (message) {
                    var $t;
                    if (message == null) {
                        return;
                    }

                    var builder = new System.Text.StringBuilder();

                    builder.append("Content-Type: multipart/mixed; boundary=\"_intelogy_8ab337ec2e38e1a8b82a01a5712a8bdb\"\r\n");
                    builder.append("MIME-Version: 1.0\r\n");
                    builder.append(System.String.concat("From: ", ExpressCraft.Gmail.Email(), "\r\n"));
                    builder.append(System.String.concat("To: ", message.ToEmail, "\r\n"));
                    builder.append(System.String.concat("Subject: ", message.Subject, "\r\n\r\n"));

                    builder.append("--_intelogy_8ab337ec2e38e1a8b82a01a5712a8bdb\r\n");
                    builder.append(System.String.concat("Content-Type: text/", (message.IsHTML ? "html" : "plain"), "; charset=\"UTF-8\"\r\n"));
                    builder.append("MIME-Version: 1.0\r\n");
                    builder.append("Content-Transfer-Encoding: 7bit\r\n\r\n");

                    if (message.IsHTML) {
                        builder.append(System.String.concat(System.String.replaceAll((System.String.concat(message.Body, "")), "\r\n", "<br />"), "\r\n\r\n"));
                    } else {
                        builder.append(System.String.concat(message.Body, "\r\n\r\n"));
                    }

                    builder.append("--_intelogy_8ab337ec2e38e1a8b82a01a5712a8bdb\r\n");

                    if (message.Attachments != null) {
                        $t = Bridge.getEnumerator(message.Attachments);
                        try {
                            while ($t.moveNext()) {
                                var attachment = $t.Current;
                                if (!System.String.isNullOrWhiteSpace(attachment.Data)) {
                                    builder.append("--_intelogy_8ab337ec2e38e1a8b82a01a5712a8bdb\r\n");
                                    builder.append(System.String.concat("Content-Type: ", ExpressCraft.Gmail.GetContentTypeFromFileName(attachment.Filename), "; charset=\"UTF-8\"\r\n"));
                                    builder.append("MIME-Version: 1.0\r\n");
                                    builder.append("Content-Transfer-Encoding: base64\r\n");
                                    builder.append(System.String.concat("Content-Disposition: attachment; filename=\"", System.String.replaceAll((attachment.Filename), "\"", ""), "\"\r\n\r\n"));

                                    if (attachment.IsBase64) {
                                        builder.append(attachment.Data);
                                    } else {
                                        builder.append(Bridge.global.btoa(attachment.Data));
                                    }

                                    builder.append("\r\n\r\n");

                                    builder.append("--_intelogy_8ab337ec2e38e1a8b82a01a5712a8bdb\r\n");
                                }
                            }
                        } finally {
                            if (Bridge.is($t, System.IDisposable)) {
                                $t.System$IDisposable$dispose();
                            }
                        }}

                    var settings = { type: "POST", url: "https://www.googleapis.com/upload/gmail/v1/users/me/messages/send?uploadType=multipart", contentType: "message/rfc822", data: builder.toString(), headers: { Authorization: System.String.concat("Bearer ", ExpressCraft.Gmail.AccessToken()) }, error: $asm.$.ExpressCraft.Gmail.f1, complete: $asm.$.ExpressCraft.Gmail.f2, success: $asm.$.ExpressCraft.Gmail.f3 };

                    $.ajax(settings);
                },
                IconURL: function () {
                    if (!ExpressCraft.Gmail.ExternalGmail.SetupCompleted) {
                        throw new System.Exception("Setup for gmail is not ready yet!");
                    }
                    if (ExpressCraft.Gmail.GoogleAuth == null) {
                        throw new System.ArgumentNullException("GoogleAuth");
                    }

                    var iconUrl = "";

                    			iconUrl = ExpressCraft.Gmail.GoogleAuth.currentUser.Ab.w3.Paa;
                    			

                    return iconUrl;
                },
                Setup: function (clientId) {
                    ExpressCraft.Gmail.ClientId = clientId;

                    ExpressCraft.Gmail.ExternalGmail.OnReady = $asm.$.ExpressCraft.Gmail.f4;
                    ExpressCraft.Gmail.ExternalGmail.Setup(true, true);
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.Gmail", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.Gmail, {
        f1: function (a, b, c) { },
        f2: function (jq, data) { },
        f3: function (obj, data, jq) { },
        f4: function () {
            try {
                			    gapi.load('client:auth2', function() {
                                gapi.client.init({
                                discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest"],
                                clientId: ExpressCraft.Gmail.ClientId,
                                scope: 'https://www.googleapis.com/auth/gmail.send'
                                }).then(function () {
                                // Listen for sign-in state changes.
                                ExpressCraft.Gmail.GoogleAuth = gapi.auth2.getAuthInstance()
                                gapi.auth2.getAuthInstance().signIn();

                                ExpressCraft.Gmail.PushEventsTimeCall();
                                });
                            });
                			    
            }
            catch ($e1) {
                $e1 = System.Exception.create($e1);
            }
        }
    });

    Bridge.define("ExpressCraft.GmailMessage", {
        props: {
            ToEmail: null,
            Subject: null,
            Body: null,
            IsHTML: false,
            Attachments: null
        },
        ctors: {
            init: function () {
                this.Attachments = new (System.Collections.Generic.List$1(ExpressCraft.GmailMessageAttachment))();
            },
            ctor: function (toEmail, subject, body, isHTML) {
                this.$initialize();
                this.ToEmail = toEmail;
                this.Subject = subject;
                this.Body = body;
                this.IsHTML = isHTML;
            }
        }
    });

    Bridge.define("ExpressCraft.GmailMessageAttachment", {
        props: {
            Filename: null,
            Data: null,
            IsBase64: false
        },
        ctors: {
            ctor: function (filename, data, isBase64) {
                if (isBase64 === void 0) { isBase64 = false; }

                this.$initialize();
                this.Filename = filename;
                this.Data = data;
                this.IsBase64 = isBase64;
            }
        }
    });

    Bridge.define("ExpressCraft.GoogleCloudPrint", {
        statics: {
            fields: {
                ExternalGoogleCloudPrint: null
            },
            ctors: {
                init: function () {
                    this.ExternalGoogleCloudPrint = new ExpressCraft.ExternalPlugin("https://www.google.com/cloudprint/client/cpgadget.js");
                }
            },
            methods: {
                Setup: function () {
                    ExpressCraft.GoogleCloudPrint.ExternalGoogleCloudPrint.Setup();
                }
            }
        },
        fields: {
            _source: null,
            _mimetype: null,
            _encoding: null,
            _title: null,
            _gadget: null
        },
        ctors: {
            init: function () {
                this._encoding = "";
            },
            ctor: function (source, title, gcpmt, encoding) {
                if (title === void 0) { title = ""; }
                if (gcpmt === void 0) { gcpmt = 0; }
                if (encoding === void 0) { encoding = ""; }

                this.$initialize();
                System.Object.call(this);
                this._title = title;
                this._source = source;
                this._encoding = encoding;
                this._mimetype = System.String.replaceAll(System.Enum.format(ExpressCraft.GoogleCloudPrintingMimeType, gcpmt, "G").toLowerCase(), "_", ".");
            }
        },
        methods: {
            Show: function () {
                ExpressCraft.GoogleCloudPrint.ExternalGoogleCloudPrint.UsageCheck();

                			this._gadget = new cloudprint.Gadget();
                			
                if (!System.String.isNullOrWhiteSpace(this._encoding)) {
                    				this._gadget.setPrintDocument(this._mimetype, this._title, this._source, this._encoding);
                    				
                } else {
                    				this._gadget.setPrintDocument(this._mimetype, this._title, this._source);
                    				
                }
                			this._gadget.openPrintDialog();
                			this._gadget.setOnCloseCallback(this.clearContent);
                			
            },
            clearContent: function () {
                try {
                    ExpressCraft.Helper.Delete($(".__gcp_dialog_container_cls").parent().get(0));
                }
                catch ($e1) {
                    $e1 = System.Exception.create($e1);
                }
            },
            Close: function () {
                if (this._gadget != null) {
                    				this._gadget.closePrintDialog();
                    				this._gadget = null;
                    				
                }
            }
        }
    });

    Bridge.define("ExpressCraft.GoogleCloudPrintingMimeType", {
        $kind: "enum",
        statics: {
            fields: {
                Url: 0,
                DataUrl: 1,
                Google_Drawing: 2,
                Google_Drive: 3,
                Google_Kix: 4,
                Google_Mail: 5,
                Google_Presentation: 6,
                Google_Spreadsheet: 7
            }
        }
    });

    Bridge.define("ExpressCraft.GridViewCellApparence", {
        fields: {
            IsBold: false,
            Alignment: "inherit",
            Forecolor: null
        },
        ctors: {
            init: function () {
                this.IsBold = false;
                this.Alignment = "left";
            },
            ctor: function () {
                this.$initialize();
            },
            $ctor1: function (isBold) {
                this.$initialize();
                this.IsBold = isBold;
            },
            $ctor2: function (isBold, alignment) {
                this.$initialize();
                this.IsBold = isBold;
                this.Alignment = alignment;
            },
            $ctor3: function (isBold, alignment, forecolor) {
                this.$initialize();
                this.IsBold = isBold;
                this.Alignment = alignment;
                this.Forecolor = forecolor;
            }
        }
    });

    Bridge.define("ExpressCraft.GridViewCellDisplay", {
        fields: {
            UseDefaultElement: false
        },
        methods: {
            OnCreate: function (gridView, dataRowIndex, columnIndex) {
                return null;
            },
            OnCreateDefault: function (originalElement, gridView, dataRowIndex, columnIndex) {
                return originalElement;
            }
        }
    });

    Bridge.define("ExpressCraft.GridViewColumn", {
        fields: {
            Column: null,
            View: null,
            Caption: null,
            Visible: false,
            CachedX: 0,
            FormatString: null,
            HeadingApparence: null,
            BodyApparence: null,
            CellDisplay: null,
            SortedMode: 0,
            FilterEdit: null,
            filterValue: null,
            AllowEdit: false,
            ReadOnly: false,
            _width: 0
        },
        props: {
            FilterValue: {
                get: function () {
                    return this.filterValue;
                },
                set: function (value) {
                    if (!Bridge.referenceEquals(this.filterValue, value)) {
                        this.filterValue = value;
                        if (this.View.ShowAutoFilterRow) {
                            this.View.CalculateVisibleRows();
                        }
                    }
                }
            },
            Width: {
                get: function () {
                    return this._width;
                },
                set: function (value) {
                    if (value < 24) {
                        value = 24;
                    }
                    if (this._width !== value) {
                        this._width = value;
                        this.View.RenderGrid();
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this.FormatString = "";
                this.HeadingApparence = new ExpressCraft.GridViewCellApparence.ctor();
                this.BodyApparence = new ExpressCraft.GridViewCellApparence.ctor();
                this.SortedMode = ExpressCraft.GridViewSortMode.None;
                this.AllowEdit = true;
                this.ReadOnly = false;
            },
            ctor: function (view, width) {
                if (width === void 0) { width = 100; }

                this.$initialize();
                this.View = view;
                this._width = width;
            }
        },
        methods: {
            ValueMatchFilter: function (index) {
                if (this.filterValue == null) {
                    return true;
                }

                var abc = this.GetDisplayValueByDataRowHandle(index);

                switch (this.Column.DataType) {
                    default: 
                    case ExpressCraft.DataType.Object: 
                    case ExpressCraft.DataType.Integer: 
                    case ExpressCraft.DataType.Long: 
                    case ExpressCraft.DataType.Float: 
                    case ExpressCraft.DataType.Double: 
                    case ExpressCraft.DataType.Decimal: 
                    case ExpressCraft.DataType.Bool: 
                    case ExpressCraft.DataType.Byte: 
                    case ExpressCraft.DataType.Short: 
                        return Bridge.referenceEquals(abc, this.filterValue);
                    case ExpressCraft.DataType.DateTime: 
                    case ExpressCraft.DataType.String: 
                        return System.String.startsWith((System.String.concat(abc, "")), System.String.concat(this.filterValue, ""));
                }
            },
            GetDataColumnIndex: function () {
                var length = this.View.DataSource.ColumnCount;
                for (var i = 0; i < length; i = (i + 1) | 0) {
                    if (Bridge.referenceEquals(this.View.DataSource.Columns.getItem(i), this.Column)) {
                        return i;
                    }
                }
                return -1;
            },
            GetDisplayValueByDataRowHandle: function (RowHandle) {
                if (System.String.isNullOrWhiteSpace(this.FormatString)) {
                    return this.Column.GetDisplayValue(RowHandle);
                } else {
                    return this.Column.GetDisplayValue$1(RowHandle, this.FormatString);
                }
            },
            GetDisplayValue: function (RowHandle) {
                if (this.View.VisibleRowHandles != null) {
                    RowHandle = this.View.VisibleRowHandles.getItem(RowHandle);
                }

                if (System.String.isNullOrWhiteSpace(this.FormatString)) {
                    return this.Column.GetDisplayValue(RowHandle);
                } else {
                    return this.Column.GetDisplayValue$1(RowHandle, this.FormatString);
                }
            }
        }
    });

    Bridge.define("ExpressCraft.GridViewSortMode", {
        $kind: "enum",
        statics: {
            fields: {
                None: 0,
                Asc: 1,
                Desc: 2
            }
        }
    });

    Bridge.define("ExpressCraft.HardSoftList$1", function (T) { return {
        fields: {
            _hhl: null,
            _hl: null,
            SL: null,
            Limit: 0,
            HardLength: 0,
            DefaultValue: Bridge.getDefaultValue(T)
        },
        ctors: {
            init: function () {
                this._hhl = new (System.Collections.Generic.List$1(T))();
                this._hl = new (System.Collections.Generic.List$1(ExpressCraft.IndexValue$1(T)))();
                this.SL = new (System.Collections.Generic.List$1(System.Int32))();
                this.HardLength = 0;
            },
            ctor: function (defaultValue, limit) {
                if (limit === void 0) { limit = 10000; }

                this.$initialize();
                this.DefaultValue = defaultValue;
                this.Limit = limit;
            }
        },
        methods: {
            GetIndexValueByHardListIndex: function (index) {
                return this._hl.getItem(index);
            },
            ClearAll: function () {
                this._hhl = new (System.Collections.Generic.List$1(T))();
                this._hl = new (System.Collections.Generic.List$1(ExpressCraft.IndexValue$1(T)))();
                this.SL = new (System.Collections.Generic.List$1(System.Int32))();
                this.HardLength = 0;
            },
            ClearAllSetHardRange: function (value, Indexs) {
                if (Indexs === void 0) { Indexs = []; }
                this.HardLength = 0;
                if (Indexs == null || Indexs.length === 0) {
                    this.ClearAll();
                } else {
                    if (Indexs.length > this.Limit) {
                        this.HardLength = Indexs.length;
                        this._hl = new (System.Collections.Generic.List$1(ExpressCraft.IndexValue$1(T)))();
                        this.SL = new (System.Collections.Generic.List$1(System.Int32))();

                        var max = 0;
                        for (var i = 0; i < this.HardLength; i = (i + 1) | 0) {
                            if (Indexs[System.Array.index(i, Indexs)] > max) {
                                max = Indexs[System.Array.index(i, Indexs)];
                            }
                        }
                        var length = (max + 1) | 0;
                        this._hhl = new (System.Collections.Generic.List$1(T))(length);

                        if (length === Indexs.length) {
                            for (var i1 = 0; i1 < this.HardLength; i1 = (i1 + 1) | 0) {
                                this._hhl.add(value);
                            }
                        } else {
                            for (var i2 = 0; i2 < length; i2 = (i2 + 1) | 0) {
                                this._hhl.add(this.DefaultValue);
                            }
                            for (var i3 = 0; i3 < this.HardLength; i3 = (i3 + 1) | 0) {
                                this._hhl.setItem(Indexs[System.Array.index(i3, Indexs)], value);
                            }
                        }
                    } else {
                        this._hhl = new (System.Collections.Generic.List$1(T))();
                        this.HardLength = Indexs.length;
                        this._hl = new (System.Collections.Generic.List$1(ExpressCraft.IndexValue$1(T)))(this.HardLength);
                        for (var i4 = 0; i4 < this.HardLength; i4 = (i4 + 1) | 0) {
                            this._hl.add(new (ExpressCraft.IndexValue$1(T))(Indexs[System.Array.index(i4, Indexs)], value));
                        }
                        this.SL = new (System.Collections.Generic.List$1(System.Int32))();
                    }
                }
            },
            ClearSoftList: function () {
                this.SL = new (System.Collections.Generic.List$1(System.Int32))();
            },
            ClearAndAddOrSet: function (value, index, AddToSoftList) {
                if (AddToSoftList === void 0) { AddToSoftList = false; }
                this._hhl = new (System.Collections.Generic.List$1(T))();
                this._hl = new (System.Collections.Generic.List$1(ExpressCraft.IndexValue$1(T)))();
                this.SL = new (System.Collections.Generic.List$1(System.Int32))();
                this.HardLength = 0;
                this.AddOrSet(value, index, AddToSoftList);
            },
            GetHardOrSoftIndexValue: function (index, AddToSoftList) {
                if (AddToSoftList === void 0) { AddToSoftList = false; }
                var length = this.SL.Count;
                for (var i = 0; i < length; i = (i + 1) | 0) {
                    var slI = this.SL.getItem(i);
                    if (this._hl.getItem(slI).Index === index) {
                        return this._hl.getItem(slI);
                    }
                }

                length = this._hl.Count;

                for (var i1 = 0; i1 < length; i1 = (i1 + 1) | 0) {
                    var hli = this._hl.getItem(i1);
                    if (hli.Index === index) {
                        if (AddToSoftList) {
                            this.SL.add(i1);
                        }
                        return hli;
                    }
                }

                return null;
            },
            GetHardIndexValue: function (index) {
                var length = this._hl.Count;

                for (var i = 0; i < length; i = (i + 1) | 0) {
                    var hli = this._hl.getItem(i);
                    if (hli.Index === index.v) {
                        index.v = i;
                        return hli;
                    }
                }
                index.v = length;

                return null;
            },
            GetValue: function (index, AddToSoftList) {
                if (AddToSoftList === void 0) { AddToSoftList = false; }
                if (this.HardLength > this.Limit) {
                    return this._hhl.getItem(index);
                }
                var hiv = this.GetHardOrSoftIndexValue(index, AddToSoftList);
                if (hiv == null) {
                    return this.DefaultValue;
                }
                return hiv.Value;
            },
            GetIndex: function (index) {
                if (this.HardLength > this.Limit) {
                    return index;
                }

                var hiv = this.GetHardOrSoftIndexValue(index);
                if (hiv == null) {
                    return -1;
                }
                return hiv.Index;
            },
            AddOrSet: function (value, index, AddToSoftList) {
                if (AddToSoftList === void 0) { AddToSoftList = false; }
                if (this.HardLength > this.Limit) {
                    if (index >= this.HardLength) {
                        var addDiff = ((((index + 1) | 0)) - this._hhl.Count) | 0;
                        if (addDiff > 0) {
                            var data = System.Array.init(addDiff, function (){
                                return Bridge.getDefaultValue(T);
                            }, T);
                            for (var i = 0; i < addDiff; i = (i + 1) | 0) {
                                data[System.Array.index(i, data)] = this.DefaultValue;
                            }
                            this._hhl.addRange(data);
                        }
                        this._hhl.add(value);
                        this.HardLength = this._hhl.Count;
                    } else {
                        this._hhl.setItem(index, value);
                    }
                    return;
                }

                var length = this.SL.Count;
                for (var i1 = 0; i1 < length; i1 = (i1 + 1) | 0) {
                    var hli = this._hl.getItem(this.SL.getItem(i1));
                    if (hli.Index === index) {
                        hli.Value = value;
                        return;
                    }
                }

                var hindex = { v : index };
                var hiv = this.GetHardIndexValue(hindex);
                if (hiv == null) {
                    this._hl.add(((hiv = new (ExpressCraft.IndexValue$1(T))(index, value))));
                } else {
                    hiv.Value = value;
                }

                if (AddToSoftList) {
                    this.SL.add(hindex.v);
                }
            },
            Remove: function (index, OnlySoftList) {
                if (OnlySoftList === void 0) { OnlySoftList = false; }
                if (this.HardLength > this.Limit) {
                    if (((this.HardLength - 1) | 0) > this.Limit) {
                        this._hhl.setItem(index, this.DefaultValue);
                    } else {
                        for (var i = 0; i < this.HardLength; i = (i + 1) | 0) {
                            if (i !== index && !Bridge.equals(this._hhl.getItem(i), this.DefaultValue)) {
                                this._hl.add(new (ExpressCraft.IndexValue$1(T))(i, this._hhl.getItem(i)));
                            }
                        }

                        this.HardLength = (this.HardLength - 1) | 0;
                    }
                } else {
                    var Length = this.SL.Count;
                    for (var i1 = 0; i1 < Length; i1 = (i1 + 1) | 0) {
                        var sli = this.SL.getItem(i1);
                        if (this._hl.getItem(sli).Index === index) {
                            this.SL.removeAt(i1);
                            if (OnlySoftList) {
                                return;
                            }
                            this._hl.removeAt(sli);
                            return;
                        }
                    }
                    var length = this._hl.Count;

                    for (var i2 = 0; i2 < length; i2 = (i2 + 1) | 0) {
                        var hli = this._hl.getItem(i2);
                        if (hli.Index === index) {
                            this._hl.removeAt(i2);
                            return;
                        }
                    }
                }
            }
        }
    }; });

    Bridge.define("ExpressCraft.Helper", {
        statics: {
            fields: {
                _notDesktop: false,
                _setupDesktop: false
            },
            props: {
                NotDesktop: {
                    get: function () {
                        var $t;
                        var result = ExpressCraft.Helper._setupDesktop ? ExpressCraft.Helper._notDesktop : ($t = (!Bridge.Browser.isDesktop || ExpressCraft.Helper.IsIPhone() || ExpressCraft.Helper.IsIPad()), ExpressCraft.Helper._notDesktop = $t, $t);
                        ExpressCraft.Helper._setupDesktop = true;
                        return result;
                    }
                }
            },
            methods: {
                IsIPhone: function () {
                    var r = false;
                    r = !!navigator.userAgent.match(/iPhone/i);
                    return r;
                },
                IsIPad: function () {
                    var r = false;
                    r = !!navigator.userAgent.match(/iPad/i);
                    return r;
                },
                IsTrue: function (value) {
                    return (Bridge.referenceEquals(((value = value.toLowerCase())), "true") || Bridge.referenceEquals(value, "1") || Bridge.referenceEquals(value, "on")) ? 1 : 0;
                },
                ToInt: function (value) {
                    return parseInt(value);
                },
                ToFloat: function (value) {
                    return parseFloat(value);
                },
                ToStr: function (value) {
                    return value;
                },
                IsFireFox: function () {
                    var value = false;

                    if(navigator.userAgent.toLowerCase().indexOf('firefox') > -1)
                    {
                        value = true;
                    }
                    			
                    return value;
                },
                FocusElement: function (element) {
                    Bridge.global.setTimeout(function () {
                        element.focus();
                    }, 0);
                },
                StripNonNumberString: function (value) {
                    if (System.String.isNullOrWhiteSpace(value)) {
                        return System.Decimal(0);
                    }

                    var builder = new System.Text.StringBuilder();

                    var AddedDigits = false;

                    for (var i = 0; i < value.length; i = (i + 1) | 0) {
                        if (System.Char.isDigit(value.charCodeAt(i)) || value.charCodeAt(i) === 46) {
                            builder.append(String.fromCharCode(value.charCodeAt(i)));
                            AddedDigits = true;
                        } else if (value.charCodeAt(i) === 45 && !AddedDigits) {
                            builder.append(String.fromCharCode(value.charCodeAt(i)));
                            AddedDigits = true;
                        }
                    }

                    var value1 = { v : System.Decimal(0) };
                    System.Decimal.tryParse(builder.toString(), null, value1);

                    return value1.v;
                },
                StripNonDateString: function (value) {
                    if (System.String.isNullOrWhiteSpace(value)) {
                        return System.DateTime.getMinValue();
                    }

                    try {
                        value = System.String.replaceAll(value.trim(), String.fromCharCode(92), String.fromCharCode(ExpressCraft.Settings.DateSeperator));

                        var startsWithPlus = (System.String.startsWith(value, "+"));
                        var startsWithMunus = !startsWithPlus && (System.String.startsWith(value, "-"));

                        if (startsWithMunus) {
                            value = value.substr(1);
                        }

                        value = System.String.replaceAll(value, String.fromCharCode(45), String.fromCharCode(ExpressCraft.Settings.DateSeperator));

                        var endsWithMonth = (startsWithPlus || startsWithMunus) && (System.String.endsWith(value.toLowerCase(), "m"));
                        var endsWithyear = !endsWithMonth && (startsWithPlus || startsWithMunus) && (System.String.endsWith(value.toLowerCase(), "y"));

                        if (Bridge.referenceEquals(value.toLowerCase(), "d")) {
                            return System.DateTime.getToday();
                        }

                        var builder = new System.Text.StringBuilder();

                        var Values = new (System.Collections.Generic.List$1(System.Int32))();

                        for (var i = 0; i < value.length; i = (i + 1) | 0) {
                            if (System.Char.isDigit(value.charCodeAt(i))) {
                                builder.append(String.fromCharCode(value.charCodeAt(i)));
                            } else {
                                if (value.charCodeAt(i) === ExpressCraft.Settings.DateSeperator) {
                                    Values.add(System.Int32.parse(builder.toString()));
                                    builder = new System.Text.StringBuilder();
                                }
                            }
                        }

                        if (builder.getLength() > 0) {
                            Values.add(System.Int32.parse(builder.toString()));
                        }

                        builder = null;
                        if (Values.Count >= 3) {
                            return System.DateTime.create(Values.getItem(ExpressCraft.Settings.YearPosition), Values.getItem(ExpressCraft.Settings.MonthPosition), Values.getItem(ExpressCraft.Settings.DayPosition));
                        } else if (Values.Count === 1) {
                            if (ExpressCraft.Settings.DayPosition === ExpressCraft.Settings.DatePosition.First) {
                                if (startsWithPlus || startsWithMunus) {
                                    var date = System.DateTime.getToday();
                                    if (endsWithMonth) {
                                        date = System.DateTime.addMonths(date, startsWithMunus ? ((-Values.getItem(0)) | 0) : Values.getItem(0));
                                    } else if (endsWithyear) {
                                        if (startsWithMunus) {
                                            date = System.DateTime.addYears(date, ((-Values.getItem(0)) | 0));
                                        } else {
                                            date = System.DateTime.addYears(date, Values.getItem(0));
                                        }
                                    } else {
                                        date = System.DateTime.addDays(date, startsWithMunus ? ((-Values.getItem(0)) | 0) : Values.getItem(0));
                                    }
                                    if (System.DateTime.getHour(date) === 23) {
                                        System.DateTime.addHours(date, 1);
                                    }
                                    return date;
                                } else {
                                    return System.DateTime.create(System.DateTime.getYear(System.DateTime.getToday()), System.DateTime.getMonth(System.DateTime.getToday()), Values.getItem(0));
                                }
                            } else if (ExpressCraft.Settings.MonthPosition === ExpressCraft.Settings.DatePosition.First) {
                                return System.DateTime.create(System.DateTime.getYear(System.DateTime.getToday()), Values.getItem(0), System.DateTime.getDay(System.DateTime.getToday()));
                            } else if (ExpressCraft.Settings.YearPosition === ExpressCraft.Settings.DatePosition.First) {
                                return System.DateTime.create(Values.getItem(0), System.DateTime.getMonth(System.DateTime.getToday()), System.DateTime.getDay(System.DateTime.getToday()));
                            }
                        } else if (Values.Count === 2) {
                            if (ExpressCraft.Settings.DayPosition === ExpressCraft.Settings.DatePosition.First && ExpressCraft.Settings.MonthPosition === ExpressCraft.Settings.DatePosition.Second) {
                                return System.DateTime.create(System.DateTime.getYear(System.DateTime.getToday()), Values.getItem(1), Values.getItem(0));
                            } else if (ExpressCraft.Settings.DayPosition === ExpressCraft.Settings.DatePosition.Second && ExpressCraft.Settings.MonthPosition === ExpressCraft.Settings.DatePosition.First) {
                                return System.DateTime.create(System.DateTime.getYear(System.DateTime.getToday()), Values.getItem(0), Values.getItem(1));
                            } else if (ExpressCraft.Settings.YearPosition === ExpressCraft.Settings.DatePosition.Second && ExpressCraft.Settings.MonthPosition === ExpressCraft.Settings.DatePosition.First) {
                                return System.DateTime.create(Values.getItem(1), Values.getItem(0), System.DateTime.getDay(System.DateTime.getToday()));
                            } else if (ExpressCraft.Settings.YearPosition === ExpressCraft.Settings.DatePosition.First && ExpressCraft.Settings.MonthPosition === ExpressCraft.Settings.DatePosition.Second) {
                                return System.DateTime.create(Values.getItem(0), Values.getItem(1), System.DateTime.getDay(System.DateTime.getToday()));
                            }
                        }
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }

                    return System.DateTime.getMinValue();
                },
                AddTax: function (value, taxPercent) {
                    if (taxPercent === void 0) { taxPercent = System.Decimal(-1.0); }
                    if (value.equalsT(System.Decimal(0))) {
                        return value;
                    }

                    if (taxPercent.equalsT(System.Decimal(-1))) {
                        taxPercent = ExpressCraft.Settings.TaxPercent;
                    }
                    if (taxPercent.equalsT(System.Decimal(0))) {
                        return value;
                    }

                    return value.mul((System.Decimal(1).add(taxPercent)));
                },
                GetPortionTax: function (value, taxPercent) {
                    if (taxPercent === void 0) { taxPercent = System.Decimal(-1.0); }
                    if (value.equalsT(System.Decimal(0))) {
                        return value;
                    }

                    if (taxPercent.equalsT(System.Decimal(-1))) {
                        taxPercent = ExpressCraft.Settings.TaxPercent;
                    }
                    if (taxPercent.equalsT(System.Decimal(0))) {
                        return System.Decimal(0);
                    }

                    return value.sub(value.div((System.Decimal(1).add(taxPercent))));
                },
                DeductTax: function (value, taxPercent) {
                    if (taxPercent === void 0) { taxPercent = System.Decimal(-1.0); }
                    if (value.equalsT(System.Decimal(0))) {
                        return value;
                    }

                    if (taxPercent.equalsT(System.Decimal(-1))) {
                        taxPercent = ExpressCraft.Settings.TaxPercent;
                    }
                    if (taxPercent.equalsT(System.Decimal(0))) {
                        return value;
                    }

                    return value.sub(ExpressCraft.Helper.GetPortionTax(value, taxPercent));
                },
                IsNumber: function (value) {
                    return Bridge.is(value, System.SByte) || Bridge.is(value, System.Byte) || Bridge.is(value, System.Int16) || Bridge.is(value, System.UInt16) || Bridge.is(value, System.Int32) || Bridge.is(value, System.UInt32) || Bridge.is(value, System.Int64) || Bridge.is(value, System.UInt64) || Bridge.is(value, System.Single) || Bridge.is(value, System.Double) || Bridge.is(value, System.Decimal);
                },
                Empty: function (element) {
                    			var len = element.childNodes.length;
                    			while(len--)
                    			{
                    				element.removeChild(element.lastChild);
                    			};
                    			
                },
                GetClientMouseLocation: function (e) {
                    var x = 0;
                    var y = 0;
                    			  if (!e) var e = window.event;

                    			  if (e.pageX || e.pageY) {
                    				x = e.pageX;
                    				y = e.pageY;
                    			  } else if (e.clientX || e.clientY) {
                    				x = e.clientX + document.body.scrollLeft +
                    								   document.documentElement.scrollLeft;
                    				y = e.clientY + document.body.scrollTop +
                    								   document.documentElement.scrollTop;
                    			  }
                    			
                    return new ExpressCraft.Vector2.$ctor1(x, y);
                },
                SetChecked$1: function (input, value) {
                    ExpressCraft.Helper.SetChecked(input.Content, value);
                },
                SetChecked: function (input, value) {
                    var check = false;
                    if (value != null) {
                        if (Bridge.is(value, System.Boolean) || ExpressCraft.Helper.IsNumber(value)) {
                            check = System.Nullable.getValue(Bridge.cast(Bridge.unbox(value), System.Boolean));
                        } else if (Bridge.is(value, System.String)) {
                            var strValue = Bridge.cast(value, System.String);
                            check = (Bridge.referenceEquals(strValue, "1") || System.String.compare(strValue.toLowerCase(), "true") === 0);
                        }
                    }
                    if (!check) {
                        input.removeAttribute(ExpressCraft.GridViewCellDisplayCheckBox.resource_checked);
                    } else {
                        input.setAttribute(ExpressCraft.GridViewCellDisplayCheckBox.resource_checked, null);
                    }
                },
                /**
                 * IE does not support .remove on Element use delete
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Helper
                 * @memberof ExpressCraft.Helper
                 * @param   {Element}    c
                 * @return  {void}
                 */
                Delete: function (c) {
                    if (c != null && c.parentElement != null && c.parentElement.contains(c)) {
                        c.parentElement.removeChild(c);
                    }
                },
                ToPx: function (i) {
                    return i + 'px';
                },
                Log: function (jso) {
                    console.log(Bridge.unbox(jso));
                },
                AppendChildren$1: function (c, Nodes) {
                    if (Nodes === void 0) { Nodes = []; }
                    if (Nodes != null && Nodes.length > 0) {
                        for (var i = 0; i < Nodes.length; i = (i + 1) | 0) {
                            c.appendChild(Nodes[System.Array.index(i, Nodes)]);
                        }
                    }
                },
                AppendChildren: function (c, Nodes) {
                    if (Nodes === void 0) { Nodes = []; }
                    ExpressCraft.Helper.AppendChildren$2(c.Content, Nodes);

                    return c;
                },
                AppendChildren$2: function (c, Nodes) {
                    if (Nodes === void 0) { Nodes = []; }
                    if (Nodes != null && Nodes.length > 0) {
                        for (var i = 0; i < Nodes.length; i = (i + 1) | 0) {
                            c.appendChild(ExpressCraft.Control.op_Implicit(Nodes[System.Array.index(i, Nodes)]));
                        }
                    }
                },
                AppendChildrenTabIndex: function (c, Nodes) {
                    if (Nodes === void 0) { Nodes = []; }
                    if (Nodes != null && Nodes.length > 0) {
                        for (var i = 0; i < Nodes.length; i = (i + 1) | 0) {
                            Nodes[System.Array.index(i, Nodes)].Content.tabIndex = i;
                            c.appendChild(ExpressCraft.Control.op_Implicit(Nodes[System.Array.index(i, Nodes)]));
                        }
                    }
                },
                AppendChildrenTabIndex$1: function (c, Nodes) {
                    if (Nodes === void 0) { Nodes = []; }
                    ExpressCraft.Helper.AppendChildrenTabIndex(c.Content, Nodes);
                },
                AppendChild: function (c, Node) {
                    c.Content.appendChild(ExpressCraft.Control.op_Implicit(Node));
                    return c;
                },
                SetBounds: function (c, left, top, width, height) {
                    ExpressCraft.Helper.SetBounds$1(c.Content, left, top, width, height);

                    return c;
                },
                SetBounds$1: function (c, left, top, width, height) {
                    c.style.left = ExpressCraft.Helper.ToHtmlValue(left);
                    c.style.top = ExpressCraft.Helper.ToHtmlValue(top);
                    c.style.width = ExpressCraft.Helper.ToHtmlValue(width);
                    c.style.height = ExpressCraft.Helper.ToHtmlValue(height);
                },
                SetBoundsFull: function (c) {
                    ExpressCraft.Helper.SetBoundsFull$1(c.Content);

                    return c;
                },
                SetBoundsFull$1: function (c) {
                    ExpressCraft.Helper.SetBounds$1(c, 0, 0, "100%", "100%");
                },
                SetSize: function (c, width, height) {
                    ExpressCraft.Helper.SetSize$1(c.Content, width, height);

                    return c;
                },
                SetSize$1: function (c, width, height) {
                    c.style.width = ExpressCraft.Helper.ToHtmlValue(width);
                    c.style.height = ExpressCraft.Helper.ToHtmlValue(height);
                },
                ToHtmlValue: function (value) {
                    if (Bridge.is(value, System.String)) {
                        return ExpressCraft.Vector2.pf(value);
                    } else {
                        if (Bridge.is(value, System.Int32)) {
                            return ExpressCraft.Helper.ToPx(Bridge.box(value, System.Int32));
                        } else {
                            return ExpressCraft.Helper.ToPx(Bridge.box(value, System.Single, System.Single.format, System.Single.getHashCode));
                        }
                    }
                },
                SetImage$1: function (c, str, useURL, useResource, center) {
                    if (useURL === void 0) { useURL = true; }
                    if (useResource === void 0) { useResource = true; }
                    if (center === void 0) { center = true; }
                    if (!System.String.startsWith(str, "url(")) {
                        str = useURL ? ExpressCraft.Control.GetImageStringURI(str, useResource) : ExpressCraft.Control.GetImageString(str);
                    }
                    ExpressCraft.Helper.SetImage(c.Content, str, useURL, center);
                },
                SetImage: function (c, str, useURL, center) {
                    if (useURL === void 0) { useURL = true; }
                    if (center === void 0) { center = true; }
                    if (System.String.isNullOrWhiteSpace(str)) {
                        c.style.background = "";
                        c.style.backgroundSize = "";
                        return;
                    } else if (!System.String.startsWith(str, "url(")) {
                        str = useURL ? ExpressCraft.Control.GetImageStringURI(str) : ExpressCraft.Control.GetImageString(str);
                    }
                    c.style.background = str;
                    if (center) {
                        c.style.backgroundSize = "100% 100%";
                    }
                },
                SetLocation$2: function (c, left, top) {
                    ExpressCraft.Helper.SetLocation(c.Content, ExpressCraft.Helper.ToPx(Bridge.box(left, System.Int32)), ExpressCraft.Helper.ToPx(Bridge.box(top, System.Int32)));
                },
                SetLocation$1: function (c, left, top) {
                    ExpressCraft.Helper.SetLocation(c.Content, left, top);
                },
                SetLocation: function (c, left, top) {
                    c.style.left = ExpressCraft.Helper.ToHtmlValue(left);
                    c.style.top = ExpressCraft.Helper.ToHtmlValue(top);
                },
                /**
                 * HtmlEscape XSS
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Helper
                 * @memberof ExpressCraft.Helper
                 * @param   {System.Object}    obj
                 * @return  {string}
                 */
                HtmlEscape: function (obj) {
                    return ExpressCraft.Helper.HtmlEscape$1((Bridge.as(obj, System.String)));
                },
                /**
                 * HtmlEscape XSS
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Helper
                 * @memberof ExpressCraft.Helper
                 * @param   {string}    input
                 * @return  {string}
                 */
                HtmlEscape$1: function (input) {
                    return !System.String.isNullOrEmpty(input) ? System.String.replaceAll(System.String.replaceAll(ExpressCraft.Helper.HtmlUrlEscape(input), "\\/", "&#x2F"), "\"", "&quot") : "";
                },
                /**
                 * HtmlUrlUnescape XSS
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Helper
                 * @memberof ExpressCraft.Helper
                 * @param   {string}    input
                 * @return  {string}
                 */
                HtmlUrlUnescape: function (input) {
                    return !System.String.isNullOrEmpty(input) ? System.String.replaceAll(System.String.replaceAll(System.String.replaceAll(System.String.replaceAll(input, "&amp", "&"), "&lt", "<"), "&gt", ">"), "&#x27", "'") : "";
                },
                /**
                 * HtmlUrlEscape XSS
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Helper
                 * @memberof ExpressCraft.Helper
                 * @param   {string}    input
                 * @return  {string}
                 */
                HtmlUrlEscape: function (input) {
                    return !System.String.isNullOrEmpty(input) ? System.String.replaceAll(System.String.replaceAll(System.String.replaceAll(System.String.replaceAll(input, "&", "&amp"), "<", "&lt"), ">", "&gt"), "'", "&#x27") : "";
                },
                /**
                 * HtmlUnescape XSS
                 *
                 * @static
                 * @public
                 * @this ExpressCraft.Helper
                 * @memberof ExpressCraft.Helper
                 * @param   {string}    input
                 * @return  {string}
                 */
                HtmlUnescape: function (input) {
                    return !ExpressCraft.Helper.IsEmpty(input) ? System.String.replaceAll(System.String.replaceAll(ExpressCraft.Helper.HtmlUrlUnescape(input), "&#x2F", "\\/"), "&quot", "\"") : "";
                },
                ExchangeClass$1: function (control, oldClass, newClass) {
                    ExpressCraft.Helper.ExchangeClass(control.Content, oldClass, newClass);
                },
                ExchangeClass: function (control, oldClass, newClass) {
                    if (!ExpressCraft.Helper.IsEmpty(oldClass) && control.classList.contains(oldClass)) {
                        control.classList.remove(oldClass);
                    }
                    if (!ExpressCraft.Helper.IsEmpty(newClass) && !control.classList.contains(newClass)) {
                        control.classList.add(newClass);
                    }
                },
                IsEmpty: function (value) {
                    return System.String.isNullOrWhiteSpace(value);
                },
                StopAndLog: function (sw, logName) {
                    if (logName === void 0) { logName = "Task"; }
                    sw.stop();
                    ExpressCraft.ConsoleForm.Log(System.String.concat(logName, " took ", sw.milliseconds(), "ms to finish"));
                }
            }
        }
    });

    Bridge.define("ExpressCraft.Helper.DataTableJson", {
        statics: {
            methods: {
                FromExternal: function (o) {
                    var x;
                    x = Bridge.merge(Bridge.createInstance(ExpressCraft.Helper.DataTableJson), o);
                    return x;
                },
                Parse: function (o) {
                    var dt = new ExpressCraft.DataTable();
                    var length = o.fieldNames.length;
                    for (var i = 0; i < length; i = (i + 1) | 0) {
                        dt.AddColumn(o.fieldNames[i], o.dataTypes[i]);
                    }
                    if (o.rows != null) {
                        length = o.rows.length;
                        dt.BeginNewRow(length);

                        for (var i1 = 0; i1 < length; i1 = (i1 + 1) | 0) {
                            var dr = dt.NewRow();
                            dr.batchData = o.rows[i1];
                        }
                        dt.AcceptNewRows();
                    }
                    return dt;
                }
            }
        },
        fields: {
            fieldNames: null,
            rows: null,
            dataTypes: null
        },
        methods: {
            ToTable: function () {
                var dt = new ExpressCraft.DataTable();

                for (var i = 0; i < this.fieldNames.length; i = (i + 1) | 0) {
                    dt.AddColumn(this.fieldNames[System.Array.index(i, this.fieldNames)], this.dataTypes[System.Array.index(i, this.dataTypes)]);
                }

                if (this.rows != null) {
                    dt.BeginNewRow(this.rows.length);

                    for (var i1 = 0; i1 < this.rows.length; i1 = (i1 + 1) | 0) {
                        var dr = dt.NewRow();
                        dr.batchData = this.rows[System.Array.index(i1, this.rows)];
                    }
                    dt.AcceptNewRows();
                }

                return dt;
            }
        }
    });

    Bridge.define("ExpressCraft.IndexValue$1", function (T) { return {
        fields: {
            Index: 0,
            Value: Bridge.getDefaultValue(T)
        },
        ctors: {
            ctor: function (index, value) {
                this.$initialize();
                this.Index = index;
                this.Value = value;
            }
        }
    }; });

    Bridge.define("ExpressCraft.IPages", {
        $kind: "interface"
    });

    Bridge.define("ExpressCraft.KeyCodes", {
        statics: {
            fields: {
                Modifiers: 0,
                None: 0,
                LButton: 0,
                RButton: 0,
                Cancel: 0,
                MButton: 0,
                XButton1: 0,
                XButton2: 0,
                Back: 0,
                Tab: 0,
                LineFeed: 0,
                Clear: 0,
                Return: 0,
                Enter: 0,
                ShiftKey: 0,
                ControlKey: 0,
                Menu: 0,
                Pause: 0,
                Capital: 0,
                CapsLock: 0,
                KanaMode: 0,
                HanguelMode: 0,
                HangulMode: 0,
                JunjaMode: 0,
                FinalMode: 0,
                HanjaMode: 0,
                KanjiMode: 0,
                Escape: 0,
                IMEConvert: 0,
                IMENonconvert: 0,
                IMEAccept: 0,
                IMEAceept: 0,
                IMEModeChange: 0,
                Space: 0,
                Prior: 0,
                PageUp: 0,
                Next: 0,
                PageDown: 0,
                End: 0,
                Home: 0,
                Left: 0,
                Up: 0,
                Right: 0,
                Down: 0,
                Select: 0,
                Print: 0,
                Execute: 0,
                Snapshot: 0,
                PrintScreen: 0,
                Insert: 0,
                Delete: 0,
                Help: 0,
                D0: 0,
                D1: 0,
                D2: 0,
                D3: 0,
                D4: 0,
                D5: 0,
                D6: 0,
                D7: 0,
                D8: 0,
                D9: 0,
                A: 0,
                B: 0,
                C: 0,
                D: 0,
                E: 0,
                F: 0,
                G: 0,
                H: 0,
                I: 0,
                J: 0,
                K: 0,
                L: 0,
                M: 0,
                N: 0,
                O: 0,
                P: 0,
                Q: 0,
                R: 0,
                S: 0,
                T: 0,
                U: 0,
                V: 0,
                W: 0,
                X: 0,
                Y: 0,
                Z: 0,
                LWin: 0,
                RWin: 0,
                Apps: 0,
                Sleep: 0,
                NumPad0: 0,
                NumPad1: 0,
                NumPad2: 0,
                NumPad3: 0,
                NumPad4: 0,
                NumPad5: 0,
                NumPad6: 0,
                NumPad7: 0,
                NumPad8: 0,
                NumPad9: 0,
                Multiply: 0,
                Add: 0,
                Separator: 0,
                Subtract: 0,
                Decimal: 0,
                Divide: 0,
                F1: 0,
                F2: 0,
                F3: 0,
                F4: 0,
                F5: 0,
                F6: 0,
                F7: 0,
                F8: 0,
                F9: 0,
                F10: 0,
                F11: 0,
                F12: 0,
                F13: 0,
                F14: 0,
                F15: 0,
                F16: 0,
                F17: 0,
                F18: 0,
                F19: 0,
                F20: 0,
                F21: 0,
                F22: 0,
                F23: 0,
                F24: 0,
                NumLock: 0,
                Scroll: 0,
                LShiftKey: 0,
                RShiftKey: 0,
                LControlKey: 0,
                RControlKey: 0,
                LMenu: 0,
                RMenu: 0,
                BrowserBack: 0,
                BrowserForward: 0,
                BrowserRefresh: 0,
                BrowserStop: 0,
                BrowserSearch: 0,
                BrowserFavorites: 0,
                BrowserHome: 0,
                VolumeMute: 0,
                VolumeDown: 0,
                VolumeUp: 0,
                MediaNextTrack: 0,
                MediaPreviousTrack: 0,
                MediaStop: 0,
                MediaPlayPause: 0,
                LaunchMail: 0,
                SelectMedia: 0,
                LaunchApplication1: 0,
                LaunchApplication2: 0,
                OemSemicolon: 0,
                Oem1: 0,
                Oemplus: 0,
                Oemcomma: 0,
                OemMinus: 0,
                OemPeriod: 0,
                OemQuestion: 0,
                Oem2: 0,
                Oemtilde: 0,
                Oem3: 0,
                OemOpenBrackets: 0,
                Oem4: 0,
                OemPipe: 0,
                Oem5: 0,
                OemCloseBrackets: 0,
                Oem6: 0,
                OemQuotes: 0,
                Oem7: 0,
                Oem8: 0,
                OemBackslash: 0,
                Oem102: 0,
                ProcessKey: 0,
                Packet: 0,
                Attn: 0,
                Crsel: 0,
                Exsel: 0,
                EraseEof: 0,
                Play: 0,
                Zoom: 0,
                NoName: 0,
                Pa1: 0,
                OemClear: 0,
                KeyCode: 0,
                Shift: 0,
                Control: 0,
                Alt: 0
            },
            ctors: {
                init: function () {
                    this.Modifiers = -65536;
                    this.None = 0;
                    this.LButton = 1;
                    this.RButton = 2;
                    this.Cancel = 3;
                    this.MButton = 4;
                    this.XButton1 = 5;
                    this.XButton2 = 6;
                    this.Back = 8;
                    this.Tab = 9;
                    this.LineFeed = 10;
                    this.Clear = 12;
                    this.Return = 13;
                    this.Enter = 13;
                    this.ShiftKey = 16;
                    this.ControlKey = 17;
                    this.Menu = 18;
                    this.Pause = 19;
                    this.Capital = 20;
                    this.CapsLock = 20;
                    this.KanaMode = 21;
                    this.HanguelMode = 21;
                    this.HangulMode = 21;
                    this.JunjaMode = 23;
                    this.FinalMode = 24;
                    this.HanjaMode = 25;
                    this.KanjiMode = 25;
                    this.Escape = 27;
                    this.IMEConvert = 28;
                    this.IMENonconvert = 29;
                    this.IMEAccept = 30;
                    this.IMEAceept = 30;
                    this.IMEModeChange = 31;
                    this.Space = 32;
                    this.Prior = 33;
                    this.PageUp = 33;
                    this.Next = 34;
                    this.PageDown = 34;
                    this.End = 35;
                    this.Home = 36;
                    this.Left = 37;
                    this.Up = 38;
                    this.Right = 39;
                    this.Down = 40;
                    this.Select = 41;
                    this.Print = 42;
                    this.Execute = 43;
                    this.Snapshot = 44;
                    this.PrintScreen = 44;
                    this.Insert = 45;
                    this.Delete = 46;
                    this.Help = 47;
                    this.D0 = 48;
                    this.D1 = 49;
                    this.D2 = 50;
                    this.D3 = 51;
                    this.D4 = 52;
                    this.D5 = 53;
                    this.D6 = 54;
                    this.D7 = 55;
                    this.D8 = 56;
                    this.D9 = 57;
                    this.A = 65;
                    this.B = 66;
                    this.C = 67;
                    this.D = 68;
                    this.E = 69;
                    this.F = 70;
                    this.G = 71;
                    this.H = 72;
                    this.I = 73;
                    this.J = 74;
                    this.K = 75;
                    this.L = 76;
                    this.M = 77;
                    this.N = 78;
                    this.O = 79;
                    this.P = 80;
                    this.Q = 81;
                    this.R = 82;
                    this.S = 83;
                    this.T = 84;
                    this.U = 85;
                    this.V = 86;
                    this.W = 87;
                    this.X = 88;
                    this.Y = 89;
                    this.Z = 90;
                    this.LWin = 91;
                    this.RWin = 92;
                    this.Apps = 93;
                    this.Sleep = 95;
                    this.NumPad0 = 96;
                    this.NumPad1 = 97;
                    this.NumPad2 = 98;
                    this.NumPad3 = 99;
                    this.NumPad4 = 100;
                    this.NumPad5 = 101;
                    this.NumPad6 = 102;
                    this.NumPad7 = 103;
                    this.NumPad8 = 104;
                    this.NumPad9 = 105;
                    this.Multiply = 106;
                    this.Add = 107;
                    this.Separator = 108;
                    this.Subtract = 109;
                    this.Decimal = 110;
                    this.Divide = 111;
                    this.F1 = 112;
                    this.F2 = 113;
                    this.F3 = 114;
                    this.F4 = 115;
                    this.F5 = 116;
                    this.F6 = 117;
                    this.F7 = 118;
                    this.F8 = 119;
                    this.F9 = 120;
                    this.F10 = 121;
                    this.F11 = 122;
                    this.F12 = 123;
                    this.F13 = 124;
                    this.F14 = 125;
                    this.F15 = 126;
                    this.F16 = 127;
                    this.F17 = 128;
                    this.F18 = 129;
                    this.F19 = 130;
                    this.F20 = 131;
                    this.F21 = 132;
                    this.F22 = 133;
                    this.F23 = 134;
                    this.F24 = 135;
                    this.NumLock = 144;
                    this.Scroll = 145;
                    this.LShiftKey = 160;
                    this.RShiftKey = 161;
                    this.LControlKey = 162;
                    this.RControlKey = 163;
                    this.LMenu = 164;
                    this.RMenu = 165;
                    this.BrowserBack = 166;
                    this.BrowserForward = 167;
                    this.BrowserRefresh = 168;
                    this.BrowserStop = 169;
                    this.BrowserSearch = 170;
                    this.BrowserFavorites = 171;
                    this.BrowserHome = 172;
                    this.VolumeMute = 173;
                    this.VolumeDown = 174;
                    this.VolumeUp = 175;
                    this.MediaNextTrack = 176;
                    this.MediaPreviousTrack = 177;
                    this.MediaStop = 178;
                    this.MediaPlayPause = 179;
                    this.LaunchMail = 180;
                    this.SelectMedia = 181;
                    this.LaunchApplication1 = 182;
                    this.LaunchApplication2 = 183;
                    this.OemSemicolon = 186;
                    this.Oem1 = 186;
                    this.Oemplus = 187;
                    this.Oemcomma = 188;
                    this.OemMinus = 189;
                    this.OemPeriod = 190;
                    this.OemQuestion = 191;
                    this.Oem2 = 191;
                    this.Oemtilde = 192;
                    this.Oem3 = 192;
                    this.OemOpenBrackets = 219;
                    this.Oem4 = 219;
                    this.OemPipe = 220;
                    this.Oem5 = 220;
                    this.OemCloseBrackets = 221;
                    this.Oem6 = 221;
                    this.OemQuotes = 222;
                    this.Oem7 = 222;
                    this.Oem8 = 223;
                    this.OemBackslash = 226;
                    this.Oem102 = 226;
                    this.ProcessKey = 229;
                    this.Packet = 231;
                    this.Attn = 246;
                    this.Crsel = 247;
                    this.Exsel = 248;
                    this.EraseEof = 249;
                    this.Play = 250;
                    this.Zoom = 251;
                    this.NoName = 252;
                    this.Pa1 = 253;
                    this.OemClear = 254;
                    this.KeyCode = 65535;
                    this.Shift = 65536;
                    this.Control = 131072;
                    this.Alt = 262144;
                }
            }
        }
    });

    Bridge.define("ExpressCraft.KnownColor", {
        $kind: "enum",
        statics: {
            fields: {
                ActiveBorder: 1,
                ActiveCaption: 2,
                ActiveCaptionText: 3,
                AliceBlue: 28,
                AntiqueWhite: 29,
                AppWorkspace: 4,
                Aqua: 30,
                Aquamarine: 31,
                Azure: 32,
                Beige: 33,
                Bisque: 34,
                Black: 35,
                BlanchedAlmond: 36,
                Blue: 37,
                BlueViolet: 38,
                Brown: 39,
                BurlyWood: 40,
                ButtonFace: 168,
                ButtonHighlight: 169,
                ButtonShadow: 170,
                CadetBlue: 41,
                Chartreuse: 42,
                Chocolate: 43,
                Control: 5,
                ControlDark: 6,
                ControlDarkDark: 7,
                ControlLight: 8,
                ControlLightLight: 9,
                ControlText: 10,
                Coral: 44,
                CornflowerBlue: 45,
                Cornsilk: 46,
                Crimson: 47,
                Cyan: 48,
                DarkBlue: 49,
                DarkCyan: 50,
                DarkGoldenrod: 51,
                DarkGray: 52,
                DarkGreen: 53,
                DarkKhaki: 54,
                DarkMagenta: 55,
                DarkOliveGreen: 56,
                DarkOrange: 57,
                DarkOrchid: 58,
                DarkRed: 59,
                DarkSalmon: 60,
                DarkSeaGreen: 61,
                DarkSlateBlue: 62,
                DarkSlateGray: 63,
                DarkTurquoise: 64,
                DarkViolet: 65,
                DeepPink: 66,
                DeepSkyBlue: 67,
                Desktop: 11,
                DimGray: 68,
                DodgerBlue: 69,
                Firebrick: 70,
                FloralWhite: 71,
                ForestGreen: 72,
                Fuchsia: 73,
                Gainsboro: 74,
                GhostWhite: 75,
                Gold: 76,
                Goldenrod: 77,
                GradientActiveCaption: 171,
                GradientInactiveCaption: 172,
                Gray: 78,
                GrayText: 12,
                Green: 79,
                GreenYellow: 80,
                Highlight: 13,
                HighlightText: 14,
                Honeydew: 81,
                HotPink: 82,
                HotTrack: 15,
                InactiveBorder: 16,
                InactiveCaption: 17,
                InactiveCaptionText: 18,
                IndianRed: 83,
                Indigo: 84,
                Info: 19,
                InfoText: 20,
                Ivory: 85,
                Khaki: 86,
                Lavender: 87,
                LavenderBlush: 88,
                LawnGreen: 89,
                LemonChiffon: 90,
                LightBlue: 91,
                LightCoral: 92,
                LightCyan: 93,
                LightGoldenrodYellow: 94,
                LightGray: 95,
                LightGreen: 96,
                LightPink: 97,
                LightSalmon: 98,
                LightSeaGreen: 99,
                LightSkyBlue: 100,
                LightSlateGray: 101,
                LightSteelBlue: 102,
                LightYellow: 103,
                Lime: 104,
                LimeGreen: 105,
                Linen: 106,
                Magenta: 107,
                Maroon: 108,
                MediumAquamarine: 109,
                MediumBlue: 110,
                MediumOrchid: 111,
                MediumPurple: 112,
                MediumSeaGreen: 113,
                MediumSlateBlue: 114,
                MediumSpringGreen: 115,
                MediumTurquoise: 116,
                MediumVioletRed: 117,
                Menu: 21,
                MenuBar: 173,
                MenuHighlight: 174,
                MenuText: 22,
                MidnightBlue: 118,
                MintCream: 119,
                MistyRose: 120,
                Moccasin: 121,
                NavajoWhite: 122,
                Navy: 123,
                OldLace: 124,
                Olive: 125,
                OliveDrab: 126,
                Orange: 127,
                OrangeRed: 128,
                Orchid: 129,
                PaleGoldenrod: 130,
                PaleGreen: 131,
                PaleTurquoise: 132,
                PaleVioletRed: 133,
                PapayaWhip: 134,
                PeachPuff: 135,
                Peru: 136,
                Pink: 137,
                Plum: 138,
                PowderBlue: 139,
                Purple: 140,
                Red: 141,
                RosyBrown: 142,
                RoyalBlue: 143,
                SaddleBrown: 144,
                Salmon: 145,
                SandyBrown: 146,
                ScrollBar: 23,
                SeaGreen: 147,
                SeaShell: 148,
                Sienna: 149,
                Silver: 150,
                SkyBlue: 151,
                SlateBlue: 152,
                SlateGray: 153,
                Snow: 154,
                SpringGreen: 155,
                SteelBlue: 156,
                Tan: 157,
                Teal: 158,
                Thistle: 159,
                Tomato: 160,
                Transparent: 27,
                Turquoise: 161,
                Violet: 162,
                Wheat: 163,
                White: 164,
                WhiteSmoke: 165,
                Window: 24,
                WindowFrame: 25,
                WindowText: 26,
                Yellow: 166,
                YellowGreen: 167
            }
        }
    });

    Bridge.define("ExpressCraft.KnownColorTable", {
        statics: {
            fields: {
                AlphaShift: 0,
                BlueShift: 0,
                colorNameTable: null,
                colorTable: null,
                GreenShift: 0,
                RedShift: 0,
                Win32BlueShift: 0,
                Win32GreenShift: 0,
                Win32RedShift: 0
            },
            ctors: {
                init: function () {
                    this.AlphaShift = 24;
                    this.BlueShift = 0;
                    this.GreenShift = 8;
                    this.RedShift = 16;
                    this.Win32BlueShift = 16;
                    this.Win32GreenShift = 8;
                    this.Win32RedShift = 0;
                }
            },
            methods: {
                ArgbToKnownColor: function (targetARGB) {
                    ExpressCraft.KnownColorTable.EnsureColorTable();
                    for (var i = 0; i < ExpressCraft.KnownColorTable.colorTable.length; i = (i + 1) | 0) {
                        var num2 = ExpressCraft.KnownColorTable.colorTable[System.Array.index(i, ExpressCraft.KnownColorTable.colorTable)];
                        if (num2 === targetARGB) {
                            var color = ExpressCraft.Color.FromKnownColor(i);
                            if (!color.IsSystemColor) {
                                return color.$clone();
                            }
                        }
                    }
                    return ExpressCraft.Color.FromArgb(targetARGB);
                },
                Encode: function (alpha, red, green, blue) {
                    return ((((red << 16) | (green << 8)) | blue) | (alpha << 24));
                },
                EnsureColorNameTable: function () {
                    if (ExpressCraft.KnownColorTable.colorNameTable == null) {
                        ExpressCraft.KnownColorTable.InitColorNameTable();
                    }
                },
                EnsureColorTable: function () {
                    if (ExpressCraft.KnownColorTable.colorTable == null) {
                        ExpressCraft.KnownColorTable.InitColorTable();
                    }
                },
                FromWin32Value: function (value) {
                    return ExpressCraft.KnownColorTable.Encode(255, value & 255, (value >> 8) & 255, (value >> 16) & 255);
                },
                InitColorNameTable: function () {
                    var s = System.Array.init(175, null, System.String);
                    s[System.Array.index(1, s)] = "ActiveBorder";
                    s[System.Array.index(2, s)] = "ActiveCaption";
                    s[System.Array.index(3, s)] = "ActiveCaptionText";
                    s[System.Array.index(4, s)] = "AppWorkspace";
                    s[System.Array.index(168, s)] = "ButtonFace";
                    s[System.Array.index(169, s)] = "ButtonHighlight";
                    s[System.Array.index(170, s)] = "ButtonShadow";
                    s[System.Array.index(5, s)] = "Control";
                    s[System.Array.index(6, s)] = "ControlDark";
                    s[System.Array.index(7, s)] = "ControlDarkDark";
                    s[System.Array.index(8, s)] = "ControlLight";
                    s[System.Array.index(9, s)] = "ControlLightLight";
                    s[System.Array.index(10, s)] = "ControlText";
                    s[System.Array.index(11, s)] = "Desktop";
                    s[System.Array.index(171, s)] = "GradientActiveCaption";
                    s[System.Array.index(172, s)] = "GradientInactiveCaption";
                    s[System.Array.index(12, s)] = "GrayText";
                    s[System.Array.index(13, s)] = "Highlight";
                    s[System.Array.index(14, s)] = "HighlightText";
                    s[System.Array.index(15, s)] = "HotTrack";
                    s[System.Array.index(16, s)] = "InactiveBorder";
                    s[System.Array.index(17, s)] = "InactiveCaption";
                    s[System.Array.index(18, s)] = "InactiveCaptionText";
                    s[System.Array.index(19, s)] = "Info";
                    s[System.Array.index(20, s)] = "InfoText";
                    s[System.Array.index(21, s)] = "Menu";
                    s[System.Array.index(173, s)] = "MenuBar";
                    s[System.Array.index(174, s)] = "MenuHighlight";
                    s[System.Array.index(22, s)] = "MenuText";
                    s[System.Array.index(23, s)] = "ScrollBar";
                    s[System.Array.index(24, s)] = "Window";
                    s[System.Array.index(25, s)] = "WindowFrame";
                    s[System.Array.index(26, s)] = "WindowText";
                    s[System.Array.index(27, s)] = "Transparent";
                    s[System.Array.index(28, s)] = "AliceBlue";
                    s[System.Array.index(29, s)] = "AntiqueWhite";
                    s[System.Array.index(30, s)] = "Aqua";
                    s[System.Array.index(31, s)] = "Aquamarine";
                    s[System.Array.index(32, s)] = "Azure";
                    s[System.Array.index(33, s)] = "Beige";
                    s[System.Array.index(34, s)] = "Bisque";
                    s[System.Array.index(35, s)] = "Black";
                    s[System.Array.index(36, s)] = "BlanchedAlmond";
                    s[System.Array.index(37, s)] = "Blue";
                    s[System.Array.index(38, s)] = "BlueViolet";
                    s[System.Array.index(39, s)] = "Brown";
                    s[System.Array.index(40, s)] = "BurlyWood";
                    s[System.Array.index(41, s)] = "CadetBlue";
                    s[System.Array.index(42, s)] = "Chartreuse";
                    s[System.Array.index(43, s)] = "Chocolate";
                    s[System.Array.index(44, s)] = "Coral";
                    s[System.Array.index(45, s)] = "CornflowerBlue";
                    s[System.Array.index(46, s)] = "Cornsilk";
                    s[System.Array.index(47, s)] = "Crimson";
                    s[System.Array.index(48, s)] = "Cyan";
                    s[System.Array.index(49, s)] = "DarkBlue";
                    s[System.Array.index(50, s)] = "DarkCyan";
                    s[System.Array.index(51, s)] = "DarkGoldenrod";
                    s[System.Array.index(52, s)] = "DarkGray";
                    s[System.Array.index(53, s)] = "DarkGreen";
                    s[System.Array.index(54, s)] = "DarkKhaki";
                    s[System.Array.index(55, s)] = "DarkMagenta";
                    s[System.Array.index(56, s)] = "DarkOliveGreen";
                    s[System.Array.index(57, s)] = "DarkOrange";
                    s[System.Array.index(58, s)] = "DarkOrchid";
                    s[System.Array.index(59, s)] = "DarkRed";
                    s[System.Array.index(60, s)] = "DarkSalmon";
                    s[System.Array.index(61, s)] = "DarkSeaGreen";
                    s[System.Array.index(62, s)] = "DarkSlateBlue";
                    s[System.Array.index(63, s)] = "DarkSlateGray";
                    s[System.Array.index(64, s)] = "DarkTurquoise";
                    s[System.Array.index(65, s)] = "DarkViolet";
                    s[System.Array.index(66, s)] = "DeepPink";
                    s[System.Array.index(67, s)] = "DeepSkyBlue";
                    s[System.Array.index(68, s)] = "DimGray";
                    s[System.Array.index(69, s)] = "DodgerBlue";
                    s[System.Array.index(70, s)] = "Firebrick";
                    s[System.Array.index(71, s)] = "FloralWhite";
                    s[System.Array.index(72, s)] = "ForestGreen";
                    s[System.Array.index(73, s)] = "Fuchsia";
                    s[System.Array.index(74, s)] = "Gainsboro";
                    s[System.Array.index(75, s)] = "GhostWhite";
                    s[System.Array.index(76, s)] = "Gold";
                    s[System.Array.index(77, s)] = "Goldenrod";
                    s[System.Array.index(78, s)] = "Gray";
                    s[System.Array.index(79, s)] = "Green";
                    s[System.Array.index(80, s)] = "GreenYellow";
                    s[System.Array.index(81, s)] = "Honeydew";
                    s[System.Array.index(82, s)] = "HotPink";
                    s[System.Array.index(83, s)] = "IndianRed";
                    s[System.Array.index(84, s)] = "Indigo";
                    s[System.Array.index(85, s)] = "Ivory";
                    s[System.Array.index(86, s)] = "Khaki";
                    s[System.Array.index(87, s)] = "Lavender";
                    s[System.Array.index(88, s)] = "LavenderBlush";
                    s[System.Array.index(89, s)] = "LawnGreen";
                    s[System.Array.index(90, s)] = "LemonChiffon";
                    s[System.Array.index(91, s)] = "LightBlue";
                    s[System.Array.index(92, s)] = "LightCoral";
                    s[System.Array.index(93, s)] = "LightCyan";
                    s[System.Array.index(94, s)] = "LightGoldenrodYellow";
                    s[System.Array.index(95, s)] = "LightGray";
                    s[System.Array.index(96, s)] = "LightGreen";
                    s[System.Array.index(97, s)] = "LightPink";
                    s[System.Array.index(98, s)] = "LightSalmon";
                    s[System.Array.index(99, s)] = "LightSeaGreen";
                    s[System.Array.index(100, s)] = "LightSkyBlue";
                    s[System.Array.index(101, s)] = "LightSlateGray";
                    s[System.Array.index(102, s)] = "LightSteelBlue";
                    s[System.Array.index(103, s)] = "LightYellow";
                    s[System.Array.index(104, s)] = "Lime";
                    s[System.Array.index(105, s)] = "LimeGreen";
                    s[System.Array.index(106, s)] = "Linen";
                    s[System.Array.index(107, s)] = "Magenta";
                    s[System.Array.index(108, s)] = "Maroon";
                    s[System.Array.index(109, s)] = "MediumAquamarine";
                    s[System.Array.index(110, s)] = "MediumBlue";
                    s[System.Array.index(111, s)] = "MediumOrchid";
                    s[System.Array.index(112, s)] = "MediumPurple";
                    s[System.Array.index(113, s)] = "MediumSeaGreen";
                    s[System.Array.index(114, s)] = "MediumSlateBlue";
                    s[System.Array.index(115, s)] = "MediumSpringGreen";
                    s[System.Array.index(116, s)] = "MediumTurquoise";
                    s[System.Array.index(117, s)] = "MediumVioletRed";
                    s[System.Array.index(118, s)] = "MidnightBlue";
                    s[System.Array.index(119, s)] = "MintCream";
                    s[System.Array.index(120, s)] = "MistyRose";
                    s[System.Array.index(121, s)] = "Moccasin";
                    s[System.Array.index(122, s)] = "NavajoWhite";
                    s[System.Array.index(123, s)] = "Navy";
                    s[System.Array.index(124, s)] = "OldLace";
                    s[System.Array.index(125, s)] = "Olive";
                    s[System.Array.index(126, s)] = "OliveDrab";
                    s[System.Array.index(127, s)] = "Orange";
                    s[System.Array.index(128, s)] = "OrangeRed";
                    s[System.Array.index(129, s)] = "Orchid";
                    s[System.Array.index(130, s)] = "PaleGoldenrod";
                    s[System.Array.index(131, s)] = "PaleGreen";
                    s[System.Array.index(132, s)] = "PaleTurquoise";
                    s[System.Array.index(133, s)] = "PaleVioletRed";
                    s[System.Array.index(134, s)] = "PapayaWhip";
                    s[System.Array.index(135, s)] = "PeachPuff";
                    s[System.Array.index(136, s)] = "Peru";
                    s[System.Array.index(137, s)] = "Pink";
                    s[System.Array.index(138, s)] = "Plum";
                    s[System.Array.index(139, s)] = "PowderBlue";
                    s[System.Array.index(140, s)] = "Purple";
                    s[System.Array.index(141, s)] = "Red";
                    s[System.Array.index(142, s)] = "RosyBrown";
                    s[System.Array.index(143, s)] = "RoyalBlue";
                    s[System.Array.index(144, s)] = "SaddleBrown";
                    s[System.Array.index(145, s)] = "Salmon";
                    s[System.Array.index(146, s)] = "SandyBrown";
                    s[System.Array.index(147, s)] = "SeaGreen";
                    s[System.Array.index(148, s)] = "SeaShell";
                    s[System.Array.index(149, s)] = "Sienna";
                    s[System.Array.index(150, s)] = "Silver";
                    s[System.Array.index(151, s)] = "SkyBlue";
                    s[System.Array.index(152, s)] = "SlateBlue";
                    s[System.Array.index(153, s)] = "SlateGray";
                    s[System.Array.index(154, s)] = "Snow";
                    s[System.Array.index(155, s)] = "SpringGreen";
                    s[System.Array.index(156, s)] = "SteelBlue";
                    s[System.Array.index(157, s)] = "Tan";
                    s[System.Array.index(158, s)] = "Teal";
                    s[System.Array.index(159, s)] = "Thistle";
                    s[System.Array.index(160, s)] = "Tomato";
                    s[System.Array.index(161, s)] = "Turquoise";
                    s[System.Array.index(162, s)] = "Violet";
                    s[System.Array.index(163, s)] = "Wheat";
                    s[System.Array.index(164, s)] = "White";
                    s[System.Array.index(165, s)] = "WhiteSmoke";
                    s[System.Array.index(166, s)] = "Yellow";
                    s[System.Array.index(167, s)] = "YellowGreen";
                    ExpressCraft.KnownColorTable.colorNameTable = s;
                },
                InitColorTable: function () {
                    var c = System.Array.init(175, 0, System.Int32);

                    c[System.Array.index(27, c)] = 16777215;
                    c[System.Array.index(28, c)] = -984833;
                    c[System.Array.index(29, c)] = -332841;
                    c[System.Array.index(30, c)] = -16711681;
                    c[System.Array.index(31, c)] = -8388652;
                    c[System.Array.index(32, c)] = -983041;
                    c[System.Array.index(33, c)] = -657956;
                    c[System.Array.index(34, c)] = -6972;
                    c[System.Array.index(35, c)] = -16777216;
                    c[System.Array.index(36, c)] = -5171;
                    c[System.Array.index(37, c)] = -16776961;
                    c[System.Array.index(38, c)] = -7722014;
                    c[System.Array.index(39, c)] = -5952982;
                    c[System.Array.index(40, c)] = -2180985;
                    c[System.Array.index(41, c)] = -10510688;
                    c[System.Array.index(42, c)] = -8388864;
                    c[System.Array.index(43, c)] = -2987746;
                    c[System.Array.index(44, c)] = -32944;
                    c[System.Array.index(45, c)] = -10185235;
                    c[System.Array.index(46, c)] = -1828;
                    c[System.Array.index(47, c)] = -2354116;
                    c[System.Array.index(48, c)] = -16711681;
                    c[System.Array.index(49, c)] = -16777077;
                    c[System.Array.index(50, c)] = -16741493;
                    c[System.Array.index(51, c)] = -4684277;
                    c[System.Array.index(52, c)] = -5658199;
                    c[System.Array.index(53, c)] = -16751616;
                    c[System.Array.index(54, c)] = -4343957;
                    c[System.Array.index(55, c)] = -7667573;
                    c[System.Array.index(56, c)] = -11179217;
                    c[System.Array.index(57, c)] = -29696;
                    c[System.Array.index(58, c)] = -6737204;
                    c[System.Array.index(59, c)] = -7667712;
                    c[System.Array.index(60, c)] = -1468806;
                    c[System.Array.index(61, c)] = -7357301;
                    c[System.Array.index(62, c)] = -12042869;
                    c[System.Array.index(63, c)] = -13676721;
                    c[System.Array.index(64, c)] = -16724271;
                    c[System.Array.index(65, c)] = -7077677;
                    c[System.Array.index(66, c)] = -60269;
                    c[System.Array.index(67, c)] = -16728065;
                    c[System.Array.index(68, c)] = -9868951;
                    c[System.Array.index(69, c)] = -14774017;
                    c[System.Array.index(70, c)] = -5103070;
                    c[System.Array.index(71, c)] = -1296;
                    c[System.Array.index(72, c)] = -14513374;
                    c[System.Array.index(73, c)] = -65281;
                    c[System.Array.index(74, c)] = -2302756;
                    c[System.Array.index(75, c)] = -460545;
                    c[System.Array.index(76, c)] = -10496;
                    c[System.Array.index(77, c)] = -2448096;
                    c[System.Array.index(78, c)] = -8355712;
                    c[System.Array.index(79, c)] = -16744448;
                    c[System.Array.index(80, c)] = -5374161;
                    c[System.Array.index(81, c)] = -983056;
                    c[System.Array.index(82, c)] = -38476;
                    c[System.Array.index(83, c)] = -3318692;
                    c[System.Array.index(84, c)] = -11861886;
                    c[System.Array.index(85, c)] = -16;
                    c[System.Array.index(86, c)] = -989556;
                    c[System.Array.index(87, c)] = -1644806;
                    c[System.Array.index(88, c)] = -3851;
                    c[System.Array.index(89, c)] = -8586240;
                    c[System.Array.index(90, c)] = -1331;
                    c[System.Array.index(91, c)] = -5383962;
                    c[System.Array.index(92, c)] = -1015680;
                    c[System.Array.index(93, c)] = -2031617;
                    c[System.Array.index(94, c)] = -329006;
                    c[System.Array.index(95, c)] = -2894893;
                    c[System.Array.index(96, c)] = -7278960;
                    c[System.Array.index(97, c)] = -18751;
                    c[System.Array.index(98, c)] = -24454;
                    c[System.Array.index(99, c)] = -14634326;
                    c[System.Array.index(100, c)] = -7876870;
                    c[System.Array.index(101, c)] = -8943463;
                    c[System.Array.index(102, c)] = -5192482;
                    c[System.Array.index(103, c)] = -32;
                    c[System.Array.index(104, c)] = -16711936;
                    c[System.Array.index(105, c)] = -13447886;
                    c[System.Array.index(106, c)] = -331546;
                    c[System.Array.index(107, c)] = -65281;
                    c[System.Array.index(108, c)] = -8388608;
                    c[System.Array.index(109, c)] = -10039894;
                    c[System.Array.index(110, c)] = -16777011;
                    c[System.Array.index(111, c)] = -4565549;
                    c[System.Array.index(112, c)] = -7114533;
                    c[System.Array.index(113, c)] = -12799119;
                    c[System.Array.index(114, c)] = -8689426;
                    c[System.Array.index(115, c)] = -16713062;
                    c[System.Array.index(116, c)] = -12004916;
                    c[System.Array.index(117, c)] = -3730043;
                    c[System.Array.index(118, c)] = -15132304;
                    c[System.Array.index(119, c)] = -655366;
                    c[System.Array.index(120, c)] = -6943;
                    c[System.Array.index(121, c)] = -6987;
                    c[System.Array.index(122, c)] = -8531;
                    c[System.Array.index(123, c)] = -16777088;
                    c[System.Array.index(124, c)] = -133658;
                    c[System.Array.index(125, c)] = -8355840;
                    c[System.Array.index(126, c)] = -9728477;
                    c[System.Array.index(127, c)] = -23296;
                    c[System.Array.index(128, c)] = -47872;
                    c[System.Array.index(129, c)] = -2461482;
                    c[System.Array.index(130, c)] = -1120086;
                    c[System.Array.index(131, c)] = -6751336;
                    c[System.Array.index(132, c)] = -5247250;
                    c[System.Array.index(133, c)] = -2396013;
                    c[System.Array.index(134, c)] = -4139;
                    c[System.Array.index(135, c)] = -9543;
                    c[System.Array.index(136, c)] = -3308225;
                    c[System.Array.index(137, c)] = -16181;
                    c[System.Array.index(138, c)] = -2252579;
                    c[System.Array.index(139, c)] = -5185306;
                    c[System.Array.index(140, c)] = -8388480;
                    c[System.Array.index(141, c)] = -65536;
                    c[System.Array.index(142, c)] = -4419697;
                    c[System.Array.index(143, c)] = -12490271;
                    c[System.Array.index(144, c)] = -7650029;
                    c[System.Array.index(145, c)] = -360334;
                    c[System.Array.index(146, c)] = -744352;
                    c[System.Array.index(147, c)] = -13726889;
                    c[System.Array.index(148, c)] = -2578;
                    c[System.Array.index(149, c)] = -6270419;
                    c[System.Array.index(150, c)] = -4144960;
                    c[System.Array.index(151, c)] = -7876885;
                    c[System.Array.index(152, c)] = -9807155;
                    c[System.Array.index(153, c)] = -9404272;
                    c[System.Array.index(154, c)] = -1286;
                    c[System.Array.index(155, c)] = -16711809;
                    c[System.Array.index(156, c)] = -12156236;
                    c[System.Array.index(157, c)] = -2968436;
                    c[System.Array.index(158, c)] = -16744320;
                    c[System.Array.index(159, c)] = -2572328;
                    c[System.Array.index(160, c)] = -40121;
                    c[System.Array.index(161, c)] = -12525360;
                    c[System.Array.index(162, c)] = -1146130;
                    c[System.Array.index(163, c)] = -663885;
                    c[System.Array.index(164, c)] = -1;
                    c[System.Array.index(165, c)] = -657931;
                    c[System.Array.index(166, c)] = -256;
                    c[System.Array.index(167, c)] = -6632142;
                    ExpressCraft.KnownColorTable.colorTable = c;
                },
                KnownColorToArgb: function (color) {
                    ExpressCraft.KnownColorTable.EnsureColorTable();
                    if (color <= ExpressCraft.KnownColor.MenuHighlight) {
                        return ExpressCraft.KnownColorTable.colorTable[System.Array.index(color, ExpressCraft.KnownColorTable.colorTable)];
                    }
                    return 0;
                },
                KnownColorToName: function (color) {
                    ExpressCraft.KnownColorTable.EnsureColorNameTable();
                    if (color <= ExpressCraft.KnownColor.MenuHighlight) {
                        return ExpressCraft.KnownColorTable.colorNameTable[System.Array.index(color, ExpressCraft.KnownColorTable.colorNameTable)];
                    }
                    return null;
                }
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutColumn", {
        fields: {
            Groups: null
        },
        ctors: {
            init: function () {
                this.Groups = new (System.Collections.Generic.List$1(ExpressCraft.LayoutGroup))();
            },
            ctor: function (groups) {
                if (groups === void 0) { groups = []; }

                this.$initialize();
                if (groups != null && groups.length > 0) {
                    this.Groups.addRange(groups);
                }
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutContainer", {
        statics: {
            fields: {
                TabIndex: 0
            },
            ctors: {
                init: function () {
                    this.TabIndex = 2;
                }
            }
        },
        fields: {
            Columns: null,
            ColumnWidth: 0,
            ControlMargin: 0,
            appliedLayout: false,
            ButtinWidth: 0,
            Controls: null,
            ControlEditable: null
        },
        ctors: {
            init: function () {
                this.Columns = new (System.Collections.Generic.List$1(ExpressCraft.LayoutColumn))();
                this.appliedLayout = false;
                this.ButtinWidth = 73;
                this.Controls = new (System.Collections.Generic.List$1(ExpressCraft.LayoutControl))();
                this.ControlEditable = new (System.Collections.Generic.List$1(ExpressCraft.LayoutControl))();
            },
            $ctor1: function (columnWidth, controlMargin, columns) {
                if (columnWidth === void 0) { columnWidth = 500; }
                if (controlMargin === void 0) { controlMargin = 6; }
                if (columns === void 0) { columns = []; }

                this.$initialize();
                this.ColumnWidth = columnWidth;
                this.ControlMargin = controlMargin;

                if (columns != null && columns.length > 0) {
                    this.Columns.addRange(columns);
                }
            },
            $ctor2: function (columnWidth, controlMargin, buttonWidth, columns) {
                if (columnWidth === void 0) { columnWidth = 500; }
                if (controlMargin === void 0) { controlMargin = 6; }
                if (buttonWidth === void 0) { buttonWidth = 73; }
                if (columns === void 0) { columns = []; }

                this.$initialize();
                this.ColumnWidth = columnWidth;
                this.ControlMargin = controlMargin;
                this.ButtinWidth = buttonWidth;

                if (columns != null && columns.length > 0) {
                    this.Columns.addRange(columns);
                }
            },
            ctor: function (columns) {
                if (columns === void 0) { columns = []; }

                this.$initialize();
                this.ColumnWidth = 500;
                this.ControlMargin = 6;

                if (columns != null && columns.length > 0) {
                    this.Columns.addRange(columns);
                }
            }
        },
        methods: {
            AddInput: function (linkField, input) {
                var cl = new ExpressCraft.LayoutControl.ctor(linkField, input);
                this.Controls.add(cl);
                if (!input.Readonly) {
                    this.ControlEditable.add(cl);
                }
            },
            AppliedLayout: function () {
                return this.appliedLayout;
            },
            GetControl: function (name, allowReadonly) {
                if (allowReadonly === void 0) { allowReadonly = false; }
                name = name.toLowerCase();

                if (allowReadonly) {
                    for (var i = 0; i < this.Controls.Count; i = (i + 1) | 0) {
                        if (Bridge.referenceEquals(this.Controls.getItem(i).LinkFieldName.toLowerCase(), name)) {
                            return this.Controls.getItem(i);
                        }
                    }
                } else {
                    for (var i1 = 0; i1 < this.ControlEditable.Count; i1 = (i1 + 1) | 0) {
                        if (Bridge.referenceEquals(this.ControlEditable.getItem(i1).LinkFieldName.toLowerCase(), name)) {
                            return this.ControlEditable.getItem(i1);
                        }
                    }
                }

                return null;
            },
            GetText: function (name, allowReadyOnly) {
                var $t, $t1;
                if (allowReadyOnly === void 0) { allowReadyOnly = false; }
                return ($t = this.GetControl(name, allowReadyOnly)) != null && ($t1 = $t.Input) != null ? $t1.Text : null;
            },
            GetEditValue: function (name, allowReadyOnly) {
                var $t, $t1;
                if (allowReadyOnly === void 0) { allowReadyOnly = false; }
                return ($t = this.GetControl(name, allowReadyOnly)) != null && ($t1 = $t.Input) != null ? $t1.GetEditValue() : null;
            },
            SetText: function (name, value, allowReadyOnly) {
                var $t;
                if (allowReadyOnly === void 0) { allowReadyOnly = false; }
                var input = ($t = this.GetControl(name, allowReadyOnly)) != null ? $t.Input : null;
                if (input != null) {
                    input.Text = value;
                }
            },
            Focus: function () {
                if (ExpressCraft.Helper.NotDesktop) {
                    return;
                }
                if (this.Controls == null || this.Controls.Count === 0) {
                    return;
                }
                var input = System.Linq.Enumerable.from(this.Controls).firstOrDefault(null, null).Input;
                var x = input.GetInput();

                if (x != null) {
                    ExpressCraft.Helper.FocusElement(x);
                } else {
                    ExpressCraft.Helper.FocusElement(input.Content);
                }
            },
            CreateLoadSQL: function () {
                var builderSQL = new System.Text.StringBuilder();

                var length = this.Controls.Count;
                for (var i = 0; i < length; i = (i + 1) | 0) {
                    if (this.Controls.getItem(i) == null || this.Controls.getItem(i).Input == null || System.String.isNullOrWhiteSpace(this.Controls.getItem(i).LinkFieldName)) {
                        continue;
                    }
                    builderSQL.append(System.String.concat("`", this.Controls.getItem(i).LinkFieldName, "`, "));

                    var control = this.Controls.getItem(i);

                    if (Bridge.is(control.Input, ExpressCraft.SearchInput)) {
                        var search = control.Input;

                        var editValue = (System.String.concat(search.EditValue, ""));
                        if (Bridge.referenceEquals(search.DisplayMember, search.ValueMember) || search.ValueMember == null) {
                            // documentTransaction.AddCombo(control.LinkFieldName,
                            //search.Text, search.Text);
                        } else {
                            // long editv = 0;
                            // long.TryParse(editValue, out editv);

                            // documentTransaction.AddCombo(control.LinkFieldName,
                            //editv, search.Text);
                        }

                        continue;
                    } else if (control.Input.Controller != null) {
                        if (Bridge.is(control.Input.Controller, ExpressCraft.CheckEdit)) {
                            //documentTransaction.AddBoolean(control.LinkFieldName, (control.Input.Controller.As<CheckEdit>().Checked));

                            continue;
                        }
                    }

                    if (control.Input.IsNumericType()) {
                        //var dec = control.Input.GetNumberValue();

                        //documentTransaction.AddNumer(control.LinkFieldName,
                        //dec);
                    } else if (control.Input.IsDateType()) {
                        //var date = control.Input.GetDateTime();

                        //documentTransaction.AddDate(control.LinkFieldName,
                        //date);
                    } else {
                        //documentTransaction.AddString(control.LinkFieldName,
                        //control.Input.Text);
                    }
                }

                return builderSQL.toString();
            },
            ApplyReadOnly: function (documentreadonly) {
                var length = this.ControlEditable.Count;
                for (var i = 0; i < length; i = (i + 1) | 0) {
                    this.ApplyReadOnlyOnControl(documentreadonly, this.ControlEditable.getItem(i).Input);
                }
            },
            ApplyReadOnlyOnControl: function (documentreadonly, input) {
                if (input.Controller != null) {
                    if (Bridge.is(input.Controller, ExpressCraft.CheckEdit)) {
                        input.Enabled = !documentreadonly;
                    }
                } else {
                    if (Bridge.is(input, ExpressCraft.TextInputDropDown)) {
                        input.GetInput().readOnly = documentreadonly;
                    }
                    input.Readonly = documentreadonly;
                }
            },
            OnControlCreated: function (Control) { },
            Apply: function (parent, documentreadonly) {
                var $t, $t1, $t2, $t3;
                if (documentreadonly === void 0) { documentreadonly = false; }
                if (parent == null) {
                    throw new System.ArgumentNullException();
                }

                if (this.appliedLayout) {
                    return;
                }
                this.appliedLayout = true;

                var leftMargin = 10;
                var topMargin = 5;

                var leftLabel = 15;

                var currentLeft = leftMargin;
                var AppendX = 0;
                var AppendY = 0;

                var EditStartX = 125;

                if (ExpressCraft.Helper.NotDesktop) {
                    EditStartX = 15;
                }


                var XIncrement = (leftMargin + this.ColumnWidth) | 0;

                var inputHeight;
                if (ExpressCraft.Helper.NotDesktop) {
                    this.ButtinWidth = 0;
                    inputHeight = 45;
                } else {
                    inputHeight = 20;
                }
                var GroupLabelIncrement = (this.ControlMargin + (ExpressCraft.Helper.NotDesktop ? (((inputHeight - 30) | 0)) : (((inputHeight - 4) | 0)))) | 0;
                var RowIncrement = (inputHeight + this.ControlMargin) | 0;

                var TinyLabelIncrement = (inputHeight - 8) | 0;

                $t = Bridge.getEnumerator(this.Columns);
                try {
                    while ($t.moveNext()) {
                        var column = $t.Current;
                        var autoDiv = new ExpressCraft.Control.$ctor1();
                        var y = topMargin;
                        if (ExpressCraft.Helper.NotDesktop) {
                            autoDiv.Width = "(100% - 12px)";
                            autoDiv.Top = AppendY;
                        } else {
                            autoDiv.Top = y;
                            autoDiv.Width = this.ColumnWidth;
                        }
                        autoDiv.Left = AppendX;

                        var docFragment = document.createDocumentFragment();

                        var groups = column.Groups;

                        $t1 = Bridge.getEnumerator(groups);
                        try {
                            while ($t1.moveNext()) {
                                var group = $t1.Current;
                                if (!System.String.isNullOrWhiteSpace(group.GroupLabel)) {
                                    var label = ExpressCraft.Control.Label$2(group.GroupLabel, currentLeft, y, true);
                                    if (ExpressCraft.Helper.NotDesktop) {
                                        label.style.fontSize = "14px";
                                    }
                                    docFragment.appendChild(label);
                                    y += GroupLabelIncrement;
                                }
                                var rows = group.Rows;

                                $t2 = Bridge.getEnumerator(rows);
                                try {
                                    while ($t2.moveNext()) {
                                        var row = $t2.Current;
                                        if (Bridge.is(row, ExpressCraft.LayoutRowControl)) {
                                            var height = row.Height;

                                            var control = row.Control;

                                            if (control != null) {
                                                control.Height = height;
                                                control.Left = (currentLeft + leftLabel) | 0;
                                                control.Top = y;

                                                if (ExpressCraft.Helper.NotDesktop) {
                                                    control.Width = "(100% - " + System.Single.format((currentLeft + (leftLabel * 2.0))) + "px)";
                                                } else {
                                                    control.Width = (((this.ColumnWidth - currentLeft) | 0) - (leftLabel)) | 0;
                                                }

                                                docFragment.appendChild(ExpressCraft.Control.op_Implicit(control));

                                                y += this.ControlMargin;
                                            }

                                            y += height;

                                            continue;
                                        }

                                        if (!System.String.isNullOrWhiteSpace(row.Label)) {
                                            var label1 = ExpressCraft.Control.Label$2(row.Label, ((currentLeft + leftLabel) | 0) + System.Decimal.toFloat(row.Offset), y, false);
                                            if (ExpressCraft.Helper.NotDesktop) {
                                                label1.style.fontSize = "12px";
                                                y += (GroupLabelIncrement - 5) | 0;
                                            }
                                            docFragment.appendChild(label1);
                                        }

                                        if (Bridge.is(row, ExpressCraft.LayoutRowGap)) {
                                            y += row.Height;
                                            continue;
                                        }

                                        if (row.Button != null && !ExpressCraft.Helper.NotDesktop) {
                                            row.Button.Location = new ExpressCraft.Vector2.$ctor1(((((this.ColumnWidth - this.ButtinWidth) | 0) + 6) | 0), y);
                                            row.Button.Width = this.ButtinWidth;
                                            docFragment.appendChild(ExpressCraft.Control.op_Implicit(row.Button));
                                        }

                                        var controls = row.Controls;
                                        var HasTinyLabel = false;

                                        if (controls.Count > 0) {
                                            var TotalPercent = System.Decimal(0);

                                            TotalPercent = System.Decimal(0);
                                            var AddWidth = 0;
                                            $t3 = Bridge.getEnumerator(controls);
                                            try {
                                                while ($t3.moveNext()) {
                                                    var control1 = $t3.Current;
                                                    if (control1.Percent.gt(System.Decimal(1.0)) || control1.Percent.lte(System.Decimal(0.0))) {
                                                        control1.Percent = System.Decimal(1.0);
                                                    }

                                                    TotalPercent = TotalPercent.add(control1.Percent);

                                                    if (TotalPercent.gt(System.Decimal(1.0))) {
                                                        if (Bridge.is(control1.Input, ExpressCraft.MemoInput)) {
                                                            y += (ExpressCraft.Helper.ToInt(control1.Input.Height) + this.ControlMargin) | 0;
                                                        } else {
                                                            y += RowIncrement;
                                                        }

                                                        if (row.NoGap) {
                                                            y -= (this.ControlMargin + 1) | 0;
                                                        }

                                                        if (HasTinyLabel) {
                                                            y += TinyLabelIncrement;
                                                            HasTinyLabel = false;
                                                        }

                                                        TotalPercent = TotalPercent.sub(System.Decimal(1.0));
                                                        AddWidth = 0;
                                                    }
                                                    var Add = (((((((currentLeft + AddWidth) | 0) + EditStartX) | 0) + this.ButtinWidth) | 0) + System.Decimal.toFloat(row.Offset));
                                                    var o100Percent = System.String.concat("((100% - ", ExpressCraft.Helper.ToPx(Bridge.box(Add, System.Single, System.Single.format, System.Single.getHashCode)), ") * ", (TotalPercent.sub(control1.Percent)), ")");
                                                    var o100Percent2 = System.String.concat("(100% - ", ExpressCraft.Helper.ToPx(Bridge.box(Add, System.Single, System.Single.format, System.Single.getHashCode)), ")");

                                                    var width = System.String.concat("(", o100Percent2, " * ", control1.Percent, ")");
                                                    var loc = new ExpressCraft.Vector2.$ctor1(System.String.concat("(", o100Percent, " + ", ExpressCraft.Helper.ToPx(Bridge.box((Add - this.ButtinWidth), System.Single, System.Single.format, System.Single.getHashCode)), ")"), y);
                                                    if (!row.NoGap) {
                                                        AddWidth = (AddWidth + 6) | 0;
                                                    }

                                                    if (control1.Input.Controller != null) {
                                                        control1.Input.Controller.Width = width;
                                                        control1.Input.Controller.Location = loc.$clone();
                                                        control1.Input.Content.tabIndex = ExpressCraft.LayoutContainer.TabIndex;
                                                        control1.Input.ClassList.remove("control");
                                                        if (Bridge.is(control1.Input.Controller, ExpressCraft.CheckEdit)) {
                                                            var span = control1.Input.Controller.span;
                                                            span.style.top = "0";
                                                            span.style.left = ExpressCraft.Helper.ToPx(Bridge.box((((inputHeight - 2) | 0)), System.Int32));

                                                            span.style.position = "absolute";

                                                            span.style.whiteSpace = "pre";
                                                            //span.Style.Transform = "translate(3px, 50%)";
                                                            if (ExpressCraft.Helper.NotDesktop) {
                                                                span.style.fontSize = "14px";
                                                                span.style.whiteSpace = "normal";
                                                            }

                                                            if (control1.Input.Content.type === "checkbox") {
                                                                control1.Input.Width = ExpressCraft.Helper.ToPx(Bridge.box((((inputHeight - 4) | 0)), System.Int32));
                                                                control1.Input.Height = ExpressCraft.Helper.ToPx(Bridge.box((((inputHeight - 4) | 0)), System.Int32));
                                                            }
                                                        }

                                                        docFragment.appendChild(ExpressCraft.Control.op_Implicit(control1.Input.Controller));
                                                    } else {
                                                        control1.Input.Width = width;
                                                        control1.Input.Location = loc.$clone();
                                                        control1.Input.GetInput().tabIndex = ExpressCraft.LayoutContainer.TabIndex;

                                                        docFragment.appendChild(ExpressCraft.Control.op_Implicit(control1.Input));
                                                    }
                                                    if (ExpressCraft.Helper.NotDesktop) {
                                                        control1.Input.Height = inputHeight;
                                                        control1.Input.Style.fontSize = "14px";

                                                        if (control1.Input.GetInput() != null) {
                                                            control1.Input.GetInput().style.fontSize = "14px";
                                                        }
                                                    }

                                                    this.OnControlCreated(control1);

                                                    if (!row.NoGap && !row.HideTinyLabel && !System.String.isNullOrWhiteSpace(control1.TinyLabel)) {
                                                        var label2 = ExpressCraft.Control.Label$2(control1.TinyLabel, 0, y + (((inputHeight + 3) | 0)), false, true);
                                                        label2.style.left = System.String.concat("calc(", o100Percent, " + ", ExpressCraft.Helper.ToPx(Bridge.box((Add - this.ButtinWidth), System.Single, System.Single.format, System.Single.getHashCode)), ")");
                                                        docFragment.appendChild(label2);
                                                        if (ExpressCraft.Helper.NotDesktop) {
                                                            label2.style.fontSize = "12px";
                                                        }
                                                        HasTinyLabel = true;
                                                    }

                                                    if (row.UsePlaceholder && !System.String.isNullOrWhiteSpace(control1.TinyLabel)) {
                                                        control1.Input.SetAttribute("placeholder", control1.TinyLabel);
                                                        if (control1.Input.ToolTip == null) {
                                                            if (System.String.isNullOrWhiteSpace(row.Label) && System.String.isNullOrWhiteSpace(group.GroupLabel)) {
                                                                control1.Input.ToolTip = new ExpressCraft.ToolTip.ctor(control1.TinyLabel);
                                                            } else {
                                                                control1.Input.ToolTip = new ExpressCraft.ToolTip.$ctor1(System.String.isNullOrWhiteSpace(row.Label) ? group.GroupLabel : row.Label, control1.TinyLabel);
                                                            }
                                                        }
                                                    }

                                                    ExpressCraft.LayoutContainer.TabIndex = (ExpressCraft.LayoutContainer.TabIndex + 1) | 0;

                                                    if (!control1.Input.Readonly) {
                                                        this.ApplyReadOnlyOnControl(documentreadonly, control1.Input);
                                                        this.ControlEditable.add(control1);
                                                    }
                                                    this.Controls.add(control1);
                                                }
                                            } finally {
                                                if (Bridge.is($t3, System.IDisposable)) {
                                                    $t3.System$IDisposable$dispose();
                                                }
                                            }
                                            if (HasTinyLabel) {
                                                y += TinyLabelIncrement;
                                            }
                                            var last = System.Linq.Enumerable.from(row.Controls).lastOrDefault(null, null);
                                            if (last != null && Bridge.is(last.Input, ExpressCraft.MemoInput)) {
                                                y += (ExpressCraft.Helper.ToInt(last.Input.Height) + this.ControlMargin) | 0;
                                            } else {
                                                y += RowIncrement;
                                            }
                                        }
                                    }
                                } finally {
                                    if (Bridge.is($t2, System.IDisposable)) {
                                        $t2.System$IDisposable$dispose();
                                    }
                                }
                            }
                        } finally {
                            if (Bridge.is($t1, System.IDisposable)) {
                                $t1.System$IDisposable$dispose();
                            }
                        }autoDiv.Height = y;
                        if (!ExpressCraft.Helper.NotDesktop) {
                            AppendX = (AppendX + XIncrement) | 0;
                        } else {
                            AppendY = (AppendY + Bridge.Int.clip32(y)) | 0;
                        }
                        autoDiv.Content.appendChild(docFragment);
                        parent.Content.appendChild(ExpressCraft.Control.op_Implicit(autoDiv));
                    }
                } finally {
                    if (Bridge.is($t, System.IDisposable)) {
                        $t.System$IDisposable$dispose();
                    }
                }var LastControl = System.Linq.Enumerable.from(this.Controls).lastOrDefault(null, null);
                if (LastControl != null) {
                    var FirstControl = System.Linq.Enumerable.from(this.Controls).firstOrDefault(null, null);

                    var PreventDefaultMoveForward = function (ev) {
                        if (ev.keyCode === 9 && !ev.shiftKey) {
                            ev.preventDefault();
                            var x = FirstControl.Input.GetInput();
                            if (x != null) {
                                ExpressCraft.Helper.FocusElement(x);
                            } else {
                                ExpressCraft.Helper.FocusElement(LastControl.Input.Content);
                            }
                        }
                    };

                    var PreventDefaultMoveBack = function (ev) {
                        if (ev.keyCode === 9 && ev.shiftKey) {
                            ev.preventDefault();
                            var x = LastControl.Input.GetInput();
                            if (x != null) {
                                ExpressCraft.Helper.FocusElement(x);
                            } else {
                                ExpressCraft.Helper.FocusElement(LastControl.Input.Content);
                            }
                        }
                    };

                    LastControl.Input.Content.onkeydown = PreventDefaultMoveForward;
                    FirstControl.Input.Content.onkeydown = PreventDefaultMoveBack;
                }
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutControl", {
        props: {
            LinkFieldName: null,
            Input: null,
            TinyLabel: null,
            Percent: System.Decimal(0.0),
            /**
             * Calculated
             *
             * @instance
             * @public
             * @memberof ExpressCraft.LayoutControl
             * @function Width
             * @type string
             */
            Width: null,
            /**
             * Calculated
             *
             * @instance
             * @public
             * @memberof ExpressCraft.LayoutControl
             * @function LineNumber
             * @type number
             */
            LineNumber: System.Decimal(0.0)
        },
        ctors: {
            $ctor2: function (linkFieldName, input, tinyLabel, percent) {
                if (tinyLabel === void 0) { tinyLabel = ""; }
                if (percent === void 0) { percent = System.Decimal(1.0); }

                this.$initialize();
                this.LinkFieldName = linkFieldName;
                this.Input = input;
                this.TinyLabel = tinyLabel;
                this.Percent = percent;
            },
            $ctor1: function (linkFieldName, input, percent) {
                if (percent === void 0) { percent = System.Decimal(1.0); }

                ExpressCraft.LayoutControl.$ctor2.call(this, linkFieldName, input, "", percent);
            },
            ctor: function (linkFieldName, input) {
                ExpressCraft.LayoutControl.$ctor2.call(this, linkFieldName, input, "");
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutGroup", {
        fields: {
            Rows: null
        },
        props: {
            GroupLabel: null
        },
        ctors: {
            init: function () {
                this.Rows = new (System.Collections.Generic.List$1(ExpressCraft.LayoutRow))();
            },
            ctor: function (rows) {
                if (rows === void 0) { rows = []; }

                this.$initialize();
                this.GroupLabel = "";
                if (rows != null && rows.length > 0) {
                    this.Rows.addRange(rows);
                }
            },
            $ctor1: function (groupLabel, rows) {
                if (rows === void 0) { rows = []; }

                this.$initialize();
                this.GroupLabel = groupLabel;
                if (rows != null && rows.length > 0) {
                    this.Rows.addRange(rows);
                }
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutRow", {
        fields: {
            Controls: null
        },
        props: {
            Label: null,
            Button: null,
            /**
             * If this is true - tiny labels are ignored
             *
             * @instance
             * @public
             * @memberof ExpressCraft.LayoutRow
             * @function NoGap
             * @type boolean
             */
            NoGap: false,
            UsePlaceholder: false,
            HideTinyLabel: false,
            Offset: System.Decimal(0.0)
        },
        ctors: {
            init: function () {
                this.Controls = new (System.Collections.Generic.List$1(ExpressCraft.LayoutControl))();
                this.NoGap = false;
                this.UsePlaceholder = false;
                this.HideTinyLabel = false;
                this.Offset = System.Decimal(0);
            },
            $ctor2: function (label, controls) {
                if (controls === void 0) { controls = []; }

                this.$initialize();
                this.Label = label;
                if (controls != null && controls.length > 0) {
                    this.Controls.addRange(controls);
                }
            },
            ctor: function (controls) {
                if (controls === void 0) { controls = []; }

                ExpressCraft.LayoutRow.$ctor2.call(this, "", controls);
            },
            $ctor1: function (offset, controls) {
                if (controls === void 0) { controls = []; }

                ExpressCraft.LayoutRow.$ctor2.call(this, "", controls);
                this.Offset = offset;
            },
            $ctor3: function (label, button, controls) {
                if (controls === void 0) { controls = []; }

                ExpressCraft.LayoutRow.$ctor2.call(this, label, controls);
                this.Button = button;
            }
        }
    });

    Bridge.define("ExpressCraft.MessageBoxButtons", {
        $kind: "enum",
        statics: {
            fields: {
                Auto: 0,
                Ok: 1,
                YesNo: 2,
                YesNoCancel: 3,
                AbortSendCancel: 4
            }
        }
    });

    Bridge.define("ExpressCraft.MessageBoxLayout", {
        $kind: "enum",
        statics: {
            fields: {
                Information: 0,
                Exclamation: 1,
                Question: 2,
                Error: 3
            }
        }
    });

    Bridge.define("ExpressCraft.MouseMoveAction", {
        $kind: "enum",
        statics: {
            fields: {
                None: 0,
                Move: 1,
                TopLeftResize: 2,
                LeftResize: 3,
                BottomLeftResize: 4,
                BottomResize: 5,
                BottomRightResize: 6,
                RightResize: 7,
                TopResize: 8,
                TopRightResize: 9
            }
        }
    });

    Bridge.define("ExpressCraft.Network", {
        statics: {
            methods: {
                GetAjaxOptions: function (JsonFile, Async) {
                    if (Async === void 0) { Async = true; }
                    return { async: Async, url: ExpressCraft.Settings.NetworkURL, cache: false, data: JsonFile == null ? "" : JSON.stringify(Bridge.unbox(JsonFile)), dataType: "json", contentType: "application/json", type: "POST" };
                },
                InvokeMethodUI: function (interfaceName, method, Success, Error, $arguments) {
                    if (Success === void 0) { Success = null; }
                    if (Error === void 0) { Error = null; }
                    if ($arguments === void 0) { $arguments = []; }
                    ExpressCraft.Network.PostJsonProgressForm(new ExpressCraft.Network.MethodRequest(interfaceName, method, $arguments), Success, Error);
                },
                InvokeMethodUIControl: function (interfaceName, method, progressControl, Success, Error, $arguments) {
                    if (Success === void 0) { Success = null; }
                    if (Error === void 0) { Error = null; }
                    if ($arguments === void 0) { $arguments = []; }
                    ExpressCraft.Network.PostJsonProgressControl(new ExpressCraft.Network.MethodRequest(interfaceName, method, $arguments), progressControl, Success, Error);
                },
                InvokeMethod: function (interfaceName, method, Success, Error, $arguments) {
                    if (Success === void 0) { Success = null; }
                    if (Error === void 0) { Error = null; }
                    if ($arguments === void 0) { $arguments = []; }
                    ExpressCraft.Network.PostJson(new ExpressCraft.Network.MethodRequest(interfaceName, method, $arguments), Success, Error);
                },
                PostJson: function (JsonFile, Success, Error, Async) {
                    if (Success === void 0) { Success = null; }
                    if (Error === void 0) { Error = null; }
                    if (Async === void 0) { Async = true; }
                    // lets convert the JsonFileObject to a string;
                    var ajo = ExpressCraft.Network.GetAjaxOptions(JsonFile, Async);
                    ajo.success = Success;
                    ajo.error = Error;

                    $.ajax(ajo);
                },
                PostJsonProgressControl: function (JsonFile, progressControl, Success, Error, Async) {
                    if (Success === void 0) { Success = null; }
                    if (Error === void 0) { Error = null; }
                    if (Async === void 0) { Async = true; }
                    // lets convert the JsonFileObject to a string;
                    var ajo = ExpressCraft.Network.GetAjaxOptions(JsonFile, Async);
                    ajo.xhr = function () {
                        var xmlRequest = new XMLHttpRequest();
                        xmlRequest.addEventListener("progress", function (e) {
                            var pe = Bridge.as(e, ProgressEvent);
                            if (progressControl == null) {
                                return;
                            }
                            var pc = progressControl;

                            var Percent = 0;

                            if (pe.loaded !== 0 && pe.total !== 0) {
                                Percent = (pe.loaded / pe.total) * 100.0;
                            }
                            pc.internalProgressControl.style.width = System.String.concat(System.Single.format(Percent), "%");
                        });

                        return xmlRequest;
                    };
                    ajo.success = Success;
                    ajo.error = Error;

                    $.ajax(ajo);
                },
                PostJsonProgressForm: function (JsonFile, Success, Error, Async) {
                    if (Success === void 0) { Success = null; }
                    if (Error === void 0) { Error = null; }
                    if (Async === void 0) { Async = true; }
                    // lets convert the JsonFileObject to a string;
                    var npf = new ExpressCraft.Network.NetworkProgressForm();

                    var ajo = ExpressCraft.Network.GetAjaxOptions(JsonFile, Async);
                    ajo.xhr = function () {
                        var xmlRequest = new XMLHttpRequest();
                        xmlRequest.addEventListener("progress", function (e) {
                            var pe = Bridge.as(e, ProgressEvent);
                            if (npf == null || npf.progressControl == null) {
                                return;
                            }
                            var pc = npf.progressControl;

                            var Percent = 0;

                            if (pe.loaded !== 0 && pe.total !== 0) {
                                Percent = (pe.loaded / pe.total) * 100.0;
                            }
                            pc.internalProgressControl.style.width = System.String.concat(System.Single.format(Percent), "%");
                        });

                        return xmlRequest;
                    };
                    ajo.success = function (o, s, jq) {
                        npf.DialogResult = ExpressCraft.DialogResultEnum.OK;
                        Success(o, s, jq);
                    };
                    ajo.error = function (jq, s1, s2) {
                        npf.DialogResult = ExpressCraft.DialogResultEnum.Cancel;
                        Error(jq, s1, s2);
                    };
                    ajo.complete = function (jq, str) {
                        npf.Close();
                    };

                    var ajr = $.ajax(ajo);

                    npf.ShowDialog([new ExpressCraft.DialogResult(ExpressCraft.DialogResultEnum.Cancel, function () {
                        ajr.abort();
                    })]);
                }
            }
        }
    });

    Bridge.define("ExpressCraft.Network.MethodRequest", {
        fields: {
            Method: null,
            Arguments: null,
            Interface: null
        },
        ctors: {
            ctor: function (interfaceName, method, $arguments) {
                if ($arguments === void 0) { $arguments = []; }

                this.$initialize();
                this.Method = method;
                this.Arguments = $arguments;
                this.Interface = interfaceName;
            }
        }
    });

    Bridge.define("ExpressCraft.PdfSourceType", {
        $kind: "enum",
        statics: {
            fields: {
                Url: 0,
                Base64: 1
            }
        }
    });

    Bridge.define("ExpressCraft.ResourceManager", {
        statics: {
            fields: {
                cacheResourceString: null
            },
            ctors: {
                init: function () {
                    this.cacheResourceString = new (System.Collections.Generic.Dictionary$2(System.String,System.String))();
                }
            },
            methods: {
                GetResourceString: function (name) {
                    var $t;
                    if (ExpressCraft.ResourceManager.cacheResourceString.containsKey(name)) {
                        return ExpressCraft.ResourceManager.cacheResourceString.get(name);
                    }
                    return (($t = ExpressCraft.Settings.GetStyleRuleValue$1(ExpressCraft.Settings.resourceManangerSheets, "content", System.String.concat(".", name)), ExpressCraft.ResourceManager.cacheResourceString.set(name, $t), $t));
                }
            }
        }
    });

    Bridge.define("ExpressCraft.RibbonControl.RibbonType", {
        $kind: "enum",
        statics: {
            fields: {
                Full: 0,
                Compact: 1
            }
        }
    });

    Bridge.define("ExpressCraft.RibbonGroup.RenderInfo", {
        fields: {
            Left: 0,
            Width: 0,
            IsSmall: false,
            FirstButton: null,
            SecondButton: null,
            ThirdButton: null,
            BeginGroup: false
        },
        ctors: {
            init: function () {
                this.IsSmall = false;
                this.BeginGroup = false;
            }
        }
    });

    Bridge.define("ExpressCraft.Settings", {
        statics: {
            fields: {
                NetworkURL: null,
                ResourceURL: null,
                AutoRender: false,
                Font: null,
                DefaultFont: null,
                /**
                 * Only for firefox - as no error with number input
                 *
                 * @static
                 * @public
                 * @memberof ExpressCraft.Settings
                 * @default true
                 * @type boolean
                 */
                OnFocusSelectAll: false,
                DefaultStyleSheet: null,
                PluginStyleSheet: null,
                resourceManangerSheets: null,
                GridViewAutoColumnGenerateFormatAsDate: false,
                GridViewAutoColumnFormatDates: false,
                GridViewBlurOnScroll: false,
                GridViewRowScrollPadding: 0,
                GridViewScrollDelayed: false,
                GridViewScrollDelayMS: 0,
                ContextMenuStartingZIndex: 0,
                ContextMenuMinWidth: 0,
                MessageFormTextMaximumHeightInPx: 0,
                MessageFormTextMinimumHeightInPx: 0,
                MessageFormMinimumWidthInPx: 0,
                DayPosition: 0,
                MonthPosition: 0,
                YearPosition: 0,
                DisableTextPopupEditor: false,
                DateSeperator: 0,
                ConsoleDefaultSize: null,
                MessageFormBeep: false,
                MaximumPixelScrollingRows: 0,
                OnSendError: null,
                IsChrome: false,
                AllowCloseWithoutQuestion: false,
                OnApplicationClose: null,
                ShowExceptionDialog: false,
                FormFadeDuration: 0,
                /**
                 * Increase Render Speed
                 *
                 * @static
                 * @public
                 * @memberof ExpressCraft.Settings
                 * @type boolean
                 */
                RemoveAttributesOffElementsWhenLoseFocus: false,
                themeElement: null,
                _includeFocusRegion: false,
                _activeTheme: null,
                themefocusValue: null,
                themeTemplate: null,
                OnF2ShowThemeForm: false,
                ToolTipPopupDelayMs: 0,
                ToolTipPopupStayOpenDelayPerWordMs: 0
            },
            props: {
                TaxPercent: System.Decimal(0.0),
                IncludeFocusRegion: {
                    get: function () {
                        return ExpressCraft.Settings._includeFocusRegion;
                    },
                    set: function (value) {
                        if (ExpressCraft.Settings._includeFocusRegion !== value) {
                            ExpressCraft.Settings._includeFocusRegion = value;
                            ExpressCraft.Settings.ApplyActiveTheme();
                        }
                    }
                },
                ActiveTheme: {
                    get: function () {
                        return ExpressCraft.Settings._activeTheme;
                    },
                    set: function (value) {
                        if (!Bridge.referenceEquals(ExpressCraft.Settings._activeTheme, value)) {
                            ExpressCraft.Settings._activeTheme = value;
                            ExpressCraft.Settings.ApplyActiveTheme();
                        }
                    }
                }
            },
            ctors: {
                init: function () {
                    this.ConsoleDefaultSize = new ExpressCraft.Vector2();
                    this.NetworkURL = "Host.ashx";
                    this.ResourceURL = "./images/";
                    this.AutoRender = true;
                    this.Font = "8.25pt Tahoma";
                    this.DefaultFont = ExpressCraft.Settings.Font;
                    this.OnFocusSelectAll = true;
                    this.resourceManangerSheets = new (System.Collections.Generic.List$1(StyleSheet))();
                    this.GridViewAutoColumnGenerateFormatAsDate = false;
                    this.GridViewAutoColumnFormatDates = true;
                    this.GridViewBlurOnScroll = false;
                    this.GridViewRowScrollPadding = 0;
                    this.GridViewScrollDelayed = false;
                    this.GridViewScrollDelayMS = 25;
                    this.ContextMenuStartingZIndex = 500;
                    this.ContextMenuMinWidth = 200;
                    this.MessageFormTextMaximumHeightInPx = 500;
                    this.MessageFormTextMinimumHeightInPx = 32;
                    this.MessageFormMinimumWidthInPx = 195;
                    this.DayPosition = ExpressCraft.Settings.DatePosition.First;
                    this.MonthPosition = ExpressCraft.Settings.DatePosition.Second;
                    this.YearPosition = ExpressCraft.Settings.DatePosition.Third;
                    this.DisableTextPopupEditor = false;
                    this.DateSeperator = 47;
                    this.ConsoleDefaultSize = new ExpressCraft.Vector2.$ctor1(540, 240);
                    this.MessageFormBeep = false;
                    this.MaximumPixelScrollingRows = 500000;
                    this.IsChrome = Bridge.Browser.isChrome;
                    this.AllowCloseWithoutQuestion = false;
                    this.ShowExceptionDialog = true;
                    this.FormFadeDuration = 100;
                    this._includeFocusRegion = true;
                    this.themefocusValue = ".{25}:focus:not(.grid){{\r\nborder: solid 1px {0};\r\n}}";
                    this.themeTemplate = ".{25}{{\r\n    color:{22};\r\n}}\r\n#focusLine;\r\n.{25}::selection{{\r\n{26}:{1};\r\n}}\r\n.{25}::-moz-selection{{\r\n{26}:{1};\r\n}}\r\n.{25}:disabled{{\r\n{26}:{2};\r\n}}\r\n.input{25}:read-only{{\r\n{26}:{3};\r\n}}\r\n.{28}{25}{{\r\n{26}:{0};\r\n{27}{29}:{0};\r\n{27}{31}:{0};\r\n{27}{32}:{1};\r\n}}\r\n.{28}page{{\r\n{26}:{3};\r\n}}\r\n.{28}group{{\r\n{26}:{3};\r\n}}\r\n.{28}{33}{{\r\n{26}:{3};\r\n}}\r\n.{28}{33}:hover:not(:active):not(.disabled)\r\n{{\r\n{26}:{4};\r\n}}\r\n.{28}{33}:active:not(.disabled){{\r\n{26}:{5};\r\n}}\r\n.{28}{33}small{{\r\n{26}:{3};\r\n}}\r\n.{28}{33}small:hover:not(:active):not(.disabled)\r\n{{\r\n{26}:{4};\r\n}}\r\n.{28}{33}small:active:not(.disabled){{\r\n{26}:{5};\r\n}}\r\n.{28}seperator{{\r\n{26}:{1};\r\n}}\r\n.{28}{35}-hidden{{\r\n{26}:{0};\r\ncolor:{23};\r\n}}\r\n.{28}{35}-hidden:hover{{\r\n{26}:{6};\r\n}}\r\n.{28}{35}-active{{\r\n{26}:{3};\r\n}}\r\n.tab{25}{{\r\n{26}:{3};\r\n}}\r\n.tab{25}page{{\r\n{26}:{3};\r\n{27}{29}:{1};\r\n{27}{31}:{1};\r\n{27}{32}:{1};\r\n}}\r\n.tab{25}{35} {{\r\n{26}:{3};\r\n}}\r\n.tab{25}{35}-hidden{{\r\n{27}{30}:{3};\r\n{27}{29}:{3};\r\n{27}{31}:{3};\r\n{27}{32}:transparent;\r\n}}\r\n.tab{25}{35}-hidden:hover{{\r\n{26}:{7};\r\n{27}{29}:{7};\r\n{27}{31}:{7};\r\n}}\r\n.tab{25}{35}-active{{\r\n{27}{30}:{0};\r\n{27}{29}:{1};\r\n{27}{31}:{1};\r\n{27}{32}:{3};\r\nborder-top-width:2px;\r\nline-height:18px;\r\ntop:2px;\r\n}}\r\n.tab{25}{35}-close{33}{{\r\ncolor:{1};\r\n}}\r\n.tab{25}{35}-close{33}:hover{{\r\ncolor:{24};\r\n\t{26}:{2};\r\n\t{27}:1px solid {19};\r\n}}\r\n.input{25} {{\r\n{27}:1px solid {1};\r\n{26}:{14};\r\n}}\r\n.simple{33}{{\r\n{27}:1px solid {19};\r\n{26}:{3};\r\n}}\r\n.simple{33}:hover:not(.disabled)\r\n{{\r\n\t{26}:{1};\r\n}}\r\n.simple{33}:active:not(.disabled)\r\n{{\r\n\t{26}:{12};\r\n{27}: 1px solid {20};\r\n}}\r\n@keyframes ColorFlash {{\r\nfrom {{ {26}: {23};}}\r\nto {{ {26}: {0};}}\r\n}}\r\n.form-base{{\r\n{27}-color:{0};\r\n}}\r\n.{34}{{\r\n{26}:{0};\r\n}}\r\n.{34}-title{{\r\ncolor:{23};\r\n}}\r\n.{34}-{33}{{\r\ncolor:{23};\r\n}}\r\n.{34}-{33}:hover:not(.{34}-{33}-close){{\r\n{26}:{8};\r\n}}\r\n.{34}-{33}:active:not(.{34}-{33}-close){{\r\n{26}:{9};\r\n}}\r\n.{34}-{33}-close:hover{{\r\n{26}:{10};\r\n}}\r\n.{34}-{33}-close:active{{\r\n{26}:{11};\r\n}}\r\n.cell{{\r\n{27}: 1px solid {3};\r\n}}\r\n.cellrow{{\r\n{26}:{14};\r\n}}\r\n.cellrow:hover{{\r\n{26}:{3} !important;\r\n}}\r\n.cellrow:active{{\r\n{26}:{12} !important;\r\n}}\r\n.even{{\r\n   {26}:{13} !important;\r\n}}\r\n.cellrow-selected{{\r\n{26}:{17} !important;\r\n}}\r\n.cellrow-selected:hover{{\r\n{26}:{18} !important;\r\n}}\r\n.{36}{{\r\n{26}:{3};\r\n{27}-right:1px solid {19} !important;\r\n}}\r\n.{36}:hover{{\r\n{26}:{1};\r\n}}\r\n.{36}:active{{\r\n{26}:{12};\r\n}}\r\n.{36}-container{{\r\n{26}:{3};\r\n{27}-bottom:1px solid {19} !important;\r\n}}\r\n.grid{{\r\n{26}:{14};\r\n{27}:1px solid {19};\r\n}}\r\n.progressbar{{\r\n{27}:1px solid {19};\r\n{26}:{14};\r\n}}\r\n.progressbarbody{{\r\n{26}:{0};\r\n}}\r\n.contextmenu{{\r\n{26}:{14};\r\n{27}: solid 1px {21};\r\n}}\r\n.contextitem:hover{{\r\n{26}:{15};\r\n}}\r\n.contextitemseperator{{\r\n{26}:{16};\r\n}}\r\n.dialog{33}section{{\r\n{26}:{3};\r\n}}\r\n.split{25}\r\n{{\r\n{27}:1px solid {19};\r\n}}\r\n.splittervertical {{\r\n{27}-left: 1px {4} solid;\r\n{27}-right: 1px {4} solid;\r\n}}\r\n.splitterhorizontal {{\r\n{27}-top: 1px {4} solid;\r\n{27}-bottom: 1px {4} solid;\r\n}}\r\n.splitterhorizontal:hover {{\r\n{26}:{4};\r\n}}\r\n.splittervertical:hover {{\r\n{26}:{4};\r\n}}\r\n.tool-tip{{\r\n{26}:{14};\r\n{27}: solid 1px {21};\r\n}}\r\n.{34}-min:hover{{\r\n\t{26}:{8};\r\n}}\r\n.simplebutton-active\r\n{{\r\n\t{26}:{12};\r\n{27}: 1px solid {20};\r\n}}\r\n.primary{{\r\n    {26}:{0};\r\n}}\r\n.tabheader-container{{\r\n    border-bottom: 2px {0} solid;\r\n}}\r\n";
                    this.OnF2ShowThemeForm = true;
                    this.ToolTipPopupDelayMs = 1000;
                    this.ToolTipPopupStayOpenDelayPerWordMs = 250;
                    this.TaxPercent = System.Decimal(0.1);
                }
            },
            methods: {
                Setup: function () {
                    ExpressCraft.Settings.ActiveTheme = ExpressCraft.Theme.Theme1;
                    ExpressCraft.Settings.SetupStyleDefaults();
                },
                SetupStyleDefaults: function () {
                    try {
                        var sheets = document.styleSheets;
                        for (var i = 0; i < sheets.length; i = (i + 1) | 0) {
                            var ownerNode = Bridge.as(sheets[i].ownerNode, HTMLLinkElement);
                            if (ownerNode == null) {
                                continue;
                            }
                            if (Bridge.referenceEquals(ownerNode.id.toLowerCase(), "expresscraft")) {
                                ExpressCraft.Settings.DefaultStyleSheet = sheets[i];
                            }
                            if (Bridge.referenceEquals(ownerNode.id.toLowerCase(), "expresscraftplugin")) {
                                ExpressCraft.Settings.PluginStyleSheet = sheets[i];
                            }
                            if (Bridge.referenceEquals(ownerNode.id.toLowerCase(), "resourcemanager")) {
                                ExpressCraft.Settings.resourceManangerSheets.add(sheets[i]);
                            }
                        }
                        if (ExpressCraft.Settings.DefaultStyleSheet == null) {
                            return;
                        }
                        var df = ExpressCraft.Settings.GetExpressStyleRuleValue("font", ".control");
                        if (df != null) {
                            ExpressCraft.Settings.DefaultFont = df;
                        }
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                },
                GetStyleRuleValue$1: function (cssFile, style, className) {
                    var $t;
                    try {
                        if (cssFile != null) {
                            $t = Bridge.getEnumerator(cssFile);
                            try {
                                while ($t.moveNext()) {
                                    var item = $t.Current;
                                    var value = ExpressCraft.Settings.GetStyleRuleValue(item, style, className);
                                    if (value != null) {
                                        return value;
                                    }
                                }
                            } finally {
                                if (Bridge.is($t, System.IDisposable)) {
                                    $t.System$IDisposable$dispose();
                                }
                            }}
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                    return null;
                },
                GetStyleRuleValue: function (cssFile, style, className) {
                    try {
                        if (cssFile != null) {
                            var pStyles = cssFile;
                            if (pStyles.cssRules) {
                                for (var i = 0; i < pStyles.cssRules.length; i = (i + 1) | 0) {
                                    var rule = pStyles.cssRules[i];
                                    if (rule.selectorText && !Bridge.referenceEquals(rule.selectorText.split(44).indexOf(className), -1)) {
                                        return rule.style[style];
                                    }
                                }
                            }
                        }
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                    return null;
                },
                GetExpressStyleRuleValue: function (style, className) {
                    var value = ExpressCraft.Settings.GetStyleRuleValue(ExpressCraft.Settings.PluginStyleSheet, style, className);
                    if (value == null) {
                        value = ExpressCraft.Settings.GetStyleRuleValue(ExpressCraft.Settings.DefaultStyleSheet, style, className);
                    }
                    return value;
                },
                ApplyActiveTheme: function () {
                    var $t;
                    if (ExpressCraft.Settings.themeElement != null) {
                        ExpressCraft.Settings.themeElement.parentElement.removeChild(ExpressCraft.Settings.themeElement);
                    }
                    if (ExpressCraft.Settings._activeTheme == null) {
                        ExpressCraft.Settings._activeTheme = ExpressCraft.Theme.Theme1;
                    }
                    var objList = new (System.Collections.Generic.List$1(System.Object))();
                    objList.addRange(ExpressCraft.Settings._activeTheme.Colors);
                    objList.addRange(System.Array.init(["control", "background-color", "border", "ribbon", "-left-color", "-top-color", "-right-color", "-bottom-color", "button", "form-heading", "pageheader", "heading"], System.Object));

                    ExpressCraft.Settings.themeElement = ($t = document.createElement("style"), $t.innerHTML = System.String.format.apply(System.String, [System.String.replaceAll(ExpressCraft.Settings.themeTemplate, "#focusLine;", ExpressCraft.Settings._includeFocusRegion ? ExpressCraft.Settings.themefocusValue : "")].concat(objList.toArray())), $t);

                    document.body.appendChild(ExpressCraft.Settings.themeElement);
                }
            }
        }
    });

    Bridge.define("ExpressCraft.Settings.DatePosition", {
        $kind: "enum",
        statics: {
            fields: {
                First: 0,
                Second: 1,
                Third: 2
            }
        }
    });

    Bridge.define("ExpressCraft.SliderLocation", {
        $kind: "enum",
        statics: {
            fields: {
                Left: 0,
                Right: 1
            }
        }
    });

    Bridge.define("ExpressCraft.SortSetting", {
        fields: {
            Column: null,
            SortMode: 0
        }
    });

    Bridge.define("ExpressCraft.TextBlock", {
        fields: {
            OriginalSource: null,
            MaxWidth: 0,
            ComputedHeight: 0,
            LinesComputed: 0,
            ElelemtsOverMax: false,
            MaxCalculatedWidth: 0
        },
        ctors: {
            init: function () {
                this.ElelemtsOverMax = false;
                this.MaxCalculatedWidth = 0;
            },
            ctor: function (source, maxWidth) {
                this.$initialize();
                this.OriginalSource = source;
                this.MaxWidth = maxWidth;
            }
        },
        methods: {
            ComputeString: function () {
                this.ElelemtsOverMax = false;
                var Lines = System.String.split(this.OriginalSource, System.Array.init([13, 10], System.Char).map(function(i) {{ return String.fromCharCode(i); }}));

                var sizePerChar = ExpressCraft.Control.GetTextWidth("M", ExpressCraft.Settings.DefaultFont);

                this.LinesComputed = 0;

                for (var i = 0; i < Lines.length; i = (i + 1) | 0) {
                    var line = Lines[System.Array.index(i, Lines)];

                    var lineWidth = ExpressCraft.Control.GetTextWidth(this.OriginalSource, ExpressCraft.Settings.DefaultFont);

                    if (lineWidth > this.MaxWidth) {
                        this.ElelemtsOverMax = true;
                        this.MaxCalculatedWidth = this.MaxWidth;
                        var yy = 0;
                        for (var x = 0; x < line.length; x = (x + 1) | 0) {
                            yy = (yy + 1) | 0;

                            if (yy * sizePerChar > this.MaxWidth) {
                                this.LinesComputed = (this.LinesComputed + 1) | 0;
                                yy = 0;
                            }
                        }

                        if (yy > 0) {
                            this.LinesComputed = (this.LinesComputed + 1) | 0;
                        }
                    } else {
                        this.LinesComputed = (this.LinesComputed + 1) | 0;
                        if (lineWidth > this.MaxCalculatedWidth) {
                            this.MaxCalculatedWidth = lineWidth;
                        }
                    }
                }
                this.ComputedHeight = this.GetFontSize(ExpressCraft.Settings.DefaultFont) * this.LinesComputed;
            },
            GetFontSize: function (fontWithSize) {
                var strs = System.String.split(fontWithSize, System.Array.init([32], System.Char).map(function(i) {{ return String.fromCharCode(i); }}), null, 1);

                for (var i = 0; i < strs.length; i = (i + 1) | 0) {
                    if (System.String.endsWith(strs[System.Array.index(i, strs)], "pt")) {
                        return parseFloat(strs[System.Array.index(i, strs)]) * 1.333333;
                    } else if (System.String.endsWith(strs[System.Array.index(i, strs)], "px")) {
                        return parseFloat(strs[System.Array.index(i, strs)]);
                    }
                }

                return 10.9999971;
            }
        }
    });

    Bridge.define("ExpressCraft.Theme", {
        statics: {
            fields: {
                Theme1: null
            },
            ctors: {
                init: function () {
                    this.Theme1 = new ExpressCraft.Theme(["#0173C7", "#C5C5C5", "#CCCCCC", "#F0F0F0", "#C3C3C3", "#ADADAD", "#2A8AD0", "#D3D3D3", "#2A8AD4", "#015C9F", "#E81123", "#F1707A", "#AEAEAE", "#FAFAFA", "#ffffff", "#CFCFCF", "#B9B9B9", "rgba(1, 115, 199, 0.3)", "rgba(1, 115, 199, 0.5)", "#A6A6A6", "#777777", "#80868A", "#404040", "#ffffff", "#000000"]);
                }
            }
        },
        props: {
            Colors: null
        },
        ctors: {
            ctor: function (colors) {
                if (colors === void 0) { colors = []; }

                this.$initialize();
                if (colors != null && colors.length === 25) {
                    this.Colors = colors;
                }

                //BackgroundColor1 = bgc1;
                //BackgroundColor2 = bgc2;
                //BackgroundColor3 = bgc3;
                //BackgroundColor4 = bgc4;
                //BackgroundColor5 = bgc5;
                //BackgroundColor6 = bgc6;
                //BackgroundColor7 = bgc7;
                //BackgroundColor8 = bgc8;
                //BackgroundColor9 = bgc9;
                //BackgroundColor10 = bgc10;
                //BackgroundColor11 = bgc11;
                //BackgroundColor12 = bgc12;
                //BackgroundColor13 = bgc13;
                //BackgroundColor14 = bgc14;
                //BackgroundColor15 = bgc15;
                //BackgroundColor16 = bgc16;
                //BackgroundColor17 = bgc17;
                //BackgroundColor18 = bgc18;
                //BackgroundColor19 = bgc19;
                //BorderColor1 = bc1;
                //BorderColor2 = bc2;
                //BorderColor3 = bc3;
                //ForeColor1 = fc1;
                //ForeColor2 = fc2;
                //ForeColor3 = fc3;
            }
        }
    });

    Bridge.define("ExpressCraft.TileViewState", {
        $kind: "enum",
        statics: {
            fields: {
                Hidden: 0,
                Visible: 1
            }
        }
    });

    Bridge.define("ExpressCraft.ToolTip", {
        fields: {
            Description: null,
            Heading: null,
            AttachedControl: null
        },
        ctors: {
            ctor: function (content) {
                this.$initialize();
                this.Description = content;
            },
            $ctor1: function (heading, description) {
                this.$initialize();
                this.Description = description;
                this.Heading = heading;
            }
        },
        methods: {
            GetWordCount: function () {
                var fullContent = System.String.concat(this.Heading, " ", this.Description).trim();
                var length = fullContent.length;
                var prevChar = 0;
                var builder = new System.Text.StringBuilder();
                var current;
                var WordCount = 1;
                for (var i = 0; i < length; i = (i + 1) | 0) {
                    current = fullContent.charCodeAt(i);
                    if (System.Char.isWhiteSpace(String.fromCharCode(current))) {
                        if (System.Char.isWhiteSpace(String.fromCharCode(prevChar))) {
                            prevChar = current;
                            continue;
                        } else {
                            WordCount = (WordCount + 1) | 0;
                        }
                    }
                    prevChar = current;
                }
                return WordCount;
            }
        }
    });

    Bridge.define("ExpressCraft.Vector2", {
        $kind: "struct",
        statics: {
            methods: {
                /**
                 * adds calc to (100% - 50px) turns to calc(100% - 50px)
                 *
                 * @static
                 * @this ExpressCraft.Vector2
                 * @memberof ExpressCraft.Vector2
                 * @param   {string}    a
                 * @return  {string}
                 */
                pf: function (a) {
                    return !System.String.isNullOrWhiteSpace(a) && System.String.startsWith(a, "(") && System.String.endsWith(a, ")") ? System.String.concat("calc", a) : a;
                },
                getDefaultValue: function () { return new ExpressCraft.Vector2(); }
            }
        },
        fields: {
            X: null,
            Y: null
        },
        props: {
            Xi: {
                get: function () {
                    return this.X;
                },
                set: function (value) {
                    this.X = value;
                }
            },
            Yi: {
                get: function () {
                    return this.Y;
                },
                set: function (value) {
                    this.Y = value;
                }
            },
            Xf: {
                get: function () {
                    return this.X;
                },
                set: function (value) {
                    this.X = value;
                }
            },
            Yf: {
                get: function () {
                    return this.Y;
                },
                set: function (value) {
                    this.Y = value;
                }
            }
        },
        ctors: {
            $ctor1: function (x, y) {
                this.$initialize();
                this.X = x;
                this.Y = y;
            },
            ctor: function () {
                this.$initialize();
            }
        },
        methods: {
            getHashCode: function () {
                var h = Bridge.addHash([1955977157, this.X, this.Y]);
                return h;
            },
            equals: function (o) {
                if (!Bridge.is(o, ExpressCraft.Vector2)) {
                    return false;
                }
                return Bridge.equals(this.X, o.X) && Bridge.equals(this.Y, o.Y);
            },
            $clone: function (to) {
                var s = to || new ExpressCraft.Vector2();
                s.X = this.X;
                s.Y = this.Y;
                return s;
            }
        }
    });

    Bridge.define("ExpressCraft.Vector4", {
        $kind: "struct",
        statics: {
            methods: {
                getDefaultValue: function () { return new ExpressCraft.Vector4(); }
            }
        },
        fields: {
            X: null,
            Y: null,
            Z: null,
            M: null
        },
        ctors: {
            $ctor1: function (x, y, z, m) {
                this.$initialize();
                this.X = x;
                this.Y = y;
                this.Z = z;
                this.M = m;
            },
            ctor: function () {
                this.$initialize();
            }
        },
        methods: {
            getHashCode: function () {
                var h = Bridge.addHash([1956108229, this.X, this.Y, this.Z, this.M]);
                return h;
            },
            equals: function (o) {
                if (!Bridge.is(o, ExpressCraft.Vector4)) {
                    return false;
                }
                return Bridge.equals(this.X, o.X) && Bridge.equals(this.Y, o.Y) && Bridge.equals(this.Z, o.Z) && Bridge.equals(this.M, o.M);
            },
            $clone: function (to) {
                var s = to || new ExpressCraft.Vector4();
                s.X = this.X;
                s.Y = this.Y;
                s.Z = this.Z;
                s.M = this.M;
                return s;
            }
        }
    });

    Bridge.define("ExpressCraft.WindowStateType", {
        $kind: "enum",
        statics: {
            fields: {
                Normal: 0,
                Minimized: 1,
                Maximized: 2
            }
        }
    });

    Bridge.define("ExpressCraft.AceCodeEditor", {
        inherits: [ExpressCraft.Control],
        statics: {
            fields: {
                ExternalAceCodeEditor: null
            },
            ctors: {
                init: function () {
                    this.ExternalAceCodeEditor = new ExpressCraft.ExternalPlugin("https://ace.c9.io/build/src/ace.js");
                }
            },
            methods: {
                Setup: function () {
                    ExpressCraft.AceCodeEditor.ExternalAceCodeEditor.Setup();
                }
            }
        },
        fields: {
            editor: null,
            _modeType: 0,
            _themeType: 0
        },
        props: {
            ReadOnly: {
                get: function () {
                    return this.editor.getReadOnly();
                },
                set: function (value) {
                    this.editor.setReadOnly(value);
                }
            },
            Source: {
                get: function () {
                    return this.editor.getValue();
                },
                set: function (value) {
                    this.editor.setValue(value);
                }
            }
        },
        ctors: {
            ctor: function (modeType, themeType) {
                if (modeType === void 0) { modeType = 17; }
                if (themeType === void 0) { themeType = 11; }

                this.$initialize();
                ExpressCraft.Control.ctor.call(this);
                this._modeType = modeType;
                this._themeType = themeType;
            }
        },
        methods: {
            ClearSelection: function () {
                this.editor.clearSelection();
            },
            Render: function () {
                ExpressCraft.AceCodeEditor.ExternalAceCodeEditor.UsageCheck();

                var theme = System.Enum.format(ExpressCraft.AceModeTypes, this._modeType, "G");
                var mode = System.Enum.format(ExpressCraft.AceModeTypes, this._modeType, "G");

                			this.editor = ace.edit(this.content);
                			this.editor.setTheme("ace/theme/" + theme);
                			this.editor.getSession().setMode("ace/mode/" + mode);
                			
                this.OnResize = $asm.$.ExpressCraft.AceCodeEditor.f1;

                this.Content.addEventListener("mousedown", $asm.$.ExpressCraft.AceCodeEditor.f2);

                this.Content.addEventListener("mouseup", $asm.$.ExpressCraft.AceCodeEditor.f3);

                ExpressCraft.Control.prototype.Render.call(this);
            }
        }
    });

    Bridge.ns("ExpressCraft.AceCodeEditor", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.AceCodeEditor, {
        f1: function (cont) {
            				this.editor.resize(true);
            				
        },
        f2: function (ev) {
            ExpressCraft.Form.InExternalMouseEvent = true;
        },
        f3: function (ev) {
            ExpressCraft.Form.InExternalMouseEvent = false;
        }
    });

    Bridge.define("ExpressCraft.Form", {
        inherits: [ExpressCraft.Control],
        statics: {
            fields: {
                WindowHolder: null,
                MinimizedForms: null,
                WindowLoader: null,
                _activeToolTip: null,
                _toolTipTimerHandle: 0,
                _activeToolTipMouseMove: null,
                _activeToolTipControl: null,
                _oepntoolTipTimerHandle: 0,
                ResizeCorners: 0,
                MovingForm: null,
                Parent: null,
                Mouse_Down: false,
                MenuOpen: false,
                FormOverLay: null,
                _hasSetup: false,
                InExternalMouseEvent: false,
                InErrorDialog: false,
                standAloneForms: null,
                FormCollections: null,
                ShowBodyOverLay: false,
                Window_DefaultHeight: 0,
                Window_DefaultWidth: 0,
                _ActiveForm: null,
                _PrevActiveForm: null,
                MoveAction: 0,
                WindowHolderSelectionBoxX: 0,
                WindowHolderSelectionBoxY: 0,
                WindowHolderSelectionBoxXOff: 0,
                WindowHolderSelectionBoxYOff: 0,
                LoadingCount: 0,
                ToClean: null
            },
            props: {
                ActiveToolTip: {
                    get: function () {
                        return ExpressCraft.Form._activeToolTip;
                    },
                    set: function (value) {
                        if (!Bridge.referenceEquals(ExpressCraft.Form._activeToolTip, value)) {
                            if (value != null && value.AttachedControl != null && value.AttachedControl.Content != null) {
                                if (!Bridge.staticEquals(ExpressCraft.Form._activeToolTipMouseMove, null)) {
                                    value.AttachedControl.Content.removeEventListener("mousemove", ExpressCraft.Form._activeToolTipMouseMove);
                                    ExpressCraft.Form._activeToolTipMouseMove = null;
                                }
                            }
                            if (ExpressCraft.Form._activeToolTipControl != null) {
                                ExpressCraft.Form._activeToolTipControl.Close();
                                ExpressCraft.Form._activeToolTipControl = null;
                            }
                            if (ExpressCraft.Form._toolTipTimerHandle > -1) {
                                Bridge.global.clearTimeout(ExpressCraft.Form._toolTipTimerHandle);
                                ExpressCraft.Form._toolTipTimerHandle = -1;
                            }

                            ExpressCraft.Form._activeToolTip = value;

                            var messageLength;
                            if (ExpressCraft.Form._activeToolTip != null && ((messageLength = ExpressCraft.Form._activeToolTip.GetWordCount())) > 0 && ExpressCraft.Form._activeToolTip.AttachedControl != null) {
                                ExpressCraft.Form._activeToolTipMouseMove = function (ev) {
                                    if (ExpressCraft.Form._toolTipTimerHandle > -1) {
                                        Bridge.global.clearTimeout(ExpressCraft.Form._toolTipTimerHandle);
                                    }
                                    ExpressCraft.Form._toolTipTimerHandle = Bridge.global.setTimeout(function () {
                                        if (ExpressCraft.Form._activeToolTipControl != null) {
                                            ExpressCraft.Form._activeToolTipControl.Close();
                                            ExpressCraft.Form._activeToolTipControl = null;
                                        }
                                        if (ExpressCraft.Form._oepntoolTipTimerHandle > -1) {
                                            Bridge.global.clearTimeout(ExpressCraft.Form._oepntoolTipTimerHandle);
                                            ExpressCraft.Form._oepntoolTipTimerHandle = -1;
                                        }
                                        ExpressCraft.Form._activeToolTipControl = new ExpressCraft.ToolTipControl(ExpressCraft.Form._activeToolTip);
                                        ExpressCraft.Form._activeToolTipControl.Show(ev);

                                        ExpressCraft.Form._oepntoolTipTimerHandle = Bridge.global.setTimeout($asm.$.ExpressCraft.Form.f1, Math.max(1000, Bridge.Int.mul(messageLength, Math.max(ExpressCraft.Settings.ToolTipPopupStayOpenDelayPerWordMs, 10))));

                                        if (!Bridge.staticEquals(ExpressCraft.Form._activeToolTipMouseMove, null)) {
                                            value.AttachedControl.Content.removeEventListener("mousemove", ExpressCraft.Form._activeToolTipMouseMove);
                                            ExpressCraft.Form._activeToolTipMouseMove = null;
                                        }
                                    }, Math.max(1, ExpressCraft.Settings.ToolTipPopupDelayMs));
                                };
                                value.AttachedControl.Content.addEventListener("mousemove", ExpressCraft.Form._activeToolTipMouseMove);
                            }
                        }
                    }
                },
                ActiveForm: {
                    get: function () {
                        return ExpressCraft.Form._ActiveForm;
                    },
                    set: function (value) {
                        if (!Bridge.referenceEquals(ExpressCraft.Form._ActiveForm, value)) {
                            ExpressCraft.Form._PrevActiveForm = ExpressCraft.Form._ActiveForm;

                            if (ExpressCraft.Form._ActiveForm != null) {
                                ExpressCraft.Form._ActiveForm.OnLostFocus();
                                if (ExpressCraft.Form._ActiveForm.Content != null) {
                                    if (ExpressCraft.Form._ActiveForm.InDesign) {
                                        ExpressCraft.Form._ActiveForm.BodyOverLay.style.visibility = "collapse";
                                        return;
                                    }
                                    ExpressCraft.Form._ActiveForm.BodyOverLay.style.visibility = "visible";
                                }
                            }
                            ExpressCraft.Form._ActiveForm = value;
                            if (ExpressCraft.Form._ActiveForm != null) {
                                ExpressCraft.Form._ActiveForm.OnGotFocus();
                                if (ExpressCraft.Form._ActiveForm.Content != null) {
                                    ExpressCraft.Form._ActiveForm.BodyOverLay.style.visibility = "collapse";
                                    ExpressCraft.Form._ActiveForm.BringToFront();
                                }
                            }
                            if (Bridge.is(ExpressCraft.Form._PrevActiveForm, ExpressCraft.FormPopup) && ((ExpressCraft.Form._ActiveForm != null && !(Bridge.is(ExpressCraft.Form._ActiveForm, ExpressCraft.FormPopup))) || ExpressCraft.Form._ActiveForm == null)) {
                                ExpressCraft.Form.CloseFormPopups();
                            }
                        }
                    }
                }
            },
            ctors: {
                init: function () {
                    this.MinimizedForms = new (System.Collections.Generic.List$1(ExpressCraft.Form))();
                    this._toolTipTimerHandle = -1;
                    this._oepntoolTipTimerHandle = -1;
                    this.ResizeCorners = 2;
                    this.Mouse_Down = false;
                    this.MenuOpen = false;
                    this._hasSetup = false;
                    this.InExternalMouseEvent = false;
                    this.InErrorDialog = false;
                    this.standAloneForms = new ExpressCraft.FormCollection(null);
                    this.FormCollections = new (System.Collections.Generic.List$1(ExpressCraft.FormCollection))();
                    this.ShowBodyOverLay = false;
                    this.Window_DefaultHeight = 480;
                    this.Window_DefaultWidth = 640;
                    this.MoveAction = ExpressCraft.MouseMoveAction.Move;
                    this.LoadingCount = 0;
                    this.ToClean = new (System.Collections.Generic.List$1(ExpressCraft.Form))();
                }
            },
            methods: {
                MidleOfAction: function () {
                    return ExpressCraft.Form.MovingForm != null; // WindowHolderSelectionBox != null ||
                },
                GetActiveFormCollection: function () {
                    for (var i = (ExpressCraft.Form.FormCollections.Count - 1) | 0; i >= 0; i = (i - 1) | 0) {
                        var frmCol = ExpressCraft.Form.FormCollections.getItem(i);
                        if (frmCol.FormOwner == null) {
                            for (var x = 0; x < frmCol.VisibleForms.Count; x = (x + 1) | 0) {
                                if (frmCol.VisibleForms.getItem(x) != null) {
                                    frmCol.VisibleForms.getItem(x).Close();
                                }
                            }
                            ExpressCraft.Form.FormCollections.removeAt(i);
                        } else {
                            return frmCol;
                        }
                    }

                    return null;
                },
                SetBodyOverLay: function () {
                    var ActiveCollection = ExpressCraft.Form.GetActiveFormCollection();
                    if (ActiveCollection == null) {
                        return;
                    }

                    ActiveCollection.FormOwner.ShowBodyOverLayStyle();

                    var VisibleForms = ActiveCollection.VisibleForms;

                    for (var i = 0; i < VisibleForms.Count; i = (i + 1) | 0) {
                        var form = VisibleForms.getItem(i);
                        if (form != null) {
                            form.ShowBodyOverLayStyle();
                        }
                    }
                },
                ChangeStateTextSelection: function (element, state) {
                    $(element).css("user-select", state ? "text" : "none");
                },
                PerformFocusShake: function () {
                    if (ExpressCraft.Form.ActiveForm != null) {
                        var form = ExpressCraft.Form.ActiveForm;
                        form.Heading.classList.add("form-heading-flash");
                        Bridge.global.setTimeout(function () {
                            form.Heading.classList.remove("form-heading-flash");
                        }, 800);
                    }
                },
                DisableStateDrag: function (element) {
                    if (Bridge.is(element, HTMLImageElement)) {
                        element.ondragstart = $asm.$.ExpressCraft.Form.f2;
                    } else {
                        $(element).css("user-drag:", "none");
                    }
                },
                SetupHideElementsOnView: function () {
                    window.onblur = $asm.$.ExpressCraft.Form.f3;

                    window.onfocus = $asm.$.ExpressCraft.Form.f4;
                },
                CloseFormPopups: function () {
                    try {
                        var x = ExpressCraft.Form.GetActiveFormCollection();

                        for (var i = 0; i < x.VisibleForms.Count; i = (i + 1) | 0) {
                            if (x.VisibleForms.getItem(i) != null && Bridge.is(x.VisibleForms.getItem(i), ExpressCraft.FormPopup) && x.VisibleForms.getItem(i).IsContentVisible()) {
                                x.VisibleForms.getItem(i).Close();
                            }
                        }
                        if (Bridge.is(x.FormOwner, ExpressCraft.FormPopup)) {
                            x.FormOwner.Close();
                        }
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                },
                BeginLoading: function () {
                    ExpressCraft.Form.LoadingCount = (ExpressCraft.Form.LoadingCount + 1) | 0;
                    ExpressCraft.Form.WindowLoader.style.visibility = "visible";
                    ExpressCraft.Form.WindowLoader.style.opacity = "0.4";
                },
                EndLoading: function () {
                    ExpressCraft.Form.LoadingCount = (ExpressCraft.Form.LoadingCount - 1) | 0;
                    if (ExpressCraft.Form.LoadingCount === 0) {
                        ExpressCraft.Form.WindowLoader.style.visibility = "hidden";
                        ExpressCraft.Form.WindowLoader.style.opacity = "0";
                    }
                },
                Setup: function (parent) {
                    if (parent === void 0) { parent = null; }
                    //Settings.Setup();
                    if (ExpressCraft.Form._hasSetup) {
                        return;
                    }
                    ExpressCraft.Form._hasSetup = true;

                    if (parent == null) {
                        ExpressCraft.Form.Parent = document.body;
                    } else {
                        ExpressCraft.Form.Parent = parent;
                    }

                    ExpressCraft.Form.WindowHolder = ExpressCraft.Control.Div$1("form-container");

                    ExpressCraft.Form.FormOverLay = ExpressCraft.Control.Div$1("system-form-collection-overlay");

                    ExpressCraft.Form.WindowLoader = document.createElement("div");
                    ExpressCraft.Form.WindowLoader.className = "ajax-loading-screen";
                    ExpressCraft.Form.WindowLoader.style.visibility = "hidden";
                    ExpressCraft.Form.WindowLoader.style.opacity = "0";
                    ExpressCraft.Form.WindowLoader.style.backgroundColor = "white";
                    ExpressCraft.Helper.SetBoundsFull$1(ExpressCraft.Form.WindowLoader);
                    ExpressCraft.Form.WindowLoader.style.position = "fixed";
                    ExpressCraft.Form.WindowLoader.style.zIndex = "100000";
                    ExpressCraft.Form.WindowLoader.oncontextmenu = $asm.$.ExpressCraft.Form.f2;
                    ExpressCraft.Form.WindowLoader.onmousedown = $asm.$.ExpressCraft.Form.f5;
                    ExpressCraft.Form.WindowLoader.style.transition = "opacity 1s ease";

                    document.body.appendChild(ExpressCraft.Form.WindowLoader);

                    ExpressCraft.Form.FormOverLay.onmousedown = $asm.$.ExpressCraft.Form.f6;
                    ExpressCraft.Form.FormOverLay.onclick = $asm.$.ExpressCraft.Form.f7;
                    ExpressCraft.Form.FormOverLay.oncontextmenu = $asm.$.ExpressCraft.Form.f8;
                    ExpressCraft.Form.FormOverLay.style.visibility = "visible";

                    window.onkeyup = $asm.$.ExpressCraft.Form.f9;

                    window.onresize = $asm.$.ExpressCraft.Form.f10;

                    window.onmousemove = $asm.$.ExpressCraft.Form.f11;

                    window.onmouseup = $asm.$.ExpressCraft.Form.f12;
                    window.onbeforeunload = $asm.$.ExpressCraft.Form.f13;
                    window.onunload = $asm.$.ExpressCraft.Form.f14;
                    window.onerror = Bridge.fn.combine(window.onerror, $asm.$.ExpressCraft.Form.f15);

                    ExpressCraft.Form.WindowHolder.appendChild(ExpressCraft.Form.FormOverLay);

                    ExpressCraft.Helper.AppendChildren$1(ExpressCraft.Form.Parent, [ExpressCraft.Form.WindowHolder]);
                },
                SetCursor: function (cursor) {
                    document.body.style.cursor = cursor;
                },
                CalculateMinmizedFormsLocation: function () {
                    var $t, $t1;
                    ExpressCraft.Form.MinimizedForms.remove(null);
                    var RemoveList = new (System.Collections.Generic.List$1(ExpressCraft.Form))();
                    var count = 0;
                    var widthTotal = 0;
                    var y = 30;

                    var viewSize = ExpressCraft.Form.Parent.getBoundingClientRect();

                    $t = Bridge.getEnumerator(ExpressCraft.Form.MinimizedForms);
                    try {
                        while ($t.moveNext()) {
                            var item = $t.Current;
                            if (item.Content == null || item.windowState !== ExpressCraft.WindowStateType.Minimized) {
                                RemoveList.add(item);
                            } else {
                                var ToIncrement = 3 + ExpressCraft.Helper.ToFloat(item.Width);

                                if (widthTotal + ToIncrement > viewSize.width) {
                                    widthTotal = 0;
                                    count = 0;
                                    y = (y + 33) | 0;
                                }

                                item.Location = new ExpressCraft.Vector2.$ctor1(widthTotal, "(100% - " + (((y + 2) | 0)) + "px)");

                                count = (count + 1) | 0;

                                widthTotal += ToIncrement;
                            }
                        }
                    } finally {
                        if (Bridge.is($t, System.IDisposable)) {
                            $t.System$IDisposable$dispose();
                        }
                    }$t1 = Bridge.getEnumerator(RemoveList);
                    try {
                        while ($t1.moveNext()) {
                            var item1 = $t1.Current;
                            ExpressCraft.Form.MinimizedForms.remove(item1);
                        }
                    } finally {
                        if (Bridge.is($t1, System.IDisposable)) {
                            $t1.System$IDisposable$dispose();
                        }
                    }
                    //Left = 0;
                    //Top = "calc(100% - 30px)";
                },
                ClearZIndex: function () {
                    var x = ExpressCraft.Form.GetActiveFormCollection().FormOwner;
                    ExpressCraft.Form.WindowHolder.style.zIndex = "-" + ExpressCraft.Form.WindowHolder.childElementCount;
                    var Found = false;

                    for (var i = 0; i < ExpressCraft.Form.WindowHolder.childElementCount; i = (i + 1) | 0) {
                        if (Found || Bridge.referenceEquals(x.Content, ExpressCraft.Form.WindowHolder.children[i])) {
                            ExpressCraft.Form.WindowHolder.children[i].style.zIndex = "";
                            Found = true;
                        } else {
                            ExpressCraft.Form.WindowHolder.children[i].style.zIndex = (((((i - ExpressCraft.Form.WindowHolder.childElementCount) | 0) - 1) | 0)).toString();
                        }
                    }
                },
                ApplyZIndex: function () {
                    ExpressCraft.Form.WindowHolder.style.zIndex = "";
                    for (var i = 0; i < ExpressCraft.Form.WindowHolder.childElementCount; i = (i + 1) | 0) {
                        ExpressCraft.Form.WindowHolder.children[i].style.zIndex = i.toString();
                    }
                },
                CalculateZOrder$1: function (formCollection, zIndex) {
                    var TopMostForms = new (System.Collections.Generic.List$1(ExpressCraft.Form))();

                    var VisibleForms = formCollection.VisibleForms;
                    if (VisibleForms != null) {
                        for (var i = 0; i < VisibleForms.Count; i = (i + 1) | 0) {
                            if (VisibleForms.getItem(i).Content == null) {
                                ExpressCraft.Form.ToClean.add(VisibleForms.getItem(i));
                            } else {
                                if (VisibleForms.getItem(i).TopMost) {
                                    TopMostForms.add(VisibleForms.getItem(i));
                                }
                            }
                        }
                        for (var i1 = 0; i1 < ExpressCraft.Form.ToClean.Count; i1 = (i1 + 1) | 0) {
                            if (VisibleForms.contains(ExpressCraft.Form.ToClean.getItem(i1))) {
                                VisibleForms.remove(ExpressCraft.Form.ToClean.getItem(i1));
                                ExpressCraft.Form.ToClean.setItem(i1, null);
                            }
                        }

                        ExpressCraft.Form.ToClean.remove(null);

                        if (formCollection.FormOwner != null) {
                            formCollection.FormOwner.ManagePlaceHolders();
                            formCollection.FormOwner.Style.zIndex = zIndex.toString();
                            zIndex = (zIndex + 1) | 0;
                            //frag.AppendChild(formCollection.FormOwner);

                            //if(Helper.NotDesktop)
                            //{
                            //    if(VisibleForms.Count == 0)
                            //    {
                            //        formCollection.FormOwner.ManagePlaceHolders();
                            //        frag.AppendChild(formCollection.FormOwner);
                            //        return zIndex;
                            //    }
                            //}
                            //else
                            //{
                            //    formCollection.FormOwner.ManagePlaceHolders();
                            //    frag.AppendChild(formCollection.FormOwner);
                            //}
                        }

                        for (var i2 = 0; i2 < TopMostForms.Count; i2 = (i2 + 1) | 0) {
                            var form = TopMostForms.getItem(i2);
                            VisibleForms.remove(form);
                            VisibleForms.add(form);
                        }
                        var length = VisibleForms.Count;
                        for (var i3 = 0; i3 < length; i3 = (i3 + 1) | 0) {
                            if (VisibleForms.getItem(i3) != null && VisibleForms.getItem(i3).Content != null) {
                                VisibleForms.getItem(i3).ManagePlaceHolders();
                                VisibleForms.getItem(i3).Style.zIndex = zIndex.toString();
                                zIndex = (zIndex + 1) | 0;
                                //frag.AppendChild(VisibleForms[i]);

                                //if(Helper.NotDesktop)
                                //{
                                //    if(length - 1 == i)
                                //    {
                                //        VisibleForms[i].ManagePlaceHolders();
                                //        frag.AppendChild(VisibleForms[i]);
                                //        return zIndex;
                                //    }
                                //}else
                                //{
                                //    VisibleForms[i].ManagePlaceHolders();
                                //    frag.AppendChild(VisibleForms[i]);
                                //}
                            }
                        }
                    }

                    return zIndex;
                },
                CalculateZOrder: function () {
                    ExpressCraft.Form.GetActiveFormCollection();

                    if (ExpressCraft.Form.FormCollections == null && ExpressCraft.Form.standAloneForms.VisibleForms.Count === 0) {
                        return;
                    }
                    ExpressCraft.Form.FormCollections.remove(null);
                    var count = ExpressCraft.Form.FormCollections.Count;
                    var zIndex = 1;

                    //var frag = Document.CreateDocumentFragment();

                    ExpressCraft.Form.FormOverLay.style.opacity = count === 0 ? "" : count === 1 ? "0" : "0.4";

                    for (var x = 0; x < count; x = (x + 1) | 0) {
                        //if(Helper.NotDesktop)
                        //{
                        //    if(x == count - 1)
                        //    {
                        //        frag.AppendChild(FormOverLay);
                        //        zIndex = CalculateZOrder(FormCollections[x], zIndex, frag);
                        //    }
                        //}
                        //else
                        //{
                        //}
                        if (x === ((count - 1) | 0)) {
                            //frag.AppendChild(FormOverLay);
                            ExpressCraft.Form.FormOverLay.style.zIndex = zIndex.toString();
                            zIndex = (zIndex + 1) | 0;
                        }
                        zIndex = ExpressCraft.Form.CalculateZOrder$1(ExpressCraft.Form.FormCollections.getItem(x), zIndex); // frag
                    }
                    zIndex = ExpressCraft.Form.CalculateZOrder$1(ExpressCraft.Form.standAloneForms, zIndex); // frag

                    //WindowHolder.Empty();
                    //WindowHolder.AppendChild(frag);

                    if (ExpressCraft.Form.ActiveForm != null) {
                        ExpressCraft.Form.ActiveForm.Body.focus();
                    }
                }
            }
        },
        fields: {
            InDesign: false,
            PreviousSizeChange: false,
            PreviousMoveChange: false,
            PreviousShowMax: false,
            PreviousShowMin: false,
            PreviousOpacity: null,
            HasRemovedPlaceHolder: false,
            AllowSizeChange: false,
            AllowMoveChange: false,
            ForReuse: false,
            Self: null,
            _IsDialog: false,
            Children: null,
            StartPosition: 0,
            TopMost: false,
            DialogResult: 0,
            Heading: null,
            ButtonClose: null,
            ButtonExpand: null,
            ButtonMinimize: null,
            ButtonMenu: null,
            HeadingTitle: null,
            Body: null,
            BodyOverLay: null,
            prev_px: 0,
            prev_py: 0,
            prev_width: 0,
            prev_height: 0,
            prev_top: 0,
            prev_left: 0,
            MinWidth: 0,
            MinHeight: 0,
            windowState: 0,
            _prevwindowState: 0,
            OnFormClosed: null,
            previousDisplay: null,
            DialogResults: null,
            _seperateInstance: false,
            closeAction: null,
            InClose: false,
            InDialogResult: false
        },
        props: {
            HasSetup: {
                get: function () {
                    return ExpressCraft.Form._hasSetup;
                }
            },
            Controls: {
                get: function () {
                    return this.Body.children;
                }
            },
            ShowMinimize: {
                get: function () {
                    return this.ButtonMinimize != null;
                },
                set: function (value) {
                    this.ChangeHeadingButton(ExpressCraft.FormButtonType.Minimize, value);
                }
            },
            BodyStyle: {
                get: function () {
                    return this.Body.style;
                }
            },
            ShowClose: {
                get: function () {
                    return this.ButtonClose != null;
                },
                set: function (value) {
                    this.ChangeHeadingButton(ExpressCraft.FormButtonType.Close, value);
                }
            },
            ShowMaximize: {
                get: function () {
                    return this.ButtonExpand != null;
                },
                set: function (value) {
                    this.ChangeHeadingButton(ExpressCraft.FormButtonType.Maximize, value);
                }
            },
            ShowMenu: {
                get: function () {
                    return this.ButtonMenu != null;
                },
                set: function (value) {
                    this.ChangeHeadingButton(ExpressCraft.FormButtonType.Menu, value);
                }
            },
            WindowState: {
                get: function () {
                    return this.windowState;
                },
                set: function (value) {
                    this.SetWindowState(value);
                }
            },
            Text: {
                get: function () {
                    return this.HeadingTitle.innerHTML;
                },
                set: function (value) {
                    this.HeadingTitle.innerHTML = value;
                }
            },
            BackColor: {
                get: function () {
                    return this.Body.style.backgroundColor;
                },
                set: function (value) {
                    this.Body.style.backgroundColor = value;
                }
            },
            ForeColor: {
                get: function () {
                    return this.Body.style.color;
                },
                set: function (value) {
                    this.Body.style.color = value;
                }
            }
        },
        ctors: {
            init: function () {
                this.InDesign = false;
                this.PreviousSizeChange = true;
                this.PreviousMoveChange = true;
                this.PreviousShowMax = true;
                this.PreviousShowMin = true;
                this.PreviousOpacity = "";
                this.AllowSizeChange = true;
                this.AllowMoveChange = true;
                this.ForReuse = false;
                this._IsDialog = false;
                this.Children = new (System.Collections.Generic.List$1(ExpressCraft.Control))();
                this.StartPosition = ExpressCraft.FormStartPosition.WindowsDefaultLocation;
                this.TopMost = false;
                this.DialogResult = ExpressCraft.DialogResultEnum.None;
                this.MinWidth = 200;
                this.MinHeight = 50;
                this._prevwindowState = ExpressCraft.WindowStateType.Normal;
                this.DialogResults = new (System.Collections.Generic.List$1(ExpressCraft.DialogResult))();
                this._seperateInstance = false;
                this.InClose = false;
                this.InDialogResult = false;
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "form-base");
                this.Heading = ExpressCraft.Control.Div$1("form-heading");

                this.Heading.oncontextmenu = $asm.$.ExpressCraft.Form.f8;

                this.HeadingTitle = ExpressCraft.Control.Span$1("form-heading-title");

                this.Body = ExpressCraft.Control.Div$1("form-body");

                this.Body.oncontextmenu = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f16);

                this.BackColor = "#F0F0F0";

                this.BodyOverLay = ExpressCraft.Control.Div$1("form-body-overlay");

                this.BodyOverLay.style.opacity = ExpressCraft.Form.ShowBodyOverLay ? "0.5" : "0";

                this.ChangeHeadingButton(ExpressCraft.FormButtonType.Close);
                if (!ExpressCraft.Helper.NotDesktop) {
                    this.ChangeHeadingButton(ExpressCraft.FormButtonType.Maximize);
                    this.ChangeHeadingButton(ExpressCraft.FormButtonType.Minimize);
                }

                if (ExpressCraft.Helper.NotDesktop) {
                    this.Heading.style.height = "50px";
                    this.HeadingTitle.style.fontSize = "14px";

                    this.Body.style.top = "50px";
                    this.Body.style.height = "calc(100% - 50px)";

                    this.BodyOverLay.style.top = "50px";
                    this.BodyOverLay.style.height = "calc(100% - 50px)";
                }

                this.BodyOverLay.style.visibility = "collapse";

                this.Self = $(this.Content);

                this.Content.addEventListener("mousedown", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f17));

                this.Heading.addEventListener("dblclick", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f18));

                this.Content.addEventListener("mouseleave", $asm.$.ExpressCraft.Form.f19);

                this.Body.addEventListener("mouseenter", $asm.$.ExpressCraft.Form.f20);

                this.Content.addEventListener("mousemove", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f21));

                this.Heading.addEventListener("mousedown", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f22));

                this.Body.addEventListener("mousedown", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f23));

                this.Body.addEventListener("mousemove", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f24));

                this.BodyOverLay.addEventListener("mousedown", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f25));

                this.Body.addEventListener("mouseleave", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f26));

                this.BodyOverLay.addEventListener("mouseenter", Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f27));

                $(this.Content).css("width", ExpressCraft.Form.Window_DefaultWidth).css("height", ExpressCraft.Form.Window_DefaultHeight);

                this.Content.appendChild(this.Heading);
                this.Content.appendChild(this.Body);
                this.Content.appendChild(this.BodyOverLay);

                this.Heading.appendChild(this.HeadingTitle);

                this.closeAction = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f28);

                this.Initialise();
            }
        },
        methods: {
            IsDialog: function () {
                return this._IsDialog;
            },
            LinkchildToForm: function (child) {
                if (child == null) {
                    return;
                }
                this.Children.add(child);
                child.LinkedForm = this;
            },
            LinkchildrenToForm: function (children) {
                if (children === void 0) { children = []; }
                if (children == null || children.length === 0) {
                    return;
                }
                this.Children.addRange(children);
                for (var i = 0; i < children.length; i = (i + 1) | 0) {
                    children[System.Array.index(i, children)].LinkedForm = this;
                }
            },
            AppendChild$1: function (node) {
                this.Body.appendChild(ExpressCraft.Control.op_Implicit(node));

                return this;
            },
            AppendChild: function (node) {
                this.Body.appendChild(node);

                return this;
            },
            AppendChildren$1: function (node) {
                if (node === void 0) { node = []; }
                ExpressCraft.Helper.AppendChildren$2(this.Body, node);

                return this;
            },
            AppendChildren: function (node) {
                if (node === void 0) { node = []; }
                ExpressCraft.Helper.AppendChildren$1(this.Body, node);

                return this;
            },
            ResizeChildren: function (parent) {
                if (!Bridge.staticEquals(this.OnResize, null)) {
                    this.OnResize(this);
                }
                this.OnResizing();

                for (var x = 0; x < parent.children.length; x = (x + 1) | 0) {
                    if (!parent.children[x].classList.contains("control")) {
                        continue;
                    }
                    for (var i = 0; i < this.Children.Count; i = (i + 1) | 0) {
                        if (this.Children.getItem(i) != null && !Bridge.staticEquals(this.Children.getItem(i).OnResize, null)) {
                            if (Bridge.referenceEquals(this.Children.getItem(i).Content, parent.children[x])) {
                                this.Children.getItem(i).OnResize(this.Children.getItem(i));
                                break;
                            }
                        }
                    }
                    this.ResizeChildren(parent.children[x]);
                }
            },
            Resizing: function () {
                if (!Bridge.staticEquals(this.OnResize, null)) {
                    this.OnResize(this);
                }
                this.OnResizing();

                for (var i = 0; i < this.Children.Count; i = (i + 1) | 0) {
                    if (this.Children.getItem(i) != null && !Bridge.staticEquals(this.Children.getItem(i).OnResize, null)) {
                        this.Children.getItem(i).OnResize(this.Children.getItem(i));
                    }
                }
            },
            OnResizing: function () { },
            IsContentVisible: function () {
                return this.Content != null && Bridge.equals(this.Content.style.visibility, "visible");
            },
            ChangeHeadingButton: function (button, visible) {
                if (visible === void 0) { visible = true; }
                switch (button) {
                    case ExpressCraft.FormButtonType.Minimize: 
                        if (this.ButtonMinimize != null) {
                            ExpressCraft.Helper.Delete(this.ButtonMinimize);
                            this.ButtonMinimize = null;
                        }
                        if (visible) {
                            this.ButtonMinimize = this.CreateFormButton(button);
                        }
                        break;
                    case ExpressCraft.FormButtonType.Maximize: 
                        if (this.ButtonExpand != null) {
                            ExpressCraft.Helper.Delete(this.ButtonExpand);
                            this.ButtonExpand = null;
                        }
                        if (visible) {
                            this.ButtonExpand = this.CreateFormButton(button);
                        }
                        break;
                    case ExpressCraft.FormButtonType.Close: 
                        if (this.ButtonClose != null) {
                            ExpressCraft.Helper.Delete(this.ButtonClose);
                            this.ButtonClose = null;
                        }
                        if (visible) {
                            this.ButtonClose = this.CreateFormButton(button);
                        }
                        break;
                    case ExpressCraft.FormButtonType.Menu: 
                        if (this.ButtonMenu != null) {
                            ExpressCraft.Helper.Delete(this.ButtonMenu);
                            this.ButtonMenu = null;
                        }
                        if (visible) {
                            this.ButtonMenu = this.CreateFormButton(button);
                        }
                        break;
                    default: 
                        break;
                }

                this.CalculateButtonLocations();
            },
            Initialise: function () { },
            OnShowing: function () { },
            OnShowed: function () { },
            OnClosing: function () { },
            OnClosed: function () { },
            ShowBodyOverLayStyle: function () {
                if (this.BodyOverLay != null && Bridge.equals(this.BodyOverLay.style.visibility, "collapse")) {
                    if (this.InDesign) {
                        return;
                    }
                    this.BodyOverLay.style.visibility = "visible";
                }
            },
            OnGotFocus: function () { },
            OnLostFocus: function () { },
            SetWindowState: function (State) {
                if (State === this.windowState) {
                    return;
                }

                this._prevwindowState = this.windowState;

                if (this._prevwindowState === ExpressCraft.WindowStateType.Minimized) {
                    this.Body.style.opacity = this.PreviousOpacity;
                    this.AllowSizeChange = this.PreviousSizeChange;
                    this.AllowMoveChange = this.PreviousMoveChange;
                    this.ShowMaximize = this.PreviousShowMax;
                    this.ShowMinimize = this.PreviousShowMin;
                    this.HeadingTitle.style.left = "";
                    this.HeadingTitle.style.marginRight = "";
                    this.HeadingTitle.style.transform = "";

                    if (this.ButtonMinimize != null) {
                        this.ButtonMinimize.innerHTML = "-";
                    }
                    this.Heading.classList.remove("form-heading-min");

                    ExpressCraft.Form.MinimizedForms.remove(this);

                    this.Body.style.display = this.previousDisplay;

                    ExpressCraft.Form.CalculateMinmizedFormsLocation();
                }

                if (!this.AllowSizeChange) {
                    return;
                }

                if (((this.windowState = State)) === ExpressCraft.WindowStateType.Normal) {
                    ExpressCraft.Helper.SetBounds(this, this.prev_left, this.prev_top, this.prev_width, this.prev_height);
                    this.Resizing();
                    this.Style.borderWidth = "1px";
                } else if (this.windowState === ExpressCraft.WindowStateType.Maximized) {
                    if (this._prevwindowState === ExpressCraft.WindowStateType.Normal) {
                        this.prev_left = ExpressCraft.Helper.ToInt(this.Left);
                        this.prev_top = ExpressCraft.Helper.ToInt(this.Top);
                        this.prev_width = ExpressCraft.Helper.ToInt(this.Width);
                        this.prev_height = ExpressCraft.Helper.ToInt(this.Height);
                    }

                    this.Style.borderWidth = "0";

                    ExpressCraft.Helper.SetBounds(this, 0, 0, "100%", "100%");
                } else if (this.windowState === ExpressCraft.WindowStateType.Minimized) {
                    this.PreviousSizeChange = this.AllowSizeChange;
                    this.PreviousMoveChange = this.AllowMoveChange;
                    this.PreviousOpacity = this.Body.style.opacity;
                    this.PreviousShowMax = this.ShowMaximize;
                    this.PreviousShowMin = this.ShowMinimize;

                    this.AllowSizeChange = false;
                    this.Body.style.opacity = "0";
                    this.ShowMaximize = false;
                    this.ShowMinimize = false;
                    this.AllowMoveChange = false;

                    if (this._prevwindowState === ExpressCraft.WindowStateType.Normal) {
                        this.prev_left = ExpressCraft.Helper.ToInt(this.Left);
                        this.prev_top = ExpressCraft.Helper.ToInt(this.Top);
                        this.prev_width = ExpressCraft.Helper.ToInt(this.Width);
                        this.prev_height = ExpressCraft.Helper.ToInt(this.Height);
                    } else {
                        this.Style.borderWidth = "1px";
                    }

                    this.HeadingTitle.style.marginRight = "0";
                    this.HeadingTitle.style.left = "3px";
                    this.HeadingTitle.style.transform = "translate(0, -50%)";

                    var offset = (this.ShowClose ? 45.5 : 0);

                    this.Width = Math.max(ExpressCraft.Control.GetTextWidth(this.Text, "10pt Tahoma") + 32, 100) + offset;
                    this.Height = 30;

                    this.Heading.classList.add("form-heading-min");

                    if (this.ButtonMinimize != null) {
                        this.ButtonMinimize.innerHTML = "+";
                    }

                    this.previousDisplay = this.Body.style.display;
                    this.Body.style.display = "none";

                    ExpressCraft.Form.MinimizedForms.add(this);

                    ExpressCraft.Form.CalculateMinmizedFormsLocation();
                }

                this.Resizing();
            },
            changeWindowState: function () {
                if (this.windowState === ExpressCraft.WindowStateType.Maximized) {
                    this.SetWindowState(ExpressCraft.WindowStateType.Normal);
                } else if (this.windowState === ExpressCraft.WindowStateType.Minimized) {
                    this.SetWindowState(this._prevwindowState);
                } else {
                    this.SetWindowState(ExpressCraft.WindowStateType.Maximized);
                }
            },
            CalculateButtonLocations: function () {
                var RightOffset = 0;
                var append = 45.5;

                if (ExpressCraft.Helper.NotDesktop) {
                    append = 65.5;
                }

                if (this.ShowClose) {
                    if (ExpressCraft.Helper.NotDesktop) {
                        this.ButtonClose.style.left = "calc(100% - " + System.Single.format(append) + "px)";
                    }
                    RightOffset += append;
                    if (!System.Linq.Enumerable.from(this.Heading.children).contains(this.ButtonClose)) {
                        this.Heading.appendChild(this.ButtonClose);
                    }
                }

                if (this.ShowMaximize) {
                    RightOffset += append;
                    this.ButtonExpand.style.left = "calc(100% - " + System.Single.format(RightOffset) + "px)";
                    if (!System.Linq.Enumerable.from(this.Heading.children).contains(this.ButtonExpand)) {
                        this.Heading.appendChild(this.ButtonExpand);
                    }
                }
                if (this.ShowMinimize) {
                    RightOffset += append;
                    this.ButtonMinimize.style.left = "calc(100% - " + System.Single.format(RightOffset) + "px)";
                    if (!System.Linq.Enumerable.from(this.Heading.children).contains(this.ButtonMinimize)) {
                        this.Heading.appendChild(this.ButtonMinimize);
                    }
                }

                if (this.ShowMenu) {
                    this.ButtonMenu.style.left = "0";
                    if (!System.Linq.Enumerable.from(this.Heading.children).contains(this.ButtonMenu)) {
                        this.Heading.appendChild(this.ButtonMenu);
                    }
                }
            },
            CreateFormButton: function (Type) {
                var butt = ExpressCraft.Control.Div$1("form-heading-button");

                switch (Type) {
                    case ExpressCraft.FormButtonType.Close: 
                        butt.classList.add("form-heading-button-close");
                        butt.innerHTML = "&times;";
                        butt.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f29);
                        butt.onmouseup = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f30);
                        break;
                    case ExpressCraft.FormButtonType.Maximize: 
                        butt.innerHTML = "&#9633;";
                        butt.onmouseup = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f31);
                        break;
                    case ExpressCraft.FormButtonType.Minimize: 
                        butt.innerHTML = "-";
                        butt.onmouseup = Bridge.fn.bind(this, function (ev) {
                            if (ExpressCraft.Form.MovingForm != null) {
                                return;
                            }

                            ev.stopPropagation();
                            ev.preventDefault();

                            if (Bridge.referenceEquals(butt.innerHTML, "-")) {
                                butt.innerHTML = "+";
                                this.WindowState = ExpressCraft.WindowStateType.Minimized;
                            } else {
                                this.WindowState = this._prevwindowState === ExpressCraft.WindowStateType.Minimized ? ExpressCraft.WindowStateType.Normal : this._prevwindowState;
                                butt.innerHTML = "-";
                            }

                            ExpressCraft.Form.Mouse_Down = false;
                        });
                        break;
                    case ExpressCraft.FormButtonType.Restore: 
                        break;
                    case ExpressCraft.FormButtonType.Help: 
                        break;
                    default: 
                        butt.onmouseup = $asm.$.ExpressCraft.Form.f32;
                        break;
                    case ExpressCraft.FormButtonType.Menu: 
                        butt.innerHTML = "&#9776;";
                        butt.onmouseup = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f33);
                        break;
                }

                butt.onmouseenter = $asm.$.ExpressCraft.Form.f34;

                butt.ondblclick = $asm.$.ExpressCraft.Form.f35;

                butt.onmousemove = $asm.$.ExpressCraft.Form.f36;

                if (Type !== ExpressCraft.FormButtonType.Close) {
                    butt.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f37);
                }

                if (ExpressCraft.Helper.NotDesktop) {
                    butt.style.width = "65px";
                    butt.style.height = "49px";
                    butt.style.fontSize = "16pt";
                    butt.style.lineHeight = "49px";
                    ExpressCraft.Helper.ExchangeClass(butt, "primary", "primary");
                    butt.style.filter = "brightness(110%)";
                }

                return butt;
            },
            OnMenuClick: function () { },
            TitleBarHeight: function () {
                return this.Heading.clientHeight;
            },
            TitleBarWidth: function () {
                return this.Heading.clientWidth;
            },
            ClientX: function () {
                return this.Body.clientLeft;
            },
            ClientY: function () {
                return this.Body.clientTop;
            },
            GetFormCollectionFromForm: function (form) {
                if (form._seperateInstance) {
                    var visibleForms = ExpressCraft.Form.standAloneForms.VisibleForms;
                    for (var x = 0; x < visibleForms.Count; x = (x + 1) | 0) {
                        if (Bridge.referenceEquals(visibleForms.getItem(x), this)) {
                            return ExpressCraft.Form.standAloneForms;
                        }
                    }
                } else {
                    for (var i = 0; i < ExpressCraft.Form.FormCollections.Count; i = (i + 1) | 0) {
                        if (Bridge.referenceEquals(this, ExpressCraft.Form.FormCollections.getItem(i).FormOwner)) {
                            return ExpressCraft.Form.FormCollections.getItem(i);
                        }
                        var visibleForms1 = ExpressCraft.Form.FormCollections.getItem(i).VisibleForms;
                        for (var x1 = 0; x1 < visibleForms1.Count; x1 = (x1 + 1) | 0) {
                            if (Bridge.referenceEquals(visibleForms1.getItem(x1), this)) {
                                return ExpressCraft.Form.FormCollections.getItem(i);
                            }
                        }
                    }
                }

                return null;
            },
            IsActiveFormCollection: function () {
                if (this._seperateInstance) {
                    return Bridge.referenceEquals(this.GetFormCollectionFromForm(this), ExpressCraft.Form.standAloneForms);
                } else {
                    return Bridge.referenceEquals(this.GetFormCollectionFromForm(this), ExpressCraft.Form.GetActiveFormCollection());
                }
            },
            IsVisible: function () {
                return this.GetFormCollectionFromForm(this) != null;
            },
            ShowStartNewLevel: function () {
                if (!this.HasSetup) {
                    ExpressCraft.Form.Setup();
                }

                if (this.IsVisible()) {
                    // Already Open???
                    throw new System.Exception("Invalid request to open form as a dialog that is already visible!");
                }

                ExpressCraft.Form.FormCollections.add(new ExpressCraft.FormCollection(this));
                ExpressCraft.Form.WindowHolder.appendChild(ExpressCraft.Control.op_Implicit(this));

                ExpressCraft.Form.CalculateZOrder();

                if (this.StartPosition === ExpressCraft.FormStartPosition.Center) {
                    this.CentreForm();
                }

                this.OnShowed();

                ExpressCraft.Form.ActiveForm = this;

                ExpressCraft.Helper.FocusElement(this.Body);
            },
            ShowDialog: function (dialogResults) {
                if (dialogResults === void 0) { dialogResults = []; }
                if (!this.HasSetup) {
                    ExpressCraft.Form.Setup();
                }

                this.InDialogResult = false;

                if (this.ButtonMinimize != null) {
                    ExpressCraft.Helper.Delete(this.ButtonMinimize);
                }
                if (this.ButtonExpand != null) {
                    ExpressCraft.Helper.Delete(this.ButtonExpand);
                }
                if (this.ButtonClose != null) {
                    ExpressCraft.Helper.Delete(this.ButtonClose);
                }

                this._IsDialog = true;
                if (this.StartPosition !== ExpressCraft.FormStartPosition.Manual) {
                    if (!ExpressCraft.Helper.NotDesktop) {
                        this.StartPosition = ExpressCraft.FormStartPosition.Center;
                    }
                }
                this.ShowStartNewLevel();

                if (dialogResults != null && dialogResults.length > 0) {
                    this.DialogResults.addRange(dialogResults);
                }
            },
            MinZero$1: function (input) {
                return input < 0 ? 0 : input;
            },
            MinZero: function (input) {
                return input < 0 ? 0 : input;
            },
            CentreForm: function () {
                if (ExpressCraft.Form.WindowHolder == null) {
                    return;
                }

                this.Self.css("left", this.MinZero((((((Bridge.Int.div(ExpressCraft.Form.WindowHolder.clientWidth, 2)) | 0)) - (((Bridge.Int.div(parseInt(ExpressCraft.Helper.ToHtmlValue(this.Width)), 2)) | 0))) | 0))).css("top", this.MinZero((((((Bridge.Int.div(ExpressCraft.Form.WindowHolder.clientHeight, 2)) | 0)) - (((Bridge.Int.div(parseInt(ExpressCraft.Helper.ToHtmlValue(this.Height)), 2)) | 0))) | 0)));
            },
            Render: function () {
                if (!this.HasRendered) {
                    ExpressCraft.Control.prototype.Render.call(this);
                    this.OnShowing();
                    this.Shown();
                }
            },
            Shown: function () {
                this.InClose = false;
                if (this.Children == null) {
                    return;
                }
                for (var i = 0; i < this.Children.Count; i = (i + 1) | 0) {
                    if (this.Children.getItem(i) != null && !Bridge.staticEquals(this.Children.getItem(i).OnLoaded, null)) {
                        this.Children.getItem(i).OnLoaded(this.Children.getItem(i));
                    }
                }
                this.Children.remove(null);
            },
            Show: function (seperateInstance) {
                if (seperateInstance === void 0) { seperateInstance = false; }
                if (!this.HasSetup) {
                    ExpressCraft.Form.Setup();
                }

                if (this._IsDialog) {
                    return;
                }
                this._seperateInstance = seperateInstance;
                if (!seperateInstance && (ExpressCraft.Form.FormCollections == null || ExpressCraft.Form.FormCollections.Count === 0)) {
                    this.ShowStartNewLevel();
                    return;
                }

                var activeCollect = !seperateInstance ? ExpressCraft.Form.GetActiveFormCollection() : ExpressCraft.Form.standAloneForms;
                var visbileForms = activeCollect.VisibleForms;

                if (!visbileForms.contains(this)) {
                    visbileForms.add(this);
                    ExpressCraft.Form.WindowHolder.appendChild(ExpressCraft.Control.op_Implicit(this));

                    this.Content.style.visibility = "visible";

                    ExpressCraft.Form.CalculateZOrder();

                    if (this.StartPosition !== ExpressCraft.FormStartPosition.Manual && this.windowState === ExpressCraft.WindowStateType.Normal) {
                        if (this.StartPosition === ExpressCraft.FormStartPosition.Center || (activeCollect == null || visbileForms == null || visbileForms.Count === 0 || visbileForms.getItem(((visbileForms.Count - 1) | 0)).windowState !== ExpressCraft.WindowStateType.Normal || visbileForms.getItem(((visbileForms.Count - 1) | 0)).Content == null)) {
                            this.CentreForm();
                        } else if (this.StartPosition === ExpressCraft.FormStartPosition.WindowsDefaultLocation) {
                            var obj = visbileForms.getItem(((visbileForms.Count - 1) | 0));

                            var x = Bridge.box(parseInt(ExpressCraft.Helper.ToHtmlValue(obj.Left)), System.Int32);
                            var y = Bridge.box(parseInt(ExpressCraft.Helper.ToHtmlValue(obj.Top)), System.Int32);

                            if (isNaN(Bridge.unbox(x))) {
                                x = Bridge.box(0, System.Int32);
                            }
                            if (isNaN(Bridge.unbox(y))) {
                                y = Bridge.box(0, System.Int32);
                            }

                            var rec = ExpressCraft.Form.WindowHolder.getBoundingClientRect();

                            var pw25 = rec.width * 0.15;
                            var ph25 = rec.height * 0.15;

                            var pw75 = rec.width * 0.55;
                            var ph75 = rec.height * 0.55;

                            if (System.Nullable.getValue(Bridge.cast(Bridge.unbox(x), System.Int32)) < pw25) {
                                x = Bridge.box(Bridge.Int.clip32(pw25), System.Int32);
                            }
                            if (System.Nullable.getValue(Bridge.cast(Bridge.unbox(y), System.Int32)) < ph25) {
                                y = Bridge.box(Bridge.Int.clip32(ph25), System.Int32);
                            }

                            if (System.Nullable.getValue(Bridge.cast(Bridge.unbox(x), System.Int32)) > pw75) {
                                x = Bridge.box(Bridge.Int.clip32(pw25), System.Int32);
                            }
                            if (System.Nullable.getValue(Bridge.cast(Bridge.unbox(y), System.Int32)) > ph75) {
                                y = Bridge.box(Bridge.Int.clip32(ph25), System.Int32);
                            }
                            x = Bridge.box((System.Nullable.getValue(Bridge.cast(Bridge.unbox(x), System.Int32)) + 10) | 0, System.Int32);
                            y = Bridge.box((System.Nullable.getValue(Bridge.cast(Bridge.unbox(y), System.Int32)) + 10) | 0, System.Int32);

                            this.Self.css("left", this.MinZero(System.Nullable.getValue(Bridge.cast(Bridge.unbox(x), System.Int32)))).css("top", this.MinZero(System.Nullable.getValue(Bridge.cast(Bridge.unbox(y), System.Int32))));
                        }
                    }

                    this.OnShowed();
                }

                ExpressCraft.Form.ActiveForm = this;

                if (ExpressCraft.Helper.NotDesktop) {
                    Bridge.global.setTimeout(Bridge.fn.bind(this, $asm.$.ExpressCraft.Form.f38), 0);
                }
            },
            BringToFront: function () {
                var activeCollect = ExpressCraft.Form.GetActiveFormCollection();
                if (activeCollect != null) {
                    if (Bridge.referenceEquals(activeCollect.FormOwner, this)) {
                        return;
                    }
                    var visibleForms = activeCollect.VisibleForms;
                    if (visibleForms != null && visibleForms.Count > 1) {
                        visibleForms.remove(this);
                        visibleForms.add(this);
                    }

                    ExpressCraft.Form.CalculateZOrder();
                }
            },
            SetZIndex: function (zIndex) {
                this.Content.style.zIndex = (Bridge.identity(zIndex.v, (zIndex.v = (zIndex.v + 1) | 0))).toString();
            },
            ManagePlaceHolders: function () {
                if (!ExpressCraft.Settings.RemoveAttributesOffElementsWhenLoseFocus) {
                    return;
                }

                var shouldHidePlaceholders = !Bridge.referenceEquals(ExpressCraft.Form.ActiveForm, this);

                if (shouldHidePlaceholders !== this.HasRemovedPlaceHolder) {
                    this.HasRemovedPlaceHolder = shouldHidePlaceholders;
                    var que = new (System.Collections.Generic.Queue$1(HTMLElement)).ctor();
                    que.enqueue(this.Body);

                    while (que.Count > 0) {
                        var element = que.dequeue();
                        if (shouldHidePlaceholders) {
                            var a = element.getAttribute("placeholder");
                            if (!System.String.isNullOrWhiteSpace(a)) {
                                element.removeAttribute("placeholder");
                                element.setAttribute("data-placeholder", a);
                            }
                        } else {
                            var a1 = element.getAttribute("data-placeholder");
                            if (!System.String.isNullOrWhiteSpace(a1)) {
                                element.removeAttribute("data-placeholder");
                                element.setAttribute("placeholder", a1);
                            }
                        }
                        var length = element.childElementCount;
                        if (length > 0) {
                            for (var i = 0; i < length; i = (i + 1) | 0) {
                                que.enqueue(element.children[i]);
                            }
                        }
                    }
                }
            },
            Close: function () {
                if (this._IsDialog && this.InDialogResult) {
                    return;
                }

                this.InClose = true;

                this.OnClosing();

                ExpressCraft.Form.ToClean.add(this);

                var ownerFormCollection = this.GetFormCollectionFromForm(this);

                if (ownerFormCollection != null) {
                    if (Bridge.referenceEquals(ownerFormCollection.FormOwner, this)) {
                        ownerFormCollection.FormOwner = null;
                        for (var i = 0; i < ownerFormCollection.VisibleForms.Count; i = (i + 1) | 0) {
                            if (Bridge.referenceEquals(ownerFormCollection.VisibleForms.getItem(i), this)) {
                                continue;
                            }
                            ownerFormCollection.VisibleForms.getItem(i).Close();
                        }
                        if (ExpressCraft.Form.FormCollections.Count === 1) {
                            ExpressCraft.Form.FormCollections = new (System.Collections.Generic.List$1(ExpressCraft.FormCollection))();
                        }
                    } else {
                        ownerFormCollection.VisibleForms.remove(this);
                    }
                }

                if (this.Content != null) {
                    if (!this.ForReuse) {
                        if (ExpressCraft.Settings.FormFadeDuration > 0) {
                            this.Self.fadeOut(ExpressCraft.Settings.FormFadeDuration, this.closeAction);
                        } else {
                            this.closeAction();
                        }
                    } else {
                        this.Content.style.visibility = "collapse";
                    }
                }

                ExpressCraft.Form.CalculateZOrder();

                ExpressCraft.Form.ActiveForm = ExpressCraft.Form._PrevActiveForm;
                if (this._IsDialog) {
                    this.InDialogResult = true;
                    if (this.DialogResult !== ExpressCraft.DialogResultEnum.None && this.DialogResults != null && this.DialogResults.Count > 0) {
                        for (var i1 = 0; i1 < this.DialogResults.Count; i1 = (i1 + 1) | 0) {
                            this.DialogResults.getItem(i1).InvokeIfResult(this.DialogResult);
                        }
                    }
                }

                if (!Bridge.staticEquals(this.OnFormClosed, null)) {
                    this.OnFormClosed();
                }
                this.OnClosed();

                if (this.WindowState === ExpressCraft.WindowStateType.Minimized) {
                    ExpressCraft.Form.MinimizedForms.remove(this);
                    ExpressCraft.Form.CalculateMinmizedFormsLocation();
                }

                this.InClose = false;
            }
        }
    });

    Bridge.ns("ExpressCraft.Form", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.Form, {
        f1: function () {
            if (ExpressCraft.Form._activeToolTipControl != null) {
                ExpressCraft.Form._activeToolTipControl.Close();
                ExpressCraft.Form._activeToolTipControl = null;
            }
        },
        f2: function (ev) {
            ev.preventDefault();
        },
        f3: function (ev) {
            if (System.Linq.Enumerable.from(document.body.childNodes).contains(ExpressCraft.Form.WindowHolder)) {
                document.body.removeChild(ExpressCraft.Form.WindowHolder);
            }
        },
        f4: function (ev) {
            if (!System.Linq.Enumerable.from(document.body.childNodes).contains(ExpressCraft.Form.WindowHolder)) {
                document.body.appendChild(ExpressCraft.Form.WindowHolder);
            }
        },
        f5: function (ev) {
            ev.preventDefault();
            ev.stopPropagation();
        },
        f6: function (ev) {
            if (Bridge.is(ExpressCraft.Form.ActiveForm, ExpressCraft.FormPopup)) {
                ExpressCraft.Form.CloseFormPopups();
            }

            if (document.activeElement != null) {
                //FormPopup
                document.activeElement.focus();
                ev.preventDefault();
                ExpressCraft.Form.SetCursor("default");
            }
        },
        f7: function (ev) {
            ExpressCraft.Form.PerformFocusShake();
        },
        f8: function (ev) {
            ev.stopPropagation();
            ev.preventDefault();
        },
        f9: function (ev) {
            if (ExpressCraft.Settings.OnF2ShowThemeForm && ev.keyCode === ExpressCraft.KeyCodes.F2) {
                ev.preventDefault();
                ExpressCraft.ThemeForm.ShowThemeForm();
            }
        },
        f10: function (ev) {
            if (ExpressCraft.Form.FormCollections == null) {
                return;
            }

            for (var i = 0; i < ExpressCraft.Form.FormCollections.Count; i = (i + 1) | 0) {
                if (ExpressCraft.Form.FormCollections.getItem(i) == null) {
                    continue;
                }
                var fc = ExpressCraft.Form.FormCollections.getItem(i);
                if (fc.FormOwner != null) {
                    fc.FormOwner.Resizing();
                }
                for (var x = 0; x < fc.VisibleForms.Count; x = (x + 1) | 0) {
                    if (fc.VisibleForms.getItem(x) != null) {
                        fc.VisibleForms.getItem(x).Resizing();
                    }
                }
            }

            ExpressCraft.Form.CalculateMinmizedFormsLocation();
        },
        f11: function (ev) {
            if (ExpressCraft.Form.InExternalMouseEvent) {
                return;
            }

            var mev = ev;

            if (ExpressCraft.Form.MovingForm != null) {
                ev.preventDefault();
                ev.stopImmediatePropagation();
                ev.stopPropagation();

                ExpressCraft.Form.MovingForm.Style.boxShadow = "none"; // box - shadow: none;

                if (Bridge.equals(ExpressCraft.Form.MovingForm.BodyOverLay.style.visibility, "collapse")) {
                    if (ExpressCraft.Form.MovingForm.InDesign) {
                        ExpressCraft.Form._ActiveForm.BodyOverLay.style.visibility = "collapse";
                    } else {
                        ExpressCraft.Form.MovingForm.BodyOverLay.style.visibility = "visible";
                    }

                    ExpressCraft.Form.MovingForm.Heading.focus();
                }

                var mousePos = ExpressCraft.Helper.GetClientMouseLocation(ev);

                var mX;
                var mY;

                var newX = (((mX = mousePos.Xf)) + ExpressCraft.Form.MovingForm.prev_px);
                var newY = (((mY = mousePos.Yf)) + ExpressCraft.Form.MovingForm.prev_py);

                if (ExpressCraft.Form.MovingForm.windowState === ExpressCraft.WindowStateType.Maximized && ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.Move) {
                    ExpressCraft.Form.MovingForm.changeWindowState();
                    newX = mousePos.Xf - (((Bridge.Int.div(ExpressCraft.Form.MovingForm.prev_width, 2)) | 0));
                    ExpressCraft.Form.MovingForm.prev_px = newX - mousePos.Xf;
                }

                var x = parseFloat(ExpressCraft.Form.MovingForm.Style.left);
                var y = parseFloat(ExpressCraft.Form.MovingForm.Style.top);
                var w = parseFloat(ExpressCraft.Form.MovingForm.Style.width);
                var h = parseFloat(ExpressCraft.Form.MovingForm.Style.height);

                var px = x;
                var py = y;
                var pw = w;
                var ph = h;

                if (newY < 1) {
                    newY = 1;
                }
                if (newX < 1) {
                    newX = 1;
                }

                if (mX < 1) {
                    mX = 1;
                }
                if (mY < 1) {
                    mY = 1;
                }

                switch (ExpressCraft.Form.MoveAction) {
                    case ExpressCraft.MouseMoveAction.Move: 
                        x = newX;
                        y = newY;
                        break;
                    case ExpressCraft.MouseMoveAction.TopLeftResize: 
                        w -= newX - x;
                        h -= newY - y;
                        if (w < ExpressCraft.Form.MovingForm.MinWidth) {
                            newX -= ExpressCraft.Form.MovingForm.MinWidth - w;
                            w = ExpressCraft.Form.MovingForm.MinWidth;
                        }
                        if (h < ExpressCraft.Form.MovingForm.MinHeight) {
                            newY -= ExpressCraft.Form.MovingForm.MinHeight - h;
                            h = ExpressCraft.Form.MovingForm.MinHeight;
                        }
                        x = newX;
                        y = newY;
                        break;
                    case ExpressCraft.MouseMoveAction.TopResize: 
                        h -= newY - y;
                        if (h < ExpressCraft.Form.MovingForm.MinHeight) {
                            newY -= ExpressCraft.Form.MovingForm.MinHeight - h;
                            h = ExpressCraft.Form.MovingForm.MinHeight;
                        }
                        y = newY;
                        break;
                    case ExpressCraft.MouseMoveAction.TopRightResize: 
                        h -= newY - y;
                        w = mX - x;
                        if (h < ExpressCraft.Form.MovingForm.MinHeight) {
                            newY -= ExpressCraft.Form.MovingForm.MinHeight - h;
                            h = ExpressCraft.Form.MovingForm.MinHeight;
                        }
                        if (w < ExpressCraft.Form.MovingForm.MinWidth) {
                            w = ExpressCraft.Form.MovingForm.MinWidth;
                        }
                        y = newY;
                        break;
                    case ExpressCraft.MouseMoveAction.LeftResize: 
                        w -= newX - x;
                        if (w < ExpressCraft.Form.MovingForm.MinWidth) {
                            newX -= ExpressCraft.Form.MovingForm.MinWidth - w;
                            w = ExpressCraft.Form.MovingForm.MinWidth;
                        }
                        x = newX;
                        break;
                    case ExpressCraft.MouseMoveAction.BottomLeftResize: 
                        w -= newX - x;
                        h = mY - y;
                        if (w < ExpressCraft.Form.MovingForm.MinWidth) {
                            newX -= ExpressCraft.Form.MovingForm.MinWidth - w;
                            w = ExpressCraft.Form.MovingForm.MinWidth;
                        }
                        if (h < ExpressCraft.Form.MovingForm.MinHeight) {
                            h = ExpressCraft.Form.MovingForm.MinHeight;
                        }
                        x = newX;
                        break;
                    case ExpressCraft.MouseMoveAction.BottomResize: 
                        h = mY - y;
                        if (h < ExpressCraft.Form.MovingForm.MinHeight) {
                            h = ExpressCraft.Form.MovingForm.MinHeight;
                        }
                        break;
                    case ExpressCraft.MouseMoveAction.RightResize: 
                        w = mX - x;
                        if (w < ExpressCraft.Form.MovingForm.MinWidth) {
                            w = ExpressCraft.Form.MovingForm.MinWidth;
                        }
                        break;
                    case ExpressCraft.MouseMoveAction.BottomRightResize: 
                        w = mX - x;
                        h = mY - y;
                        if (h < ExpressCraft.Form.MovingForm.MinHeight) {
                            h = ExpressCraft.Form.MovingForm.MinHeight;
                        }
                        if (w < ExpressCraft.Form.MovingForm.MinWidth) {
                            w = ExpressCraft.Form.MovingForm.MinWidth;
                        }
                        break;
                }
                var changed = false;
                if (px !== x) {
                    ExpressCraft.Form.MovingForm.Style.left = x + 'px';
                }
                if (py !== y) {
                    ExpressCraft.Form.MovingForm.Style.top = y + 'px';
                }
                if (pw !== w && ((changed = true))) {
                    ExpressCraft.Form.MovingForm.Style.width = w + 'px';
                }
                if (ph !== h && ((changed = true))) {
                    ExpressCraft.Form.MovingForm.Style.height = h + 'px';
                }

                if (changed) {
                    ExpressCraft.Form.MovingForm.Resizing();
                }
            }
        },
        f12: function (ev) {
            ExpressCraft.Form.InExternalMouseEvent = false;
            if (ExpressCraft.Form.MovingForm != null) {
                ExpressCraft.Form.MovingForm.Style.boxShadow = null;
                ExpressCraft.Form.MovingForm.BodyOverLay.style.visibility = "collapse";
            }

            ExpressCraft.Form.MovingForm = null;
            ExpressCraft.Form.Mouse_Down = false;
            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.Move;
            ExpressCraft.Form.SetCursor("default");
        },
        f13: function (ev) {
            if (!ExpressCraft.Settings.AllowCloseWithoutQuestion) {
                return 'Would you like to close this application?';
            }
        },
        f14: function (ev) {
            if (!Bridge.staticEquals(ExpressCraft.Settings.OnApplicationClose, null)) {
                ExpressCraft.Settings.OnApplicationClose();
            }
        },
        f15: function (message, url, lineNumber, columnNumber, error) {
            if (ExpressCraft.Form.InErrorDialog) {
                return false;
            }
            try {
                ExpressCraft.Form.InErrorDialog = true;
                var errStr;
                if (System.String.isNullOrWhiteSpace(message) || Bridge.referenceEquals(message, "Script error.")) {
                    errStr = "Script Error: See Browser Console for Detail's";
                } else {
                    errStr = System.String.concat("Script Error: ", message);
                }

                if (ExpressCraft.Application.AplicationDefition === ExpressCraft.ApplicationDefitnion.ExpressCraftConsole) {
                    ExpressCraft.ConsoleForm.Log(errStr, ExpressCraft.ConsoleLogType.Error);
                }

                if (ExpressCraft.Settings.ShowExceptionDialog) {
                    var msgBox = new ExpressCraft.MessageBoxForm.ctor(errStr, ExpressCraft.MessageBoxLayout.Error);
                    msgBox.ShowDialog();
                }
            }
            catch ($e1) {
                $e1 = System.Exception.create($e1);
            }
            finally {
                ExpressCraft.Form.InErrorDialog = false;
            }

            return false;
        },
        f16: function (ev) {
            if (Bridge.referenceEquals(ev.target, this.Body)) {
                ev.stopPropagation();
                ev.preventDefault();
            }
        },
        f17: function (ev) {
            if (ExpressCraft.Form.InExternalMouseEvent) {
                return;
            }
            var mev = ev;

            mev.stopPropagation();
            mev.stopImmediatePropagation();

            if (!this.IsActiveFormCollection()) {
                return;
            }

            ExpressCraft.Form.Mouse_Down = true;

            ExpressCraft.Form.MovingForm = this;
            ExpressCraft.Form.ActiveForm = this;

            ExpressCraft.Form.SetBodyOverLay();

            var clientRec = this.Content.getBoundingClientRect();

            var mousePos = ExpressCraft.Helper.GetClientMouseLocation(ev);

            this.prev_px = clientRec.left - mousePos.Xf;
            this.prev_py = clientRec.top - mousePos.Yf;

            var width = clientRec.width;
            var height = clientRec.height;

            var X = mousePos.Xf - clientRec.left;
            var Y = mousePos.Yf - clientRec.top;

            if (this.windowState === ExpressCraft.WindowStateType.Maximized) {
                ExpressCraft.Form.SetCursor("default");
                ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.Move;
            } else if (this.windowState === ExpressCraft.WindowStateType.Minimized) {
                ExpressCraft.Form.SetCursor("default");
                ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.None;
                this.changeWindowState();
            } else {
                if (this.InDesign) {
                    return;
                }

                if (this.HeadingTitle != null && Bridge.referenceEquals(ev.target, this.HeadingTitle)) {
                    ExpressCraft.Form.SetCursor("default");
                    ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.Move;
                } else {
                    if (this.AllowSizeChange) {
                        if (X <= ExpressCraft.Form.ResizeCorners && Y <= ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("nwse-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.TopLeftResize;
                        } else if (Y <= ExpressCraft.Form.ResizeCorners && X >= width - ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("nesw-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.TopRightResize;
                        } else if (Y <= ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("n-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.TopResize;
                        } else if (X <= ExpressCraft.Form.ResizeCorners && Y >= height - ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("nesw-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.BottomLeftResize;
                        } else if (Y >= height - ExpressCraft.Form.ResizeCorners && X >= width - ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("nwse-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.BottomRightResize;
                        } else if (Y >= height - ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("s-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.BottomResize;
                        } else if (X <= ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("w-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.LeftResize;
                        } else if (X >= width - ExpressCraft.Form.ResizeCorners) {
                            ExpressCraft.Form.SetCursor("e-resize");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.RightResize;
                        } else {
                            ExpressCraft.Form.SetCursor("default");
                            ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.Move;
                        }
                    }
                }
            }

            if (!this.AllowMoveChange && ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.Move) {
                ExpressCraft.Form.SetCursor("default");
                ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.None;
            }
        },
        f18: function (ev) {
            if (this.AllowSizeChange) {
                this.changeWindowState();
            }

            ev.preventDefault();
            ev.stopPropagation();
        },
        f19: function (ev) {
            if (ExpressCraft.Form.MovingForm == null) {
                ExpressCraft.Form.SetCursor("default");
            }
        },
        f20: function (ev) {
            ExpressCraft.Form.SetCursor("default");
        },
        f21: function (ev) {
            if (ExpressCraft.Form.InExternalMouseEvent) {
                return;
            }

            if (Bridge.referenceEquals(ev.target, this.HeadingTitle)) {
                return;
            }
            var mev = ev;

            var width = this.Content.clientWidth;
            var height = this.Content.clientHeight;
            var X = (mev.pageX - this.Content.offsetLeft) | 0;
            var Y = (mev.pageY - this.Content.offsetTop) | 0;

            if (ExpressCraft.Form.MovingForm != null && ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.Move) {
                ExpressCraft.Form.SetCursor("default");
                return;
            } else if (this.windowState === ExpressCraft.WindowStateType.Maximized) {
                ExpressCraft.Form.SetCursor("default");
                return;
            }
            if (this.InDesign) {
                return;
            }

            if (this.AllowSizeChange) {
                if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.TopLeftResize || X <= ExpressCraft.Form.ResizeCorners && Y <= ExpressCraft.Form.ResizeCorners) {
                    ExpressCraft.Form.SetCursor("nwse-resize");
                } else if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.TopRightResize || Y <= ExpressCraft.Form.ResizeCorners && X >= ((width - ExpressCraft.Form.ResizeCorners) | 0)) {
                    ExpressCraft.Form.SetCursor("nesw-resize");
                } else if (Y <= ExpressCraft.Form.ResizeCorners || ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.TopResize) {
                    ExpressCraft.Form.SetCursor("n-resize");
                } else if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.BottomLeftResize || X <= ExpressCraft.Form.ResizeCorners && Y >= ((height - ExpressCraft.Form.ResizeCorners) | 0)) {
                    ExpressCraft.Form.SetCursor("nesw-resize");
                } else if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.BottomRightResize || Y >= ((height - ExpressCraft.Form.ResizeCorners) | 0) && X >= ((width - ExpressCraft.Form.ResizeCorners) | 0)) {
                    ExpressCraft.Form.SetCursor("nwse-resize");
                } else if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.BottomResize || Y >= ((height - ExpressCraft.Form.ResizeCorners) | 0)) {
                    ExpressCraft.Form.SetCursor("s-resize");
                } else if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.LeftResize || X <= ExpressCraft.Form.ResizeCorners) {
                    ExpressCraft.Form.SetCursor("w-resize");
                } else if (ExpressCraft.Form.MoveAction === ExpressCraft.MouseMoveAction.RightResize || X >= ((width - ExpressCraft.Form.ResizeCorners) | 0)) {
                    ExpressCraft.Form.SetCursor("e-resize");
                } else {
                    ExpressCraft.Form.SetCursor("default");
                }
            } else {
                ExpressCraft.Form.SetCursor("default");
            }
        },
        f22: function (ev) {
            ExpressCraft.Form.SetBodyOverLay();
            if (!this.IsActiveFormCollection()) {
                return;
            }

            if (this.windowState === ExpressCraft.WindowStateType.Maximized) {
                ExpressCraft.Form.MovingForm = this;
                ExpressCraft.Form.SetCursor("default");

                ExpressCraft.Form.MoveAction = ExpressCraft.MouseMoveAction.Move;
            } else {
                ExpressCraft.Form.MovingForm = this;
            }

            ExpressCraft.Form.ActiveForm = this;
        },
        f23: function (ev) {
            if (ExpressCraft.Form.InExternalMouseEvent) {
                return;
            }
            if (!this.IsActiveFormCollection()) {
                return;
            }

            ExpressCraft.Form.ActiveForm = this;
            ExpressCraft.Form.MovingForm = null;
            ev.stopPropagation();
        },
        f24: function (ev) {
            if (ExpressCraft.Form.InExternalMouseEvent) {
                return;
            }

            if (ExpressCraft.Form.MovingForm == null) {
                if (!this.IsActiveFormCollection()) {
                    return;
                }
                ev.stopPropagation();
            }
        },
        f25: function (ev) {
            if (this.InDesign) {
                this.BodyOverLay.style.visibility = "collapse";
                return;
            }
            if (!this.IsActiveFormCollection()) {
                return;
            }
            this.BodyOverLay.style.visibility = "collapse";
            ExpressCraft.Form.ActiveForm = this;
        },
        f26: function (ev) {
            if (this.InDesign) {
                this.BodyOverLay.style.visibility = "collapse";
                return;
            }

            if (ExpressCraft.Form.MovingForm == null) {
                ExpressCraft.Form.SetBodyOverLay();
            }
        },
        f27: function (ev) {
            if (this.InDesign) {
                this.BodyOverLay.style.visibility = "collapse";
                return;
            }
            if (ExpressCraft.Form.MovingForm == null && this.IsActiveFormCollection()) {
                ExpressCraft.Form.SetCursor("default");
                this.BodyOverLay.style.visibility = "collapse";
            } else {
                this.BodyOverLay.style.visibility = "visible";
            }
        },
        f28: function () {
            ExpressCraft.Helper.Empty(this.Content);
            if (this.Content != null) {
                ExpressCraft.Helper.Delete(this.Content);
                this.Content = null;
            }
        },
        f29: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }
            ExpressCraft.Form.Mouse_Down = true;

            ev.stopPropagation();
            ev.preventDefault();

            ExpressCraft.Form.ActiveForm = this;
        },
        f30: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }

            ev.stopPropagation();
            ev.preventDefault();

            if (this.InDesign) {
                return;
            }

            this.Close();
        },
        f31: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }

            ev.stopPropagation();
            ev.preventDefault();

            ExpressCraft.Form.Mouse_Down = false;

            this.changeWindowState();
        },
        f32: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }

            ev.stopPropagation();
            ev.preventDefault();

            ExpressCraft.Form.Mouse_Down = false;
        },
        f33: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }

            ev.stopPropagation();
            ev.preventDefault();

            ExpressCraft.Form.Mouse_Down = false;

            this.OnMenuClick();
        },
        f34: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }
            ExpressCraft.Form.SetCursor("default");
        },
        f35: function (ev) {
            ev.stopPropagation();
        },
        f36: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }

            ev.stopImmediatePropagation();
            ev.preventDefault();
        },
        f37: function (ev) {
            if (ExpressCraft.Form.MovingForm != null) {
                return;
            }

            ExpressCraft.Form.Mouse_Down = true;

            ev.stopPropagation();
            ev.preventDefault();

            ExpressCraft.Form.ActiveForm = this;
        },
        f38: function () {
            this.Content.focus();
            this.Content.click();
        }
    });

    Bridge.define("ExpressCraft.CalculatorControl", {
        inherits: [ExpressCraft.Control],
        fields: {
            DisplayInput: null,
            btnClose: null,
            btnBack: null,
            btnCE: null,
            btnC: null,
            btnPTAX: null,
            btnMTAX: null,
            btnTAX: null,
            btnDbl: null,
            btn7: null,
            btn8: null,
            btn9: null,
            btnDiv: null,
            btnSqrt: null,
            btn4: null,
            btn5: null,
            btn6: null,
            btnMul: null,
            btnPer: null,
            btn1: null,
            btn2: null,
            btn3: null,
            btnMinus: null,
            btn1OverX: null,
            btn0: null,
            btnplusOrNeg: null,
            btnDot: null,
            btnPlus: null,
            btnEq: null,
            Value: System.Decimal(0.0),
            _commands: null,
            current_command: null,
            OnEqual: null,
            OnClose: null,
            DontRefresh: false
        },
        ctors: {
            init: function () {
                this._commands = new (System.Collections.Generic.List$1(System.String))();
                this.current_command = "";
                this.DontRefresh = false;
            },
            ctor: function (startingValue, CloseButtonVisible) {
                if (CloseButtonVisible === void 0) { CloseButtonVisible = false; }

                this.$initialize();
                ExpressCraft.Control.$ctor1.call(this);
                var $t;
                this.Value = startingValue;

                this.current_command = this.Value.toString();

                var doc = document.createDocumentFragment();

                var AddHeight = (ExpressCraft.Helper.NotDesktop ? 45 : 22);

                //27.77778

                doc.appendChild(((this.DisplayInput = ($t = new ExpressCraft.MemoInput(), $t.Readonly = true, $t.Bounds = new ExpressCraft.Vector4.$ctor1(4, 4, "(100% - 8px)", AddHeight), $t))).Content);

                if (ExpressCraft.Helper.NotDesktop) {
                    this.DisplayInput.Style.fontSize = "14px";
                    this.DisplayInput.Height = 45;
                }

                var buttons = new (System.Collections.Generic.List$1(ExpressCraft.SimpleButton))();

                buttons.addRange(System.Array.init([(this.btnPTAX = ($t = new ExpressCraft.SimpleButton(), $t.Text = "+TAX", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btn7 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "7", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btn8 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "8", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btn9 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "9", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btnDiv = ($t = new ExpressCraft.SimpleButton(), $t.Text = "/", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnSqrt = ($t = new ExpressCraft.SimpleButton(), $t.Text = "sqrt", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnMTAX = ($t = new ExpressCraft.SimpleButton(), $t.Text = "-TAX", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btn4 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "4", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btn5 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "5", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btn6 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "6", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btnMul = ($t = new ExpressCraft.SimpleButton(), $t.Text = "*", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnPer = ($t = new ExpressCraft.SimpleButton(), $t.Text = "%", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnTAX = ($t = new ExpressCraft.SimpleButton(), $t.Text = "TAX", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btn1 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "1", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btn2 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "2", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btn3 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "3", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btnMinus = ($t = new ExpressCraft.SimpleButton(), $t.Text = "-", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btn1OverX = ($t = new ExpressCraft.SimpleButton(), $t.Text = "1/x", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnDbl = ($t = new ExpressCraft.SimpleButton(), $t.Text = "Dbl", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btn0 = ($t = new ExpressCraft.SimpleButton(), $t.Text = "0", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btnplusOrNeg = ($t = new ExpressCraft.SimpleButton(), $t.Text = "+/-", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnDot = ($t = new ExpressCraft.SimpleButton(), $t.Text = ".", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddTextToCommand), $t)), (this.btnPlus = ($t = new ExpressCraft.SimpleButton(), $t.Text = "+", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t)), (this.btnEq = ($t = new ExpressCraft.SimpleButton(), $t.Text = "=", $t.ItemClick = Bridge.fn.cacheBind(this, this.AddOperator), $t))], ExpressCraft.SimpleButton));
                var index = 0;
                var y = 0;
                var yOffset = (28 + AddHeight) | 0;
                this.btnClose = ($t = new ExpressCraft.SimpleButton(), $t.Text = "&times;", $t.Size = new ExpressCraft.Vector2.$ctor1("((100% - 28px) * 0.1666666666666667)", "((100% - " + yOffset + "px) * 0.2)"), $t.Location = new ExpressCraft.Vector2.$ctor1("(((100% - 28px) * " + (System.Decimal("0.8333333333333335")) + ") + " + (24) + "px)", "(((100% - " + yOffset + "px) * " + (System.Decimal(y).mul(System.Decimal(0.2))) + ") + " + (((((((Bridge.Int.mul(y, 4)) + 8) | 0)) + AddHeight) | 0)) + "px)"), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.CalculatorControl.f1), $t);
                if (ExpressCraft.Helper.NotDesktop) {
                    this.btnClose.Style.fontSize = "26px";
                    this.btnClose.Style.fontWeight = "bold";
                }
                this.btnBack = ($t = new ExpressCraft.SimpleButton(), $t.Text = "Back", $t.Size = new ExpressCraft.Vector2.$ctor1("(((100% - 24px) - ((100% - 28px) * 0.1666666666666667)) * 0.333)", "((100% - " + yOffset + "px) * 0.2)"), $t.Location = new ExpressCraft.Vector2.$ctor1("(((((100% - 24px) - ((100% - 28px) * 0.1666666666666667)) * 0.333) * 0) + 4px)", "(((100% - " + yOffset + "px) * " + (System.Decimal(y).mul(System.Decimal(0.2))) + ") + " + (((((((Bridge.Int.mul(y, 4)) + 8) | 0)) + AddHeight) | 0)) + "px)"), $t.ItemClick = Bridge.fn.cacheBind(this, this.Back), $t);
                if (ExpressCraft.Helper.NotDesktop) {
                    this.btnBack.Style.fontSize = "14px";
                }
                this.btnCE = ($t = new ExpressCraft.SimpleButton(), $t.Text = "CE", $t.Size = new ExpressCraft.Vector2.$ctor1("(((100% - 24px) - ((100% - 28px) * 0.1666666666666667)) * 0.333)", "((100% - " + yOffset + "px) * 0.2)"), $t.Location = new ExpressCraft.Vector2.$ctor1("(((((100% - 24px) - ((100% - 28px) * 0.1666666666666667)) * 0.333) * 1) + 8px)", "(((100% - " + yOffset + "px) * " + (System.Decimal(y).mul(System.Decimal(0.2))) + ") + " + (((((((Bridge.Int.mul(y, 4)) + 8) | 0)) + AddHeight) | 0)) + "px)"), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.CalculatorControl.f2), $t);
                if (ExpressCraft.Helper.NotDesktop) {
                    this.btnCE.Style.fontSize = "14px";
                }
                this.btnC = ($t = new ExpressCraft.SimpleButton(), $t.Text = "C", $t.Size = new ExpressCraft.Vector2.$ctor1("((((100% - 24px) - ((100% - 28px) * 0.1666666666666667)) * 0.333) + 4px)", "((100% - " + yOffset + "px) * 0.2)"), $t.Location = new ExpressCraft.Vector2.$ctor1("(((((100% - 24px) - ((100% - 28px) * 0.1666666666666667)) * 0.333) * 2) + 12px)", "(((100% - " + yOffset + "px) * " + (System.Decimal(y).mul(System.Decimal(0.2))) + ") + " + (((((((Bridge.Int.mul(y, 4)) + 8) | 0)) + AddHeight) | 0)) + "px)"), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.CalculatorControl.f3), $t);
                if (ExpressCraft.Helper.NotDesktop) {
                    this.btnC.Style.fontSize = "14px";
                }

                ExpressCraft.Helper.AppendChildren$1(doc, [this.btnClose.Content, this.btnBack.Content, this.btnCE.Content, this.btnC.Content]);

                y = (y + 1) | 0;

                for (var i = 0; i < buttons.Count; i = (i + 1) | 0) {
                    buttons.getItem(i).Size = new ExpressCraft.Vector2.$ctor1("((100% - 28px) * 0.1666666666666667)", "((100% - " + yOffset + "px) * 0.2)");
                    buttons.getItem(i).Location = new ExpressCraft.Vector2.$ctor1("(((100% - 28px) * " + (System.Decimal(index).mul(System.Decimal("0.1666666666666667"))) + ") + " + ((((Bridge.Int.mul(index, 4)) + 4) | 0)) + "px)", "(((100% - " + yOffset + "px) * " + (System.Decimal(y).mul(System.Decimal(0.2))) + ") + " + (((((((Bridge.Int.mul(y, 4)) + 8) | 0)) + AddHeight) | 0)) + "px)");
                    if (ExpressCraft.Helper.NotDesktop) {
                        buttons.getItem(i).Style.fontSize = "14px";
                    }

                    doc.appendChild(buttons.getItem(i).Content);
                    index = (index + 1) | 0;
                    if (index === 6) {
                        index = 0;
                        y = (y + 1) | 0;
                    }
                }

                this.btnDbl.Style.fontSize = "6.5pt";
                this.btnTAX.Style.fontSize = "6.5pt";
                this.btnPTAX.Style.fontSize = "6.5pt";
                this.btnMTAX.Style.fontSize = "6.5pt";

                this.btnClose.Style.color = "red";
                this.btnClose.Style.fontWeight = "bold";

                if (!CloseButtonVisible) {
                    this.btnClose.Style.visibility = "hidden";
                }

                this.RefreshValue();

                this.Content.appendChild(doc);
        }
    },
    methods: {
        AddTextToCommand: function (button) {
            if (Bridge.referenceEquals(button.Text, ".") && System.String.contains(this.current_command,".")) {
                return;
            }

            if (Bridge.referenceEquals(this.current_command, "0")) {
                this.current_command = "";
            }

            this.current_command = System.String.concat(this.current_command, button.Text);

            this.RefreshValue();
        },
        CalculateAndClose: function () {
            var x = this.Calculate();

            if (!Bridge.staticEquals(this.OnEqual, null)) {
                this.OnEqual(x);
            }
            if (!this.DontRefresh) {
                if (!Bridge.staticEquals(this.OnClose, null)) {
                    this.OnClose();
                }
            }
        },
        Calculate: function () {
            var previousValue = System.Decimal(0);

            var previousOp = "";
            var length = this._commands.Count;

            for (var i = 0; i < length; i = (i + 1) | 0) {
                var command = this._commands.getItem(i);

                if (System.String.endsWith(command, "%")) {
                    command = command.substr(0, ((command.length - 1) | 0));
                }

                var tryDec = { };
                if (System.Decimal.tryParse(command, null, tryDec)) {
                    if (!Bridge.referenceEquals(previousOp, "")) {
                        if (System.String.endsWith(this._commands.getItem(i), "%")) {
                            try {
                                tryDec.v = previousValue.mul((tryDec.v.div(System.Decimal(100))));
                            }
                            catch ($e1) {
                                $e1 = System.Exception.create($e1);
                                tryDec.v = System.Decimal(0);
                            }
                        }

                        if (Bridge.referenceEquals(previousOp, "+")) {
                            previousValue = previousValue.add(tryDec.v);
                        } else if (Bridge.referenceEquals(previousOp, "-")) {
                            previousValue = previousValue.sub(tryDec.v);
                        } else if (Bridge.referenceEquals(previousOp, "/")) {
                            try {
                                previousValue = previousValue.div(tryDec.v);
                            }
                            catch ($e2) {
                                $e2 = System.Exception.create($e2);
                                previousValue = System.Decimal(0);
                            }
                        } else if (Bridge.referenceEquals(previousOp, "*")) {
                            previousValue = previousValue.mul(tryDec.v);
                        } else if (Bridge.referenceEquals(previousOp, "*")) {
                            previousValue = previousValue.mul(tryDec.v);
                        }

                        previousOp = "";
                    } else {
                        previousValue = tryDec.v;
                    }
                } else {
                    previousOp = command;
                    if (Bridge.referenceEquals(previousOp, "+TAX")) {
                        previousValue = ExpressCraft.Helper.AddTax(previousValue);
                        previousOp = "";
                    } else if (Bridge.referenceEquals(previousOp, "-TAX")) {
                        previousValue = ExpressCraft.Helper.DeductTax(previousValue);
                        previousOp = "";
                    } else if (Bridge.referenceEquals(previousOp, "TAX")) {
                        previousValue = ExpressCraft.Helper.GetPortionTax(previousValue);
                        previousOp = "";
                    } else if (Bridge.referenceEquals(previousOp, "Dbl")) {
                        previousValue = previousValue.mul(System.Decimal(2));
                        previousOp = "";
                    } else if (Bridge.referenceEquals(previousOp, "sqrt")) {
                        try {
                            previousValue = System.Decimal(Math.sqrt(System.Decimal.toFloat(previousValue)), null, System.Double);
                        }
                        catch ($e3) {
                            $e3 = System.Exception.create($e3);
                            previousValue = System.Decimal(0);
                        }
                        previousOp = "";
                    } else if (Bridge.referenceEquals(previousOp, "1/x")) {
                        try {
                            previousValue = System.Decimal(1.0).div(previousValue);
                        }
                        catch ($e4) {
                            $e4 = System.Exception.create($e4);
                            previousValue = System.Decimal(0);
                        }

                        previousOp = "";
                    } else if (Bridge.referenceEquals(previousOp, "+/-")) {
                        previousValue = previousValue.neg();
                        previousOp = "";
                    }
                }
            }

            return previousValue;
        },
        RefreshValue: function () {
            if (this.DontRefresh) {
                return;
            }
            var builder = new System.Text.StringBuilder();

            var length = this._commands.Count;

            for (var i = 0; i < length; i = (i + 1) | 0) {
                builder.append(System.String.concat(this._commands.getItem(i), " "));
            }
            builder.append(this.current_command);
            this.DisplayInput.Text = "";
            this.DisplayInput.Text = builder.toString();
        },
        IsAllNumbers: function (value) {
            var x = { };
            return System.Decimal.tryParse(value, null, x);
        },
        Back: function (button) {
            if (!Bridge.referenceEquals(this.current_command, "")) {
                this.current_command = this.current_command.substr(0, ((this.current_command.length - 1) | 0));
            } else {
                if (this._commands.Count > 0) {
                    var x = System.Linq.Enumerable.from(this._commands).last();
                    if (this.IsAllNumbers(x)) {
                        this.current_command = x;
                        this.current_command = this.current_command.substr(0, ((this.current_command.length - 1) | 0));
                    } else {
                        this.current_command = "";
                    }
                    this._commands.removeAt(((this._commands.Count - 1) | 0));
                }
            }
            this.RefreshValue();
        },
        IsSingleOperator: function (x) {
            return (System.String.contains(x,"TAX") || Bridge.referenceEquals(x, "Dbl") || Bridge.referenceEquals(x, "1/x") || Bridge.referenceEquals(x, "+/-") || Bridge.referenceEquals(x, "sqrt"));
        },
        AddOperator: function (button) {
            if (this.IsSingleOperator(button.Text)) {
                if (this._commands.Count > 0) {
                    var x = System.Linq.Enumerable.from(this._commands).last();
                    if (!this.IsSingleOperator(x)) {
                        if (Bridge.referenceEquals(this.current_command, "") && !this.IsAllNumbers(x)) {
                            return;
                        }
                    }
                }

                if (!Bridge.referenceEquals(this.current_command, "")) {
                    this._commands.add(this.current_command);
                    this.current_command = "";
                }

                this._commands.add(button.Text);

                this.RefreshValue();
            } else {
                if (Bridge.referenceEquals(this.current_command, "")) {
                    if (Bridge.referenceEquals(button.Text, "=")) {
                        this.CalculateAndClose();
                        return;
                    } else {
                        if (this._commands.Count > 0) {
                            var x1 = System.Linq.Enumerable.from(this._commands).last();
                            if (!this.IsSingleOperator(x1)) {
                                return;
                            }
                        } else {
                            return;
                        }
                    }
                }

                if (Bridge.referenceEquals(button.Text, "%")) {
                    if (this._commands.Count > 0) {
                        var x2 = System.Linq.Enumerable.from(this._commands).last();

                        if (!this.IsSingleOperator(x2)) {
                            this.current_command = System.String.concat(this.current_command, "%");
                            this._commands.add(this.current_command);
                            this.current_command = "";
                        } else {
                            return;
                        }
                    }
                } else {
                    this._commands.add(this.current_command);
                    this.current_command = "";

                    if (Bridge.referenceEquals(button.Text, "=")) {
                        this.CalculateAndClose();
                    } else {
                        this._commands.add(button.Text);
                    }
                }
                this.RefreshValue();
            }
        }
    }
    });

    Bridge.ns("ExpressCraft.CalculatorControl", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.CalculatorControl, {
        f1: function (ev) {
            if (!Bridge.staticEquals(this.OnClose, null)) {
                this.OnClose();
            }
        },
        f2: function (ev) {
            this.current_command = "";
            this.RefreshValue();
        },
        f3: function (ev) {
            this._commands = new (System.Collections.Generic.List$1(System.String))();
            this.current_command = "";
            this.RefreshValue();
        }
    });

    Bridge.define("ExpressCraft.CheckEdit", {
        inherits: [ExpressCraft.Control],
        statics: {
            methods: {
                op_Implicit: function (checkEdit) {
                    return checkEdit.Edit;
                }
            }
        },
        fields: {
            Edit: null,
            span: null
        },
        props: {
            Checked: {
                get: function () {
                    return ExpressCraft.Helper.IsTrue(this.Edit.Text) === 1;
                },
                set: function (value) {
                    this.Edit.Text = System.Boolean.toString(value);
                }
            },
            Text: {
                get: function () {
                    return this.span.innerHTML;
                },
                set: function (value) {
                    this.span.innerHTML = value;
                }
            }
        },
        ctors: {
            ctor: function (label) {
                if (label === void 0) { label = ""; }

                this.$initialize();
                ExpressCraft.Control.ctor.call(this, ($t = document.createElement("label"), $t.className = ExpressCraft.Control.BaseClass(false, true), $t));
                var $t;
                this.Edit = new ExpressCraft.TextInput.$ctor1("checkbox");
                this.Edit.Controller = this;
                this.span = document.createElement("span");

                this.Text = label;

                ExpressCraft.Helper.AppendChildren$1(this.Content, [ExpressCraft.Control.op_Implicit(this.Edit), this.span]);
        }
    }
    });

    Bridge.define("ExpressCraft.TextInput", {
        inherits: [ExpressCraft.Control],
        statics: {
            methods: {
                FixInput: function (type) {
                    if (type === "date" || (ExpressCraft.Helper.IsFireFox() && type !== "password" && type !== "checkbox")) {
                        return "text";
                    } else {
                        return type;
                    }
                }
            }
        },
        fields: {
            prevText: null,
            OnTextChanged: null,
            OnKeyDown: null,
            OnKeyUp: null,
            OnKeyPress: null,
            OnGotFocus: null,
            OnLostFocus: null,
            OnValidateData: null,
            _displayFormat: null,
            Controller: null,
            Type: "button",
            DisableFocusPopup: false,
            IsOverride: false,
            PreZIndex: null,
            enabled: false,
            _readonly: false
        },
        props: {
            IsSubmit: false,
            GoNext: false,
            OnFocusDontSelectAll: false,
            DisplayFormat: {
                get: function () {
                    return this._displayFormat;
                },
                set: function (value) {
                    this.SetDisplayFormat(value);
                }
            },
            Text: {
                get: function () {
                    if (this.IsOverride) {
                        return this.GetValue();
                    } else {
                        if (this.Type === "checkbox") {
                            return System.Boolean.toString(this.Content.checked);
                        } else {
                            return this.Content.value;
                        }
                    }
                },
                set: function (value) {
                    if (this.IsOverride) {
                        this.SetValue(value);
                    } else {
                        if (this.Type === "checkbox") {
                            value = value.toLowerCase();
                            this.Content.checked = ExpressCraft.Helper.IsTrue(value) === 1;
                        } else {
                            this.Content.value = value;
                            this.formatText();
                        }
                    }

                    this.CheckTextChanged();
                }
            },
            Enabled: {
                get: function () {
                    return this.enabled;
                },
                set: function (value) {
                    this.enabled = value;
                    if (this.enabled) {
                        this.Content.removeAttribute("disabled");
                    } else {
                        this.Content.setAttribute("disabled", null);
                    }
                }
            },
            Readonly: {
                get: function () {
                    return this._readonly;
                },
                set: function (value) {
                    this._readonly = value;
                    if (this._readonly) {
                        this.Content.setAttribute("readonly", System.Boolean.toString((this._readonly)));
                    } else {
                        this.Content.removeAttribute("readonly");
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this.prevText = "";
                this._displayFormat = "";
                this.IsOverride = false;
                this.enabled = true;
                this._readonly = false;
            },
            ctor: function (overrideElement, addInputControl, addEventsOnControl) {
                if (addInputControl === void 0) { addInputControl = true; }
                if (addEventsOnControl === void 0) { addEventsOnControl = true; }

                this.$initialize();
                ExpressCraft.Control.ctor.call(this, overrideElement);
                overrideElement.className = System.String.concat((addInputControl ? "inputcontrol" : ""), ExpressCraft.Control.BaseClass(addInputControl));
                this.IsOverride = true;
                if (addEventsOnControl) {
                    this.addEvents();
                }
            },
            $ctor1: function (type, ac) {
                if (type === void 0) { type = 19; }
                if (ac === void 0) { ac = true; }

                this.$initialize();
                ExpressCraft.Control.$ctor3.call(this, "inputcontrol", ExpressCraft.TextInput.FixInput(type), ac);
                this.Type = type;

                if (this.Type === "number") {
                    this.Content.style.textAlign = "right";
                    this.Content.style.textIndent = "3px";
                    this.Content.style.paddingRight = "3px";

                    this.DisplayFormat = "n2";
                } else if (this.Type === "date") {
                    var str = System.Array.init(3, null, System.String);
                    str[System.Array.index(ExpressCraft.Settings.DayPosition, str)] = "dd";
                    str[System.Array.index(ExpressCraft.Settings.MonthPosition, str)] = "MM";
                    str[System.Array.index(ExpressCraft.Settings.YearPosition, str)] = "yyyy";
                    var builder = new System.Text.StringBuilder();

                    for (var i = 0; i < 3; i = (i + 1) | 0) {
                        builder.append(System.String.concat(str[System.Array.index(i, str)], String.fromCharCode(ExpressCraft.Settings.DateSeperator)));
                    }
                    builder.setLength((builder.getLength() - 1) | 0);
                    this.DisplayFormat = builder.toString();
                }

                this.addEvents();

                this.formatText();
            }
        },
        methods: {
            ValidateData: function () {
                if (Bridge.is(this, ExpressCraft.TextInputDropDown)) {
                    var c = this;
                    if (c.UsedEdit != null && !Bridge.staticEquals(c.OnValidateData, null)) {
                        c.OnValidateData(c.UsedEdit);
                    }
                }
                if (!Bridge.staticEquals(this.OnValidateData, null)) {
                    this.OnValidateData(this);
                }
            },
            SetDisplayFormat: function (value) {
                this._displayFormat = value;
                this.formatText();
            },
            GetDisplayFormat: function () {
                return this._displayFormat;
            },
            GetValue: function () {
                return this.Content.innerHTML;
            },
            SetValue: function (value) {
                this.Content.innerHTML = value;
            },
            SetDateTime: function (date) {
                this.SetDate(System.String.format(System.String.concat("{0:", this.GetDisplayFormat(), "}"), Bridge.box(date, System.DateTime, System.DateTime.format)));
            },
            OnFocus: function () { },
            GetInput: function () {
                if (Bridge.is(this.Content, HTMLInputElement)) {
                    return this.Content;
                } else {
                    return this.Content;
                }
            },
            GetNumberValue: function () {
                var value = ExpressCraft.Helper.StripNonNumberString(this.Text);
                return value;
            },
            GetEditValue: function () {
                if (Bridge.is(this, ExpressCraft.SearchInput)) {
                    var value = Bridge.cast(this, ExpressCraft.SearchInput).EditValue;
                    if (value == null) {
                        return Bridge.box(0, System.Int32);
                    }
                    return value;
                } else {
                    if (this.Type === "number") {
                        var value1 = ExpressCraft.Helper.StripNonNumberString(this.Text);
                        return value1;
                    } else if (this.Type === "date") {
                        var date = this.GetDateTime();
                        return Bridge.box(date, System.DateTime, System.DateTime.format);
                    } else {
                        return this.Text;
                    }
                }
            },
            Scroll: function (value, parent) {
                if (parent == null) {
                    return;
                }
                parent.scrollTop = value;
                //Global.SetTimeout(() =>
                //{
                //    if(this.Content.ParentElement == null || this.Content.ParentElement.ParentElement == null)
                //        return;
                //    this.Content.ParentElement.ParentElement.ScrollTop = value;
                //}, 0);
            },
            GetDisplayValue: function () {
                if (System.String.isNullOrWhiteSpace(this.DisplayFormat)) {
                    return this.Text;
                } else {
                    if (this.Type === "number") {
                        var value = ExpressCraft.Helper.StripNonNumberString(this.Text);
                        if (System.String.startsWith(this.DisplayFormat.toLowerCase(), "c")) {
                            var wasNeg = false;
                            if (value.lt(System.Decimal(0))) {
                                wasNeg = true;
                                value = value.neg();
                            }

                            return System.String.concat((wasNeg ? "-" : ""), System.String.format(System.String.concat("${0:", System.String.replaceAll(System.String.replaceAll(this.DisplayFormat, "c", "n"), "C", "N"), "}"), value));
                        } else if (System.String.startsWith(this.DisplayFormat.toLowerCase(), "p")) {
                            return System.String.format(System.String.concat("{0:", this.DisplayFormat, "}"), value.equalsT(System.Decimal(0)) ? System.Decimal(0) : value.div(System.Decimal(100.0)));
                        } else {
                            return System.String.format(System.String.concat("{0:", this.DisplayFormat, "}"), value);
                        }
                    } else if (this.Type === "date") {
                        var value1 = ExpressCraft.Helper.StripNonDateString(this.Text);
                        if (Bridge.equals(value1, System.DateTime.getMinValue())) {
                            return "";
                        } else {
                            return System.String.format(System.String.concat("{0:", this.DisplayFormat, "}"), Bridge.box(value1, System.DateTime, System.DateTime.format));
                        }
                    } else {
                        return System.String.format(System.String.concat("{0:", this.DisplayFormat, "}"), this.Text);
                    }
                }
            },
            formatText: function () {
                var input = this.GetInput();
                if (input != null && !Bridge.referenceEquals(input, document.activeElement)) {
                    if (!System.String.isNullOrWhiteSpace(this.DisplayFormat)) {
                        input.type = "text";
                        var newText = this.GetDisplayValue();

                        if (!Bridge.referenceEquals(newText, this.Text)) {
                            this.Text = newText;
                        }
                    }
                }
            },
            addEvents: function () {
                if (!this.IsOverride) {
                    var input = this.GetInput();
                    if (input != null) {
                        if (!System.String.isNullOrWhiteSpace(this.DisplayFormat)) {
                            if (this.Type === "password") {
                                return;
                            }
                            input.type = "text";
                        }
                    }
                }

                this.Content.onblur = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f1);
                this.Content.onfocus = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f2);
                this.Content.onchange = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f3);
                this.Content.oncontextmenu = $asm.$.ExpressCraft.TextInput.f4;
                this.Content.onkeypress = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f5);
                this.Content.onkeydown = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f6);
                this.Content.onkeyup = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f7);
                this.Content.addEventListener("paste", Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f8));
                this.Content.addEventListener("cut", Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInput.f8));
            },
            CheckTextChanged: function () {
                if (!Bridge.referenceEquals(this.Text, this.prevText)) {
                    if (!Bridge.staticEquals(this.OnTextChanged, null)) {
                        this.OnTextChanged(this);
                    }
                    this.prevText = this.Text;
                }
            },
            Render: function () {
                ExpressCraft.Control.prototype.Render.call(this);
                this.prevText = this.Text;
            },
            SetDate: function (date) {
                if (!System.String.isNullOrWhiteSpace(date)) {
                    var dd = ExpressCraft.Helper.StripNonDateString(date);
                    if (Bridge.equals(dd, System.DateTime.getMinValue())) {
                        this.Text = "";
                    } else {
                        this.Text = System.String.format(System.String.concat("{0:", this.DisplayFormat, "}"), Bridge.box(dd, System.DateTime, System.DateTime.format));
                    }
                } else {
                    this.Text = "";
                }
            },
            GetDate: function () {
                if (!System.String.isNullOrWhiteSpace(this.Text)) {
                    var dd = ExpressCraft.Helper.StripNonDateString(this.Text);
                    if (Bridge.equals(dd, System.DateTime.getMinValue())) {
                        return "";
                    } else {
                        return System.String.format(System.String.concat("{0:", this.DisplayFormat, "}"), Bridge.box(dd, System.DateTime, System.DateTime.format));
                    }
                } else {
                    return "";
                }
            },
            GetDateTime: function () {
                return ExpressCraft.Helper.StripNonDateString(this.Text);
            },
            IsNumericType: function () {
                return this.Type === "number";
            },
            IsDateType: function () {
                return this.Type === "date";
            }
        }
    });

    Bridge.ns("ExpressCraft.TextInput", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.TextInput, {
        f1: function (ev) {
            this.Content.style.zIndex = this.PreZIndex;

            this.formatText();

            if (!Bridge.staticEquals(this.OnLostFocus, null)) {
                this.OnLostFocus(this);
            }
        },
        f2: function (ev) {
            this.PreZIndex = this.Content.style.zIndex;
            this.Content.style.zIndex = "10000";

            this.OnFocus();
            var input1 = this.GetInput();
            if (input1 != null) {
                if (!System.String.isNullOrWhiteSpace(this.DisplayFormat)) {
                    if (this.Type === "number") {
                        try {
                            this.Text = ExpressCraft.Helper.StripNonNumberString(this.Text).toString();
                        }
                        catch ($e1) {
                            $e1 = System.Exception.create($e1);
                            this.Text = "0.00";
                        }
                    }

                    if (!ExpressCraft.Helper.IsFireFox() && !this.Readonly && this.Type !== "date") {
                        input1.type = this.Type;
                    }
                }
                if (this.Type !== "checkbox" && ExpressCraft.Settings.OnFocusSelectAll && !this.OnFocusDontSelectAll) {
                    input1.select();
                }
            }

            if (!Bridge.staticEquals(this.OnGotFocus, null)) {
                this.OnGotFocus(this);
            }

            if (!this.DisableFocusPopup && !this.Readonly && this.Enabled && ExpressCraft.Helper.NotDesktop && !(Bridge.is(this, ExpressCraft.TextInputDropDown)) && this.Controller == null) {
                if (!ExpressCraft.Settings.DisableTextPopupEditor) {
                    new ExpressCraft.TextForm(this).ShowPopup(new ExpressCraft.Vector2.$ctor1(0, 0));
                }
            }
        },
        f3: function (ev) {
            this.CheckTextChanged();
        },
        f4: function (ev) {
            ev.stopPropagation();
        },
        f5: function (ev) {
            this.CheckTextChanged();
            if (!Bridge.staticEquals(this.OnKeyPress, null)) {
                this.OnKeyPress(this, ev);
            }
        },
        f6: function (ev) {
            this.CheckTextChanged();
            if (!Bridge.staticEquals(this.OnKeyDown, null)) {
                this.OnKeyDown(this, ev);
            }
        },
        f7: function (ev) {
            this.CheckTextChanged();
            if (!Bridge.staticEquals(this.OnKeyUp, null)) {
                this.OnKeyUp(this, ev);
            }
        },
        f8: function () {
            this.CheckTextChanged();
        }
    });

    Bridge.define("ExpressCraft.ComboBoxEdit", {
        inherits: [ExpressCraft.Control],
        fields: {
            ComboBoxBase: null,
            previousSelectedIndex: 0,
            SelectedIndexChanged: null,
            enabled: false,
            _readonly: false
        },
        props: {
            Text: {
                get: function () {
                    if (this.ComboBoxBase.selectedIndex === -1) {
                        return "";
                    }
                    return this.ComboBoxBase.options[this.ComboBoxBase.selectedIndex].innerHTML;
                },
                set: function (value) {
                    for (var i = 0; i < this.ComboBoxBase.options.length; i = (i + 1) | 0) {
                        if (Bridge.referenceEquals(this.ComboBoxBase.options[i].innerHTML, value)) {
                            this.ComboBoxBase.selectedIndex = i;
                        }
                    }
                    this.ComboBoxBase.selectedIndex = -1;
                }
            },
            Value: {
                get: function () {
                    if (this.ComboBoxBase.selectedIndex === -1) {
                        return "";
                    }
                    return this.ComboBoxBase.options[this.ComboBoxBase.selectedIndex].value;
                },
                set: function (value) {
                    for (var i = 0; i < this.ComboBoxBase.options.length; i = (i + 1) | 0) {
                        if (Bridge.referenceEquals(this.ComboBoxBase.options[i].value, value)) {
                            this.ComboBoxBase.selectedIndex = i;
                        }
                    }
                    this.ComboBoxBase.selectedIndex = -1;
                }
            },
            Enabled: {
                get: function () {
                    return this.enabled;
                },
                set: function (value) {
                    this.enabled = value;
                    this.Content.setAttribute("disabled", System.Boolean.toString((!this.enabled)));
                }
            },
            Readonly: {
                get: function () {
                    return this._readonly;
                },
                set: function (value) {
                    this._readonly = value;
                    this.Content.setAttribute("readonly", System.Boolean.toString((this._readonly)));
                }
            }
        },
        ctors: {
            init: function () {
                this.previousSelectedIndex = -1;
                this.enabled = true;
                this._readonly = false;
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor4.call(this, "inputcontrol", ExpressCraft.ComboBoxTypes.Default);
                this.ComboBoxBase = Bridge.as(this.Content, HTMLSelectElement);

                this.Content.oncontextmenu = $asm.$.ExpressCraft.ComboBoxEdit.f1;

                this.ComboBoxBase.onchange = Bridge.fn.bind(this, $asm.$.ExpressCraft.ComboBoxEdit.f2);
            }
        },
        methods: {
            FillData: function (dataitems) {
                var $t;
                if (dataitems === void 0) { dataitems = []; }
                $(this.ComboBoxBase).empty();

                if (dataitems == null) {
                    for (var i = 0; i < dataitems.length; i = (i + 1) | 0) {
                        this.ComboBoxBase.appendChild(($t = document.createElement("option"), $t.innerHTML = dataitems[System.Array.index(i, dataitems)].Text, $t.value = dataitems[System.Array.index(i, dataitems)].Value, $t));
                    }
                }
            },
            Render: function () {
                ExpressCraft.Control.prototype.Render.call(this);
            }
        }
    });

    Bridge.ns("ExpressCraft.ComboBoxEdit", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.ComboBoxEdit, {
        f1: function (ev) {
            ev.stopPropagation();
        },
        f2: function (ev) {
            if (this.previousSelectedIndex !== this.ComboBoxBase.selectedIndex) {
                if (!Bridge.staticEquals(this.SelectedIndexChanged, null)) {
                    this.SelectedIndexChanged(this);
                }

                this.previousSelectedIndex = this.ComboBoxBase.selectedIndex;
            }
            ev.stopPropagation();
        }
    });

    Bridge.define("ExpressCraft.ContextMenu", {
        inherits: [ExpressCraft.Control],
        statics: {
            fields: {
                TotalContextHandles: 0,
                MainContextMenu: null
            },
            ctors: {
                init: function () {
                    this.TotalContextHandles = 0;
                }
            }
        },
        fields: {
            /**
             * For internal use only - so if we click on document - we can close all context menus ---
             *
             * @instance
             * @protected
             * @memberof ExpressCraft.ContextMenu
             * @type ExpressCraft.ContextMenu
             */
            SubContextOpened: null,
            ContextItems: null,
            Visible: false
        },
        ctors: {
            init: function () {
                this.ContextItems = new (System.Collections.Generic.List$1(ExpressCraft.ContextItem))();
                this.Visible = false;
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "contextmenu");
                this.Content.onmouseleave = Bridge.fn.bind(this, $asm.$.ExpressCraft.ContextMenu.f1);
            }
        },
        methods: {
            RenderContextMenu: function () {
                // What we need to do first is get the maxed size text...
                var x = 0;
                var ii = -1;

                ExpressCraft.Helper.Empty(this.Content);

                for (var i = 0; i < this.ContextItems.Count; i = (i + 1) | 0) {
                    var y = this.ContextItems.getItem(i).Caption.length;
                    if (y > x) {
                        x = y;
                        ii = i;
                    }
                }

                if (ii === -1) {
                    return;
                }
                var calwidth = Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(this.ContextItems.getItem(ii).Caption, ExpressCraft.Settings.DefaultFont));
                if (calwidth < ExpressCraft.Settings.ContextMenuMinWidth) {
                    calwidth = ExpressCraft.Settings.ContextMenuMinWidth;
                }
                var width = (((((((calwidth + 34) | 0) + 8) | 0) + 2) | 0));

                var top = 1;

                for (var i1 = 0; i1 < this.ContextItems.Count; i1 = (i1 + 1) | 0) {
                    var contextItem = { v : this.ContextItems.getItem(i1) };
                    var y1 = contextItem.v.Caption.length;
                    var item = ExpressCraft.Control.Label$1(contextItem.v.Caption, 1, top, ((width - 2) | 0), false, false, "contextitem");

                    item.onclick = (function ($me, contextItem) {
                        return Bridge.fn.bind($me, function (ev) {
                            if (contextItem.v.Enabled) {
                                if (!Bridge.staticEquals(contextItem.v.OnItemClick, null)) {
                                    contextItem.v.OnItemClick(contextItem.v);
                                }
                                this.Close();
                            }
                        });
                    })(this, contextItem);

                    this.Content.appendChild(item);

                    top = (top + 24) | 0;

                    if (this.ContextItems.getItem(i1).BeginGroup && i1 !== this.ContextItems.Count) {
                        top = (top + 1) | 0;
                        var sep = ExpressCraft.Control.Div$1("contextitemseperator");

                        sep.style.top = ExpressCraft.Helper.ToPx(Bridge.box(top, System.Int32));
                        sep.style.width = ExpressCraft.Helper.ToPx(Bridge.box(calwidth, System.Int32));

                        this.Content.appendChild(sep);

                        top = (top + 2) | 0;
                    }
                }

                top = (top + 1) | 0;

                ExpressCraft.Helper.SetSize$1(this.Content, width, top);
            },
            Show: function (Location) {
                if (ExpressCraft.ContextMenu.MainContextMenu != null) {
                    ExpressCraft.ContextMenu.MainContextMenu.Close();
                    ExpressCraft.ContextMenu.MainContextMenu = null;
                }
                ExpressCraft.ContextMenu.MainContextMenu = this;

                if (this.Visible) {
                    this.Close();
                }
                if (!this.Visible) {
                    ExpressCraft.Helper.SetLocation(this.Content, ((Location.Xi - 5) | 0), ((Location.Yi - 5) | 0));
                    this.RenderContextMenu();

                    ExpressCraft.ContextMenu.TotalContextHandles = (ExpressCraft.ContextMenu.TotalContextHandles + 1) | 0;
                    this.Content.style.zIndex = (((ExpressCraft.ContextMenu.TotalContextHandles + ExpressCraft.Settings.ContextMenuStartingZIndex) | 0)).toString();
                    document.body.appendChild(ExpressCraft.Control.op_Implicit(this));
                    this.Visible = true;
                }
            },
            Close: function () {
                if (this.Visible) {
                    ExpressCraft.ContextMenu.TotalContextHandles = (ExpressCraft.ContextMenu.TotalContextHandles - 1) | 0;
                    document.body.removeChild(ExpressCraft.Control.op_Implicit(this));
                    this.Visible = false;
                }

                if (this.SubContextOpened != null) {
                    this.SubContextOpened.Close();
                    this.SubContextOpened = null;
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.ContextMenu", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.ContextMenu, {
        f1: function (ev) {
            this.Close();
        }
    });

    Bridge.define("ExpressCraft.DataColumnBool", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Boolean)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Bool;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnByte", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Byte)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Byte;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnDateTime", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.DateTime)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.DateTime;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnDecimal", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Decimal)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Decimal;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnDouble", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Double)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Double;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnFloat", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Single)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Float;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnInteger", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Int32)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Integer;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnLong", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Int64)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Long;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnObject", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Object))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Object;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnShort", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.Nullable$1(System.Int16)))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.Short;
            }
        }
    });

    Bridge.define("ExpressCraft.DataColumnString", {
        inherits: [ExpressCraft.DataColumn],
        fields: {
            Cells: null
        },
        ctors: {
            init: function () {
                this.Cells = new (System.Collections.Generic.List$1(System.String))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.DataColumn.ctor.call(this);
                this.DataType = ExpressCraft.DataType.String;
            }
        }
    });

    Bridge.define("ExpressCraft.DateControl", {
        inherits: [ExpressCraft.Control],
        statics: {
            fields: {
                Days: null
            },
            ctors: {
                init: function () {
                    this.Days = System.Array.init(["MO", "TU", "WE", "TH", "FR", "SA", "SU"], System.String);
                }
            }
        },
        fields: {
            btnTop: null,
            btnSelectedRange: null,
            btnToday: null,
            btnLeft: null,
            btnRight: null,
            ContentRange: null,
            SelectedYear: 0,
            SelectedMonth: 0,
            SelectedDay: 0,
            _activeDisplayMode: 0,
            OnDateChanged: null,
            OnRequestToClose: null
        },
        props: {
            ActiveDisplayMode: {
                get: function () {
                    return this._activeDisplayMode;
                },
                set: function (value) {
                    if (this._activeDisplayMode !== value) {
                        this._activeDisplayMode = value;
                        this.RefreshView();
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this._activeDisplayMode = ExpressCraft.DateControl.DisplayMode.Day;
            },
            ctor: function (startDate) {
                this.$initialize();
                ExpressCraft.Control.$ctor1.call(this);
                var $t;
                this.Size = new ExpressCraft.Vector2.$ctor1(230, 245);

                var doc = document.createDocumentFragment();

                this.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                this.btnTop = new ExpressCraft.SimpleButton();
                this.btnTop.Style.transform = "translate(-50%, 0)";
                this.btnTop.Style.left = "50%";
                this.btnTop.Style.marginRight = "50%";
                this.btnTop.Top = 6;
                this.btnTop.Width = "auto";
                this.btnTop.Style.borderColor = "transparent";
                this.btnTop.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                this.btnSelectedRange = ($t = new ExpressCraft.SimpleButton(), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.DateControl.f1), $t);

                this.btnSelectedRange.Style.transform = "translate(-50%, 0)";
                this.btnSelectedRange.Style.left = "50%";
                this.btnSelectedRange.Style.marginRight = "50%";
                this.btnSelectedRange.Top = 30;
                this.btnSelectedRange.Width = "auto";
                this.btnSelectedRange.Style.borderColor = "transparent";
                this.btnSelectedRange.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                this.btnLeft = ($t = new ExpressCraft.SimpleButton(), $t.Text = "<", $t.Location = new ExpressCraft.Vector2.$ctor1(14, 36), $t.Size = new ExpressCraft.Vector2.$ctor1(13, 13), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.DateControl.f2), $t);
                this.btnLeft.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                this.btnRight = ($t = new ExpressCraft.SimpleButton(), $t.Text = ">", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 26px)", 36), $t.Size = new ExpressCraft.Vector2.$ctor1(13, 13), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.DateControl.f3), $t);
                this.btnRight.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                this.btnLeft.Style.borderRadius = "50%";
                this.btnRight.Style.borderRadius = "50%";

                this.btnLeft.Style.lineHeight = "0";
                this.btnRight.Style.lineHeight = "0";

                if (ExpressCraft.Helper.NotDesktop) {
                    this.btnSelectedRange.Style.fontSize = "14px";
                    this.btnSelectedRange.Height = 36;
                    this.btnSelectedRange.Top = 42;

                    this.btnTop.Style.fontSize = "14px";
                    this.btnTop.Height = 36;

                    this.btnLeft.Size = new ExpressCraft.Vector2.$ctor1(36, 36);
                    this.btnLeft.Style.fontSize = "14px";
                    this.btnLeft.Top = 20;

                    this.btnRight.Size = new ExpressCraft.Vector2.$ctor1(36, 36);
                    this.btnRight.Style.fontSize = "14px";
                    this.btnRight.Top = 20;
                    this.btnRight.Left = "(100% - 50px)";

                    this.ContentRange = ($t = new ExpressCraft.Control.$ctor1(), $t.Size = new ExpressCraft.Vector2.$ctor1("(100% - 20px)", "(100% - 147px)"), $t.Location = new ExpressCraft.Vector2.$ctor1(11, 90), $t);
                } else {
                    this.ContentRange = ($t = new ExpressCraft.Control.$ctor1(), $t.Size = new ExpressCraft.Vector2.$ctor1("(100% - 20px)", "(100% - 92px)"), $t.Location = new ExpressCraft.Vector2.$ctor1(11, 60), $t);
                }

                this.ContentRange.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                this.btnToday = ($t = new ExpressCraft.SimpleButton(), $t.Text = "Today", $t.Width = 50, $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.DateControl.f4), $t);

                this.btnToday.Style.transform = "translate(-50%, 0)";
                this.btnToday.Style.left = "50%";
                this.btnToday.Style.marginRight = "50%";

                if (ExpressCraft.Helper.NotDesktop) {
                    this.btnToday.Top = "(100% - 51px)";
                    this.btnToday.Style.fontSize = "14px";
                    this.btnToday.Height = 45;
                    this.btnToday.Style.minWidth = "60px";
                    this.btnToday.Width = "(100% * 0.1428)";
                } else {
                    this.btnToday.Top = "(100% - 26px)";
                }

                this.btnToday.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                ExpressCraft.Helper.AppendChildren$2(doc, [this.btnTop, this.btnLeft, this.btnSelectedRange, this.btnRight, this.ContentRange, this.btnToday]);
                if (Bridge.equals(startDate, System.DateTime.getMinValue())) {
                    startDate = System.DateTime.getToday();
                }

                this.Content.appendChild(doc);

                this.SetViewDateTime(startDate);
        }
    },
    methods: {
        GetViewDateTime: function () {
            return System.DateTime.create(this.SelectedYear, this.SelectedMonth, this.SelectedDay);
        },
        SetViewDateTime: function (date) {
            var newSelectedYear = System.DateTime.getYear(date);
            var newSelectedMonth = System.DateTime.getMonth(date);
            var newSelectedDay = System.DateTime.getDay(date);

            if (newSelectedYear !== this.SelectedYear || newSelectedMonth !== this.SelectedMonth || newSelectedDay !== this.SelectedDay || Bridge.equals(date, System.DateTime.getToday())) {
                this.SelectedYear = newSelectedYear;
                this.SelectedMonth = newSelectedMonth;
                this.SelectedDay = newSelectedDay;

                if (!Bridge.staticEquals(this.OnDateChanged, null)) {
                    this.OnDateChanged(date);
                }

                this.RefreshView();
            }
        },
        RefreshView: function () {
            var $t;
            var date = this.GetViewDateTime();
            this.btnTop.Text = System.DateTime.format(date, "ddd, dd MMM yyyy");

            var doc = document.createDocumentFragment();

            switch (this._activeDisplayMode) {
                case ExpressCraft.DateControl.DisplayMode.Day: 
                    this.btnSelectedRange.Text = System.DateTime.format(date, "MMM yyyy");
                    var startDate = System.DateTime.create(System.DateTime.getYear(date), System.DateTime.getMonth(date), 1);
                    var endDate = System.DateTime.addDays(System.DateTime.addMonths(startDate, 1), -1);
                    var TotalDays = (System.DateTime.subdd(endDate, startDate)).getDays();
                    var startDayIndex = ((System.DateTime.getDayOfWeek(startDate) === System.DayOfWeek.Sunday ? 7 : System.DateTime.getDayOfWeek(startDate)) - 1) | 0;
                    var offsetStart = 0;
                    var row = 1;
                    var startOutside = startDayIndex === 0 ? startDate : System.DateTime.addDays(startDate, ((-startDayIndex) | 0));
                    var endDayIndex = ((System.DateTime.getDayOfWeek(endDate) === System.DayOfWeek.Sunday ? 7 : System.DateTime.getDayOfWeek(endDate)) - 1) | 0;
                    for (var i = 0; i < 42; i = (i + 1) | 0) {
                        var curDate = { v : startOutside };

                        var btn = ($t = new ExpressCraft.SimpleButton(), $t.Text = System.DateTime.getDay(curDate.v).toString(), $t.Bounds = new ExpressCraft.Vector4.$ctor1("(100% * " + System.Double.format((offsetStart * 0.1428)) + ")", "(((100% - " + (ExpressCraft.Helper.NotDesktop ? 29 : 16) + "px) * " + System.Double.format(((((row - 1) | 0)) * 0.1666)) + ") + " + (ExpressCraft.Helper.NotDesktop ? 29 : 16) + "px)", "(100% * 0.1428)", "((100% - " + (ExpressCraft.Helper.NotDesktop ? 29 : 16) + "px) * " + System.Double.format(0.1666) + ")"), $t.ItemClick = (function ($me, curDate) {
                            return Bridge.fn.bind($me, function (ev) {
                                if (Bridge.equals(this.GetViewDateTime(), curDate.v)) {
                                    if (!Bridge.staticEquals(this.OnRequestToClose, null)) {
                                        this.OnRequestToClose();
                                    }
                                }
                                this.SetViewDateTime(curDate.v);
                            });
                        })(this, curDate), $t);
                        if (ExpressCraft.Helper.NotDesktop) {
                            btn.Style.fontSize = "14px";
                            btn.Style.fontWeight = "bold";
                        }
                        if (Bridge.equals(curDate.v, date)) {
                            btn.ClassList.add("simplebutton-active");
                        }
                        btn.Style.borderColor = "transparent";

                        if (System.DateTime.lt(curDate.v, startDate) || System.DateTime.gt(curDate.v, endDate)) {
                            //btn.Style.Color = "rgb(211, 211, 211)";
                        } else if (System.DateTime.getDayOfWeek(curDate.v) === System.DayOfWeek.Saturday || System.DateTime.getDayOfWeek(curDate.v) === System.DayOfWeek.Sunday) {
                            btn.Style.color = "rgb(191, 11, 11)";
                            btn.Style.filter = "brightness(110%)";
                        } else {
                            btn.Style.filter = "brightness(110%)";
                        }
                        btn.Content.onkeydown = Bridge.fn.cacheBind(this, this.BlockTabEvent);

                        doc.appendChild(ExpressCraft.Control.op_Implicit(btn));

                        offsetStart = (offsetStart + 1) | 0;

                        if (offsetStart > 6) {
                            row = (row + 1) | 0;
                            offsetStart = 0;
                        }

                        startOutside = System.DateTime.addDays(System.DateTime.getDate(startOutside), 1);
                        if (System.DateTime.getHour(startOutside) === 23) {
                            startOutside = System.DateTime.addHours(startOutside, 1);
                        }
                    }
                    for (var x = 0; x < 7; x = (x + 1) | 0) {
                        var label = ExpressCraft.Control.Label(ExpressCraft.DateControl.Days[System.Array.index(x, ExpressCraft.DateControl.Days)], 0, 0);
                        ExpressCraft.Helper.SetLocation(label, "(100% * " + System.Double.format((x * 0.1428)) + " + ((100% * 0.1428) * 0.45) - 6px)", 0);
                        //Bounds = new Vector4("(100% * " + (offsetStart * 0.1428) + ")", "((100% * " + (row * 0.1666) + ") + (100% * 0.1666))", "(100% * 0.1428)", "((100% * " + 0.1666 + ") + (100% * 0.1666))"), //  offsetStart * 30,  (22 * row) - 6, 30, 22
                        if (ExpressCraft.Helper.NotDesktop) {
                            label.style.fontSize = "14px";
                        }

                        doc.appendChild(label);
                    }
                    break;
                case ExpressCraft.DateControl.DisplayMode.Month: 
                    break;
                case ExpressCraft.DateControl.DisplayMode.Year: 
                    break;
                default: 
                    break;
            }

            ExpressCraft.Helper.Empty(this.ContentRange.Content); // empty and re-create
            this.ContentRange.Content.appendChild(doc);
        },
        BlockTabEvent: function (ev) {
            if (ev.keyCode === 9) {
                if (!Bridge.staticEquals(this.OnRequestToClose, null)) {
                    this.OnRequestToClose();
                }
                ev.preventDefault();
            }
        },
        MoveLeft: function () {
            this.MoveLeftOrRight(-1);
        },
        MoveUp: function () {
            return;
        },
        MoveLeftOrRight: function (timesValue) {
            var date = this.GetViewDateTime();

            switch (this._activeDisplayMode) {
                default: 
                case ExpressCraft.DateControl.DisplayMode.Day: 
                    date = System.DateTime.addMonths(date, (Bridge.Int.mul(1, timesValue)));
                    break;
                case ExpressCraft.DateControl.DisplayMode.Month: 
                    date = System.DateTime.addMonths(date, (Bridge.Int.mul(12, timesValue)));
                    break;
                case ExpressCraft.DateControl.DisplayMode.Year: 
                    date = System.DateTime.addYears(date, (Bridge.Int.mul(120, timesValue)));
                    break;
            }

            this.SetViewDateTime(date);
        },
        MoveRight: function () {
            this.MoveLeftOrRight(1);
        }
    }
    });

    Bridge.ns("ExpressCraft.DateControl", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.DateControl, {
        f1: function (ev) {
            this.MoveUp();
        },
        f2: function (ev) {
            this.MoveLeft();
        },
        f3: function (ev) {
            this.MoveRight();
        },
        f4: function (ev) {
            this.ActiveDisplayMode = ExpressCraft.DateControl.DisplayMode.Day;
            this.SetViewDateTime(System.DateTime.getToday());

            if (!Bridge.staticEquals(this.OnDateChanged, null)) {
                this.OnDateChanged(System.DateTime.getToday());
            }

            if (Bridge.equals(this.GetViewDateTime(), System.DateTime.getToday())) {
                if (!Bridge.staticEquals(this.OnRequestToClose, null)) {
                    this.OnRequestToClose();
                }
            }
        }
    });

    Bridge.define("ExpressCraft.GridLookupEdit", {
        inherits: [ExpressCraft.Control],
        fields: {
            gridView: null,
            FieldName: null,
            DisplayName: null,
            Visible: false
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor4.call(this, "inputcontrol", ExpressCraft.ComboBoxTypes.Default);
                var $t;
                this.gridView = ($t = new ExpressCraft.GridView(true, true), $t.Size = new ExpressCraft.Vector2.$ctor1(250, 400), $t);
                this.gridView.ContextMenu = null;
                this.gridView.OnFocusedRowChanged = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridLookupEdit.f1);

                this.gridView.Content.onmouseleave = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridLookupEdit.f2);
                this.Content.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridLookupEdit.f3);
        }
    },
    methods: {
        ShowPopup: function () {
            if (this.Visible) {
                return;
            }
            var x = this.Content.getBoundingClientRect();
            this.gridView.Location = new ExpressCraft.Vector2.$ctor1(x.left, x.top + x.height);

            ExpressCraft.ContextMenu.TotalContextHandles = (ExpressCraft.ContextMenu.TotalContextHandles + 1) | 0;
            this.Content.parentElement.appendChild(ExpressCraft.Control.op_Implicit(this.gridView));

            this.gridView.RenderGrid();

            this.gridView.Content.style.zIndex = (((ExpressCraft.ContextMenu.TotalContextHandles + ExpressCraft.Settings.ContextMenuStartingZIndex) | 0)).toString();
            this.Visible = true;
        },
        ClosePopup: function () {
            if (this.Visible) {
                this.gridView.Content.parentElement.removeChild(ExpressCraft.Control.op_Implicit(this.gridView));
                ExpressCraft.ContextMenu.TotalContextHandles = (ExpressCraft.ContextMenu.TotalContextHandles - 1) | 0;
                this.Visible = false;
            }
        }
    }
    });

    Bridge.ns("ExpressCraft.GridLookupEdit", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.GridLookupEdit, {
        f1: function (rowHandle, PrevRowhandle) {
            var $t1;
            ExpressCraft.Helper.Empty(this.Content);

            if (rowHandle > -1) {
                this.Content.appendChild(($t1 = document.createElement("option"), $t1.innerHTML = (Bridge.as(this.gridView.GetRowCellValue$3(rowHandle, this.DisplayName), System.String)), $t1.value = (Bridge.as(this.gridView.GetRowCellValue$3(rowHandle, this.FieldName), System.String)), $t1));
            }
            if (this.Visible) {
                this.ClosePopup();
            }
        },
        f2: function (ev) {
            this.ClosePopup();
        },
        f3: function (ev) {
            ev.preventDefault();
            ev.stopImmediatePropagation();
            if (this.Visible) {
                this.ClosePopup();
            } else {
                this.ShowPopup();
            }
        }
    });

    Bridge.define("ExpressCraft.GridView", {
        inherits: [ExpressCraft.Control],
        fields: {
            GridHeader: null,
            GridHeaderContainer: null,
            GridBodyContainer: null,
            GridBody: null,
            BottonOfTable: null,
            RightOfTable: null,
            RightOfTableHeader: null,
            _dataSource: null,
            OnFocusedRowChanged: null,
            OnRowDoubleClick: null,
            OnCustomRowStyle: null,
            OnRowClick: null,
            OnDoubleClick: null,
            OnCellRowMouseDown: null,
            SelectedRows: null,
            VisibleRowHandles: null,
            _allowRowDrag: false,
            AutoGenerateColumnsFromSource: false,
            AllowMultiSelection: false,
            showAutoFilterRow: false,
            UnitHeight: 0,
            _columnAutoWidth: false,
            _focusedcolumn: 0,
            _focusedDataHandle: 0,
            _columnHeadersVisible: false,
            _useEditForm: false,
            SortSettings: null,
            Columns: null,
            PrevRenderGridScrollId: 0,
            clickTimeDiff: null,
            headingClass: null,
            cellClass: null,
            CacheRow: null,
            CountOfDeletion: 0,
            DragIndex: 0,
            ResizeIndex: 0,
            ResizePageX: 0,
            ResizeSpan: null,
            OnColumnOnClick: null,
            OnColumnDragStart: null,
            OnColumnDragOver: null,
            OnColumnDrop: null,
            OnColumnMouseDown: null,
            OnColumnMouseMove: null,
            OnColumnMouseLeave: null,
            OnRowDragStart: null,
            lastId: 0,
            PrevScroll: 0,
            FilterRowOnChange: null,
            RenderTime: 0,
            renderGridInternal: null,
            _disableRender: false
        },
        props: {
            AllowRowDrag: {
                get: function () {
                    return this._allowRowDrag;
                },
                set: function (value) {
                    if (this._allowRowDrag !== value) {
                        this._allowRowDrag = value;
                        this.RenderGrid();
                    }
                }
            },
            ShowAutoFilterRow: {
                get: function () {
                    return this.showAutoFilterRow;
                },
                set: function (value) {
                    if (this.showAutoFilterRow !== value) {
                        this.showAutoFilterRow = value;
                        if (!this.showAutoFilterRow) {
                            // Remove Filter.
                            for (var i = 0; i < this.ColumnCount(); i = (i + 1) | 0) {
                                //FilterEdit = null;
                                this.Columns.getItem(i).FilterEdit = null;
                                this.Columns.getItem(i).FilterValue = null;
                            }
                            this.CalculateVisibleRows();
                        }
                        this.RenderGrid();
                    }
                }
            },
            FocusedColumn: {
                get: function () {
                    return this._focusedcolumn;
                },
                set: function (value) {
                    if (value !== this.FocusedColumn) {
                        var prev = this._focusedcolumn;
                        this._focusedcolumn = value;
                        //RenderGrid();
                    }
                }
            },
            FocusedDataHandle: {
                get: function () {
                    return this._focusedDataHandle;
                },
                set: function (value) {
                    if (value !== this._focusedDataHandle) {
                        var prev = this._focusedDataHandle;
                        this._focusedDataHandle = value;
                        this.RenderGrid();
                        if (!Bridge.staticEquals(this.OnFocusedRowChanged, null)) {
                            this.OnFocusedRowChanged(this._focusedDataHandle, prev);
                        }
                    }
                }
            },
            ColumnHeadersVisible: {
                get: function () {
                    return this._columnHeadersVisible;
                },
                set: function (value) {
                    if (value !== this._columnHeadersVisible) {
                        this._columnHeadersVisible = value;

                        this.SetDefaultSizes();

                        this.RenderGrid();
                    }
                }
            },
            ColumnAutoWidth: {
                get: function () {
                    return this._columnAutoWidth;
                },
                set: function (value) {
                    if (value) {
                        this.GridBodyContainer.style.overflowX = "hidden";
                    } else {
                        this.GridBodyContainer.style.overflowX = "auto";
                    }

                    if (this._columnAutoWidth !== value) {
                        this._columnAutoWidth = value;
                        this.RenderGrid();
                    }
                }
            },
            UseEditForm: {
                get: function () {
                    return this._useEditForm;
                },
                set: function (value) {
                    if (value !== this._useEditForm) {
                        this._useEditForm = value;
                        this.RenderGrid();
                    }
                }
            },
            DataSource: {
                get: function () {
                    return this._dataSource;
                },
                set: function (value) {
                    this.FocusedDataHandle = -1;
                    this.SelectedRows = new (ExpressCraft.HardSoftList$1(System.Boolean))(false);
                    this.VisibleRowHandles = new (System.Collections.Generic.List$1(System.Int32))();

                    if (this._dataSource != null) {
                        this._dataSource.removeOnDataSourceChanged(Bridge.fn.cacheBind(this, this.DataSource_OnDataSourceChanged));
                    }

                    this._dataSource = value;

                    if (this._dataSource != null) {
                        this._dataSource.addOnDataSourceChanged(Bridge.fn.cacheBind(this, this.DataSource_OnDataSourceChanged));

                        if (this.Columns.Count === 0 && this.AutoGenerateColumnsFromSource) {
                            var sw = System.Diagnostics.Stopwatch.startNew();

                            for (var i = 0; i < this._dataSource.ColumnCount; i = (i + 1) | 0) {
                                var sw1 = System.Diagnostics.Stopwatch.startNew();

                                var gvc = new ExpressCraft.GridViewColumn(this);
                                gvc.Caption = this._dataSource.Columns.getItem(i).FieldName;
                                gvc.Column = this._dataSource.Columns.getItem(i);
                                gvc.Visible = true;

                                switch (this._dataSource.Columns.getItem(i).DataType) {
                                    case ExpressCraft.DataType.Byte: 
                                    case ExpressCraft.DataType.Short: 
                                    case ExpressCraft.DataType.Integer: 
                                    case ExpressCraft.DataType.Long: 
                                    case ExpressCraft.DataType.Float: 
                                    case ExpressCraft.DataType.Double: 
                                    case ExpressCraft.DataType.Decimal: 
                                        gvc.BodyApparence.Alignment = "right";
                                        break;
                                    case ExpressCraft.DataType.DateTime: 
                                        if (ExpressCraft.Settings.GridViewAutoColumnFormatDates) {
                                            if (ExpressCraft.Settings.GridViewAutoColumnGenerateFormatAsDate) {
                                                gvc.FormatString = "{0:d}";
                                            } else {
                                                gvc.FormatString = "{0:yyyy-MM-dd}";
                                            }
                                        }
                                        break;
                                    case ExpressCraft.DataType.Bool: 
                                        gvc.CellDisplay = new ExpressCraft.GridViewCellDisplayCheckBox();
                                        break;
                                }

                                this.Columns.add(gvc);

                                sw.stop();
                                System.Console.WriteLine("DataSource AddColumn Auto: " + sw1.milliseconds());
                            }

                            sw.stop();
                            System.Console.WriteLine("DataSource AutoColumns: " + sw.milliseconds());
                        }
                        this.RenderGrid();
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this.SelectedRows = new (ExpressCraft.HardSoftList$1(System.Boolean))(false);
                this._allowRowDrag = false;
                this.AutoGenerateColumnsFromSource = true;
                this.AllowMultiSelection = true;
                this.showAutoFilterRow = false;
                this.UnitHeight = 28.0;
                this._columnAutoWidth = false;
                this._focusedcolumn = -1;
                this._focusedDataHandle = -1;
                this._columnHeadersVisible = true;
                this._useEditForm = true;
                this.Columns = new (System.Collections.Generic.List$1(ExpressCraft.GridViewColumn))();
                this.PrevRenderGridScrollId = -1;
                this.CacheRow = new (System.Collections.Generic.Dictionary$2(System.Int32,HTMLDivElement))();
                this.CountOfDeletion = 0;
                this.DragIndex = -1;
                this.ResizeIndex = -1;
                this.ResizePageX = 0;
                this.lastId = -1;
                this.PrevScroll = -1;
                this.RenderTime = -1;
                this._disableRender = false;
            },
            ctor: function (autoGenerateColumns, columnAutoWidth) {
                if (autoGenerateColumns === void 0) { autoGenerateColumns = true; }
                if (columnAutoWidth === void 0) { columnAutoWidth = false; }

                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "grid");
                if (ExpressCraft.Helper.NotDesktop) {
                    this.UnitHeight = 53;
                    this.headingClass = "heading heading-responsive";

                    this.cellClass = "cell cell-responsive";
                } else {
                    this.UnitHeight = 20;
                    this.headingClass = "heading";
                    this.cellClass = "cell";
                }

                this.Content.style.overflow = "hidden";

                this.renderGridInternal = Bridge.fn.bind(this, function () {
                    if (this._disableRender) {
                        return;
                    }

                    var StartedWith = this.RenderTime;

                    this.GridHeaderContainer.scrollLeft = this.GridBodyContainer.scrollLeft;
                    if (ExpressCraft.Settings.GridViewBlurOnScroll) {
                        this.ProcessBlur();
                    }

                    this.ValidateGridSize();

                    if (this.ColumnCount() === 0) {
                        this.ClearGrid();
                        return;
                    }

                    var RawLeftCellIndex = 0;
                    var RawLeftCellScrollPadding = 0;

                    var RawLeftCellCount = this.Columns.Count;

                    var LeftLocation = 0;
                    var foundLeftLocation = false;
                    var foundRightLocation = false;

                    var ClientWidth = this.GridBodyContainer.clientWidth;


                    var ViewWidth = (this.GridBodyContainer.scrollLeft + ClientWidth) | 0;
                    var _columnAutoWidthSingle = 0.0;

                    if (this._columnAutoWidth) {
                        _columnAutoWidthSingle = ClientWidth === 0 ? 0.0 : ((Bridge.Int.div(ClientWidth, this.GetVisibleCount())) | 0);
                    }

                    var MaxWidth;
                    var LastWidth;

                    for (var x = 0; x < this.Columns.Count; x = (x + 1) | 0) {
                        if (!this.Columns.getItem(x).Visible) {
                            continue;
                        }

                        this.Columns.getItem(x).CachedX = LeftLocation;
                        LastWidth = this._columnAutoWidth ? _columnAutoWidthSingle : this.Columns.getItem(x).Width;
                        LeftLocation += LastWidth;
                        if (!foundLeftLocation && LeftLocation >= this.GridBodyContainer.scrollLeft) {
                            foundLeftLocation = true;
                            RawLeftCellIndex = x;
                            RawLeftCellScrollPadding = LeftLocation - this.GridBodyContainer.scrollLeft;
                        }
                        if (foundLeftLocation && !foundRightLocation && LeftLocation >= ViewWidth) {
                            foundRightLocation = true;
                            RawLeftCellCount = (x + 1) | 0;
                            break;
                        }
                        if (StartedWith !== this.RenderTime) {
                            return;
                        }
                    }

                    MaxWidth = LeftLocation;

                    var colFragment = document.createDocumentFragment();

                    var uboundRowCount = (RawLeftCellCount - 1) | 0;

                    if (this._columnHeadersVisible) {
                        for (var x1 = RawLeftCellIndex; x1 < RawLeftCellCount; x1 = (x1 + 1) | 0) {
                            if (x1 >= this.Columns.Count) {
                                break;
                            }
                            if (!this.Columns.getItem(x1).Visible) {
                                continue;
                            }

                            var gcol = this.Columns.getItem(x1);
                            var colIndex = x1;
                            var apparence = gcol.HeadingApparence;

                            var col = ExpressCraft.Control.Label$3(gcol.Caption, (this._columnAutoWidth ? gcol.CachedX : gcol.CachedX), 0, (this._columnAutoWidth ? _columnAutoWidthSingle : gcol.Width) - (x1 === uboundRowCount ? 0 : 1), apparence.IsBold, false, this.headingClass, apparence.Alignment, apparence.Forecolor);
                            if (gcol.SortedMode !== ExpressCraft.GridViewSortMode.None) {
                                var sortImage = ExpressCraft.Control.Div$1(gcol.SortedMode === ExpressCraft.GridViewSortMode.Asc ? "grid-sort-up" : "grid-sort-down");
                                ExpressCraft.Helper.SetBounds$1(sortImage, "(100% - 13px)", 11, 9, 5);
                                col.appendChild(sortImage);
                            }

                            this.SetupColumn(col, x1, gcol);

                            colFragment.appendChild(col);

                            if (StartedWith !== this.RenderTime) {
                                return;
                            }
                        }
                    }


                    if (this._dataSource == null || this._dataSource.RowCount === 0 || this._dataSource.ColumnCount === 0) {
                        this.ClearGrid();
                        this.GridHeader.appendChild(colFragment);
                        return;
                    }

                    var ppr = this.PixelsPerRow(this._dataSource.RowCount);

                    var RawTopRowIndex = this.GetRawTopRowIndex();
                    var RawTopRowScrollPadding = RawTopRowIndex % 1.0;
                    var RawVisibleRowCount = this.GetRawVisibleRowCount();

                    var Length = (Bridge.Int.clip32((RawVisibleRowCount + RawTopRowIndex)) + 1) | 0;
                    var start = Bridge.Int.clip32(RawTopRowIndex);


                    for (var x2 = (this.SelectedRows.SL.Count - 1) | 0; x2 >= 0; x2 = (x2 - 1) | 0) {
                        var Found = false;
                        for (var i = start; i < Length; i = (i + 1) | 0) {
                            if (i < this.DataSource.RowCount) {
                                var DataRowhandle = this.GetDataSourceRow(i);
                                if (this.SelectedRows.GetIndexValueByHardListIndex(this.SelectedRows.SL.getItem(x2)).Index === DataRowhandle) {
                                    Found = true;
                                    break;
                                }
                            }
                            if (StartedWith !== this.RenderTime) {
                                return;
                            }
                        }
                        if (StartedWith !== this.RenderTime) {
                            return;
                        }
                        if (!Found) {
                            this.SelectedRows.SL.removeAt(x2);
                        }
                    }


                    var rowFragment = document.createDocumentFragment();

                    if (ExpressCraft.Settings.GridViewRowScrollPadding > 0) {
                        start = (start - ExpressCraft.Settings.GridViewRowScrollPadding) | 0;
                        Length = (Length + ExpressCraft.Settings.GridViewRowScrollPadding) | 0;
                    }

                    var Y = (start * (ppr)) - RawTopRowScrollPadding;

                    if (this.ShowAutoFilterRow) {
                        Length = (Length - 1) | 0;
                        Y += this.UnitHeight;
                    }

                    // #TODO - CLEAN...
                    if (start < 0) {
                        start = 0;
                    }
                    if (Length > this.DataSource.RowCount) {
                        Length = this.DataSource.RowCount;
                    }

                    if (this.CacheRow.count > 10) {
                        if (this.CountOfDeletion > 8) {
                            this.CacheRow = new (System.Collections.Generic.Dictionary$2(System.Int32,HTMLDivElement))();
                            this.CountOfDeletion = 0;
                        } else {
                            var MaxDelete = (this.CacheRow.count - 10) | 0;
                            var __length = this.CacheRow.count;
                            var KeysToDelete = new (System.Collections.Generic.List$1(System.Int32))();
                            for (var i1 = 0; i1 < __length; i1 = (i1 + 1) | 0) {
                                var fieldIndex = System.Linq.Enumerable.from(this.CacheRow).elementAt(i1).key;
                                if (fieldIndex < start || fieldIndex >= Length) {
                                    KeysToDelete.add(System.Linq.Enumerable.from(this.CacheRow).elementAt(i1).key);
                                    if (KeysToDelete.Count > MaxDelete) {
                                        break;
                                    }
                                }
                            }
                            __length = KeysToDelete.Count;
                            if (__length > 0) {
                                this.CountOfDeletion = (this.CountOfDeletion + 1) | 0;
                            }
                            for (var i2 = 0; i2 < __length; i2 = (i2 + 1) | 0) {
                                var x3 = this.CacheRow.get(KeysToDelete.getItem(i2));
                                x3.onclick = null;
                                x3.ondblclick = null;
                                ExpressCraft.Helper.Empty(x3);
                                x3.ondragstart = null;
                                ExpressCraft.Helper.Delete(x3);

                                this.CacheRow.remove(KeysToDelete.getItem(i2));
                            }
                        }

                    }

                    var prevRowCache = this.CacheRow.count;




                    for (var i3 = start; i3 < Length; i3 = (i3 + 1) | 0) {
                        if (!this.CacheRow.containsKey(i3)) {
                            var DataRowhandle1 = this.GetDataSourceRow(i3);
                            var dr = ExpressCraft.Control.Div$1(System.String.concat((i3 % 2 === 0 ? "cellrow even" : "cellrow"), (this.SelectedRows.GetValue(DataRowhandle1, true) ? " cellrow-selected" : ""), (DataRowhandle1 === this.FocusedDataHandle ? " focusedrow" : "")));

                            ExpressCraft.Helper.SetBounds$1(dr, 0, Y, this._columnAutoWidth ? ClientWidth : MaxWidth, this.UnitHeight);
                            dr.setAttribute("i", System.Convert.toString(Bridge.box(DataRowhandle1, System.Int32)));

                            dr.onclick = this.OnRowClick;
                            if (ExpressCraft.Settings.IsChrome) {
                                dr.ondblclick = this.OnDoubleClick;
                            }

                            for (var x4 = RawLeftCellIndex; x4 < RawLeftCellCount; x4 = (x4 + 1) | 0) {
                                var col1 = this.Columns.getItem(x4);
                                if (!col1.Visible) {
                                    continue;
                                }

                                var apparence1 = col1.BodyApparence;
                                var useDefault = false;
                                var cell;
                                if (col1.CellDisplay == null || ((useDefault = col1.CellDisplay.UseDefaultElement))) {
                                    cell = ExpressCraft.Control.Label$3(col1.GetDisplayValueByDataRowHandle(DataRowhandle1), col1.CachedX, 0, this._columnAutoWidth ? _columnAutoWidthSingle : col1.Width, apparence1.IsBold, false, this.cellClass, apparence1.Alignment, apparence1.Forecolor);

                                    dr.appendChild(useDefault ? col1.CellDisplay.OnCreateDefault(cell, this, DataRowhandle1, x4) : cell);
                                } else {
                                    cell = col1.CellDisplay.OnCreate(this, DataRowhandle1, x4);
                                    ExpressCraft.Helper.SetLocation(cell, col1.CachedX, 0);
                                    cell.style.width = ExpressCraft.Helper.ToPx(Bridge.box((this._columnAutoWidth ? _columnAutoWidthSingle : col1.Width), System.Single, System.Single.format, System.Single.getHashCode));

                                    dr.appendChild(cell);
                                }
                                cell.setAttribute("i", x4.toString());
                                cell.onmousedown = this.OnCellRowMouseDown;
                            }

                            if (this.AllowRowDrag) {
                                dr.setAttribute("draggable", "true");

                                dr.ondragstart = this.OnRowDragStart;
                            }

                            rowFragment.appendChild(dr);

                            this.CacheRow.set(i3, dr);
                        }

                        if (StartedWith !== this.RenderTime) {
                            if (prevRowCache === 0) {
                                this.ClearGrid();
                            }

                            this.GridBody.appendChild(rowFragment);

                            return;
                        }

                        Y += this.UnitHeight;
                    }
                    if (prevRowCache === 0) {
                        this.ClearGrid();
                    }

                    if (!Bridge.staticEquals(this.OnCustomRowStyle, null) && rowFragment.childNodes != null) {
                        var count = rowFragment.childNodes.length;
                        for (var i4 = 0; i4 < count; i4 = (i4 + 1) | 0) {
                            if (StartedWith !== this.RenderTime) {
                                this.GridBody.appendChild(rowFragment);

                                return;
                            }

                            try {
                                var child = Bridge.cast(rowFragment.childNodes[i4], HTMLElement);
                                this.OnCustomRowStyle(child, parseInt(child.getAttribute("i")));
                            }
                            catch (ex) {
                                ex = System.Exception.create(ex);
                                if (ExpressCraft.Application.AplicationDefition === ExpressCraft.ApplicationDefitnion.ExpressCraftConsole) {
                                    ExpressCraft.ConsoleForm.Log(ex.toString(), ExpressCraft.ConsoleLogType.Error);
                                }
                            }
                        }
                    }

                    this.GridHeader.appendChild(colFragment);
                    this.GridBody.appendChild(rowFragment);

                    if (StartedWith !== this.RenderTime) {
                        return;
                    }

                    this.RenderTime = -1;
                });

                this.GridHeaderContainer = ExpressCraft.Control.Div$1("heading-container");

                this.GridHeader = ExpressCraft.Control.Div();
                ExpressCraft.Helper.SetBounds$1(this.GridHeader, "0", "0", "0", "29px");
                this.GridBodyContainer = ExpressCraft.Control.Div();

                this.GridBodyContainer.style.overflowX = "auto";
                this.GridBodyContainer.style.overflowY = "auto";

                this.GridHeaderContainer.style.overflow = "hidden";

                this.GridBody = ExpressCraft.Control.Div();
                ExpressCraft.Helper.SetBounds$1(this.GridBody, "0", "0", "0", "0");

                this.GridBodyContainer.appendChild(this.GridBody);
                this.GridHeaderContainer.appendChild(this.GridHeader);

                this.SetDefaultSizes();

                this.Content.onmouseup = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f1);

                this.OnResize = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f2);
                var prevleft = 0;
                this.GridBodyContainer.onscroll = Bridge.fn.bind(this, function (ev) {
                    if (prevleft !== this.GridBodyContainer.scrollLeft) {
                        this.CacheRow = new (System.Collections.Generic.Dictionary$2(System.Int32,HTMLDivElement))();
                        prevleft = this.GridBodyContainer.scrollLeft;
                        this.DelayedRenderGrid();
                    } else {
                        this.DelayedRenderGrid(true);
                    }


                });
                this.OnLoaded = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f3);
                this.OnCellRowMouseDown = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f4);
                this.OnRowClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f5);
                this.Content.tabIndex = 0;
                this.OnDoubleClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f6);

                this.Content.onkeydown = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f7);

                this.ContextMenu = new ExpressCraft.ContextMenu();

                this.ContextMenu.ContextItems.addRange(System.Array.init([new ExpressCraft.ContextItem.$ctor1("Sort Ascending", Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f8)), new ExpressCraft.ContextItem.$ctor1("Sort Descending", Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f9)), new ExpressCraft.ContextItem.$ctor1("Clear All Sorting", Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f10), true), new ExpressCraft.ContextItem.$ctor2("Group By This Column"), new ExpressCraft.ContextItem.$ctor2("Hide Group By Box", true), new ExpressCraft.ContextItem.$ctor2("Hide This Column"), new ExpressCraft.ContextItem.$ctor2("View Columns"), new ExpressCraft.ContextItem.$ctor2("Save Column Layout"), new ExpressCraft.ContextItem.$ctor2("Best Fit"), new ExpressCraft.ContextItem.$ctor1("Best Fit (all columns)", Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f11), true), new ExpressCraft.ContextItem.$ctor2("Filter Editor..."), new ExpressCraft.ContextItem.$ctor2("Show Find Panel"), new ExpressCraft.ContextItem.$ctor2("Show Auto Filter Row"), new ExpressCraft.ContextItem.$ctor1("Select All", Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f12)), new ExpressCraft.ContextItem.$ctor1("Unselect All", Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f13))], ExpressCraft.ContextItem));

                this.Content.oncontextmenu = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f14);

                this.OnColumnOnClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f15);
                this.OnColumnDragStart = $asm.$.ExpressCraft.GridView.f16;
                this.OnColumnDragOver = $asm.$.ExpressCraft.GridView.f17;
                this.OnColumnDrop = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f18);
                this.OnColumnMouseDown = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f19);
                this.OnColumnMouseMove = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f20);

                this.OnColumnMouseLeave = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f21);

                this.OnRowDragStart = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f22);

                ExpressCraft.Helper.AppendChildren$1(this.Content, [this.GridHeaderContainer, this.GridBodyContainer]);

                this.FilterRowOnChange = Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f23);

                this.AutoGenerateColumnsFromSource = autoGenerateColumns;
                this.ColumnAutoWidth = columnAutoWidth;
            }
        },
        methods: {
            SetVisibleRowHandles: function (T, Cells, asc) {
                if (asc) {
                    var sorted = System.Linq.Enumerable.from(Cells).select(function (x, i) {
                            return new (System.Collections.Generic.KeyValuePair$2(System.Int32,T))(i, x);
                        }).orderBy($asm.$.ExpressCraft.GridView.f24).toList(System.Collections.Generic.KeyValuePair$2(System.Int32,T));

                    this.VisibleRowHandles = System.Linq.Enumerable.from(sorted).select($asm.$.ExpressCraft.GridView.f25).toList(System.Int32);
                } else {
                    var sorted1 = System.Linq.Enumerable.from(Cells).select(function (x, i) {
                            return new (System.Collections.Generic.KeyValuePair$2(System.Int32,T))(i, x);
                        }).orderByDescending($asm.$.ExpressCraft.GridView.f24).toList(System.Collections.Generic.KeyValuePair$2(System.Int32,T));

                    this.VisibleRowHandles = System.Linq.Enumerable.from(sorted1).select($asm.$.ExpressCraft.GridView.f25).toList(System.Int32);
                }
            },
            CalculateVisibleRows: function () {
                var calcVisibleRows = new (System.Collections.Generic.List$1(System.Int32))();

                for (var y = 0; y < this.RowCount(); y = (y + 1) | 0) {
                    var AddIndex = true;

                    for (var x = 0; x < this.ColumnCount(); x = (x + 1) | 0) {
                        if (!this.Columns.getItem(x).ValueMatchFilter(y)) {
                            AddIndex = false;
                            break;
                        }
                    }
                    if (AddIndex) {
                        calcVisibleRows.add(y);
                    }
                }

                this.VisibleRowHandles = calcVisibleRows;
                this.RenderGrid();
            },
            SetDefaultSizes: function () {
                if (this._columnHeadersVisible) {
                    ExpressCraft.Helper.SetBounds$1(this.GridHeaderContainer, 0, 0, "100%", this.UnitHeight + 1);
                    ExpressCraft.Helper.SetBounds$1(this.GridBodyContainer, 0, this.UnitHeight + 3, "100%", "(100% - " + System.Single.format((this.UnitHeight + 3)) + "px)");
                    this.GridHeader.style.visibility = "inherit";
                    this.GridHeaderContainer.style.visibility = "inherit";
                } else {
                    this.GridHeader.style.visibility = "hidden";
                    this.GridHeaderContainer.style.visibility = "hidden";

                    ExpressCraft.Helper.SetBounds$1(this.GridBodyContainer, 0, 1, "100%", "(100% - 1px)");
                }
            },
            SortColumn: function () {
                if (this.SortSettings != null) {
                    this.SortColumn$1(this.SortSettings.Column, this.SortSettings.SortMode);
                }
            },
            SortColumn$1: function (column, sort) {
                var $t;
                if (sort === void 0) { sort = 1; }
                column.SortedMode = sort;

                if (this.SortSettings != null && !Bridge.referenceEquals(this.SortSettings.Column, column)) {
                    this.SortSettings.Column.SortedMode = ExpressCraft.GridViewSortMode.None;
                    this.VisibleRowHandles = null;
                }

                if (sort === ExpressCraft.GridViewSortMode.None) {
                    this.VisibleRowHandles = null;
                } else {
                    var sort1 = sort === ExpressCraft.GridViewSortMode.Asc;

                    switch (column.Column.DataType) {
                        default: 
                        case ExpressCraft.DataType.Object: 
                            this.SetVisibleRowHandles(System.Object, (Bridge.as(column.Column, ExpressCraft.DataColumnObject)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Bool: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Boolean), (Bridge.as(column.Column, ExpressCraft.DataColumnBool)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.DateTime: 
                            this.SetVisibleRowHandles(Bridge.global.System.Nullable$1(System.DateTime), (Bridge.as(column.Column, ExpressCraft.DataColumnDateTime)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.String: 
                            this.SetVisibleRowHandles(System.String, (Bridge.as(column.Column, ExpressCraft.DataColumnString)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Byte: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Byte), (Bridge.as(column.Column, ExpressCraft.DataColumnByte)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Short: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Int16), (Bridge.as(column.Column, ExpressCraft.DataColumnShort)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Integer: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Int32), (Bridge.as(column.Column, ExpressCraft.DataColumnInteger)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Long: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Int64), (Bridge.as(column.Column, ExpressCraft.DataColumnLong)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Float: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Single), (Bridge.as(column.Column, ExpressCraft.DataColumnFloat)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Double: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Double), (Bridge.as(column.Column, ExpressCraft.DataColumnDouble)).Cells, sort1);
                            break;
                        case ExpressCraft.DataType.Decimal: 
                            this.SetVisibleRowHandles(System.Nullable$1(System.Decimal), (Bridge.as(column.Column, ExpressCraft.DataColumnDecimal)).Cells, sort1);
                            break;
                    }
                }

                this.RenderGrid();
                this.SortSettings = ($t = new ExpressCraft.SortSetting(), $t.Column = column, $t.SortMode = sort, $t);
            },
            ClearSortColumn: function () {
                if (this.SortSettings != null) {
                    this.SortColumn$1(this.SortSettings.Column, ExpressCraft.GridViewSortMode.None);
                }
            },
            ColumnCount: function () {
                return this.Columns.Count;
            },
            RowCount: function () {
                if (this._dataSource == null) {
                    return 0;
                }
                return this._dataSource.RowCount;
            },
            ScrollToBottom: function () {
                this.GridBodyContainer.scrollTop = (this.GridBody.clientHeight - this.GridBodyContainer.clientHeight) | 0;
            },
            ScrollToTop: function () {
                this.GridBodyContainer.scrollTop = 0;
            },
            GetColumn: function (i) {
                return this.Columns.getItem(i);
            },
            GetFocusedRowCellValue$2: function (columnIndex) {
                return this.GetFocusedRowCellValue$1(this.Columns.getItem(columnIndex));
            },
            GetFocusedRowCellValue$3: function (FieldName) {
                return this.GetFocusedRowCellValue(this.GetColumnByFieldName(FieldName));
            },
            GetFocusedRowCellValue$1: function (column) {
                return this.GetRowCellValue$1(this.FocusedDataHandle, column);
            },
            GetFocusedRowCellValue: function (column) {
                return this.GetRowCellValue(this.FocusedDataHandle, column);
            },
            GetGridViewColumnByFieldName: function (FieldName) {
                for (var i = 0; i < this.ColumnCount(); i = (i + 1) | 0) {
                    if (Bridge.referenceEquals(this.Columns.getItem(i).Column.FieldName, FieldName)) {
                        return this.Columns.getItem(i);
                    }
                }
                return null;
            },
            GetGridViewColumnByFieldName$1: function (fieldName, IgnoreCase) {
                if (IgnoreCase === void 0) { IgnoreCase = false; }
                for (var i = 0; i < this.ColumnCount(); i = (i + 1) | 0) {
                    if (this.Columns.getItem(i) != null && this.Columns.getItem(i).Column != null && System.String.compare(this.Columns.getItem(i).Column.FieldName, fieldName, IgnoreCase) === 0) {
                        return this.Columns.getItem(i);
                    }
                }

                return null;
            },
            GetRowCellValue$1: function (Datahandle, column) {
                return this.GetRowCellValue(Datahandle, column.Column);
            },
            GetRowCellValue: function (Datahandle, column) {
                if (Datahandle === -1) {
                    return null;
                }
                return column.GetCellValue(Datahandle);
            },
            GetRowCellValue$3: function (Datahandle, FieldName) {
                return this.GetRowCellValue(Datahandle, this.GetColumnByFieldName(FieldName));
            },
            GetRowCellValue$2: function (Datahandle, columnIndex) {
                return this.GetRowCellValue$1(Datahandle, this.Columns.getItem(columnIndex));
            },
            GetColumnByFieldName: function (fieldName, IgnoreCase) {
                if (IgnoreCase === void 0) { IgnoreCase = false; }
                if (this.DataSource == null) {
                    return null;
                }

                for (var i = 0; i < this.DataSource.ColumnCount; i = (i + 1) | 0) {
                    if (this.DataSource.Columns.getItem(i) != null && System.String.compare(this.DataSource.Columns.getItem(i).FieldName, fieldName, IgnoreCase) === 0) {
                        return this.DataSource.Columns.getItem(i);
                    }
                }

                return null;
            },
            AddColumn$2: function (caption, fieldname, width, formatstring, alignment, forecolor, isBold) {
                if (width === void 0) { width = 100; }
                if (formatstring === void 0) { formatstring = ""; }
                if (alignment === void 0) { alignment = 3; }
                if (forecolor === void 0) { forecolor = null; }
                if (isBold === void 0) { isBold = false; }
                var col = this.GetColumnByFieldName(fieldname);
                if (col == null) {
                    return;
                }
                this.AddColumn$1(caption, col, width, formatstring, alignment, forecolor, isBold);
            },
            AddColumn$1: function (caption, column, width, formatstring, alignment, forecolor, isBold) {
                var $t;
                if (width === void 0) { width = 100; }
                if (formatstring === void 0) { formatstring = ""; }
                if (alignment === void 0) { alignment = 3; }
                if (forecolor === void 0) { forecolor = null; }
                if (isBold === void 0) { isBold = false; }
                this.AddColumn(($t = new ExpressCraft.GridViewColumn(this, width), $t.Caption = caption, $t.BodyApparence = new ExpressCraft.GridViewCellApparence.$ctor3(isBold, alignment, forecolor), $t.FormatString = formatstring, $t.Column = column, $t));
            },
            AddColumn: function (column) {
                if (column == null) {
                    return;
                }

                this.Columns.add(column);

                this.RenderGrid();
            },
            AddColumns: function (columns) {
                if (columns === void 0) { columns = []; }
                if (columns == null || columns.length === 0) {
                    return;
                }

                this.Columns.addRange(columns);

                this.RenderGrid();
            },
            RemoveColumn: function (column) {
                this.Columns.remove(column);

                this.RenderGrid();
            },
            GetDataSourceRow: function (i) {
                if (this.VisibleRowHandles == null || this.VisibleRowHandles.Count === 0) {
                    return i;
                }
                return this.VisibleRowHandles.getItem(i);
            },
            GetColumnWidths: function () {
                if (this._columnAutoWidth) {
                    return this.GridBodyContainer.clientWidth;
                } else {
                    var width = 0.0;
                    for (var i = 0; i < this.Columns.Count; i = (i + 1) | 0) {
                        if (this.Columns.getItem(i).Visible) {
                            width += this.Columns.getItem(i).Width;
                        }
                    }
                    return width;
                }
            },
            ClearSelection: function () {
                this.SelectedRows = new (ExpressCraft.HardSoftList$1(System.Boolean))(false);
                this.RenderGrid();
            },
            SelectAllRows: function () {
                var length = this.RowCount();
                if (length === 0) {
                    this.SelectedRows.ClearAll();
                } else {
                    var index = System.Array.init(length, 0, System.Int32);
                    for (var i = 0; i < length; i = (i + 1) | 0) {
                        index[System.Array.index(i, index)] = this.GetDataSourceRow(i);
                    }
                    this.SelectedRows.ClearAllSetHardRange(true, index);
                }
                this.RenderGrid();
            },
            DelayedRenderGrid: function (renderNoLag) {
                if (renderNoLag === void 0) { renderNoLag = false; }
                if (renderNoLag) {
                    this.RenderGrid(false);
                } else {
                    if (ExpressCraft.Settings.GridViewScrollDelayed) {
                        if (this.PrevRenderGridScrollId !== -1) {
                            Bridge.global.clearTimeout(this.PrevRenderGridScrollId);
                            this.PrevRenderGridScrollId = -1;
                        }
                        this.PrevRenderGridScrollId = Bridge.global.setTimeout(Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f26), Math.max(1, ExpressCraft.Settings.GridViewScrollDelayMS));
                    } else {
                        this.RenderGrid();
                    }
                }

            },
            GetFocusedRow: function () {
                if (this.FocusedDataHandle > -1) {
                    return this.DataSource.getItem(this.GetDataSourceRow(this.FocusedDataHandle));
                } else {
                    return null;
                }
            },
            GetVisibleCount: function () {
                if (this.Columns == null || this.Columns.Count === 0) {
                    return 0;
                }
                var length = this.Columns.Count;
                var length1 = this.Columns.Count;

                for (var i = 0; i < length; i = (i + 1) | 0) {
                    if (!this.Columns.getItem(i).Visible) {
                        length1 = (length1 - 1) | 0;
                    }
                }
                return length1;
            },
            GetBestFitForColumn: function (column) {
                if (!column.Visible) {
                    return 0;
                }

                var maxLength = 0;
                var maxIndex = -1;
                var maxStr = "";

                var length = this.RowCount();
                for (var i = 0; i < length; i = (i + 1) | 0) {
                    var value = column.GetDisplayValueByDataRowHandle(i);
                    if (!System.String.isNullOrWhiteSpace(value)) {
                        var v = value.length;
                        if (v > maxLength) {
                            maxLength = v;
                            maxIndex = i;
                            maxStr = value;
                        }
                    }
                }

                if (maxIndex > -1) {
                    return ((Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(maxStr, ExpressCraft.Settings.DefaultFont)) + 20) | 0);
                } else {
                    return 0;
                }
            },
            BestFitAllColumns: function () {
                this._disableRender = true;
                for (var i = 0; i < this.Columns.Count; i = (i + 1) | 0) {
                    if (this.Columns.getItem(i).Visible) {
                        this.Columns.getItem(i).Width = this.GetBestFitForColumn(this.Columns.getItem(i));
                    }
                }
                this._disableRender = false;
                this.renderGridInternal();
            },
            DataSource_OnDataSourceChanged: function (sender, e) {
                this.SortColumn();
                this.RenderGrid();
            },
            Render: function () {
                ExpressCraft.Control.prototype.Render.call(this);
                this.HasRendered = true;
                this.RenderGrid();

                if (this.Content.parentElement != null) {
                }
            },
            GetRawVisibleRowCount: function () {
                return this.GridBodyContainer.clientHeight === 0 ? 0.0 : this.GridBodyContainer.clientHeight / this.UnitHeight;
            },
            GetRawTopRowIndex: function () {
                return this.GridBodyContainer.scrollTop === 0 ? 0.0 : this.GridBodyContainer.scrollTop / this.PixelsPerRow(this.RowCount());
            },
            ValidateGridWidth: function () {
                var width = this.GetColumnWidths();
                this.GridBody.style.width = ExpressCraft.Helper.ToPx(Bridge.box((width), System.Single, System.Single.format, System.Single.getHashCode));
                this.GridHeader.style.width = ExpressCraft.Helper.ToPx(Bridge.box(((width) + 24), System.Single, System.Single.format, System.Single.getHashCode)); // (width).ToPx();
                if (this.RightOfTable == null) {
                    this.RightOfTable = ExpressCraft.Control.Div();
                    this.GridBody.appendChild(this.RightOfTable);
                }
                if (this.RightOfTableHeader == null) {
                    this.RightOfTableHeader = ExpressCraft.Control.Div();
                    this.GridHeader.appendChild(this.RightOfTableHeader);
                }
                ExpressCraft.Helper.SetBounds$1(this.RightOfTable, width - 1, 0, 1, 1);
                ExpressCraft.Helper.SetBounds$1(this.RightOfTableHeader, width - 1, 0, 1, 1);
            },
            PixelsPerRow: function (rowCount) {
                if (rowCount > ExpressCraft.Settings.MaximumPixelScrollingRows) {
                    return 3.0;
                } else {
                    return this.UnitHeight;
                }
            },
            ValidateGridHeight: function () {
                var i = this.RowCount();
                var ppr = this.PixelsPerRow(i);
                var height = ppr * i;

                if (i > ExpressCraft.Settings.MaximumPixelScrollingRows && this.GridBodyContainer.clientHeight > 0) {
                    height += ((this.GridBodyContainer.clientHeight / this.UnitHeight) * ppr);
                }

                this.GridBody.style.height = ExpressCraft.Helper.ToPx(Bridge.box(height, System.Single, System.Single.format, System.Single.getHashCode));
                if (this.BottonOfTable == null) {
                    this.BottonOfTable = ExpressCraft.Control.Div();
                    this.GridBody.appendChild(this.BottonOfTable);
                }
                ExpressCraft.Helper.SetBounds$1(this.BottonOfTable, 0, height, 1, 1);
            },
            ValidateGridSize: function () {
                this.ValidateGridHeight();
                this.ValidateGridWidth();
            },
            ClearHeader: function () {
                ExpressCraft.Helper.Empty(this.GridHeader);
                this.GridHeader.appendChild(this.RightOfTableHeader);
            },
            ClearColumns: function () {
                this.Columns = new (System.Collections.Generic.List$1(ExpressCraft.GridViewColumn))();
            },
            ClearView: function () {
                this.Columns = new (System.Collections.Generic.List$1(ExpressCraft.GridViewColumn))();
                this.VisibleRowHandles = new (System.Collections.Generic.List$1(System.Int32))();
                this.SelectedRows = new (ExpressCraft.HardSoftList$1(System.Boolean))(false);
                this._dataSource = null;
            },
            ClearBody: function () {
                ExpressCraft.Helper.Empty(this.GridBody);
                ExpressCraft.Helper.AppendChildren$1(this.GridBody, [this.RightOfTable, this.BottonOfTable]);
            },
            ClearGrid: function () {
                this.ClearHeader();
                this.ClearBody();
            },
            SetupColumn: function (se, index, gcol) {
                se.setAttribute("i", System.Convert.toString(Bridge.box(index, System.Int32)));
                se.setAttribute("draggable", "true");
                se.onclick = this.OnColumnOnClick;
                se.ondragstart = this.OnColumnDragStart;
                se.ondragover = this.OnColumnDragOver;
                se.ondrop = this.OnColumnDrop;
                se.onmousedown = this.OnColumnMouseDown;
                se.onmousemove = this.OnColumnMouseMove;
                se.onmouseleave = this.OnColumnMouseLeave;
            },
            ProcessBlur: function () {
                if (this.PrevScroll !== this.GridBodyContainer.scrollTop) {
                    this.GridBody.classList.add("blur");
                    if (this.lastId !== -1) {
                        Bridge.global.clearTimeout(this.lastId);
                        this.lastId = -1;
                    }

                    this.lastId = Bridge.global.setTimeout(Bridge.fn.bind(this, $asm.$.ExpressCraft.GridView.f27), 100);
                }
                this.PrevScroll = this.GridBodyContainer.scrollTop;
            },
            RenderGrid: function (clear) {
                if (clear === void 0) { clear = true; }
                if (clear) {
                    this.CacheRow = new (System.Collections.Generic.Dictionary$2(System.Int32,HTMLDivElement))();
                }

                if (this.RenderTime > -1) {
                    Bridge.global.clearTimeout(this.RenderTime);
                    this.RenderTime = Bridge.global.setTimeout(this.renderGridInternal, 1);
                } else {
                    this.renderGridInternal();
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.GridView", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.GridView, {
        f1: function (ev) {
            if (this.ResizeIndex === -1) {
                return;
            }
            var x = ev.pageX;
            x = (this.Columns.getItem(this.ResizeIndex).Width + (((x - this.ResizePageX) | 0))) | 0;
            if (x < 24) {
                x = 24;
            }
            this.Columns.getItem(this.ResizeIndex).Width = x;

            ExpressCraft.Form.SetCursor("default");

            ev.preventDefault();
            ev.stopImmediatePropagation();
            ev.stopPropagation();

            this.ResizeIndex = -1;
            this.ResizeSpan = null;
        },
        f2: function (ev) {
            this.CacheRow = new (System.Collections.Generic.Dictionary$2(System.Int32,HTMLDivElement))();
            this.DelayedRenderGrid();
        },
        f3: function (ev) {
            this.RenderGrid();
        },
        f4: function (ev) {
            this.FocusedColumn = parseInt(ev.currentTarget.getAttribute("i"));
        },
        f5: function (ev) {
            if (!ExpressCraft.Settings.IsChrome) {
                if (this.clickTimeDiff == null) {
                    this.clickTimeDiff = System.Diagnostics.Stopwatch.startNew();
                } else {
                    this.clickTimeDiff.stop();
                    var ems = this.clickTimeDiff.milliseconds();
                    this.clickTimeDiff = null;

                    if (ems.lt(System.Int64(200))) {
                        this.OnDoubleClick(ev);
                    }
                }
            }

            var DataRowHandle = parseInt(ev.currentTarget.getAttribute("i"));

            var mev = ev;
            if (this.AllowMultiSelection) {
                if (mev.ctrlKey) {
                    this.SelectedRows.AddOrSet(true, DataRowHandle, true);
                    this.RenderGrid();
                    return;
                } else if (mev.shiftKey) {
                    return;
                }
            }
            this.SelectedRows.ClearAndAddOrSet(true, DataRowHandle, true);
            if (DataRowHandle !== this._focusedDataHandle) {
                this.FocusedDataHandle = DataRowHandle;
            } else {
                this.RenderGrid();
            }
        },
        f6: function (ev) {
            var drh = parseInt(ev.currentTarget.getAttribute("i"));
            if (!Bridge.staticEquals(this.OnRowDoubleClick, null)) {
                this.OnRowDoubleClick(drh);
            }

            if (this._useEditForm) {
                var idr = this.DataSource.getItem(drh);

                var fdre = new ExpressCraft.DataRowEditForm(idr, this, true);
                fdre.ShowDialog();
            }
        },
        f7: function (ev) {
            var kev = ev;
            //Global.Alert("CONTROL + A");
            if (this.AllowMultiSelection && kev.ctrlKey && (kev.keyCode === 65 || kev.keyCode === 97)) {
                // keyCode == 65 || keyCode == 97
                //Global.Alert("AllowMultiSelection = TRUE");
                this.SelectAllRows();
            } else {
                //Global.Alert("AllowMultiSelection = FALSE");
            }
        },
        f8: function (cm) {
            if (this.FocusedColumn > -1) {
                this.SortColumn$1(this.Columns.getItem(this.FocusedColumn), ExpressCraft.GridViewSortMode.Asc);
            }
        },
        f9: function (cm) {
            if (this.FocusedColumn > -1) {
                this.SortColumn$1(this.Columns.getItem(this.FocusedColumn), ExpressCraft.GridViewSortMode.Desc);
            }
        },
        f10: function (cm) {
            this.ClearSortColumn();
        },
        f11: function (ci) {
            this.BestFitAllColumns();
        },
        f12: function (cm) {
            this.SelectAllRows();
        },
        f13: function (cm) {
            this.ClearSelection();
        },
        f14: function (ev) {
            if (ExpressCraft.Helper.NotDesktop) {
                ev.preventDefault();
                ev.stopPropagation();

                this.OnDoubleClick(ev);
            } else {
                if (this.ContextMenu != null) {
                    this.ContextMenu.Show(ExpressCraft.Helper.GetClientMouseLocation(ev));
                    ev.preventDefault();
                    ev.stopPropagation();
                }
            }
        },
        f15: function (ev) {
            if (this.ResizeIndex >= 0) {
                return;
            }

            var gcol = this.Columns.getItem(parseInt(ev.currentTarget.getAttribute("i")));

            for (var i = 0; i < this.ColumnCount(); i = (i + 1) | 0) {
                if (!Bridge.referenceEquals(this.Columns.getItem(i), gcol)) {
                    this.Columns.getItem(i).SortedMode = ExpressCraft.GridViewSortMode.None;
                }
            }
            switch (gcol.SortedMode) {
                default: 
                case ExpressCraft.GridViewSortMode.None: 
                    this.SortColumn$1(gcol, ExpressCraft.GridViewSortMode.Asc);
                    break;
                case ExpressCraft.GridViewSortMode.Asc: 
                    this.SortColumn$1(gcol, ExpressCraft.GridViewSortMode.Desc);
                    break;
                case ExpressCraft.GridViewSortMode.Desc: 
                    this.SortColumn$1(gcol, ExpressCraft.GridViewSortMode.None);
                    break;
            }
        },
        f16: function (ev) {
            ev.dataTransfer.setData("gridviewColumnDrag", ev.currentTarget.getAttribute("i"));
        },
        f17: function (ev) {
            ev.preventDefault();
        },
        f18: function (ev) {
            if (ev.target == null || !(Bridge.is(ev.target, HTMLSpanElement))) {
                return;
            }

            var target = ev.target;

            if (!Bridge.referenceEquals(target.parentElement, this.GridHeader)) {
                return;
            }

            var HoverIndex = parseInt(target.getAttribute("i"));
            var SelectedIndex = parseInt(ev.dataTransfer.getData("gridviewColumnDrag"));
            if (SelectedIndex === HoverIndex) {
                return;
            }

            if (HoverIndex < 0) {
                return;
            }

            var x = ev.layerX;
            x = (x - target.clientLeft) | 0;
            var w = (Bridge.Int.div(target.clientWidth, 2)) | 0;

            if (HoverIndex === ((SelectedIndex - 1) | 0) && x > w) {
                return;
            }
            if (HoverIndex === ((SelectedIndex + 1) | 0) && x < w) {
                return;
            }

            if (x < w) {
                this.DragIndex = HoverIndex;
            } else {
                this.DragIndex = (HoverIndex + 1) | 0;
            }

            if (this.DragIndex < 0 || SelectedIndex < 0) {
                return;
            }
            var col = this.Columns.getItem(SelectedIndex);
            if (this.DragIndex === this.Columns.Count) {
                this.Columns.remove(col);
                this.Columns.add(col);
            } else {
                var col1 = this.Columns.getItem(this.DragIndex);
                this.Columns.remove(col);
                this.Columns.insert(this.Columns.indexOf(col1), col);
            }

            this.RenderGrid();
        },
        f19: function (ev) {
            var x = ev.layerX;
            var target = ev.target;
            x = (x - target.clientLeft) | 0;
            this.ResizePageX = ev.pageX;

            this.FocusedColumn = parseInt(ev.currentTarget.getAttribute("i"));

            if (x >= ((target.clientWidth - 2) | 0)) {
                this.ResizeIndex = parseInt(target.getAttribute("i"));
                this.ResizeSpan = target;
                ExpressCraft.Form.SetCursor("ew-resize");

                ev.preventDefault();
            } else {
                this.ResizeSpan = null;
                this.ResizeIndex = -1;
            }
        },
        f20: function (ev) {
            if (this.ResizeIndex === -1) {
                var x = ev.layerX;
                var target = ev.target;
                x = (x - target.clientLeft) | 0;

                if (x >= ((target.clientWidth - 2) | 0)) {
                    ExpressCraft.Form.SetCursor("ew-resize");
                    return;
                }
                ExpressCraft.Form.SetCursor("default");
            }
        },
        f21: function (ev) {
            if (this.ResizeIndex === -1) {
                ExpressCraft.Form.SetCursor("default");
            }
        },
        f22: function (ev) {
            ev.dataTransfer.setData("gridviewRowDrag", JSON.stringify(this.DataSource.getItem(parseInt(ev.currentTarget.getAttribute("i"))).GetOfflineDataRow()));
        },
        f23: function (te) {
            this.Columns.getItem(parseInt(te.Content.getAttribute("i"))).FilterValue = te.Text;
        },
        f24: function (x) {
            return x.value;
        },
        f25: function (x) {
            return x.key;
        },
        f26: function () {
            this.RenderGrid();
        },
        f27: function () {
            this.GridBody.classList.remove("blur");
        }
    });

    Bridge.define("ExpressCraft.GridViewCellDisplayCheckBox", {
        inherits: [ExpressCraft.GridViewCellDisplay],
        statics: {
            fields: {
                resource_checked: null
            },
            ctors: {
                init: function () {
                    this.resource_checked = "checked";
                }
            }
        },
        methods: {
            OnCreate: function (gridView, dataRowIndex, columnIndex) {
                var value = gridView.GetRowCellValue$2(dataRowIndex, columnIndex);

                var cell = ExpressCraft.Control.Div$1("cell");
                var input = ExpressCraft.Control.Input("", "checkbox");
                ExpressCraft.Helper.SetBoundsFull$1(input);
                ExpressCraft.Helper.SetChecked(input, value);
                input.style.margin = "0";
                cell.appendChild(input);

                return cell;
            }
        }
    });

    Bridge.define("ExpressCraft.GridViewCellDisplayImage", {
        inherits: [ExpressCraft.GridViewCellDisplay],
        fields: {
            UseBase64Resource: false
        },
        methods: {
            OnCreate: function (gridView, dataRowIndex, columnIndex) {
                var src = ExpressCraft.Helper.HtmlUrlEscape((System.String.concat(gridView.GetRowCellValue$2(dataRowIndex, columnIndex), "")));
                var imgDiv = ExpressCraft.Control.Div$1("cell");

                ExpressCraft.Helper.SetImage(imgDiv, src, !this.UseBase64Resource);

                return imgDiv;
            }
        }
    });

    Bridge.define("ExpressCraft.ImageEdit", {
        inherits: [ExpressCraft.Control],
        fields: {
            _noImageDataText: null,
            _isURL: false,
            _image: null
        },
        props: {
            isUrl: {
                get: function () {
                    return this._isURL;
                },
                set: function (value) {
                    if (this._isURL !== value) {
                        this._isURL = value;
                        this.RefreshImage();
                    }
                }
            },
            Image: {
                get: function () {
                    return this._image;
                },
                set: function (value) {
                    if (Bridge.referenceEquals(this._image, value)) {
                        return;
                    }
                    this._image = value;
                    this.RefreshImage();
                }
            }
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "inputcontrol");
                this._noImageDataText = new ExpressCraft.Control.$ctor5("form-heading-title");
                this._noImageDataText.Content.innerHTML = "No image data";
                this._noImageDataText.Content.style.color = "black";
                this._noImageDataText.Content.style.visibility = "inherit";

                this.Content.appendChild(ExpressCraft.Control.op_Implicit(this._noImageDataText));
            }
        },
        methods: {
            RefreshImage: function () {
                if (!System.String.isNullOrWhiteSpace(this._image)) {
                    this._noImageDataText.Content.style.visibility = "hidden";
                } else {
                    this._image = "";
                    this._noImageDataText.Content.style.visibility = "inherit";
                }
                ExpressCraft.Helper.SetImage$1(this, this._image, this._isURL);
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutRowControl", {
        inherits: [ExpressCraft.LayoutRow],
        fields: {
            Height: 0,
            Control: null
        },
        ctors: {
            ctor: function (height, control) {
                this.$initialize();
                ExpressCraft.LayoutRow.ctor.call(this);
                this.Height = height;
                this.Label = "";
                this.Control = control;
            }
        }
    });

    Bridge.define("ExpressCraft.LayoutRowGap", {
        inherits: [ExpressCraft.LayoutRow],
        fields: {
            Height: 0
        },
        ctors: {
            ctor: function (height, label) {
                if (label === void 0) { label = ""; }

                this.$initialize();
                ExpressCraft.LayoutRow.ctor.call(this);
                this.Height = height;
                this.Label = label;
            }
        }
    });

    Bridge.define("ExpressCraft.ProgressControl", {
        inherits: [ExpressCraft.Control],
        fields: {
            position: 0,
            internalProgressControl: null,
            maximum: 0,
            Step: 0,
            DisableUpdate: false
        },
        props: {
            Maximum: {
                get: function () {
                    return this.maximum;
                },
                set: function (value) {
                    if (value < 1) {
                        value = 1;
                    }
                    if (value < this.position) {
                        this.position = value;
                    }
                    this.maximum = value;
                    if (!this.DisableUpdate) {
                        this.Update();
                    }
                }
            },
            Position: {
                get: function () {
                    return this.position;
                },
                set: function (value) {
                    if (value < 0) {
                        value = 0;
                    } else {
                        if (value > this.maximum) {
                            value = this.maximum;
                        }
                    }
                    this.position = value;
                    if (!this.DisableUpdate) {
                        this.Update();
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this.Step = 1;
                this.DisableUpdate = false;
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "progressbar");
                this.internalProgressControl = ExpressCraft.Control.Div$1("progressbarbody");
            }
        },
        methods: {
            NextStep: function () {
                this.Position = (this.Position + this.Step) | 0;
            },
            Render: function () {
                ExpressCraft.Control.prototype.Render.call(this);

                this.Content.appendChild(this.internalProgressControl);

                this.Update();
            },
            Update: function () {
                if (this.DisableUpdate || this.internalProgressControl == null) {
                    return;
                }
                if (this.maximum === 0 || this.position === 0) {
                    this.internalProgressControl.style.width = "0%";
                } else {
                    var source = ((this.position / this.maximum) * 100.00) + '%';
                    this.internalProgressControl.style.width = System.String.concat("calc(", source, " - 2px)");
                }
            }
        }
    });

    Bridge.define("ExpressCraft.RibbonButton", {
        inherits: [ExpressCraft.Control],
        fields: {
            _icon: null,
            _iconURL: null,
            _caption: null,
            BeginGroup: false,
            IsSmallCaption: false,
            OnItemClick: null,
            enabled: false,
            captionDiv: null,
            imageDiv: null,
            AfterItemClick: null
        },
        props: {
            Icon: {
                get: function () {
                    return this._icon;
                },
                set: function (value) {
                    if (!Bridge.referenceEquals(this._icon, value)) {
                        this._icon = value;
                        this.ProcessImage();
                    }
                }
            },
            IconURL: {
                get: function () {
                    return this._iconURL;
                },
                set: function (value) {
                    if (!Bridge.referenceEquals(this._iconURL, value)) {
                        this._iconURL = value;
                        this.ProcessImage();
                    }
                }
            },
            Caption: {
                get: function () {
                    return this._caption;
                },
                set: function (value) {
                    if (!Bridge.referenceEquals(this._caption, value)) {
                        this._caption = value;
                        this.ProcessCaption();
                    }
                }
            },
            Enabled: {
                get: function () {
                    return this.enabled;
                },
                set: function (value) {
                    this.enabled = value;
                    this.setEnabled(value);
                }
            }
        },
        ctors: {
            init: function () {
                this._icon = "";
                this._iconURL = "";
                this._caption = "";
                this.BeginGroup = false;
                this.IsSmallCaption = false;
                this.enabled = true;
            },
            ctor: function (caption, _isSmallCaption) {
                if (caption === void 0) { caption = ""; }
                if (_isSmallCaption === void 0) { _isSmallCaption = false; }

                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, _isSmallCaption ? "ribbonbuttonsmall" : "ribbonbutton");
                this.Caption = caption;
                this.IsSmallCaption = _isSmallCaption;
            }
        },
        methods: {
            setEnabled: function (value) {
                this.ChangeState(value);
                if (value) {
                    if (this.imageDiv != null) {
                        this.imageDiv.classList.remove("disabled");
                    }
                    if (this.captionDiv != null) {
                        this.captionDiv.classList.remove("disabled");
                    }
                } else {
                    if (this.imageDiv != null) {
                        this.imageDiv.classList.add("disabled");
                    }
                    if (this.captionDiv != null) {
                        this.captionDiv.classList.add("disabled");
                    }
                }
            },
            Render: function () {
                this.HasRendered = true;

                this.Content.onclick = Bridge.fn.bind(this, $asm.$.ExpressCraft.RibbonButton.f1);

                this.ProcessCaption();
                this.ProcessImage();

                this.setEnabled(this.enabled);
            },
            ProcessCaption: function () {
                if (this.captionDiv != null) {
                    this.captionDiv.remove();
                    this.captionDiv = null;
                }
                if (!System.String.isNullOrWhiteSpace(this.Caption)) {
                    this.captionDiv = ExpressCraft.Control.Div$1(this.IsSmallCaption ? "ribbonbuttonsmallcaption" : "ribbonbuttoncaption");

                    this.captionDiv.innerHTML = this.Caption;

                    this.Content.appendChild(this.captionDiv);
                }
            },
            ProcessImage: function () {
                if (this.imageDiv == null) {
                    if (!System.String.isNullOrWhiteSpace(this.Icon)) {
                        this.imageDiv = ExpressCraft.Control.Div$1(this.IsSmallCaption ? "ribbonbuttonsmallicon" : "ribbonbuttonicon");
                        this.imageDiv.style.background = ExpressCraft.Control.GetImageString(this.Icon);
                    } else if (!System.String.isNullOrWhiteSpace(this.IconURL)) {
                        this.imageDiv = ExpressCraft.Control.Div$1(this.IsSmallCaption ? "ribbonbuttonsmallicon" : "ribbonbuttonicon");
                        this.imageDiv.style.background = ExpressCraft.Control.GetImageStringURI(this.IconURL);
                    }
                    if (this.imageDiv != null) {
                        this.Content.appendChild(this.imageDiv);
                    }
                } else {
                    if (!System.String.isNullOrWhiteSpace(this.Icon)) {
                        this.imageDiv.style.background = ExpressCraft.Control.GetImageString(this.Icon);
                    } else if (!System.String.isNullOrWhiteSpace(this.IconURL)) {
                        this.imageDiv.style.background = ExpressCraft.Control.GetImageStringURI(this.IconURL);
                    }
                }

                if (this.imageDiv != null) {
                    this.imageDiv.style.backgroundSize = "100% 100%";

                    if (this.captionDiv != null && this.IsSmallCaption) {
                        this.captionDiv.style.left = "28px";
                    }
                } else {
                    if (this.captionDiv != null && this.IsSmallCaption) {
                        this.captionDiv.style.left = "6px";
                    }
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.RibbonButton", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.RibbonButton, {
        f1: function (ev) {
            var wasEnabled = this.enabled;

            if (this.enabled && !Bridge.staticEquals(this.OnItemClick, null)) {
                this.OnItemClick(this);
            }
            if (wasEnabled && !Bridge.staticEquals(this.AfterItemClick, null)) {
                this.AfterItemClick(this);
            }

            ev.stopPropagation();
        }
    });

    Bridge.define("ExpressCraft.RibbonControl", {
        inherits: [ExpressCraft.Control,ExpressCraft.IPages],
        fields: {
            IconURL: null,
            Type: 0,
            ApplicationIcon: null,
            OnSelectedPageChange: null,
            selectedindex: 0
        },
        props: {
            RibbonPages: null,
            SelectedIndex: {
                get: function () {
                    return this.selectedindex;
                },
                set: function (value) {
                    if (value < 0) {
                        value = 0;
                    }
                    if (this.selectedindex >= this.RibbonPages.Count) {
                        this.selectedindex = (this.RibbonPages.Count - 1) | 0;
                    }

                    if (this.selectedindex !== value) {
                        this.selectedindex = value;
                        if (!Bridge.staticEquals(this.OnSelectedPageChange, null)) {
                            this.OnSelectedPageChange(this.selectedindex, this.RibbonPages.getItem(this.selectedindex));
                        }
                    }
                    this.SetSelectedIndex(value);
                }
            }
        },
        alias: ["AddRibbonPages", "ExpressCraft$IPages$AddRibbonPages"],
        ctors: {
            init: function () {
                this.IconURL = "fav.ico";
                this.selectedindex = -1;
                this.RibbonPages = new (System.Collections.Generic.List$1(ExpressCraft.RibbonPage))();
            },
            ctor: function (type) {
                if (type === void 0) { type = 0; }

                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, System.String.concat("ribboncontrol", (type === ExpressCraft.RibbonControl.RibbonType.Full ? "" : " ribboncontrol-compact")));
                this.Type = type;

                this.Content.oncontextmenu = $asm.$.ExpressCraft.RibbonControl.f1;
            }
        },
        methods: {
            AddRibbonPages: function (pages) {
                if (pages === void 0) { pages = []; }
                if (pages != null) {
                    this.RibbonPages.addRange(pages);
                }
            },
            MenuClick: function () {
                if (ExpressCraft.Helper.NotDesktop) {
                }
            },
            SetSelectedIndex: function (index) {
                if (this.RibbonPages != null && this.RibbonPages.Count > 0) {
                    for (var i = 0; i < this.RibbonPages.Count; i = (i + 1) | 0) {
                        if (this.RibbonPages.getItem(i).RibbonHeader != null) {
                            this.RibbonPages.getItem(i).RibbonHeader.classList.remove("ribbonpageheader-hidden");
                            this.RibbonPages.getItem(i).RibbonHeader.classList.remove("ribbonpageheader-active");

                            if (i === index) {
                                this.RibbonPages.getItem(i).RibbonHeader.classList.add("ribbonpageheader-active");
                                this.RibbonPages.getItem(i).Content.style.visibility = "inherit";
                            } else {
                                this.RibbonPages.getItem(i).RibbonHeader.classList.add("ribbonpageheader-hidden");
                                this.RibbonPages.getItem(i).Content.style.visibility = "hidden";
                            }
                        }
                    }
                }
            },
            Render: function () {
                this.HasRendered = true;
                if (this.Type === ExpressCraft.RibbonControl.RibbonType.Full) {
                    if (this.ApplicationIcon != null) {
                        ExpressCraft.Helper.Delete(this.ApplicationIcon);
                    }
                    this.ApplicationIcon = ExpressCraft.Control.Div$1("application-icon");
                    var appIconImage = ExpressCraft.Control.Div$1("fav-icon");
                    appIconImage.style.background = ExpressCraft.Control.GetImageStringURI(this.IconURL);
                    appIconImage.style.backgroundSize = "100% 100%";

                    this.ApplicationIcon.appendChild(appIconImage);

                    this.Content.appendChild(this.ApplicationIcon);
                }

                if (this.RibbonPages != null && this.RibbonPages.Count > 0) {
                    var width = 58;
                    for (var i = 0; i < this.RibbonPages.Count; i = (i + 1) | 0) {
                        if (this.Content.contains(ExpressCraft.Control.op_Implicit(this.RibbonPages.getItem(i)))) {
                            ExpressCraft.Helper.Delete(this.RibbonPages.getItem(i).Content);
                            ExpressCraft.Helper.Delete(this.RibbonPages.getItem(i).RibbonHeader);
                        }
                        this.RibbonPages.getItem(i).Render();

                        if (this.Type === ExpressCraft.RibbonControl.RibbonType.Compact) {
                            if (!System.String.contains(this.RibbonPages.getItem(i).Content.className,"ribbonpage-compact")) {
                                this.RibbonPages.getItem(i).Content.classList.add("ribbonpage-compact");
                            }
                        } else {
                            if (System.String.contains(this.RibbonPages.getItem(i).Content.className,"ribbonpage-compact")) {
                                this.RibbonPages.getItem(i).Content.classList.remove("ribbonpage-compact");
                            }
                        }

                        var index = { v : i };

                        if (i === this.selectedindex) {
                            this.RibbonPages.getItem(i).RibbonHeader = ExpressCraft.Control.Div$1(System.String.concat("ribbonpageheader ribbonpageheader-active", (this.Type === ExpressCraft.RibbonControl.RibbonType.Full ? "" : " ribbonpageheader-compact")));
                            this.RibbonPages.getItem(i).Content.style.visibility = "visible";
                        } else {
                            this.RibbonPages.getItem(i).RibbonHeader = ExpressCraft.Control.Div$1(System.String.concat("ribbonpageheader ribbonpageheader-hidden", (this.Type === ExpressCraft.RibbonControl.RibbonType.Full ? "" : " ribbonpageheader-compact")));
                            this.RibbonPages.getItem(i).Content.style.visibility = "hidden";
                        }

                        this.RibbonPages.getItem(i).RibbonHeader.onmousedown = (function ($me, index) {
                            return Bridge.fn.bind($me, function (ev) {
                                this.SelectedIndex = index.v;
                            });
                        })(this, index);
                        this.RibbonPages.getItem(i).RibbonHeader.ontouchstart = (function ($me, index) {
                            return Bridge.fn.bind($me, function (ev) {
                                this.SelectedIndex = index.v;
                            });
                        })(this, index);

                        this.RibbonPages.getItem(i).RibbonHeader.innerHTML = this.RibbonPages.getItem(i).Caption;

                        var inwidth = 24;

                        if (!System.String.isNullOrEmpty(this.RibbonPages.getItem(i).Caption)) {
                            inwidth = (inwidth + Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(this.RibbonPages.getItem(i).Caption, ExpressCraft.Settings.DefaultFont))) | 0;
                        }

                        this.RibbonPages.getItem(i).RibbonHeader.style.left = width + "px";
                        this.RibbonPages.getItem(i).RibbonHeader.style.width = inwidth + "px";

                        this.Content.appendChild(this.RibbonPages.getItem(i).RibbonHeader);
                        this.Content.appendChild(ExpressCraft.Control.op_Implicit(this.RibbonPages.getItem(i)));

                        width = (width + inwidth) | 0;
                    }
                }
                this.SelectedIndex = this.selectedindex;
            }
        }
    });

    Bridge.ns("ExpressCraft.RibbonControl", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.RibbonControl, {
        f1: function (ev) {
            ev.stopPropagation();
            ev.preventDefault();
        }
    });

    Bridge.define("ExpressCraft.RibbonGroup", {
        inherits: [ExpressCraft.Control],
        fields: {
            enabled: false,
            captionDiv: null,
            riList: null
        },
        props: {
            Caption: null,
            Buttons: null,
            Enabled: {
                get: function () {
                    return this.enabled;
                },
                set: function (value) {
                    this.enabled = value;
                    this.setEnabled(value);
                }
            }
        },
        ctors: {
            init: function () {
                this.enabled = true;
            },
            ctor: function (_caption) {
                if (_caption === void 0) { _caption = ""; }

                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "ribbongroup");
                this.Caption = _caption;
                this.Buttons = new (System.Collections.Generic.List$1(ExpressCraft.RibbonButton))();
            },
            $ctor1: function (_caption, buttons) {
                if (buttons === void 0) { buttons = []; }

                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "ribbongroup");
                this.Caption = _caption;
                this.Buttons = new (System.Collections.Generic.List$1(ExpressCraft.RibbonButton))();
                if (buttons != null) {
                    this.Buttons.addRange(buttons);
                }
            }
        },
        methods: {
            setEnabled: function (value) {
                if (this.Buttons.Count > 0) {
                    for (var i = 0; i < this.Buttons.Count; i = (i + 1) | 0) {
                        if (!value) {
                            this.Buttons.getItem(i).setEnabled(value);
                        } else {
                            this.Buttons.getItem(i).setEnabled(this.Buttons.getItem(i).Enabled);
                        }
                    }
                }
                this.ChangeState(value);
                if (value) {
                    if (this.captionDiv != null) {
                        this.captionDiv.classList.remove("disabled");
                    }
                } else {
                    if (this.captionDiv != null) {
                        this.captionDiv.classList.add("disabled");
                    }
                }
            },
            CreateVerticalLine: function (height) {
                var htmlDiv = ExpressCraft.Control.Div$1("ribbonseperator");
                if (height !== 58) {
                    htmlDiv.style.height = height + "px";
                }

                return htmlDiv;
            },
            GenerateRList: function () {
                var ri = null;

                if (this.riList == null) {
                    this.riList = new (System.Collections.Generic.List$1(ExpressCraft.RibbonGroup.RenderInfo))();
                    for (var i = 0; i < this.Buttons.Count; i = (i + 1) | 0) {
                        if (ri == null) {
                            ri = new ExpressCraft.RibbonGroup.RenderInfo();
                            ri.FirstButton = this.Buttons.getItem(i);
                            ri.IsSmall = ri.FirstButton.IsSmallCaption;
                        } else {
                            if (ri.IsSmall !== this.Buttons.getItem(i).IsSmallCaption || this.Buttons.getItem(i).BeginGroup || !this.Buttons.getItem(i).IsSmallCaption || (ri.FirstButton != null && ri.SecondButton != null && ri.ThirdButton != null)) {
                                this.riList.add(ri);

                                ri = new ExpressCraft.RibbonGroup.RenderInfo();
                                ri.FirstButton = this.Buttons.getItem(i);
                                ri.IsSmall = this.Buttons.getItem(i).IsSmallCaption;
                                ri.BeginGroup = this.Buttons.getItem(i).BeginGroup;
                            } else {
                                if (ri.SecondButton == null) {
                                    ri.SecondButton = this.Buttons.getItem(i);
                                } else {
                                    ri.ThirdButton = this.Buttons.getItem(i);
                                }
                            }
                        }
                    }

                    if (ri != null) {
                        this.riList.add(ri);
                        ri = null;
                    }
                }
            },
            Render: function () {
                this.HasRendered = true;

                this.GenerateRList();

                ExpressCraft.Helper.Empty(this.Content);

                var width = 0;

                for (var i = 0; i < this.riList.Count; i = (i + 1) | 0) {
                    var ri = this.riList.getItem(i);

                    if (ri.BeginGroup) {
                        width = (width + 3) | 0;
                        var vlbg = this.CreateVerticalLine(58);
                        vlbg.style.left = width + "px";

                        this.Content.appendChild(vlbg);
                    }

                    width = (width + 3) | 0;

                    if (ri.IsSmall) {
                        var MaxWidth;

                        if (ri.ThirdButton == null) {
                            if (ri.SecondButton == null) {
                                MaxWidth = Math.max(((((Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.FirstButton.Caption, ExpressCraft.Settings.DefaultFont)) + 28) | 0) + 6) | 0), 64);

                                ri.FirstButton.Render();

                                ri.FirstButton.Content.style.left = width + "px";
                                ri.FirstButton.Content.style.width = MaxWidth + "px";

                                ri.FirstButton.Content.style.top = "26px";

                                this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.FirstButton));
                                // 1
                            } else {
                                MaxWidth = Math.max(((((Math.max(Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.FirstButton.Caption, ExpressCraft.Settings.DefaultFont)), Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.SecondButton.Caption, ExpressCraft.Settings.DefaultFont))) + 28) | 0) + 6) | 0), 64);

                                ri.FirstButton.Render();
                                ri.SecondButton.Render();

                                ri.FirstButton.Content.style.left = width + "px";
                                ri.SecondButton.Content.style.left = width + "px";

                                ri.FirstButton.Content.style.top = (21) + "px";

                                ri.FirstButton.Content.style.width = MaxWidth + "px";
                                ri.SecondButton.Content.style.width = MaxWidth + "px";

                                ri.FirstButton.Content.style.top = "11px";
                                ri.SecondButton.Content.style.top = "41px";

                                this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.FirstButton));
                                this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.SecondButton));
                                // 2
                            }
                        } else {
                            MaxWidth = Math.max(((((Math.max(Math.max(Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.FirstButton.Caption, ExpressCraft.Settings.DefaultFont)), Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.SecondButton.Caption, ExpressCraft.Settings.DefaultFont))), Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.ThirdButton.Caption, ExpressCraft.Settings.DefaultFont))) + 28) | 0) + 6) | 0), 64);

                            ri.FirstButton.Render();
                            ri.SecondButton.Render();
                            ri.ThirdButton.Render();

                            ri.FirstButton.Content.style.left = width + "px";
                            ri.SecondButton.Content.style.left = width + "px";
                            ri.ThirdButton.Content.style.left = width + "px";

                            ri.FirstButton.Content.style.width = MaxWidth + "px";
                            ri.SecondButton.Content.style.width = MaxWidth + "px";
                            ri.ThirdButton.Content.style.width = MaxWidth + "px";

                            ri.FirstButton.Content.style.top = "3px";
                            ri.SecondButton.Content.style.top = "26px";
                            ri.ThirdButton.Content.style.top = "49px";
                            // 3

                            this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.FirstButton));
                            this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.SecondButton));
                            this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.ThirdButton));
                        }

                        width = (width + MaxWidth) | 0;
                    } else {
                        ri.FirstButton.Render();

                        ri.FirstButton.Content.style.left = width + "px";
                        var inwidth = 0;
                        if (System.String.contains(ri.FirstButton.Caption," ")) {
                            var strings = System.String.split(ri.FirstButton.Caption, [32].map(function(i) {{ return String.fromCharCode(i); }}));
                            var builder = new System.Text.StringBuilder();

                            var length = (Bridge.Int.div(ri.FirstButton.Caption.length, 2)) | 0;

                            for (var j = 0; j < strings.length; j = (j + 1) | 0) {
                                if (builder.getLength() > length) {
                                    inwidth = (Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(builder.toString(), ExpressCraft.Settings.DefaultFont)) + 20) | 0;
                                    break;
                                }
                                if (builder.getLength() > 0) {
                                    builder.append(System.String.concat(" ", strings[System.Array.index(j, strings)]));
                                } else {
                                    builder.append(strings[System.Array.index(j, strings)]);
                                }
                            }
                            if (inwidth === 0) {
                                inwidth = (Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(builder.toString(), ExpressCraft.Settings.DefaultFont)) + 20) | 0;
                            }
                        } else {
                            inwidth = (Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(ri.FirstButton.Caption, ExpressCraft.Settings.DefaultFont)) + 20) | 0;
                        }

                        if (inwidth < 44) {
                            inwidth = 44;
                        }

                        ri.FirstButton.Content.style.width = inwidth + "px";

                        width = (width + inwidth) | 0;

                        this.Content.appendChild(ExpressCraft.Control.op_Implicit(ri.FirstButton));
                    }
                }

                var minWidth = (Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(this.Caption, ExpressCraft.Settings.DefaultFont)) + 20) | 0;

                if (width < minWidth) {
                    width = minWidth;
                }

                width = (width + 3) | 0;

                var vl = this.CreateVerticalLine(80);
                vl.style.left = ((width - 1) | 0) + "px";

                this.Content.appendChild(vl);

                this.Content.style.width = width + "px";

                if (!System.String.isNullOrWhiteSpace(this.Caption)) {
                    this.captionDiv = ExpressCraft.Control.Div$1("ribbongroupcaption");

                    this.captionDiv.innerHTML = this.Caption;
                    this.Content.appendChild(this.captionDiv);
                }

                this.setEnabled(this.enabled);
            }
        }
    });

    Bridge.define("ExpressCraft.RibbonPage", {
        inherits: [ExpressCraft.Control],
        fields: {
            RibbonHeader: null
        },
        props: {
            Caption: null,
            RibbonGroups: null
        },
        ctors: {
            init: function () {
                this.RibbonGroups = new (System.Collections.Generic.List$1(ExpressCraft.RibbonGroup))();
            },
            ctor: function (_caption) {
                if (_caption === void 0) { _caption = ""; }

                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "ribbonpage");
                this.Caption = _caption;
            }
        },
        methods: {
            AddRibbonGroups: function (pages) {
                if (pages === void 0) { pages = []; }
                if (pages != null) {
                    this.RibbonGroups.addRange(pages);
                }
            },
            Render: function () {
                this.HasRendered = true;
                if (this.RibbonGroups == null || this.RibbonGroups.Count === 0) {
                    return;
                }
                var width = 0;
                for (var i = 0; i < this.RibbonGroups.Count; i = (i + 1) | 0) {
                    this.RibbonGroups.getItem(i).Render();
                    this.RibbonGroups.getItem(i).Content.style.left = width + "px";
                    width = (width + (parseInt(this.RibbonGroups.getItem(i).Content.style.width))) | 0;
                    this.Content.appendChild(ExpressCraft.Control.op_Implicit(this.RibbonGroups.getItem(i)));
                }
            }
        }
    });

    Bridge.define("ExpressCraft.SimpleButton", {
        inherits: [ExpressCraft.Control],
        fields: {
            ItemClick: null,
            ParentForm: null,
            DialogResult: 0,
            _imageElement: null,
            _image: null,
            _useBase64Image: false,
            _imageRightAlign: false,
            _buttonImageSize: 0,
            enabled: false
        },
        props: {
            Image: {
                get: function () {
                    return this._image;
                },
                set: function (value) {
                    value = (System.String.concat(value, "")).trim();
                    if (!Bridge.referenceEquals(value, this._image)) {
                        this._image = value;
                        this._ProcessButtonImage();
                    }
                }
            },
            UseBase64Image: {
                get: function () {
                    return this._useBase64Image;
                },
                set: function (value) {
                    if (this._useBase64Image !== value) {
                        this._useBase64Image = value;
                        this._ProcessButtonImage();
                    }
                }
            },
            ImageRightAlign: {
                get: function () {
                    return this._imageRightAlign;
                },
                set: function (value) {
                    if (this._imageRightAlign !== value) {
                        this._imageRightAlign = value;
                        this._ProcessButtonImage();
                    }

                }
            },
            ButtonImageSize: {
                get: function () {
                    return this._buttonImageSize;
                },
                set: function (value) {
                    if (this._buttonImageSize !== value) {
                        this._buttonImageSize = value;
                        this._ProcessButtonImage();
                    }

                }
            },
            Text: {
                get: function () {
                    return this.Content.textContent;
                },
                set: function (value) {
                    if (!Bridge.referenceEquals(this.Text, value)) {
                        this.Content.textContent = value;

                        if (this._imageElement != null) {
                            ExpressCraft.Helper.Delete(this._imageElement);
                            this._imageElement = null;
                        }
                        this._ProcessButtonImage();
                    }
                }
            },
            Enabled: {
                get: function () {
                    return this.enabled;
                },
                set: function (value) {
                    this.enabled = value;
                    if (this.enabled) {
                        this.Content.removeAttribute("disabled");
                    } else {
                        this.Content.setAttribute("disabled", System.Boolean.toString((!this.enabled)));
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this.DialogResult = ExpressCraft.DialogResultEnum.None;
                this.enabled = true;
            },
            ctor: function (button, ac) {
                if (button === void 0) { button = 2; }
                if (ac === void 0) { ac = true; }

                this.$initialize();
                ExpressCraft.Control.$ctor2.call(this, "simplebutton", button, ac);
                this.Content.oncontextmenu = $asm.$.ExpressCraft.SimpleButton.f1;

                if (ac) {
                    this.Style.font = ExpressCraft.Settings.Font;
                }

                ExpressCraft.Helper.SetSize(this, "69px", "20px");

                this.Content.onclick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SimpleButton.f2);
                this.Content.ondblclick = $asm.$.ExpressCraft.SimpleButton.f3;
                this.Content.onmousedown = $asm.$.ExpressCraft.SimpleButton.f3;
                this.Content.onmouseup = $asm.$.ExpressCraft.SimpleButton.f3;
            }
        },
        methods: {
            _ProcessButtonImage: function () {
                if (System.String.isNullOrWhiteSpace(this._image)) {
                    if (this._imageElement != null) {
                        ExpressCraft.Helper.Delete(this._imageElement);
                        this._imageElement = null;
                    }
                } else {
                    if (this._imageElement == null) {
                        this._imageElement = new Image();
                    } else {
                        ExpressCraft.Helper.Delete(this._imageElement);
                    }
                    ExpressCraft.Helper.SetImage(this._imageElement, this._image, !this._useBase64Image, false);
                    var padding = this._buttonImageSize === 0 ? "16px" : ExpressCraft.Helper.ToPx(Bridge.box(this._buttonImageSize, System.Int32));

                    this._imageElement.style.height = padding;
                    this._imageElement.style.position = "absolute";
                    this._imageElement.style.top = "1px";

                    if (!this._imageRightAlign) {
                        this._imageElement.style.backgroundPosition = "left";
                        this._imageElement.style.paddingLeft = padding;
                        this._imageElement.style.paddingRight = "";

                        this._imageElement.style.left = "1px";

                        if (this.Content.lastChild == null) {
                            this.Content.appendChild(this._imageElement);
                        } else {
                            this.Content.insertBefore(this._imageElement, this.Content.lastChild);
                        }
                    } else {
                        this._imageElement.style.right = "1px";
                        this._imageElement.style.left = "";
                        this._imageElement.style.backgroundPosition = "right";
                        this._imageElement.style.paddingRight = padding;
                        this._imageElement.style.paddingLeft = "";

                        this.Content.appendChild(this._imageElement);
                    }
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.SimpleButton", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.SimpleButton, {
        f1: function (ev) {
            ev.stopPropagation();
            ev.preventDefault();
        },
        f2: function (ev) {
            if (this.enabled) {
                this.Content.blur();

                if (this.DialogResult !== ExpressCraft.DialogResultEnum.None && this.ParentForm != null && this.ParentForm.IsDialog()) {
                    this.ParentForm.DialogResult = this.DialogResult;
                }

                if (!Bridge.staticEquals(this.ItemClick, null)) {
                    this.ItemClick(this);
                }

                if (this.DialogResult !== ExpressCraft.DialogResultEnum.None && this.ParentForm.DialogResult !== ExpressCraft.DialogResultEnum.None && this.ParentForm != null && this.ParentForm.IsDialog()) {
                    this.ParentForm.Close();
                }
            }

            ev.stopPropagation();
            ev.stopImmediatePropagation();
        },
        f3: function (ev) {
            ev.stopPropagation();
            ev.stopImmediatePropagation();
        }
    });

    Bridge.define("ExpressCraft.SplitControlContainer", {
        inherits: [ExpressCraft.Control],
        fields: {
            Panel1: null,
            Panel2: null,
            Splitter: null,
            _prevClientRect: null,
            IsMouseDown: false,
            _mouseDownVector: null,
            _currentMouseDownVector: null,
            _startingSplitterPos: 0,
            _splitterPosition: 0,
            fixedSplitterPostion: 0,
            SplitterResizable: false,
            horizontal: false
        },
        props: {
            FixedSplitterPostion: {
                get: function () {
                    return this.fixedSplitterPostion;
                },
                set: function (value) {
                    this.fixedSplitterPostion = value;
                    this.RenderControls();
                }
            },
            SplitterPosition: {
                get: function () {
                    return this._splitterPosition;
                },
                set: function (value) {
                    if (value < 0) {
                        value = 0;
                    }
                    this._splitterPosition = value;
                    this.RenderControls();
                }
            },
            Horizontal: {
                get: function () {
                    return this.horizontal;
                },
                set: function (value) {
                    if (value !== this.horizontal) {
                        this.RenderControls();
                        this.horizontal = value;
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this._mouseDownVector = new ExpressCraft.Vector2();
                this._currentMouseDownVector = new ExpressCraft.Vector2();
                this.IsMouseDown = false;
                this._splitterPosition = -1;
                this.fixedSplitterPostion = ExpressCraft.FixedSplitterPosition.Panel1;
                this.SplitterResizable = true;
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "splitcontrol");
                var $t;
                this.Panel1 = ($t = new ExpressCraft.Control.$ctor1(), $t.Location = new ExpressCraft.Vector2.$ctor1(0, 0), $t);
                this.Panel2 = new ExpressCraft.Control.$ctor1();
                this.Panel1.Style.overflow = "auto";
                this.Panel2.Style.overflow = "auto";

                this.Splitter = new ExpressCraft.Control.$ctor1();

                this.Splitter.Content.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitControlContainer.f1);

                this.OnResize = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitControlContainer.f2);

                this.Content.onmousemove = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitControlContainer.f3);

                this.Content.onmouseup = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitControlContainer.f4);

                ExpressCraft.Helper.AppendChildren(this, [this.Panel1, this.Splitter, this.Panel2]);
        }
    },
    methods: {
        Render: function () {
            ExpressCraft.Control.prototype.Render.call(this);

            this.RenderControls();
        },
        ResizeChildren: function () {
            if (this.LinkedForm != null && this.Content != null) {
                this.LinkedForm.ResizeChildren(this.Content);
            }
        },
        GetMaxSplitterSize: function () {
            var maxSize = (Bridge.Int.clip32((this.Horizontal ? this.Content.getBoundingClientRect().height : this.Content.getBoundingClientRect().width)) - 12) | 0;
            if (maxSize < 0) {
                maxSize = 0;
            }
            return maxSize;
        },
        RenderControls: function () {
            var sp = this.SplitterPosition;
            var maxSize = this.GetMaxSplitterSize();

            if (this._prevClientRect != null) {
                if (sp > maxSize) {
                    sp = maxSize;
                }
            }

            if (this.Horizontal) {
                ExpressCraft.Helper.ExchangeClass$1(this.Panel1, "splitvertical", "splithorizontal");
                ExpressCraft.Helper.ExchangeClass$1(this.Panel2, "splitvertical", "splithorizontal");
                ExpressCraft.Helper.ExchangeClass$1(this.Splitter, "splittervertical", "splitterhorizontal");

                this.Panel1.Width = "";
                this.Splitter.Width = "";
                this.Panel2.Width = "";

                if (this.fixedSplitterPostion !== ExpressCraft.FixedSplitterPosition.Panel2) {
                    this.Splitter.Location = new ExpressCraft.Vector2.$ctor1(0, sp);

                    this.Panel1.Height = sp;
                    this.Panel2.Location = new ExpressCraft.Vector2.$ctor1(0, ((sp + 12) | 0));
                    this.Panel2.Height = "(100% - " + (((sp + 12) | 0)) + "px)";
                    ;
                } else {
                    this.Splitter.Location = new ExpressCraft.Vector2.$ctor1(0, "(100% - " + (sp) + "px)");

                    this.Panel1.Height = "(100% - " + sp + "px)";

                    this.Panel2.Height = (sp - 12) | 0;
                    this.Panel2.Location = new ExpressCraft.Vector2.$ctor1(0, "(100% - " + (((sp - 12) | 0)) + "px)");
                }
            } else {
                ExpressCraft.Helper.ExchangeClass$1(this.Panel1, "splithorizontal", "splitvertical");
                ExpressCraft.Helper.ExchangeClass$1(this.Panel2, "splithorizontal", "splitvertical");
                ExpressCraft.Helper.ExchangeClass$1(this.Splitter, "splitterhorizontal", "splittervertical");

                this.Panel1.Height = "";
                this.Splitter.Height = "";
                this.Panel2.Height = "";

                if (this.fixedSplitterPostion !== ExpressCraft.FixedSplitterPosition.Panel2) {
                    this.Splitter.Location = new ExpressCraft.Vector2.$ctor1(sp, 0);

                    this.Panel1.Width = sp;

                    this.Panel2.Width = "(100% - " + (((sp + 12) | 0)) + "px)";
                    this.Panel2.Location = new ExpressCraft.Vector2.$ctor1(((sp + 12) | 0), 0);
                } else {
                    this.Splitter.Location = new ExpressCraft.Vector2.$ctor1("(100% - " + sp + "px)", 0);

                    this.Panel1.Width = "(100% - " + sp + "px)";

                    this.Panel2.Width = sp;
                    this.Panel2.Location = new ExpressCraft.Vector2.$ctor1("(100% - " + (((sp + 12) | 0)) + "px)", 0);
                }
            }
        }
    }
    });

    Bridge.ns("ExpressCraft.SplitControlContainer", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.SplitControlContainer, {
        f1: function (ev) {
            if (!this.SplitterResizable) {
                return;
            }
            this.IsMouseDown = true;
            this._mouseDownVector = ExpressCraft.Helper.GetClientMouseLocation(ev);
            var maxSize = this.GetMaxSplitterSize();
            this._startingSplitterPos = this._splitterPosition > maxSize ? maxSize : this._splitterPosition;
            ev.stopImmediatePropagation();
        },
        f2: function (ev) {
            if (this.LinkedForm != null) {
                if (!this.LinkedForm.IsVisible()) {
                    return;
                }
            }
            var clientRec = this.Content.getBoundingClientRect();

            if (this._prevClientRect == null) {
                this._prevClientRect = clientRec;
            }

            if (this.fixedSplitterPostion === ExpressCraft.FixedSplitterPosition.None) {
                var V1 = 0;
                var V2 = 0;
                var dirty = false;

                if (this.Horizontal) {
                    if (clientRec.height !== this._prevClientRect.height) {
                        V1 = clientRec.height;
                        V2 = this._prevClientRect.height;
                        dirty = true;
                    }
                } else {
                    if (clientRec.width !== this._prevClientRect.width) {
                        V1 = clientRec.width;
                        V2 = this._prevClientRect.width;
                        dirty = true;
                    }
                }
                if (dirty) {
                    this.SplitterPosition = V1 === 0 || V2 === 0 ? 0 : Bridge.Int.clip32(this.SplitterPosition * (V1 / V2));
                }
            }

            this._prevClientRect = clientRec;

            this.RenderControls();

            this.ResizeChildren();
        },
        f3: function (ev) {
            if (this.IsMouseDown) {
                this._currentMouseDownVector = ExpressCraft.Helper.GetClientMouseLocation(ev);
                var x;
                var m = this.horizontal ? (((this._mouseDownVector.Yi - this._currentMouseDownVector.Yi) | 0)) : (((this._mouseDownVector.Xi - this._currentMouseDownVector.Xi) | 0));

                var y = this.GetMaxSplitterSize();
                if (((x = this.fixedSplitterPostion === ExpressCraft.FixedSplitterPosition.Panel2 ? ((this._startingSplitterPos + m) | 0) : ((this._startingSplitterPos - m) | 0))) > y) {
                    x = y;
                }
                this.SplitterPosition = x;
                this._currentMouseDownVector = this._mouseDownVector.$clone();

                this.ResizeChildren();
            }
        },
        f4: function (ev) {
            this.IsMouseDown = false;
            this.RenderControls();
        }
    });

    Bridge.define("ExpressCraft.SplitHideControlContainer", {
        inherits: [ExpressCraft.Control],
        fields: {
            Body: null,
            Slider: null,
            Panel: null,
            span: null,
            _slideWidth: 0,
            _sliderLocation: 0,
            _sliderVisible: false,
            refreshId: 0
        },
        props: {
            SlideWidth: {
                get: function () {
                    return this._slideWidth;
                },
                set: function (value) {
                    if (this._slideWidth !== value) {
                        this._slideWidth = value;
                        this.RenderControl();
                        this.ResizeChildren();
                    }
                }
            },
            SliderLocation: {
                get: function () {
                    return this._sliderLocation;
                },
                set: function (value) {
                    if (this._sliderLocation !== value) {
                        this._sliderLocation = value;
                        this.RenderControl();
                        this.ResizeChildren();
                    }
                }
            },
            SliderVisible: {
                get: function () {
                    return this._sliderVisible;
                },
                set: function (value) {
                    if (this._sliderVisible !== value) {
                        this._sliderVisible = value;
                        this.RenderControl();
                        this.ResizeChildren();
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this._sliderLocation = ExpressCraft.SliderLocation.Left;
                this._sliderVisible = false;
                this.refreshId = -1;
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor1.call(this);
                this.Body = new ExpressCraft.Control.$ctor1();
                this.Slider = new ExpressCraft.Control.$ctor5("primary");
                this.Panel = new ExpressCraft.Control.$ctor1();
                this.span = ExpressCraft.Control.Span$1("form-heading-title");
                this.span.textContent = ">";

                this.span.style.fontWeight = "bold";
                this.span.style.color = "white";

                this.Slider.Content.appendChild(this.span);

                this.Slider.Content.onmouseenter = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitHideControlContainer.f1);

                this.Slider.Content.onmouseleave = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitHideControlContainer.f2);

                this.Slider.Style.transition = "width 1s, left 1s";
                this.Body.Style.transition = "left 1s, width 1s";
                this.Panel.Style.transition = "width 1s";

                this.Slider.Style.filter = "brightness(90%)";

                if (ExpressCraft.Helper.NotDesktop) {
                    this.span.style.fontStyle = "36px";
                    this.Slider.Width = 65;
                } else {
                    this.span.style.fontStyle = "26px";
                    this.Slider.Width = 30;
                }

                this.Slider.Height = "100%";

                this.Slider.Content.onclick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitHideControlContainer.f3);
                this._slideWidth = 250;
                ExpressCraft.Helper.AppendChildren$2(this.Content, [this.Panel, this.Slider, this.Body]);

                this.RenderControl();
            }
        },
        methods: {
            ResizeChildren: function () {
                if (this.LinkedForm != null && this.Content != null) {
                    if (this.refreshId !== -1) {
                        Bridge.global.clearTimeout(this.refreshId);
                    }
                    this.refreshId = Bridge.global.setTimeout(Bridge.fn.bind(this, $asm.$.ExpressCraft.SplitHideControlContainer.f4), 1000);
                }
            },
            RenderControl: function () {
                var width;
                if (ExpressCraft.Helper.NotDesktop) {
                    width = 65;
                } else {
                    width = 30;
                }

                if (this.SliderLocation === ExpressCraft.SliderLocation.Left) {
                    if (this.SliderVisible) {
                        this.span.textContent = "<";
                        this.Panel.Width = this.SlideWidth;
                        this.Slider.Left = this.SlideWidth;
                        this.Body.Location = new ExpressCraft.Vector2.$ctor1(((width + this.SlideWidth) | 0), 0);
                        this.Body.Size = new ExpressCraft.Vector2.$ctor1("(100% - " + (((width + this.SlideWidth) | 0)) + "px)", "100%");
                    } else {
                        this.span.textContent = ">";
                        this.Slider.Left = 0;
                        this.Panel.Width = 0;
                        this.Body.Location = new ExpressCraft.Vector2.$ctor1(width, 0);
                        this.Body.Size = new ExpressCraft.Vector2.$ctor1("(100% - " + (width) + "px)", "100%");
                    }

                    this.Panel.Location = new ExpressCraft.Vector2.$ctor1(0, 0);
                    this.Panel.Height = "100%";
                } else {
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.SplitHideControlContainer", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.SplitHideControlContainer, {
        f1: function (ev) {
            this.Slider.Style.filter = "brightness(110%)";
        },
        f2: function (ev) {
            this.Slider.Style.filter = "brightness(90%)";
        },
        f3: function (ev) {
            this.SliderVisible = !this.SliderVisible;
        },
        f4: function () {
            this.LinkedForm.ResizeChildren(this.Content);
            this.refreshId = -1;
        }
    });

    Bridge.define("ExpressCraft.TabControl", {
        inherits: [ExpressCraft.Control],
        fields: {
            tabHeaders: null,
            tabHeaderContainer: null,
            showClosedButton: false,
            OnSelectedTabIndexChanged: null,
            selectedindex: 0
        },
        props: {
            TabPages: null,
            ShowClosedButton: {
                get: function () {
                    return this.showClosedButton;
                },
                set: function (value) {
                    if (value !== this.showClosedButton) {
                        this.showClosedButton = value;
                        this.ResizeTabHeaders();
                    }
                }
            },
            SelectedIndex: {
                get: function () {
                    return this.selectedindex;
                },
                set: function (value) {
                    if (value < 0) {
                        value = 0;
                    }
                    if (this.selectedindex !== value) {
                        this.selectedindex = value;
                        !Bridge.staticEquals(this.OnSelectedTabIndexChanged, null) ? this.OnSelectedTabIndexChanged(value) : null;
                    }

                    if (this.TabPages != null && this.TabPages.Count > 0) {
                        for (var i = 0; i < this.TabPages.Count; i = (i + 1) | 0) {
                            var page = { v : this.TabPages.getItem(i) };
                            this.TabControlActiveStyleChange(i, page);
                            this.TabPages.setItem(i, page.v);
                        }
                    }
                }
            }
        },
        ctors: {
            init: function () {
                this.selectedindex = 0;
                this.TabPages = new (System.Collections.Generic.List$1(ExpressCraft.TabControlPage))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "tabcontrol");
                this.Content.oncontextmenu = $asm.$.ExpressCraft.TabControl.f1;
            }
        },
        methods: {
            AddPages: function (Pages) {
                if (Pages === void 0) { Pages = []; }
                this.TabPages.addRange(Pages);
                if (this.HasRendered) {
                    this.ResizeTabHeaders();
                }
            },
            TabControlActiveStyleChange: function (i, page) {
                var Isselected = i === this.selectedindex;

                var state = Isselected ? "active" : "hidden";
                if (page.v.TabPageHeader != null) {
                    page.v.TabPageHeader.classList.remove("tabcontrolpageheader-hidden");
                    page.v.TabPageHeader.classList.remove("tabcontrolpageheader-active");

                    page.v.TabPageHeader.classList.add(System.String.concat("tabcontrolpageheader-", state));
                } else {
                    page.v.TabPageHeader = ExpressCraft.Control.Div$1(System.String.concat("tabcontrolpageheader tabcontrolpageheader-", state));
                }
                if (ExpressCraft.Helper.NotDesktop) {
                    if (Isselected) {
                        page.v.TabPageHeader.style.lineHeight = "44px";
                    } else {
                        page.v.TabPageHeader.style.lineHeight = "46px";
                    }
                    page.v.TabPageHeader.style.height = "45px";
                }

                page.v.TabPageHeader.setAttribute("i", i.toString());
                if (this.showClosedButton) {
                    if (page.v.TabPageHeaderClose == null) {
                        page.v.TabPageHeaderClose = ExpressCraft.Control.Div$1("tabcontrolpageheader-closebutton");
                        page.v.TabPageHeaderClose.onclick = Bridge.fn.bind(this, $asm.$.ExpressCraft.TabControl.f2);
                        page.v.TabPageHeader.appendChild(page.v.TabPageHeaderClose);
                    }
                } else {
                    if (page.v.TabPageHeaderClose != null) {
                        page.v.TabPageHeader.removeChild(page.v.TabPageHeaderClose);
                    }
                }

                page.v.Content.style.visibility = Isselected ? "inherit" : "collapse";
            },
            ResizeTabHeaders: function () {
                var $t, $t1;
                if (this.tabHeaders == null) {
                    this.tabHeaders = ($t = new ExpressCraft.Control.$ctor5("tabheader-container"), $t.Location = new ExpressCraft.Vector2.$ctor1(0, 0), $t);
                    if (ExpressCraft.Helper.NotDesktop) {
                        this.tabHeaders.Height = 47;
                        this.tabHeaderContainer = ($t = new ExpressCraft.Control.$ctor1(), $t.Location = new ExpressCraft.Vector2.$ctor1(0, 0), $t);
                        this.tabHeaderContainer.Width = "100%";
                        this.tabHeaderContainer.Height = 50;
                        ExpressCraft.Helper.AppendChild(this.tabHeaderContainer, this.tabHeaders);
                        this.tabHeaderContainer.Style.backgroundColor = "transparent";
                        this.tabHeaderContainer.Style.overflowX = "auto";

                        this.tabHeaders.Style.minWidth = "100%";

                        this.Content.appendChild(ExpressCraft.Control.op_Implicit(this.tabHeaderContainer));
                    } else {
                        this.tabHeaders.Height = 23;
                        this.Content.appendChild(ExpressCraft.Control.op_Implicit(this.tabHeaders));
                        this.tabHeaders.Width = "100%";
                    }
                }
                if (this.TabPages != null && this.TabPages.Count > 0) {
                    var width = 2;

                    for (var i = 0; i < this.TabPages.Count; i = (i + 1) | 0) {
                        var page = { v : this.TabPages.getItem(i) };

                        page.v.Render();

                        if (page.v.TabPageHeader == null) {
                            this.TabControlActiveStyleChange(i, page);
                            page.v.TabPageHeader.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.TabControl.f3);
                            page.v.TabPageHeader.ontouchstart = Bridge.fn.bind(this, $asm.$.ExpressCraft.TabControl.f3);
                            this.tabHeaders.Content.appendChild(page.v.TabPageHeader);
                            this.Content.appendChild(page.v.Content);
                        }
                        page.v.TabPageHeader.setAttribute("i", i.toString());

                        var inwidth = 24;

                        if (!System.String.isNullOrEmpty(page.v.Caption)) {
                            if (ExpressCraft.Helper.NotDesktop) {
                                inwidth = (inwidth + Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(page.v.Caption, "14px Tahoma"))) | 0;
                            } else {
                                inwidth = (inwidth + Bridge.Int.clip32(ExpressCraft.Control.GetTextWidth(page.v.Caption, ExpressCraft.Settings.DefaultFont))) | 0;
                            }
                        }

                        if (this.showClosedButton) {
                            inwidth = (inwidth + 19) | 0;
                        }
                        var span = null;
                        $t = Bridge.getEnumerator(page.v.TabPageHeader.children);
                        try {
                            while ($t.moveNext()) {
                                var item = $t.Current;
                                if (Bridge.is(item, HTMLSpanElement)) {
                                    ((span = item)).innerHTML = page.v.Caption;
                                    break;
                                }
                            }
                        } finally {
                            if (Bridge.is($t, System.IDisposable)) {
                                $t.System$IDisposable$dispose();
                            }
                        }if (span == null) {
                            span = ($t1 = document.createElement("span"), $t1.innerHTML = page.v.Caption, $t1);

                            page.v.TabPageHeader.appendChild(span);
                        }
                        if (ExpressCraft.Helper.NotDesktop) {
                            span.style.fontSize = "14px";
                        }

                        page.v.TabPageHeader.style.left = ExpressCraft.Helper.ToPx(Bridge.box(width, System.Int32));
                        page.v.TabPageHeader.style.width = ExpressCraft.Helper.ToPx(Bridge.box(inwidth, System.Int32));

                        //                height: calc(100% - 26px);
                        //top: 24px;

                        if (ExpressCraft.Helper.NotDesktop) {
                            page.v.Height = "(100% - 49px)";
                            page.v.Top = 49;
                        }

                        width = (width + (((inwidth + 2) | 0))) | 0;

                        this.TabPages.setItem(i, page.v);
                    }
                    if (ExpressCraft.Helper.NotDesktop) {
                        this.tabHeaders.Width = width;
                    }
                }
            },
            Render: function () {
                this.HasRendered = true;
                this.ResizeTabHeaders();
            }
        }
    });

    Bridge.ns("ExpressCraft.TabControl", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.TabControl, {
        f1: function (ev) {
            ev.stopPropagation();
            ev.preventDefault();
        },
        f2: function (ev) {
            var index = parseInt(ev.currentTarget.parentElement.getAttribute("i"));
            var cpage = this.TabPages.getItem(index);
            if (cpage.Content != null) {
                ExpressCraft.Helper.Empty(cpage.Content);
                ExpressCraft.Helper.Delete(cpage.Content);
            }
            if (cpage.TabPageHeader != null) {
                ExpressCraft.Helper.Empty(cpage.TabPageHeader);
                ExpressCraft.Helper.Delete(cpage.TabPageHeader);
            }
            this.TabPages.remove(cpage);
            if (index > ((this.TabPages.Count - 1) | 0)) {
                index = (this.TabPages.Count - 1) | 0;
            }

            ev.stopPropagation();

            this.SelectedIndex = index;

            this.ResizeTabHeaders();
        },
        f3: function (ev) {
            this.SelectedIndex = parseInt(ev.currentTarget.getAttribute("i"));
        }
    });

    Bridge.define("ExpressCraft.TabControlPage", {
        inherits: [ExpressCraft.Control],
        fields: {
            index: 0,
            TabPageHeader: null,
            TabPageHeaderClose: null
        },
        props: {
            Caption: null
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "tabcontrolpage");
            }
        }
    });

    Bridge.define("ExpressCraft.TileControl", {
        inherits: [ExpressCraft.Control,ExpressCraft.IPages],
        fields: {
            _viewState: 0,
            prevOverFlow: null,
            ClearTimeOut: 0
        },
        props: {
            RibbonPages: null,
            ViewState: {
                get: function () {
                    return this._viewState;
                },
                set: function (value) {
                    if (this.ClearTimeOut !== -1) {
                        Bridge.global.clearTimeout(this.ClearTimeOut);
                        this.ClearTimeOut = -1;
                    }
                    if (value !== this._viewState) {
                        this._viewState = value;
                        if (this._viewState === ExpressCraft.TileViewState.Hidden) {
                            this.ClearTimeOut = Bridge.global.setTimeout(Bridge.fn.bind(this, $asm.$.ExpressCraft.TileControl.f1), 1000);
                            this.Location = new ExpressCraft.Vector2.$ctor1("(100% * -1)", 0);

                            if (this.Content.parentElement != null && this.prevOverFlow != null) {
                                this.Content.parentElement.style.overflow = this.prevOverFlow;
                            }
                        } else {
                            this.Location = new ExpressCraft.Vector2.$ctor1(0, 0);
                            this.Content.style.visibility = "inherit";
                            this.RenderTiles();
                            if (this.Content.parentElement != null) {
                                this.prevOverFlow = this.Content.parentElement.style.overflow;
                                this.Content.parentElement.style.overflow = "hidden";
                            }
                        }
                    }
                }
            }
        },
        alias: ["AddRibbonPages", "ExpressCraft$IPages$AddRibbonPages"],
        ctors: {
            init: function () {
                this._viewState = ExpressCraft.TileViewState.Hidden;
                this.ClearTimeOut = -1;
                this.RibbonPages = new (System.Collections.Generic.List$1(ExpressCraft.RibbonPage))();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.Control.$ctor1.call(this);
                this.Style.overflowY = "auto";
                this.Location = new ExpressCraft.Vector2.$ctor1("(100% * -1)", 0);
                this.Size = new ExpressCraft.Vector2.$ctor1("100%", "100%");

                this.Content.style.backgroundColor = "transparent";
                this.Content.style.visibility = "hidden";
                this.Content.style.transition = "left 1s ease";
            }
        },
        methods: {
            RenderTiles: function () {
                var $t, $t1, $t2;
                var x = 0;
                var y = 6;

                var doc = document.createDocumentFragment();
                var div = new ExpressCraft.Control.$ctor1();
                div.Width = "100%";
                ExpressCraft.Helper.SetLocation$2(div, 0, 0);
                div.Style.zIndex = "10";

                var div2 = new ExpressCraft.Control.$ctor5("primary");
                div2.Width = "100%";
                div2.Style.minHeight = "100%";
                ExpressCraft.Helper.SetLocation$2(div2, 0, 0);
                div2.Style.filter = "brightness(50%)";

                div2.Style.opacity = "0.9";
                div2.Style.zIndex = "9";

                $t = Bridge.getEnumerator(this.RibbonPages);
                try {
                    while ($t.moveNext()) {
                        var page = $t.Current;
                        if (!System.String.isNullOrWhiteSpace(page.Caption)) {
                            var llb = ExpressCraft.Control.Label(page.Caption, 6, y);
                            llb.style.fontSize = "14px";
                            llb.style.color = "white";
                            doc.appendChild(llb);
                            y = (y + 26) | 0;
                        }

                        $t1 = Bridge.getEnumerator(page.RibbonGroups);
                        try {
                            while ($t1.moveNext()) {
                                var group = $t1.Current;
                                $t2 = Bridge.getEnumerator(group.Buttons);
                                try {
                                    while ($t2.moveNext()) {
                                        var button = $t2.Current;
                                        ExpressCraft.Helper.ExchangeClass$1(button, "ribbonbuttonsmall", "ribbonbutton");
                                        button.Style.borderRadius = "4px";
                                        button.AfterItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.TileControl.f2);
                                        if (button.Enabled) {
                                            ExpressCraft.Helper.ExchangeClass$1(button, "primary", "primary");
                                            button.Style.border = "0";
                                            button.Style.filter = "brightness(110%)";
                                        } else {
                                            ExpressCraft.Helper.ExchangeClass$1(button, "primary", "");
                                            button.Style.border = "1px";
                                            button.Style.filter = "";
                                        }
                                        button.Style.opacity = "1";
                                        button.Style.boxShadow = "0px 0px 10px -2px rgba(0,0,0,0.25)";
                                        button.IsSmallCaption = false;
                                        button.ProcessCaption();
                                        button.ProcessImage();
                                        button.Size = new ExpressCraft.Vector2.$ctor1("((100% - 24px) * 0.33)", 100);
                                        button.Location = new ExpressCraft.Vector2.$ctor1("(((100% - 24px) * (" + (System.Decimal(x).mul(System.Decimal(0.33))) + ")) + (" + (Bridge.Int.mul(6, (x))) + "px) + 6px)", y);

                                        if (button.captionDiv != null) {
                                            if (button.Enabled) {
                                                button.captionDiv.style.color = "white";
                                            } else {
                                                button.captionDiv.style.color = "grey";
                                            }

                                            button.captionDiv.style.fontSize = "14px";
                                            button.captionDiv.style.top = "65px";
                                        }

                                        if (button.imageDiv != null) {
                                            ExpressCraft.Helper.ExchangeClass(button.imageDiv, "ribbonbuttonsmallicon", "ribbonbuttonicon");
                                            button.IconURL = System.String.replaceAll((System.String.concat(button.IconURL, "")), "x16x16", "x32x32");
                                            button.imageDiv.style.top = "27px";
                                            if (button.Enabled) {
                                                //  button.imageDiv.Style.Filter = "brightness(90%) grayscale(100%) contrast(60%) brightness(180%)";
                                            } else {
                                                //  button.imageDiv.Style.Filter = "";
                                            }
                                        }

                                        if (x === 2) {
                                            x = 0;
                                            y = (y + 106) | 0;
                                        } else {
                                            x = (x + 1) | 0;
                                        }
                                        button.Style.opacity = "1";
                                        doc.appendChild(ExpressCraft.Control.op_Implicit(button));
                                    }
                                } finally {
                                    if (Bridge.is($t2, System.IDisposable)) {
                                        $t2.System$IDisposable$dispose();
                                    }
                                }
                            }
                        } finally {
                            if (Bridge.is($t1, System.IDisposable)) {
                                $t1.System$IDisposable$dispose();
                            }
                        }
                        if (x !== 0) {
                            x = 0;
                            y = (y + 106) | 0;
                        }
                    }
                } finally {
                    if (Bridge.is($t, System.IDisposable)) {
                        $t.System$IDisposable$dispose();
                    }
                }
                div.Height = y;
                div2.Height = y;

                ExpressCraft.Helper.Empty(this.Content);
                div.Content.appendChild(doc);

                div2.Content.onmousedown = $asm.$.ExpressCraft.TileControl.f3;

                this.Content.appendChild(ExpressCraft.Control.op_Implicit(div2));
                this.Content.appendChild(ExpressCraft.Control.op_Implicit(div));

                div.Content.click();
            },
            Render: function () {
                ExpressCraft.Control.prototype.Render.call(this);
                this.RenderTiles();
            },
            AddRibbonPages: function (pages) {
                if (pages === void 0) { pages = []; }
                if (pages != null) {
                    this.RibbonPages.addRange(pages);
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.TileControl", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.TileControl, {
        f1: function () {
            this.Content.style.visibility = "hidden";
        },
        f2: function (ev) {
            this.ViewState = ExpressCraft.TileViewState.Hidden;
        },
        f3: function (ev) {
            ev.stopPropagation();
        }
    });

    Bridge.define("ExpressCraft.ToolTipControl", {
        inherits: [ExpressCraft.Control],
        fields: {
            visible: false,
            _toolTip$1: null
        },
        ctors: {
            init: function () {
                this.visible = false;
            },
            ctor: function (toolTip) {
                this.$initialize();
                ExpressCraft.Control.$ctor5.call(this, "tool-tip");
                this._toolTip$1 = toolTip;
            }
        },
        methods: {
            Show: function (ev) {
                var $t;
                if (ExpressCraft.Helper.NotDesktop) {
                    return;
                }

                ExpressCraft.Helper.Empty(this.Content);

                if (this._toolTip$1 != null) {
                    if (!ExpressCraft.Helper.IsEmpty(this._toolTip$1.Heading)) {
                        this.Content.appendChild(($t = document.createElement("p"), $t.className = "tool-tip-heading", $t.innerHTML = System.String.replaceAll(ExpressCraft.Helper.HtmlEscape$1(this._toolTip$1.Heading), "\r\n", "<br>"), $t));
                    }
                    if (!ExpressCraft.Helper.IsEmpty(this._toolTip$1.Description)) {
                        this.Content.appendChild(($t = document.createElement("p"), $t.className = "tool-tip-body", $t.innerHTML = System.String.replaceAll(ExpressCraft.Helper.HtmlEscape$1(this._toolTip$1.Description), "\r\n", "<br>"), $t));
                    }
                }
                var mouse = ExpressCraft.Helper.GetClientMouseLocation(ev);

                this.Location = new ExpressCraft.Vector2.$ctor1(mouse.X, ((ExpressCraft.Helper.ToInt(mouse.Y) + 22) | 0));

                if (!this.visible) {
                    this.visible = true;
                    ExpressCraft.ContextMenu.TotalContextHandles = (ExpressCraft.ContextMenu.TotalContextHandles + 1) | 0;
                    this.Content.style.zIndex = (((ExpressCraft.ContextMenu.TotalContextHandles + ExpressCraft.Settings.ContextMenuStartingZIndex) | 0)).toString();
                    document.body.appendChild(ExpressCraft.Control.op_Implicit(this));
                }
            },
            Close: function () {
                if (this.visible) {
                    if (this.Content != null) {
                        $(this.Content).fadeOut(100, Bridge.fn.bind(this, $asm.$.ExpressCraft.ToolTipControl.f1));
                    }
                    this.visible = false;
                    ExpressCraft.ContextMenu.TotalContextHandles = (ExpressCraft.ContextMenu.TotalContextHandles - 1) | 0;
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.ToolTipControl", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.ToolTipControl, {
        f1: function () {
            ExpressCraft.Helper.Delete(this.Content);
        }
    });

    Bridge.define("ExpressCraft.FormPopup", {
        inherits: [ExpressCraft.Form],
        statics: {
            methods: {
                GetPopupDefaultLocation: function (control, isControlChild) {
                    if (isControlChild === void 0) { isControlChild = false; }
                    if (ExpressCraft.Helper.NotDesktop) {
                        return new ExpressCraft.Vector2.$ctor1(0, 0);
                    }

                    if (isControlChild) {
                        var rec = control.Content.parentElement.getBoundingClientRect();
                        return new ExpressCraft.Vector2.$ctor1(rec.left, rec.top + rec.height);
                    } else {
                        var rec1 = control.Content.getBoundingClientRect();
                        return new ExpressCraft.Vector2.$ctor1(rec1.left, rec1.top + rec1.height);
                    }
                }
            }
        },
        fields: {
            PreviousScrollTop: 0,
            ParentContainer: null
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.Form.ctor.call(this);
                this.Heading.style.display = "none";
                ExpressCraft.Helper.SetLocation(this.Body, 0, 0);
                ExpressCraft.Helper.SetSize$1(this.Body, "100%", "100%");
                this.Content.classList.add("inputcontrol");
                this.Content.classList.remove("form-base");
                this.Content.style.boxShadow = "0 0 63px -17px rgba(0,0,0,0.75)";

                this.StartPosition = ExpressCraft.FormStartPosition.Manual;

                this.ShowClose = false;
                this.ShowMaximize = false;
                this.ShowMinimize = false;
                this.AllowMoveChange = false;
                this.AllowSizeChange = false;
            }
        },
        methods: {
            ShowPopup: function (location) {
                this.Location = location.$clone();
                this.ShowDialog();
            },
            MoveFormUp: function () {
                this.Location = new ExpressCraft.Vector2.$ctor1(this.Left, ExpressCraft.Helper.ToFloat(this.Top) - ExpressCraft.Helper.ToFloat(this.Height) - 20);
            },
            OnShowed: function () {
                ExpressCraft.Form.prototype.OnShowed.call(this);

                if (ExpressCraft.Helper.NotDesktop) {
                    this.AllowSizeChange = true;
                    this.WindowState = ExpressCraft.WindowStateType.Maximized;
                    this.AllowSizeChange = false;
                } else {
                    var rect = this.Content.getBoundingClientRect();

                    try {
                        if (rect.bottom > window.innerHeight || rect.bottom > document.documentElement.clientHeight) {
                            this.MoveFormUp();
                        }
                    }
                    catch ($e1) {
                        $e1 = System.Exception.create($e1);
                    }
                }
            },
            OnClosed: function () {
                ExpressCraft.Form.prototype.OnClosed.call(this);
            }
        }
    });

    Bridge.define("ExpressCraft.ColorInput", {
        inherits: [ExpressCraft.TextInput],
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.TextInput.$ctor1.call(this, "color");
            }
        }
    });

    Bridge.define("ExpressCraft.ConsoleForm", {
        inherits: [ExpressCraft.Form],
        statics: {
            fields: {
                ConsoleVisible: false,
                _consoleForm: null,
                prevWindowState: 0,
                firstLoad: false,
                prevLocation: null,
                prevSize: null
            },
            ctors: {
                init: function () {
                    this.prevLocation = new ExpressCraft.Vector2();
                    this.prevSize = new ExpressCraft.Vector2();
                    this.ConsoleVisible = false;
                    this.prevWindowState = ExpressCraft.WindowStateType.Normal;
                    this.firstLoad = true;
                    this.prevSize = ExpressCraft.Settings.ConsoleDefaultSize.$clone();
                }
            },
            methods: {
                CheckConsoleState: function () {
                    if (!ExpressCraft.ConsoleForm.ConsoleVisible) {
                        ExpressCraft.ConsoleForm._consoleForm = new ExpressCraft.ConsoleForm();
                        ExpressCraft.ConsoleForm._consoleForm.Show(true);
                    }
                },
                Log: function (source, logType) {
                    if (logType === void 0) { logType = 0; }
                    ExpressCraft.ConsoleForm.CheckConsoleState();
                    ExpressCraft.ConsoleForm._consoleForm.InternalLog(source, logType);
                },
                Clear: function () {
                    ExpressCraft.ConsoleForm.CheckConsoleState();
                    ExpressCraft.ConsoleForm._consoleForm.InternalClear();
                }
            }
        },
        fields: {
            logContent: null
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.Form.ctor.call(this);
                this.logContent = ExpressCraft.Control.Div$1("console-body");
                this.Body.appendChild(this.logContent);
                this.Body.style.background = ExpressCraft.Color.op_Implicit$1(ExpressCraft.Color.Black.$clone());
                this.Body.style.overflowY = "scroll";

                this.Text = System.String.concat(document.title, " - Console");
                if (ExpressCraft.ConsoleForm.firstLoad) {
                    this.StartPosition = ExpressCraft.FormStartPosition.Center;
                    this.Size = ExpressCraft.ConsoleForm.prevSize.$clone();
                } else {
                    this.StartPosition = ExpressCraft.FormStartPosition.Manual;
                    this.Location = ExpressCraft.ConsoleForm.prevLocation.$clone();

                    if (ExpressCraft.ConsoleForm.prevWindowState === ExpressCraft.WindowStateType.Maximized) {
                        ExpressCraft.ConsoleForm.prevSize = ExpressCraft.Settings.ConsoleDefaultSize.$clone();
                    }

                    this.Size = ExpressCraft.ConsoleForm.prevSize.$clone();

                    if (ExpressCraft.ConsoleForm.prevWindowState === ExpressCraft.WindowStateType.Maximized) {
                        this.SetWindowState(ExpressCraft.ConsoleForm.prevWindowState);
                    }
                }
            }
        },
        methods: {
            InternalClear: function () {
                ExpressCraft.Helper.Empty(this.logContent);
            },
            InternalLog: function (source, logType) {
                var $t;
                if (logType === void 0) { logType = 0; }
                var para = ($t = document.createElement("p"), $t.className = "console-para", $t);
                switch (logType) {
                    case ExpressCraft.ConsoleLogType.Debug: 
                        para.style.color = ExpressCraft.Color.op_Implicit$1(ExpressCraft.Color.ForestGreen.$clone());
                        break;
                    case ExpressCraft.ConsoleLogType.Error: 
                        para.style.color = ExpressCraft.Color.op_Implicit$1(ExpressCraft.Color.Red.$clone());
                        break;
                }

                para.innerHTML = source;
                this.logContent.appendChild(para);
                if (this.logContent.children.length > 1000) {
                    this.logContent.removeChild(this.logContent.children[0]);
                }
                para.scrollIntoView(false);
            },
            OnGotFocus: function () {
                if (this.Content != null) {
                    this.Style.opacity = "1";
                }
                ExpressCraft.Form.prototype.OnGotFocus.call(this);
            },
            OnLostFocus: function () {
                if (this.Content != null) {
                    this.Style.opacity = "0.5";
                }
                ExpressCraft.Form.prototype.OnLostFocus.call(this);
            },
            OnShowed: function () {
                ExpressCraft.Form.prototype.OnShowed.call(this);
                ExpressCraft.ConsoleForm.ConsoleVisible = true;
                ExpressCraft.ConsoleForm.firstLoad = false;
            },
            OnClosing: function () {
                ExpressCraft.Form.prototype.OnClosing.call(this);

                ExpressCraft.ConsoleForm.prevSize = this.Size.$clone();
                ExpressCraft.ConsoleForm.prevLocation = this.Location.$clone();
                ExpressCraft.ConsoleForm.prevWindowState = this.WindowState;
            },
            OnClosed: function () {
                ExpressCraft.Form.prototype.OnClosed.call(this);
                ExpressCraft.ConsoleForm.ConsoleVisible = false;
            }
        }
    });

    Bridge.define("ExpressCraft.DialogForm", {
        inherits: [ExpressCraft.Form],
        fields: {
            _buttonCollection: null,
            ButtonSection: null
        },
        ctors: {
            ctor: function (text) {
                if (text === void 0) { text = ""; }

                this.$initialize();
                ExpressCraft.Form.ctor.call(this);
                this.Text = text;
                this.Body.style.backgroundColor = "white";

                //           top:calc(100% - 70px);
                //width:100%;
                //height:70px;

                this.ButtonSection = new ExpressCraft.Control.$ctor5("dialogbuttonsection");

                if (ExpressCraft.Helper.NotDesktop) {
                    this.ButtonSection.Top = "(100% - 70px)";
                    this.ButtonSection.Size = new ExpressCraft.Vector2.$ctor1("100%", 70);
                }
            }
        },
        methods: {
            OnShowing: function () {
                this.Body.appendChild(ExpressCraft.Control.op_Implicit(this.ButtonSection));
                ExpressCraft.Form.prototype.OnShowing.call(this);
            }
        }
    });

    Bridge.define("ExpressCraft.TextInputDropDown", {
        inherits: [ExpressCraft.TextInput],
        fields: {
            DropDownButton: null,
            UsedEdit: null
        },
        ctors: {
            ctor: function (inputType) {
                if (inputType === void 0) { inputType = 19; }

                this.$initialize();
                ExpressCraft.TextInput.ctor.call(this, document.createElement("div"), true, false);
                var $t;
                var dropDownWidth = 17;

                if (ExpressCraft.Helper.NotDesktop) {
                    dropDownWidth = 45;
                }

                this.Type = inputType;

                this.UsedEdit = ($t = new ExpressCraft.TextInput.$ctor1(inputType), $t.DisableFocusPopup = true, $t.Location = new ExpressCraft.Vector2.$ctor1(0, 0), $t.Size = new ExpressCraft.Vector2.$ctor1("(100% - " + (((dropDownWidth - 1) | 0)) + "px)", "100%"), $t);
                this.UsedEdit.OnTextChanged = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInputDropDown.f1);

                this._displayFormat = this.UsedEdit.DisplayFormat;

                this.DropDownButton = ($t = new ExpressCraft.SimpleButton(), $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - " + dropDownWidth + "px)", 0), $t.Size = new ExpressCraft.Vector2.$ctor1(dropDownWidth, "100%"), $t);
                this.DropDownButton.Content.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextInputDropDown.f2);

                this.Style.border = "0";

                this.DropDownButton.ClassList.add("dropdown");

                if (ExpressCraft.Helper.NotDesktop) {
                    this.DropDownButton.Style.backgroundPosition = "right 16px center";
                }

                ExpressCraft.Helper.AppendChildren$2(this.Content, [this.UsedEdit, this.DropDownButton]);
        }
    },
    methods: {
        GetDisplayFormat: function () {
            return this.UsedEdit.GetDisplayFormat();
        },
        GetDropdownWidth: function () {
            return this.Content.getBoundingClientRect().width;
        },
        SetDisplayFormat: function (value) {
            this.UsedEdit.SetDisplayFormat(value);
        },
        OnFocus: function () {
            this.UsedEdit.Focus();
        },
        GetInput: function () {
            return this.UsedEdit.GetInput();
        },
        GetValue: function () {
            return this.UsedEdit.Text;
        },
        SetValue: function (value) {
            this.UsedEdit.Text = value;
        },
        OnDropDownClicked: function (mouseEvent) { }
    }
    });

    Bridge.ns("ExpressCraft.TextInputDropDown", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.TextInputDropDown, {
        f1: function (sender) {
            if (!Bridge.staticEquals(this.OnTextChanged, null)) {
                this.OnTextChanged(sender);
            }
        },
        f2: function (ev) {
            if (!this.Readonly && this.Enabled) {
                this.OnDropDownClicked(ev);
            }
        }
    });

    Bridge.define("ExpressCraft.MemoInput", {
        inherits: [ExpressCraft.TextInput],
        fields: {
            PreSize: null,
            PrePreSize: null,
            PreZIndex$1: null,
            _hasGotFocus: false
        },
        props: {
            Rows: {
                get: function () {
                    return this.Content.rows;
                },
                set: function (value) {
                    this.Content.rows = value;
                }
            },
            Cols: {
                get: function () {
                    return this.Content.cols;
                },
                set: function (value) {
                    this.Content.cols = value;
                }
            },
            DisableResize: false
        },
        ctors: {
            init: function () {
                this.PreSize = new ExpressCraft.Vector2();
                this.PrePreSize = new ExpressCraft.Vector2();
            },
            ctor: function () {
                this.$initialize();
                ExpressCraft.TextInput.ctor.call(this, document.createElement("textarea"));
                this.Style.resize = "none";

                this.OnGotFocus = Bridge.fn.bind(this, $asm.$.ExpressCraft.MemoInput.f1);
                this.OnLostFocus = Bridge.fn.bind(this, $asm.$.ExpressCraft.MemoInput.f2);
            }
        },
        methods: {
            GetValue: function () {
                return this.Content.value;
            },
            SetValue: function (value) {
                this.Content.value = value;
            }
        }
    });

    Bridge.ns("ExpressCraft.MemoInput", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.MemoInput, {
        f1: function (memo) {
            if (this.DisableResize) {
                return;
            }

            this.Style.resize = "both";
            this.PrePreSize = this.Size.$clone();

            if (this._hasGotFocus) {
                this.Size = this.PreSize.$clone();
            } else {
                this._hasGotFocus = true;
                this.PreSize = this.Size.$clone();
            }
        },
        f2: function (memo) {
            this.Style.resize = "none";
            this.PreSize = this.Size.$clone();
            this.Size = this.PrePreSize.$clone();
        }
    });

    Bridge.define("ExpressCraft.Network.NetworkProgressForm", {
        inherits: [ExpressCraft.Form],
        fields: {
            progressControl: null,
            buttonCancel: null
        },
        ctors: {
            ctor: function (_text) {
                if (_text === void 0) { _text = "Loading..."; }

                this.$initialize();
                ExpressCraft.Form.ctor.call(this);
                var $t;
                this.Text = _text;
                this.Width = 400;
                this.Height = 200;

                this.progressControl = new ExpressCraft.ProgressControl();
                ExpressCraft.Helper.SetBounds(this.progressControl, 50, 50, "(100% - 100px)", "23px");

                this.buttonCancel = ($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Cancel), $t.Text = "Cancel", $t);
                ExpressCraft.Helper.SetLocation$1(this.buttonCancel, "(100% - 78px)", "(100% - 26px)");
                this.buttonCancel.Content.tabIndex = 0;

                ExpressCraft.Helper.AppendChildren$2(this.Body, [this.buttonCancel, this.progressControl]);

                this.AllowSizeChange = false;
        }
    }
    });

    Bridge.define("ExpressCraft.PDFPreviewForm", {
        inherits: [ExpressCraft.Form],
        fields: {
            Source: null,
            PDFSourceType: 0,
            PdfViewer: null
        },
        ctors: {
            ctor: function (source, pdfSourceType) {
                if (pdfSourceType === void 0) { pdfSourceType = 0; }

                this.$initialize();
                ExpressCraft.Form.ctor.call(this);
                this.Source = source;
                this.PDFSourceType = pdfSourceType;

                this.PdfViewer = document.createElement(Bridge.Browser.isIE ? "iframe" : pdfSourceType === ExpressCraft.PdfSourceType.Url ? "embed" : "object");
                this.PdfViewer.className = "control";

                ExpressCraft.Helper.SetBounds$1(this.PdfViewer, 0, 0, "100%", "100%");
                this.PdfViewer.setAttribute("alt", "pdf");
                this.PdfViewer.setAttribute("type", "application/pdf");
                //object

                this.Body.appendChild(this.PdfViewer);
            }
        },
        methods: {
            OnShowing: function () {
                ExpressCraft.Form.prototype.OnShowing.call(this);
                //data
                if (this.PDFSourceType === ExpressCraft.PdfSourceType.Url) {
                    this.PdfViewer.setAttribute("Src", this.Source);
                } else {
                    this.PdfViewer.setAttribute("data", ExpressCraft.Control.GetPdfString(this.Source));
                }
            }
        }
    });

    Bridge.define("ExpressCraft.SimpleDialogButton", {
        inherits: [ExpressCraft.SimpleButton],
        ctors: {
            ctor: function (parentForm, dialogResult) {
                if (dialogResult === void 0) { dialogResult = 0; }

                this.$initialize();
                ExpressCraft.SimpleButton.ctor.call(this);
                this.ParentForm = parentForm;
                this.DialogResult = dialogResult;

                ExpressCraft.Helper.SetSize(this, 75, 23);
            }
        }
    });

    Bridge.define("ExpressCraft.CalcForm", {
        inherits: [ExpressCraft.FormPopup],
        fields: {
            InputControl: null,
            CalControl: null,
            ClickedClose: false
        },
        ctors: {
            init: function () {
                this.ClickedClose = false;
            },
            ctor: function (inputControl) {
                this.$initialize();
                ExpressCraft.FormPopup.ctor.call(this);
                if (inputControl.Content.parentElement != null && inputControl.Content.parentElement.parentElement != null && inputControl.Content.parentElement.parentElement.parentElement != null) {
                    this.PreviousScrollTop = inputControl.Content.parentElement.parentElement.parentElement.scrollTop;
                    this.ParentContainer = inputControl.Content.parentElement.parentElement.parentElement;
                }

                this.InputControl = inputControl;
                this.CalControl = new ExpressCraft.CalculatorControl(this.InputControl.GetNumberValue(), true);
                ExpressCraft.Helper.SetBoundsFull(this.CalControl);
                this.CalControl.OnClose = Bridge.fn.bind(this, $asm.$.ExpressCraft.CalcForm.f1);

                this.CalControl.OnEqual = Bridge.fn.bind(this, $asm.$.ExpressCraft.CalcForm.f2);

                this.AppendChild$1(this.CalControl);

                this.Size = new ExpressCraft.Vector2.$ctor1(182, 157);
            }
        },
        methods: {
            OnClosed: function () {
                ExpressCraft.FormPopup.prototype.OnClosed.call(this);
                this.InputControl.ValidateData();
                if (!ExpressCraft.Helper.NotDesktop) {
                    this.InputControl.Focus();
                } else {
                    this.InputControl.Scroll(this.PreviousScrollTop, this.ParentContainer);
                }
            },
            OnClosing: function () {
                ExpressCraft.FormPopup.prototype.OnClosing.call(this);

                if (!this.ClickedClose) {
                    this.CalControl.DontRefresh = true;
                    this.CalControl.AddOperator(this.CalControl.btnEq);
                }
            },
            OnShowed: function () {
                ExpressCraft.FormPopup.prototype.OnShowed.call(this);
                if (this.InputControl == null) {
                    this.Close();
                }

                this.CalControl.btnEq.Focus();
            }
        }
    });

    Bridge.ns("ExpressCraft.CalcForm", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.CalcForm, {
        f1: function () {
            this.ClickedClose = true;
            this.Close();
        },
        f2: function (value) {
            this.InputControl.Text = value.toString();
        }
    });

    Bridge.define("ExpressCraft.DataRowEditForm", {
        inherits: [ExpressCraft.DialogForm],
        fields: {
            LiveData: false,
            GridView: null,
            DataRow: null,
            Panel: null,
            prevData: null
        },
        ctors: {
            ctor: function (_dataRow, _gridView, _liveData) {
                if (_liveData === void 0) { _liveData = true; }

                this.$initialize();
                ExpressCraft.DialogForm.ctor.call(this);
                this.prevData = System.Array.init(_dataRow.ParentTable.ColumnCount, null, System.Object);

                for (var i = 0; i < _dataRow.ParentTable.ColumnCount; i = (i + 1) | 0) {
                    this.prevData[System.Array.index(i, this.prevData)] = _dataRow.getItem(i);
                }

                this.DataRow = _dataRow;
                this.GridView = _gridView;
                this.LiveData = _liveData;

                this.Text = "Row Edit Form";
                this.Width = "400px"; // 25px - 25px 350px width;
                this.Height = "600px";
                this.Body.style.overflowY = "auto";

                this.Panel = ExpressCraft.Control.Div();
                this.Panel.style.overflowY = "auto";
                ExpressCraft.Helper.SetBounds$1(this.Panel, "0", "0", "100%", "(100% - 60px)");
                this.Body.style.backgroundColor = "white";

                this._buttonCollection = Bridge.fn.bind(this, function (_o3) {
                        var $t;
                        _o3.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Cancel), $t.Text = "Cancel", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 85px)", "(100% - 35px)"), $t.ItemClick = Bridge.fn.bind(this, function (ev) {
                            for (var i1 = 0; i1 < this.DataRow.ParentTable.ColumnCount; i1 = (i1 + 1) | 0) {
                                _dataRow.setItem(i1, this.prevData[System.Array.index(i1, this.prevData)]);
                            }

                            this.GridView.RenderGrid();
                        }), $t));
                        _o3.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.OK), $t.Text = "OK", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 170px)", "(100% - 35px)"), $t));
                        return _o3;
                    })(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());

                ExpressCraft.Helper.AppendChildrenTabIndex$1(this.ButtonSection, this._buttonCollection.toArray());

                this.Body.appendChild(this.Panel);

                this.AllowSizeChange = false;
            }
        },
        methods: {
            OnClosed: function () {
                this.GridView.DataSource.EndDataUpdate();

                ExpressCraft.DialogForm.prototype.OnClosed.call(this);
            },
            OnShowed: function () {
                ExpressCraft.DialogForm.prototype.OnShowed.call(this);

                if (this.DataRow == null) {
                    this.DialogResult = ExpressCraft.DialogResultEnum.Cancel;
                    this.Close();
                } else {
                    this.GridView.DataSource.BeginDataUpdate();

                    this.GenerateForm();
                }
            },
            GenerateForm: function () {
                ExpressCraft.Helper.Empty(this.Panel);
                var length = this.GridView.ColumnCount();

                var col = 0;
                var height = 25;

                var defaultHeight = 54;
                var defaultHeight2X = Bridge.Int.mul(defaultHeight, 3);
                var incrementHeight = defaultHeight;

                var eachWidth = 113;

                for (var i = 0; i < length; i = (i + 1) | 0) {
                    incrementHeight = defaultHeight;
                    var grCol = this.GridView.GetColumn(i);

                    if (!grCol.AllowEdit) {
                        continue;
                    }

                    var dtCol = grCol.Column;

                    var dtIndex = { v : grCol.GetDataColumnIndex() };

                    if (Bridge.referenceEquals(grCol.Column.FieldName.toLowerCase(), "cntr")) {
                        grCol.ReadOnly = true;
                    }

                    switch (dtCol.DataType) {
                        case ExpressCraft.DataType.DateTime: 
                            var lbldate = ExpressCraft.Control.Label(grCol.Caption, ((25 + (((Bridge.Int.mul(col, eachWidth) + (Bridge.Int.mul(col, 3))) | 0))) | 0), height);
                            var inputDate = { v : new ExpressCraft.TextInput.$ctor1("date") };
                            ExpressCraft.Helper.SetBounds(inputDate.v, ((25 + (((Bridge.Int.mul(col, eachWidth) + (Bridge.Int.mul(col, 3))) | 0))) | 0), ((((height + 16) | 0) + 3) | 0), eachWidth, 24);
                            inputDate.v.SetDate(System.Convert.toString(this.DataRow.getItem(dtIndex.v)));
                            inputDate.v.Readonly = grCol.ReadOnly;
                            if (!grCol.ReadOnly) {
                                inputDate.v.OnTextChanged = (function ($me, dtIndex, inputDate) {
                                    return Bridge.fn.bind($me, function (ev) {
                                        this.DataRow.setItem(dtIndex.v, inputDate.v.GetDate());
                                        if (this.LiveData) {
                                            this.GridView.RenderGrid();
                                        }
                                    });
                                })(this, dtIndex, inputDate);
                            }
                            ExpressCraft.Helper.AppendChildren$1(this.Panel, [lbldate, ExpressCraft.Control.op_Implicit(inputDate.v)]);
                            break;
                        case ExpressCraft.DataType.Integer: 
                        case ExpressCraft.DataType.Long: 
                        case ExpressCraft.DataType.Float: 
                        case ExpressCraft.DataType.Double: 
                        case ExpressCraft.DataType.Decimal: 
                        case ExpressCraft.DataType.Bool: 
                        case ExpressCraft.DataType.Byte: 
                        case ExpressCraft.DataType.Short: 
                            var lblnmb = ExpressCraft.Control.Label(grCol.Caption, ((25 + (((Bridge.Int.mul(col, eachWidth) + (Bridge.Int.mul(col, 3))) | 0))) | 0), height);
                            var inputNum = { };
                            if (Bridge.is(grCol.CellDisplay, ExpressCraft.GridViewCellDisplayCheckBox)) {
                                inputNum.v = new ExpressCraft.TextInput.$ctor1("checkbox");
                                ExpressCraft.Helper.SetChecked$1(inputNum.v, this.DataRow.getItem(dtIndex.v));
                            } else {
                                inputNum.v = new ExpressCraft.TextInput.$ctor1("number");
                                inputNum.v.Text = System.Convert.toString(this.DataRow.getItem(dtIndex.v));
                            }
                            ExpressCraft.Helper.SetBounds(inputNum.v, ((25 + (((Bridge.Int.mul(col, eachWidth) + (Bridge.Int.mul(col, 3))) | 0))) | 0), ((((height + 16) | 0) + 3) | 0), eachWidth, 24);
                            inputNum.v.Readonly = grCol.ReadOnly;
                            if (!grCol.ReadOnly) {
                                inputNum.v.OnTextChanged = (function ($me, inputNum, dtIndex) {
                                    return Bridge.fn.bind($me, function (ev) {
                                        if (inputNum.v.Type === "checkbox") {
                                            this.DataRow.setItem(dtIndex.v, Bridge.box(ExpressCraft.Helper.IsTrue(inputNum.v.Text) === 1, System.Boolean, System.Boolean.toString));
                                        } else {
                                            this.DataRow.setItem(dtIndex.v, inputNum.v.Text);
                                        }
                                        if (this.LiveData) {
                                            this.GridView.RenderGrid();
                                        }
                                    });
                                })(this, inputNum, dtIndex);
                            }
                            ExpressCraft.Helper.AppendChildren$1(this.Panel, [lblnmb, ExpressCraft.Control.op_Implicit(inputNum.v)]);
                            break;
                        default: 
                        case ExpressCraft.DataType.Object: 
                        case ExpressCraft.DataType.String: 
                            var lblstr = ExpressCraft.Control.Label(grCol.Caption, ((25 + (((Bridge.Int.mul(col, eachWidth) + (Bridge.Int.mul(col, 3))) | 0))) | 0), height);
                            var inputstr = { v : new ExpressCraft.TextInput.$ctor1("text") };
                            ExpressCraft.Helper.SetBounds(inputstr.v, ((25 + (((Bridge.Int.mul(col, eachWidth) + (Bridge.Int.mul(col, 3))) | 0))) | 0), ((((height + 16) | 0) + 3) | 0), eachWidth, 24);
                            inputstr.v.Text = System.Convert.toString(this.DataRow.getItem(dtIndex.v));
                            inputstr.v.Readonly = grCol.ReadOnly;
                            if (!grCol.ReadOnly) {
                                inputstr.v.OnTextChanged = (function ($me, dtIndex, inputstr) {
                                    return Bridge.fn.bind($me, function (ev) {
                                        this.DataRow.setItem(dtIndex.v, inputstr.v.Text);

                                        if (this.LiveData) {
                                            this.GridView.RenderGrid();
                                        }
                                    });
                                })(this, dtIndex, inputstr);
                            }
                            ExpressCraft.Helper.AppendChildren$1(this.Panel, [lblstr, ExpressCraft.Control.op_Implicit(inputstr.v)]);
                            //if(obj.Length > 100)
                            //{
                            //	incrementHeight = defaultHeight2X;
                            //	col = 2;
                            //}
                            //else
                            //{
                            //}
                            break;
                    }
                    if (col === 2) {
                        height = (height + (((incrementHeight + 3) | 0))) | 0;
                        col = 0;
                    } else {
                        col = (col + 1) | 0;
                    }
                }
                // Add Accept Changes
            }
        }
    });

    Bridge.define("ExpressCraft.DateForm", {
        inherits: [ExpressCraft.FormPopup],
        fields: {
            InputControl: null,
            DateControl: null,
            ClickedClose: false
        },
        ctors: {
            init: function () {
                this.ClickedClose = false;
            },
            ctor: function (inputControl) {
                this.$initialize();
                ExpressCraft.FormPopup.ctor.call(this);
                if (inputControl.Content.parentElement != null && inputControl.Content.parentElement.parentElement != null && inputControl.Content.parentElement.parentElement.parentElement != null) {
                    this.PreviousScrollTop = inputControl.Content.parentElement.parentElement.parentElement.scrollTop;
                    this.ParentContainer = inputControl.Content.parentElement.parentElement.parentElement;
                }

                this.Size = new ExpressCraft.Vector2.$ctor1(232, 247);

                this.InputControl = inputControl;
                this.DateControl = new ExpressCraft.DateControl(inputControl.GetDateTime());
                ExpressCraft.Helper.SetBoundsFull(this.DateControl);

                this.DateControl.OnDateChanged = function (date) {
                    if (Bridge.equals(date, System.DateTime.getMinValue())) {
                        inputControl.SetDate("");
                    } else {
                        inputControl.SetDate(System.String.format(System.String.concat("{0:", inputControl.DisplayFormat, "}"), Bridge.box(date, System.DateTime, System.DateTime.format)));
                    }
                };

                this.DateControl.OnRequestToClose = Bridge.fn.bind(this, $asm.$.ExpressCraft.DateForm.f1);

                this.Content.onkeydown = Bridge.fn.cacheBind(this.DateControl, this.DateControl.BlockTabEvent);

                this.AppendChild$1(this.DateControl);
            }
        },
        methods: {
            OnClosed: function () {
                ExpressCraft.FormPopup.prototype.OnClosed.call(this);
                this.InputControl.ValidateData();
                if (!ExpressCraft.Helper.NotDesktop) {
                    this.InputControl.Focus();
                } else {
                    this.InputControl.Scroll(this.PreviousScrollTop, this.ParentContainer);
                }
            },
            OnShowed: function () {
                ExpressCraft.FormPopup.prototype.OnShowed.call(this);
                if (this.InputControl == null) {
                    this.Close();
                }

                this.DateControl.btnToday.Focus();
            }
        }
    });

    Bridge.ns("ExpressCraft.DateForm", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.DateForm, {
        f1: function () {
            this.Close();
        }
    });

    Bridge.define("ExpressCraft.DateInput", {
        inherits: [ExpressCraft.TextInputDropDown],
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.TextInputDropDown.ctor.call(this, "date");
            }
        },
        methods: {
            OnDropDownClicked: function (mouseEvent) {
                if (!this.Readonly && this.Enabled) {
                    (new ExpressCraft.DateForm(this.UsedEdit)).ShowPopup(ExpressCraft.FormPopup.GetPopupDefaultLocation(this.DropDownButton, true));
                }
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogBase", {
        inherits: [ExpressCraft.DialogForm],
        props: {
            QuestionSize: 0,
            Wrapper: null,
            QuestionDiv: null,
            AnswerDiv: null,
            ImageDiv: null
        },
        ctors: {
            ctor: function (title, width, question) {
                this.$initialize();
                ExpressCraft.DialogForm.ctor.call(this, title);
                this.Width = ExpressCraft.Helper.ToPx(Bridge.box(width, System.Int32));
                this.Wrapper = ExpressCraft.Control.Div();
                this.QuestionDiv = ExpressCraft.Control.Div();
                this.AnswerDiv = ExpressCraft.Control.Div();
                this._buttonCollection = Bridge.fn.bind(this, $asm.$.ExpressCraft.InputDialogBase.f1)(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());

                this.Wrapper.style.overflowY = "hidden";
                ExpressCraft.Helper.SetBounds$1(this.Wrapper, "0px", "0px", "100%", "(100% - 60px)");
                this.QuestionDiv.style.position = "relative";
                this.QuestionDiv.style.height = "auto";
                this.QuestionDiv.style.marginLeft = "10px";
                this.QuestionDiv.style.marginRight = "10px";
                this.QuestionDiv.style.marginTop = "10px";
                this.AnswerDiv.style.position = "relative";
                this.AnswerDiv.style.height = "auto";
                ExpressCraft.Helper.SetLocation$1(this._buttonCollection.getItem(0), "(100% - 170px)", "(100% - 35px)");
                ExpressCraft.Helper.SetLocation$1(this._buttonCollection.getItem(1), "(100% - 85px)", "(100% - 35px)");

                var tb = new ExpressCraft.TextBlock(question, ((width - 25) | 0));
                tb.ComputeString();

                if (!tb.ElelemtsOverMax) {
                    width = (((Bridge.Int.clip32(tb.MaxCalculatedWidth) + 65) | 0) + 37) | 0;
                    if (width < ExpressCraft.Settings.MessageFormMinimumWidthInPx) {
                        width = ExpressCraft.Settings.MessageFormMinimumWidthInPx;
                    }
                }
                if (tb.ComputedHeight > ExpressCraft.Settings.MessageFormTextMaximumHeightInPx) {
                    tb.ComputedHeight = ExpressCraft.Settings.MessageFormTextMaximumHeightInPx;
                }
                if (tb.ComputedHeight < ExpressCraft.Settings.MessageFormTextMinimumHeightInPx) {
                    tb.ComputedHeight = ExpressCraft.Settings.MessageFormTextMinimumHeightInPx;
                }

                this.QuestionDiv.innerHTML = question;
                this.QuestionSize = System.Convert.toInt32(Bridge.box(tb.ComputedHeight, System.Single, System.Single.format, System.Single.getHashCode));
            }
        },
        methods: {
            Create: function (height) {
                this.Wrapper.appendChild(this.QuestionDiv);
                this.Wrapper.appendChild(document.createElement("br"));
                this.Wrapper.appendChild(this.AnswerDiv);
                this.Body.appendChild(this.Wrapper);

                ExpressCraft.Helper.AppendChildrenTabIndex$1(this.ButtonSection, this._buttonCollection.toArray());

                this.Height = ExpressCraft.Helper.ToPx(Bridge.box(height, System.Int32));
                this.AllowSizeChange = false;
            }
        }
    });

    Bridge.ns("ExpressCraft.InputDialogBase", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.InputDialogBase, {
        f1: function (_o1) {
            var $t;
            _o1.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.OK), $t.Text = "Accept", $t));
            _o1.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Cancel), $t.Text = "Cancel", $t));
            return _o1;
        }
    });

    Bridge.define("ExpressCraft.MessageBoxForm", {
        inherits: [ExpressCraft.DialogForm],
        statics: {
            fields: {
                snd: null
            },
            methods: {
                Beep: function () {
                    if (!ExpressCraft.Settings.MessageFormBeep) {
                        return;
                    }
                    if (ExpressCraft.MessageBoxForm.snd == null) {
                        ExpressCraft.MessageBoxForm.snd = new Audio(ExpressCraft.ResourceManager.GetResourceString("beepSound"));
                    }
                    ExpressCraft.MessageBoxForm.snd.play();
                }
            }
        },
        fields: {
            _prompt: null,
            _buttons: 0
        },
        ctors: {
            /**
             * Create a new Message Dialog
             *
             * @instance
             * @public
             * @this ExpressCraft.MessageBoxForm
             * @memberof ExpressCraft.MessageBoxForm
             * @param   {string}                           prompt    The text to be displayed in the message box
             * @param   {ExpressCraft.MessageBoxLayout}    ui        The UI settings to be applied to the form
             * @return  {void}
             */
            ctor: function (prompt, ui) {
                ExpressCraft.MessageBoxForm.$ctor2.call(this, prompt, ui, ExpressCraft.MessageBoxButtons.Auto, System.Enum.toString(ExpressCraft.MessageBoxLayout, ui));
            },
            /**
             * Create a new Message Dialog
             *
             * @instance
             * @public
             * @this ExpressCraft.MessageBoxForm
             * @memberof ExpressCraft.MessageBoxForm
             * @param   {string}                           prompt    The text to be displayed in the message box
             * @param   {ExpressCraft.MessageBoxLayout}    ui        The UI settings to be applied to the form
             * @param   {string}                           title     The title of the message box
             * @return  {void}
             */
            $ctor3: function (prompt, ui, title) {
                ExpressCraft.MessageBoxForm.$ctor2.call(this, prompt, ui, ExpressCraft.MessageBoxButtons.Auto, title);
            },
            /**
             * Create a new Message Dialog
             *
             * @instance
             * @public
             * @this ExpressCraft.MessageBoxForm
             * @memberof ExpressCraft.MessageBoxForm
             * @param   {string}                            prompt     The text to be displayed in the message box
             * @param   {ExpressCraft.MessageBoxLayout}     ui         The UI settings to be applied to the form
             * @param   {ExpressCraft.MessageBoxButtons}    buttons    The Type of button to be displayed with this message
             * @return  {void}
             */
            $ctor1: function (prompt, ui, buttons) {
                ExpressCraft.MessageBoxForm.$ctor2.call(this, prompt, ui, buttons, System.Enum.toString(ExpressCraft.MessageBoxLayout, ui));
            },
            /**
             * Create a new Message Dialog
             *
             * @instance
             * @public
             * @this ExpressCraft.MessageBoxForm
             * @memberof ExpressCraft.MessageBoxForm
             * @param   {string}                            prompt     The text to be displayed in the message box
             * @param   {ExpressCraft.MessageBoxLayout}     ui         The UI settings  to be applied to the form
             * @param   {ExpressCraft.MessageBoxButtons}    buttons    The Type of button to be displayed with this message
             * @param   {string}                            title      The title of the message box
             * @return  {void}
             */
            $ctor2: function (prompt, ui, buttons, title) {
                this.$initialize();
                ExpressCraft.DialogForm.ctor.call(this, title);
                var section = ExpressCraft.Control.Div();
                var pic = ExpressCraft.Control.Div$1("image32");
                var textContent = ExpressCraft.Control.Div$1("messag-box-content");
                this._prompt = prompt;
                this._buttons = buttons;

                switch (ui) {
                    case ExpressCraft.MessageBoxLayout.Exclamation: 
                        if (this._buttons === ExpressCraft.MessageBoxButtons.Auto) {
                            this._buttons = ExpressCraft.MessageBoxButtons.Ok;
                        }
                        pic.classList.add("imagewarning");
                        break;
                    case ExpressCraft.MessageBoxLayout.Information: 
                        if (this._buttons === ExpressCraft.MessageBoxButtons.Auto) {
                            this._buttons = ExpressCraft.MessageBoxButtons.Ok;
                        }
                        pic.classList.add("imageinfo");
                        break;
                    case ExpressCraft.MessageBoxLayout.Question: 
                        if (this._buttons === ExpressCraft.MessageBoxButtons.Auto) {
                            this._buttons = ExpressCraft.MessageBoxButtons.YesNo;
                        }
                        pic.classList.add("imageindex");
                        break;
                    case ExpressCraft.MessageBoxLayout.Error: 
                        if (this._buttons === ExpressCraft.MessageBoxButtons.Auto) {
                            this._buttons = ExpressCraft.MessageBoxButtons.AbortSendCancel;
                        }
                        pic.classList.add("imageerror");
                        break;
                    default: 
                        throw new System.ArgumentOutOfRangeException("ui", null, null, Bridge.box(ui, ExpressCraft.MessageBoxLayout, System.Enum.toStringFn(ExpressCraft.MessageBoxLayout)));
                }
                var heightCalc = ExpressCraft.Helper.NotDesktop ? "(100% - 60px)" : "(100% - 35px)";
                switch (this._buttons) {
                    case ExpressCraft.MessageBoxButtons.Ok: 
                        this._buttonCollection = Bridge.fn.bind(this, function (_o4) {
                                var $t;
                                _o4.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.OK), $t.Text = "Ok", $t.Location = new ExpressCraft.Vector2.$ctor1("(50% - 37.5px)", heightCalc), $t));
                                return _o4;
                            })(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());
                        break;
                    case ExpressCraft.MessageBoxButtons.YesNo: 
                        this._buttonCollection = Bridge.fn.bind(this, function (_o5) {
                                var $t;
                                _o5.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.No), $t.Text = "No", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 85px)", heightCalc), $t));
                                _o5.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Yes), $t.Text = "Yes", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 170px)", heightCalc), $t));
                                return _o5;
                            })(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());
                        break;
                    case ExpressCraft.MessageBoxButtons.YesNoCancel: 
                        this._buttonCollection = Bridge.fn.bind(this, function (_o6) {
                                var $t;
                                _o6.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Cancel), $t.Text = "Cancel", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 85px)", heightCalc), $t));
                                _o6.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.No), $t.Text = "No", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 170px)", heightCalc), $t));
                                _o6.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Yes), $t.Text = "Yes", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 255px)", heightCalc), $t));
                                return _o6;
                            })(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());
                        break;
                    case ExpressCraft.MessageBoxButtons.AbortSendCancel: 
                        this._buttonCollection = Bridge.fn.bind(this, function (_o7) {
                                var $t;
                                _o7.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Cancel), $t.Text = "Cancel", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 85px)", heightCalc), $t));
                                _o7.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Send), $t.Text = "Send", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 170px)", heightCalc), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.MessageBoxForm.f1), $t));
                                _o7.add(($t = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Abort), $t.Text = "Abort", $t.Location = new ExpressCraft.Vector2.$ctor1("(100% - 255px)", heightCalc), $t.ItemClick = $asm.$.ExpressCraft.MessageBoxForm.f2, $t));
                                return _o7;
                            })(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());
                        break;
                    default: 
                        throw new System.ArgumentOutOfRangeException();
                }
                var tb = null;

                var width = 480;

                if (!ExpressCraft.Helper.NotDesktop) {
                    tb = new ExpressCraft.TextBlock(prompt, 455);
                    tb.ComputeString();
                    if (this._buttonCollection.Count > 2) {
                        if (width < 320) {
                            width = 320;
                        }
                    }
                    if (!tb.ElelemtsOverMax) {
                        width = (((Bridge.Int.clip32(tb.MaxCalculatedWidth) + 65) | 0) + 37) | 0;
                        if (width < ExpressCraft.Settings.MessageFormMinimumWidthInPx) {
                            width = ExpressCraft.Settings.MessageFormMinimumWidthInPx;
                        }
                    }
                } else {
                    var count = this._buttonCollection.Count;
                    for (var i = 0; i < count; i = (i + 1) | 0) {
                        var but = this._buttonCollection.getItem(i);
                        but.Height = 45;
                        but.Style.borderRadius = "4px";
                        but.Style.fontSize = "14px";
                        if (but.DialogResult === ExpressCraft.DialogResultEnum.OK || but.DialogResult === ExpressCraft.DialogResultEnum.Yes) {
                            but.ClassList.add("primary");
                            but.Style.color = "white";
                            but.Style.border = "0";
                        }
                    }
                }

                textContent.innerHTML = prompt;

                section.style.overflowY = "auto";
                section.style.height = "100%";
                section.style.maxHeight = ExpressCraft.Helper.ToPx(Bridge.box(ExpressCraft.Settings.MessageFormTextMaximumHeightInPx, System.Int32));
                section.appendChild(textContent);
                section.style.top = "32px";
                section.style.width = "90%";

                ExpressCraft.Helper.AppendChildren$1(this.Body, [pic, section]);

                ExpressCraft.Helper.AppendChildrenTabIndex$1(this.ButtonSection, this._buttonCollection.toArray());
                if (ExpressCraft.Helper.NotDesktop) {
                    section.style.textAlign = "center";
                    section.style.lineHeight = "100%";

                    this.WindowState = ExpressCraft.WindowStateType.Maximized;
                    this.Heading.style.display = "none";
                    ExpressCraft.Helper.SetLocation(this.Body, 0, 0);
                    ExpressCraft.Helper.SetSize$1(this.Body, "100%", "100%");
                    this.StartPosition = ExpressCraft.FormStartPosition.Manual;
                    this.AllowSizeChange = false;
                    this.AllowMoveChange = false;

                    this.ShowMaximize = false;
                    this.ShowMinimize = false;
                    this.ShowClose = false;

                    textContent.style.display = "inline-block";
                    textContent.style.fontSize = "14px";
                    textContent.style.verticalAlign = "middle";
                    textContent.style.lineHeight = "normal";
                } else {
                    if (tb.ComputedHeight > ExpressCraft.Settings.MessageFormTextMaximumHeightInPx) {
                        tb.ComputedHeight = ExpressCraft.Settings.MessageFormTextMaximumHeightInPx;
                    }
                    if (tb.ComputedHeight < ExpressCraft.Settings.MessageFormTextMinimumHeightInPx) {
                        tb.ComputedHeight = ExpressCraft.Settings.MessageFormTextMinimumHeightInPx;
                    }

                    this.Height = System.Single.format(tb.ComputedHeight + 77 + 29 + 32) + "px";
                    this.Width = ExpressCraft.Helper.ToPx(Bridge.box(width, System.Int32));
                }

                this.AllowSizeChange = false;
            }
        },
        methods: {
            OnShowed: function () {
                ExpressCraft.MessageBoxForm.Beep();

                ExpressCraft.DialogForm.prototype.OnShowed.call(this);
                this._buttonCollection.getItem(0).Content.focus();
            }
        }
    });

    Bridge.ns("ExpressCraft.MessageBoxForm", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.MessageBoxForm, {
        f1: function (ev) {
            if (!Bridge.staticEquals(ExpressCraft.Settings.OnSendError, null)) {
                ExpressCraft.Settings.OnSendError(this._prompt);
            }
        },
        f2: function (ev) {
            var pre = ExpressCraft.Settings.AllowCloseWithoutQuestion;

            ExpressCraft.Settings.AllowCloseWithoutQuestion = false;
            ExpressCraft.Application.Close();
            ExpressCraft.Settings.AllowCloseWithoutQuestion = pre;
        }
    });

    Bridge.define("ExpressCraft.NumberInput", {
        inherits: [ExpressCraft.TextInputDropDown],
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.TextInputDropDown.ctor.call(this, "number");
                this.UsedEdit.SetAttribute("step", "any");
            }
        },
        methods: {
            OnDropDownClicked: function (mouseEvent) {
                if (!this.Readonly && this.Enabled) {
                    var calcEdit = new ExpressCraft.CalcForm(this.UsedEdit);
                    calcEdit.ShowPopup(ExpressCraft.FormPopup.GetPopupDefaultLocation(this.DropDownButton, true));
                    calcEdit.OnFormClosed = Bridge.fn.bind(this, $asm.$.ExpressCraft.NumberInput.f1);
                }

            }
        }
    });

    Bridge.ns("ExpressCraft.NumberInput", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.NumberInput, {
        f1: function () {
            this.ValidateData();
        }
    });

    Bridge.define("ExpressCraft.SearchInput", {
        inherits: [ExpressCraft.TextInputDropDown],
        fields: {
            OnSearch: null
        },
        props: {
            EditValue: null,
            DisplayMember: null,
            ValueMember: null
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.TextInputDropDown.ctor.call(this, "text");
                this.UsedEdit.OnKeyDown = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchInput.f1);
                this.UsedEdit.Content.onmousedown = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchInput.f2);
            }
        },
        methods: {
            ClearOnOpen: function () {
                return false;
            },
            OnRequestSearch: function (searchValue, grid) {
                if (!Bridge.staticEquals(this.OnSearch, null)) {
                    this.OnSearch(searchValue, grid);
                }
            },
            SearchOnLoad: function () {
                return false;
            },
            OnAcceptResult: function (value) {
                if (value == null) {
                    this.EditValue = null;
                    this.Text = "";
                } else {
                    if (!Bridge.referenceEquals(this.ValueMember, "")) {
                        this.EditValue = value.GetValue$1(this.ValueMember);
                    }
                    if (this.DisplayMember != null) {
                        this.Text = (System.String.concat(value.GetValue$1(this.DisplayMember), ""));
                    }
                }
            },
            OnRequestNew: function (grid) { },
            OnClosed: function (value) { },
            OnDropDownClicked: function (mouseEvent) {
                if (!this.Readonly && this.Enabled) {
                    (new ExpressCraft.SearchLookupForm(this)).ShowPopup(ExpressCraft.FormPopup.GetPopupDefaultLocation(this.DropDownButton, true));
                }
            }
        }
    });

    Bridge.ns("ExpressCraft.SearchInput", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.SearchInput, {
        f1: function (obj, ev) {
            if (ev.keyCode === 13 || ev.keyCode === 40) {
                this.OnDropDownClicked(new MouseEvent("onmousedown"));
            }
        },
        f2: function (ev) {
            this.OnDropDownClicked(new MouseEvent("onmousedown"));
        }
    });

    Bridge.define("ExpressCraft.SearchLookupForm", {
        inherits: [ExpressCraft.FormPopup],
        fields: {
            SearchInput: null,
            FocusedRow: null,
            View: null,
            SearchEdit: null,
            btnSearch: null,
            btnClose: null,
            btnNew: null,
            btnUse: null,
            btnClear: null
        },
        ctors: {
            ctor: function (searchInput) {
                this.$initialize();
                ExpressCraft.FormPopup.ctor.call(this);
                var $t;
                if (searchInput.Content.parentElement != null && searchInput.Content.parentElement.parentElement != null) {
                    this.PreviousScrollTop = searchInput.Content.parentElement.parentElement.scrollTop;
                    this.ParentContainer = searchInput.Content.parentElement.parentElement;
                }
                var x = searchInput.Content.getBoundingClientRect();

                this.MinHeight = 100;
                this.MinWidth = 150;

                var wid = searchInput.GetDropdownWidth();
                if (wid < 150) {
                    wid = 150;
                }

                this.Size = new ExpressCraft.Vector2.$ctor1(wid, 250);

                this.AllowSizeChange = true;

                this.SearchInput = searchInput;

                var frag = document.createDocumentFragment();

                ExpressCraft.Helper.AppendChildren$2(frag, [(this.SearchEdit = ($t = new ExpressCraft.TextInput.$ctor1(), $t.Text = searchInput.ClearOnOpen() ? "" : this.SearchInput.Text, $t.OnFocusDontSelectAll = true, $t.DisableFocusPopup = true, $t.Bounds = new ExpressCraft.Vector4.$ctor1(4, 4, "(100% - 68px)", 20), $t.ToolTip = new ExpressCraft.ToolTip.$ctor1("Help:", "[Enter] to Search, [CTRL] + [Enter] to Search and Use, [ESC] to close"), $t)), (this.btnSearch = ($t = new ExpressCraft.SimpleButton(), $t.Text = "Search", $t.Bounds = new ExpressCraft.Vector4.$ctor1("(100% - 65px)", 4, 61, 20), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f1), $t)), (this.View = ($t = new ExpressCraft.GridView(true, true), $t.AllowMultiSelection = false, $t.UseEditForm = false, $t.Bounds = new ExpressCraft.Vector4.$ctor1(4, 28, "(100% - 10px)", "(100% - 60px)"), $t)), (this.btnClose = ($t = new ExpressCraft.SimpleButton(), $t.Text = "&times;", $t.Bounds = new ExpressCraft.Vector4.$ctor1(4, "(100% - 25px)", 20, 20), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f2), $t)), (this.btnNew = ($t = new ExpressCraft.SimpleButton(), $t.Text = "New", $t.Bounds = new ExpressCraft.Vector4.$ctor1("(100% - 65px)", "(100% - 25px)", 61, 20), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f3), $t)), (this.btnUse = ($t = new ExpressCraft.SimpleButton(), $t.Text = "Use", $t.Bounds = new ExpressCraft.Vector4.$ctor1("(100% - 132px)", "(100% - 25px)", 61, 20), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f4), $t)), (this.btnClear = ($t = new ExpressCraft.SimpleButton(), $t.Text = "Clear", $t.Bounds = new ExpressCraft.Vector4.$ctor1("(100% - 199px)", "(100% - 25px)", 61, 20), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f5), $t))]);

                this.btnClose.Style.color = "red";

                if (ExpressCraft.Helper.NotDesktop) {
                    this.SearchEdit.Style.fontSize = "14px";
                    this.SearchEdit.Height = "45px";

                    this.btnSearch.Style.fontSize = "14px";
                    this.btnSearch.Height = 45;

                    this.View.Top = 55;
                    this.View.Height = "(100% - 112px)";

                    this.btnClear.Style.fontSize = "14px";
                    this.btnClear.Height = 45;
                    this.btnClear.Top = "(100% - 51px)";

                    this.btnUse.Style.fontSize = "14px";
                    this.btnUse.Height = 45;
                    this.btnUse.Top = "(100% - 51px)";

                    this.btnNew.Style.fontSize = "14px";
                    this.btnNew.Height = 45;
                    this.btnNew.Top = "(100% - 51px)";

                    this.btnClose.Style.fontSize = "26px";
                    this.btnClose.Style.fontWeight = "bold";
                    this.btnClose.Height = 45;
                    this.btnClose.Width = 61;
                    this.btnClose.Top = "(100% - 51px)";
                }

                this.SearchEdit.OnKeyDown = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f6);

                this.View.OnFocusedRowChanged = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f7);

                this.View.OnRowDoubleClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f8);

                this.Body.appendChild(frag);

                this.SearchEdit.OnGotFocus = Bridge.fn.bind(this, $asm.$.ExpressCraft.SearchLookupForm.f9);

                this.LinkchildToForm(this.View);
        }
    },
    methods: {
        OnShowed: function () {
            ExpressCraft.FormPopup.prototype.OnShowed.call(this);

            this.SearchEdit.Focus();

            if (this.SearchInput.SearchOnLoad()) {
                this.btnSearch.Content.click();
            }
        },
        OnClosed: function () {
            ExpressCraft.FormPopup.prototype.OnClosed.call(this);

            this.SearchInput.OnClosed(this.FocusedRow);
            this.SearchInput.ValidateData();
            if (!ExpressCraft.Helper.NotDesktop) {
                this.SearchInput.GetInput().focus();
            } else {
                this.SearchInput.Scroll(this.PreviousScrollTop, this.ParentContainer);
            }
        }
    }
    });

    Bridge.ns("ExpressCraft.SearchLookupForm", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.SearchLookupForm, {
        f1: function (s) {
            this.SearchInput.OnRequestSearch(this.SearchEdit.Text, this.View);
        },
        f2: function (s) {
            this.Close();
        },
        f3: function (s) {
            this.SearchInput.OnRequestNew(this.View);
        },
        f4: function (s) {
            if (this.View.FocusedDataHandle === -1 && this.View.RowCount() > 0) {
                this.View.FocusedDataHandle = 0;
            }
            if (this.FocusedRow != null) {
                this.SearchInput.OnAcceptResult(this.FocusedRow);
                this.Close();
            }
        },
        f5: function (s) {
            this.FocusedRow = null;
            this.SearchInput.OnAcceptResult(this.FocusedRow);
            this.Close();
        },
        f6: function (obj, ev) {
            if (ev.keyCode === 9) {
                this.Close();
                ev.preventDefault();
            } else if (ev.keyCode === 13) {
                this.SearchInput.OnRequestSearch(this.SearchEdit.Text, this.View);
                if (ev.ctrlKey) {
                    this.btnUse.Content.click();
                }
                ev.preventDefault();
            } else if (ev.keyCode === 27) {
                this.FocusedRow = null;
                this.Close();
                ev.preventDefault();
            }
        },
        f7: function (row, col) {
            if (this.View.FocusedDataHandle > -1) {
                this.FocusedRow = this.View.DataSource.getItem(this.View.GetDataSourceRow(this.View.FocusedDataHandle));
            } else {
                this.FocusedRow = null;
            }
            this.SearchInput.OnAcceptResult(this.FocusedRow);
        },
        f8: function (row) {
            if (this.View.FocusedDataHandle > -1) {
                this.FocusedRow = this.View.DataSource.getItem(this.View.GetDataSourceRow(this.View.FocusedDataHandle));
            } else {
                this.FocusedRow = null;
            }
            this.SearchInput.OnAcceptResult(this.FocusedRow);
            this.Close();
        },
        f9: function (obj) {
            this.SearchEdit.GetInput().selectionStart = this.SearchEdit.Text.length;
        }
    });

    Bridge.define("ExpressCraft.TextForm", {
        inherits: [ExpressCraft.FormPopup],
        fields: {
            ReadInput: null,
            EditInput: null,
            btnDone: null
        },
        ctors: {
            ctor: function (input) {
                this.$initialize();
                ExpressCraft.FormPopup.ctor.call(this);
                var $t;
                if (input.Content.parentElement != null && input.Content.parentElement.parentElement != null) {
                    this.PreviousScrollTop = input.Content.parentElement.parentElement.scrollTop;
                    this.ParentContainer = input.Content.parentElement.parentElement;
                }

                this.WindowState = ExpressCraft.WindowStateType.Maximized;

                this.ReadInput = input;

                if (Bridge.is(this.ReadInput, ExpressCraft.MemoInput)) {
                    this.EditInput = new ExpressCraft.MemoInput();
                } else {
                    this.EditInput = ($t = new ExpressCraft.TextInput.$ctor1(input.Type), $t.DisplayFormat = this.ReadInput.DisplayFormat, $t);
                    this.EditInput.OnKeyDown = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextForm.f1);
                }

                this.EditInput.Text = input.Text;
                this.EditInput.Style.fontSize = "14px";

                this.EditInput.DisableFocusPopup = true;
                this.EditInput.Size = new ExpressCraft.Vector2.$ctor1("(100% - 112px)", "100%");
                this.EditInput.Location = new ExpressCraft.Vector2.$ctor1(0, 0);

                this.btnDone = ($t = new ExpressCraft.SimpleButton(), $t.Text = "&times;", $t.Bounds = new ExpressCraft.Vector4.$ctor1("(100% - 106px)", "(50% - 22.5px)", 100, 45), $t.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextForm.f2), $t);

                this.btnDone.Style.borderRadius = "4px";
                this.btnDone.ClassList.add("primary");
                this.btnDone.Style.borderWidth = "0";

                this.btnDone.Text = "&times;";
                this.btnDone.Style.fontSize = "26px";
                this.btnDone.Style.color = "white";
                this.btnDone.Style.fontWeight = "bold";

                this.EditInput.OnTextChanged = Bridge.fn.bind(this, $asm.$.ExpressCraft.TextForm.f3);

                this.AppendChildren$1([this.EditInput, this.btnDone]);
        }
    },
    methods: {
        OnShowed: function () {
            ExpressCraft.FormPopup.prototype.OnShowed.call(this);

            var dataP = this.ReadInput.GetAttribute("data-placeholder");
            if (!System.String.isNullOrWhiteSpace(dataP)) {
                this.EditInput.SetAttribute("placeholder", dataP);
            } else {
                if (!System.String.isNullOrWhiteSpace(this.ReadInput.GetAttribute("placeholder"))) {
                    this.EditInput.SetAttribute("placeholder", this.ReadInput.GetAttribute("placeholder"));
                }
            }

            this.EditInput.Focus();
        },
        OnClosed: function () {
            this.ReadInput.Scroll(this.PreviousScrollTop, this.ParentContainer);
            this.ReadInput.ValidateData();
            ExpressCraft.FormPopup.prototype.OnClosed.call(this);
        }
    }
    });

    Bridge.ns("ExpressCraft.TextForm", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.TextForm, {
        f1: function (s, ev) {
            if (ev.keyCode === 13) {
                this.btnDone.Content.click();
            }
        },
        f2: function (sender) {
            this.Close();
            if (!Bridge.referenceEquals(this.EditInput.GetEditValue(), this.ReadInput.GetEditValue())) {
                this.ReadInput.Text = this.EditInput.Text;

                if (this.ReadInput.IsSubmit) {
                    var e = $.Event("keypress");
                    e.which = 13;
                    e.keyCode = 13;
                    $(this.ReadInput.Content).trigger(Bridge.cast(e, jQuery.Event));
                } else if (this.ReadInput.GoNext) {
                    var x = document.querySelectorAll("input, textarea, button");
                    var tabPlus1 = (this.ReadInput.Content.tabIndex + 1) | 0;
                    for (var i = 0; i < x.length; i = (i + 1) | 0) {
                        if (x[i].tabIndex === tabPlus1) {
                            ExpressCraft.Helper.FocusElement(x[i]);
                            break;
                        }
                    }
                }
            }
        },
        f3: function (sender) {
            if (Bridge.referenceEquals(this.EditInput.GetEditValue(), this.ReadInput.GetEditValue())) {
                this.btnDone.Text = "&times;";
                this.btnDone.Style.fontSize = "26px";
                this.btnDone.Style.fontWeight = "bold";
            } else {
                this.btnDone.Text = this.ReadInput.IsSubmit ? "Submit" : this.ReadInput.GoNext ? "Next" : "Done";
                this.btnDone.Style.fontSize = "14px";
                this.btnDone.Style.fontWeight = "";
            }
        }
    });

    Bridge.define("ExpressCraft.ThemeForm", {
        inherits: [ExpressCraft.DialogForm],
        statics: {
            fields: {
                _themeVisible: false,
                themeForm: null
            },
            methods: {
                ShowThemeForm: function () {
                    if (!ExpressCraft.ThemeForm._themeVisible) {
                        ExpressCraft.ThemeForm.themeForm = new ExpressCraft.ThemeForm();
                        ExpressCraft.ThemeForm.themeForm.Show(true);

                        ExpressCraft.ThemeForm._themeVisible = true;
                    }
                }
            }
        },
        fields: {
            currentTheme: null,
            prevTheme: null
        },
        ctors: {
            ctor: function () {
                this.$initialize();
                ExpressCraft.DialogForm.ctor.call(this);
                var $t, $t1;
                this.prevTheme = ExpressCraft.Settings.ActiveTheme;
                this.currentTheme = Newtonsoft.Json.JsonConvert.DeserializeObject(Newtonsoft.Json.JsonConvert.SerializeObject(this.prevTheme, ($t = new Newtonsoft.Json.JsonSerializerSettings(), $t.TypeNameHandling = Newtonsoft.Json.TypeNameHandling.Objects, $t)), ExpressCraft.Theme, ($t = new Newtonsoft.Json.JsonSerializerSettings(), $t.TypeNameHandling = Newtonsoft.Json.TypeNameHandling.Objects, $t));

                ExpressCraft.Settings.ActiveTheme = this.currentTheme;

                this._buttonCollection = Bridge.fn.bind(this, $asm.$.ExpressCraft.ThemeForm.f3)(new (System.Collections.Generic.List$1(ExpressCraft.SimpleDialogButton))());
                ExpressCraft.Helper.AppendChildrenTabIndex$1(this.ButtonSection, this._buttonCollection.toArray());

                var length = this.currentTheme.Colors.length;
                var y = 20;
                var x = 20;

                var Panel = ExpressCraft.Control.Div();
                Panel.style.overflowY = "auto";
                ExpressCraft.Helper.SetBounds$1(Panel, 0, 0, "100%", "(100% - 60px)");

                this.Body.style.backgroundColor = ExpressCraft.Color.op_Implicit$1(ExpressCraft.Color.White.$clone());

                for (var i = 0; i < length; i = (i + 1) | 0) {
                    Panel.appendChild(ExpressCraft.Control.op_Implicit(ExpressCraft.Helper.SetBounds(($t = new ExpressCraft.ColorInput(), $t.Text = ($t1 = this.currentTheme.Colors)[System.Array.index(i, $t1)].toString(), $t.ToolTip = new ExpressCraft.ToolTip.$ctor1("This is a heading test.", "This is a description test."), $t.OnTextChanged = Bridge.fn.bind(this, $asm.$.ExpressCraft.ThemeForm.f4), $t).SetAttribute("i", i), x, y, 95, 20)));

                    x = (x + 100) | 0;

                    if (i % 2 !== 0) {
                        y = (y + 30) | 0;
                        x = 20;
                    }
                }

                this.Body.appendChild(Panel);

                this.Size = new ExpressCraft.Vector2.$ctor1(250, 300);
                this.Text = "Theme Form Editor";

                this.AllowMoveChange = true;
                this.AllowSizeChange = false;

                this.ShowClose = false;
                this.ShowMaximize = false;
                this.ShowMinimize = false;
        }
    },
    methods: {
        OnClosed: function () {
            ExpressCraft.DialogForm.prototype.OnClosed.call(this);
            ExpressCraft.ThemeForm._themeVisible = false;
        },
        OnGotFocus: function () {
            if (this.Content != null) {
                this.Style.opacity = "1";
            }
            ExpressCraft.DialogForm.prototype.OnGotFocus.call(this);
        },
        OnLostFocus: function () {
            if (this.Content != null) {
                this.Style.opacity = "0.5";
            }
            ExpressCraft.DialogForm.prototype.OnLostFocus.call(this);
        }
    }
    });

    Bridge.ns("ExpressCraft.ThemeForm", $asm.$);

    Bridge.apply($asm.$.ExpressCraft.ThemeForm, {
        f1: function (ev) {
            ExpressCraft.Settings.ActiveTheme = this.prevTheme;
            this.Close();
        },
        f2: function (ev) {
            ExpressCraft.Settings.ApplyActiveTheme();
            this.Close();
        },
        f3: function (_o2) {
            var $t1;
            _o2.add(($t1 = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.Cancel), $t1.Text = "Cancel", $t1.Location = new ExpressCraft.Vector2.$ctor1("(100% - 85px)", "(100% - 35px)"), $t1.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.ThemeForm.f1), $t1));
            _o2.add(($t1 = new ExpressCraft.SimpleDialogButton(this, ExpressCraft.DialogResultEnum.OK), $t1.Text = "OK", $t1.Location = new ExpressCraft.Vector2.$ctor1("(100% - 170px)", "(100% - 35px)"), $t1.ItemClick = Bridge.fn.bind(this, $asm.$.ExpressCraft.ThemeForm.f2), $t1));
            return _o2;
        },
        f4: function (tx) {
            var $t2;
            var index = tx.GetAttributei("i");
            ($t2 = this.currentTheme.Colors)[System.Array.index(index, $t2)] = tx.Text;

            ExpressCraft.Settings.ApplyActiveTheme();
        }
    });

    Bridge.define("ExpressCraft.InputDialogCheckbox", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: false
        },
        ctors: {
            /**
             * Creates a Question Dialog with a checkbox
                 The Result Property contains a boolean value of the checkbox state
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogCheckbox
             * @memberof ExpressCraft.InputDialogCheckbox
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogCheckbox.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a checkbox
                 The Result Property contains a boolean value of the checkbox state
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogCheckbox
             * @memberof ExpressCraft.InputDialogCheckbox
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "checkbox");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "40px");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.checked;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 40) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogColour", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            /**
             * Creates a Question Dialog with a colour selector
                 The Result Property contains the HexCode for the selected colour
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogColour
             * @memberof ExpressCraft.InputDialogColour
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogColour.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a colour selector
                 The Result Property contains the HexCode for the selected colour
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogColour
             * @memberof ExpressCraft.InputDialogColour
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "color");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "40px");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.value;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 40) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogDate", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            /**
             * Creates a Question Dialog with a Date Selector
                 The Result Property contains the selected Date
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogDate
             * @memberof ExpressCraft.InputDialogDate
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogDate.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a Date Selector
                 The Result Property contains the selected Date
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogDate
             * @memberof ExpressCraft.InputDialogDate
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "date");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.value;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogDateTimeLocal", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            init: function () {
                this.Result = System.DateTime.getDefaultValue();
            },
            /**
             * Creates a Question Dialog with a Date Selector
                 The Result Property contains the selected Date
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogDateTimeLocal
             * @memberof ExpressCraft.InputDialogDateTimeLocal
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogDateTimeLocal.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a Date Selector
                 The Result Property contains the selected Date
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogDateTimeLocal
             * @memberof ExpressCraft.InputDialogDateTimeLocal
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                this.Result = System.DateTime.getNow();
                var input = ExpressCraft.Control.Input("inputcontrol", "datetime-local");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = System.DateTime.parseExact(input.value, "yyyy-MM-ddTHH:mm", System.Globalization.CultureInfo.invariantCulture);
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogEmail", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            /**
             * Creates a Question Dialog with an email input
                 The Result Property contains the Entered email address
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogEmail
             * @memberof ExpressCraft.InputDialogEmail
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogEmail.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with an email input
                 The Result Property contains the Entered email
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogEmail
             * @memberof ExpressCraft.InputDialogEmail
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "email");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    //todo css for email input not showing up
                    //todo could always validate email here
                    this.Result = input.value;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogMonth", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            /**
             * Creates a Question Dialog with a Month input
                 The Result Property contains the Entered Month
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogMonth
             * @memberof ExpressCraft.InputDialogMonth
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogMonth.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a Month input
                 The Result Property contains the Entered Month
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogMonth
             * @memberof ExpressCraft.InputDialogMonth
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "month");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.value;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogNumber", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: 0
        },
        ctors: {
            /**
             * Creates a Question Dialog with a Number Selector
                 The Result Property contains the selected value
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogNumber
             * @memberof ExpressCraft.InputDialogNumber
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogNumber.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a Number Selector
                 The Result Property contains the selected value
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogNumber
             * @memberof ExpressCraft.InputDialogNumber
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "number");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.valueAsNumber;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogText", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            /**
             * Creates a Question Dialog with a Text input
                 The Result Property contains the Entered Text
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogText
             * @memberof ExpressCraft.InputDialogText
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogText.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a Text input
                 The Result Property contains the Entered Text
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogText
             * @memberof ExpressCraft.InputDialogText
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "text");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.value;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });

    Bridge.define("ExpressCraft.InputDialogWeek", {
        inherits: [ExpressCraft.InputDialogBase],
        props: {
            Result: null
        },
        ctors: {
            /**
             * Creates a Question Dialog with a Week input
                 The Result Property contains the Entered week
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogWeek
             * @memberof ExpressCraft.InputDialogWeek
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @return  {void}
             */
            ctor: function (title, question) {
                ExpressCraft.InputDialogWeek.$ctor1.call(this, title, question, 360);
            },
            /**
             * Creates a Question Dialog with a Week input
                 The Result Property contains the Entered Week
             *
             * @instance
             * @public
             * @this ExpressCraft.InputDialogWeek
             * @memberof ExpressCraft.InputDialogWeek
             * @param   {string}    title       The message that will appear in the title bar of the dialog
             * @param   {string}    question    The message that will appear about the input box on the dialog
             * @param   {number}    size        The width of this dialog. The default size is 360
             * @return  {void}
             */
            $ctor1: function (title, question, size) {
                this.$initialize();
                ExpressCraft.InputDialogBase.ctor.call(this, title, size, question);
                var input = ExpressCraft.Control.Input("inputcontrol", "week");
                input.id = "DialogAnswerBox";
                ExpressCraft.Helper.SetBounds$1(input, "10px", "0px", "90%", "auto");
                input.onchange = Bridge.fn.bind(this, function (ev) {
                    this.Result = input.value;
                });
                this.AnswerDiv.appendChild(input);
                this.Create(((((((this.QuestionSize + 25) | 0) + 25) | 0) + 78) | 0));
            }
        }
    });
});

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICJFeHByZXNzQ3JhZnQuanMiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbImNvbnRyb2xzL0NvbnRyb2wuY3MiLCJBcHAuY3MiLCJ1dGlscy9BcHBsaWNhdGlvbi5jcyIsInV0aWxzL0JhcmNvZGVRdWFnZ2FKUy5jcyIsInV0aWxzL0NvbG9yLmNzIiwiY29udHJvbHMvQ29udGV4dE1lbnUuY3MiLCJ1dGlscy9EYXRhVGFibGUuY3MiLCJjb250cm9scy9Db21ib0JveEVkaXQuY3MiLCJmb3Jtcy9EaWFsb2dSZXN1bHQuY3MiLCJ1dGlscy9FeHRlcm5hbFBsdWdpbi5jcyIsInV0aWxzL0ZpcmViYXNlLmNzIiwiZm9ybXMvRm9ybUNvbGxlY3Rpb24uY3MiLCJ1dGlscy9HbWFpbC5jcyIsInV0aWxzL0dvb2dsZUNsb3VkUHJpbnQuY3MiLCJncmlkL0dyaWRWaWV3Q2VsbEFwcGFyZW5jZS5jcyIsImdyaWQvR3JpZFZpZXdDZWxsRGlzcGxheS5jcyIsImdyaWQvR3JpZFZpZXdDb2x1bW4uY3MiLCJ1dGlscy9IYXJkU29mdExpc3QuY3MiLCJ1dGlscy9IZWxwZXIuY3MiLCJ1dGlscy9LZXlDb2Rlcy5jcyIsImNvbXBvbmVudHMvTGF5b3V0Q29udGFpbmVyLmNzIiwidXRpbHMvTmV0d29yay5jcyIsInV0aWxzL1Jlc291cmNlTWFuYWdlci5jcyIsInV0aWxzL1NldHRpbmdzLmNzIiwidXRpbHMvVGV4dEJsb2NrLmNzIiwiY29udHJvbHMvVG9vbFRpcENvbnRyb2wuY3MiLCJ1dGlscy9WZWN0b3IyLmNzIiwidXRpbHMvVmVjdG9yNC5jcyIsImNvbnRyb2xzL0FjZUNvZGVFZGl0b3IuY3MiLCJmb3Jtcy9Gb3JtLmNzIiwiY29udHJvbHMvQ2FsY3VsYXRvckNvbnRyb2wuY3MiLCJjb250cm9scy9DaGVja0VkaXQuY3MiLCJjb250cm9scy9UZXh0SW5wdXQuY3MiLCJjb250cm9scy9EYXRlQ29udHJvbC5jcyIsImNvbnRyb2xzL0dyaWRMb29rdXBFZGl0LmNzIiwiZ3JpZC9HcmlkVmlldy5jcyIsImdyaWQvR3JpZFZpZXdDZWxsRGlzcGxheUNoZWNrQm94LmNzIiwiZ3JpZC9HcmlkVmlld0NlbGxEaXNwbGF5SW1hZ2UuY3MiLCJjb250cm9scy9JbWFnZUVkaXQuY3MiLCJjb250cm9scy9Qcm9ncmVzc0NvbnRyb2wuY3MiLCJjb250cm9scy9SaWJib25CdXR0b24uY3MiLCJjb250cm9scy9SaWJib25Db250cm9sLmNzIiwiY29udHJvbHMvUmliYm9uR3JvdXAuY3MiLCJjb250cm9scy9SaWJib25QYWdlLmNzIiwiY29udHJvbHMvU2ltcGxlQnV0dG9uLmNzIiwiY29udHJvbHMvU3BsaXRDb250cm9sQ29udGFpbmVyLmNzIiwiY29udHJvbHMvU3BsaXRIaWRlQ29udHJvbENvbnRhaW5lci5jcyIsImNvbnRyb2xzL1RhYkNvbnRyb2wuY3MiLCJjb250cm9scy9UYWJDb250cm9sUGFnZS5jcyIsImNvbnRyb2xzL1RpbGVDb250cm9sLmNzIiwiZm9ybXMvRm9ybVBvcHVwLmNzIiwiY29udHJvbHMvQ29sb3JJbnB1dC5jcyIsImZvcm1zL0NvbnNvbGVGb3JtLmNzIiwiZm9ybXMvRGlhbG9nRm9ybS5jcyIsImNvbnRyb2xzL1RleHRJbnB1dERyb3BEb3duLmNzIiwiY29udHJvbHMvTWVtb0lucHV0LmNzIiwiZm9ybXMvUGRmUHJldmlld0Zvcm0uY3MiLCJjb250cm9scy9TaW1wbGVEaWFsb2dCdXR0b24uY3MiLCJmb3Jtcy9wb3B1cGZvcm1zL0NhbGNGb3JtLmNzIiwiZm9ybXMvRGF0YVJvd0VkaXRGb3JtLmNzIiwiZm9ybXMvcG9wdXBmb3Jtcy9EYXRlRm9ybS5jcyIsImNvbnRyb2xzL0RhdGVJbnB1dC5jcyIsImZvcm1zL0lucHV0RGlhbG9nLmNzIiwiZm9ybXMvTWVzc2FnZUJveEZvcm0uY3MiLCJjb250cm9scy9OdW1iZXJJbnB1dC5jcyIsImNvbnRyb2xzL1NlYXJjaElucHV0LmNzIiwiZm9ybXMvcG9wdXBmb3Jtcy9TZWFyY2hMb29rdXBGb3JtLmNzIiwiZm9ybXMvcG9wdXBmb3Jtcy9UZXh0Rm9ybS5jcyIsImZvcm1zL1RoZW1lRm9ybS5jcyJdLAogICJuYW1lcyI6IFsiIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7O3FCQTRjK0NBOzs7Ozs7OztxQ0EzVlJBLEtBQWlCQTs7O29CQUU1Q0EsT0FBT0EsS0FBS0EsQ0FBQ0EsTUFBTUEsYUFDZkE7OzBDQXVHNEJBO29CQUVoQ0EsT0FBT0EsbUVBQTREQTs7d0NBR3JDQTtvQkFFOUJBLE9BQU9BLHdEQUFpREE7OzZDQUdyQkEsR0FBVUE7O29CQUU3Q0EsT0FBT0EsZ0RBQXlDQSxpQkFBaUJBLHdDQUEyQkE7OytCQXNDL0RBOzs7b0JBRTdCQSxPQUFPQSxvREFBbUNBLHNDQUFpQkE7O2lDQTBLOUJBLElBQVdBOzs7b0JBRXhDQSxPQUFPQSxvREFBbUNBLHlCQUFLQSxxQ0FBZ0JBOztnQ0F6S2hDQTs7O29CQUUvQkEsT0FBT0EscURBQW9DQSxzQ0FBaUJBOztrQ0FrSjdCQSxJQUFXQTs7O29CQUUxQ0EsT0FBT0EscURBQW9DQSx5QkFBS0EscUNBQWdCQTs7bUNBakpoQ0EsU0FBZ0JBLEdBQVNBLEdBQVNBLFFBQXFCQSxRQUFxQkE7Ozs7O29CQUU1R0EsVUFBVUEscURBQW9DQSxzQ0FBaUJBOztvQkFFL0RBLGdCQUFnQkE7b0JBQ2hCQSxxQ0FBZ0JBLEdBQUdBO29CQUNuQkEsMkJBQU1BLEtBQUtBLFFBQVFBOztvQkFFbkJBLE9BQU9BOzttQ0FHeUJBLFNBQWdCQSxHQUFTQSxHQUFTQSxPQUFhQSxRQUFjQSxRQUFxQkEsUUFBcUJBLFFBQW9CQSxXQUFzQ0EsV0FBeUJBOzs7Ozs7OztvQkFFMU5BLFVBQVVBLHFEQUFvQ0EsNkJBQVNBLCtCQUFVQSxDQUFDQSxpQ0FBMEJBLFNBQVNBOztvQkFFckdBLGdCQUFnQkE7b0JBQ2hCQSxxQ0FBY0EsR0FBR0EsR0FBR0EsT0FBT0E7b0JBQzNCQSxJQUFHQSxjQUFhQTt3QkFFWkEsc0JBQXNCQTs7b0JBRTFCQSwyQkFBTUEsS0FBS0EsUUFBUUE7b0JBQ25CQSxJ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QSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBCQUFNQTs7Ozs7d0JBUWpCQSxPQUFPQSxJQUFJQSwwQkFBTUE7Ozs7O3dCQVFqQkEsT0FBT0EsSUFBSUEsMEJBQU1BOzs7Ozt3QkFRakJBLE9BQU9BLElBQUlBLDBC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QUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBO29CQUNBQTtvQkFDQUE7b0JBQ0FBLDhDQUFpQkE7OztvQkFLakJBLFFBQVVBOztvQkFFVkE7b0JBQ0FBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBUUE7b0JBQ1JBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFRQTtvQkFDUkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVFBO29CQUNSQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBUUE7b0JBQ1JBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFRQTtvQkFDUkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVFBO29CQUNSQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBUUE7b0JBQ1JBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLCtCQUFVQTtvQkFDVkEsK0JBQVVBO29CQUNWQSwrQkFBVUE7b0JBQ1ZBLGdDQUFTQTtvQkFDVEEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVNBO29CQUNUQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBU0E7b0JBQ1RBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFTQTtvQkFDVEEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVNBO29CQUNUQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBU0E7b0JBQ1RBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFVQTtvQkFDVkEsZ0NBQVVBO29CQUNWQSxnQ0FBVUE7b0JBQ1ZBLGdDQUFTQTtvQkFDVEEsZ0NBQVVBO29CQUNW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Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEJBY1lBLE9BQWNBOytEQUF3QkEsT0FBT0E7Ozs7Ozs7Ozs7Ozs7Ozs4QkFXN0NBLE9BQWNBLFVBQWlCQTs7NkRBQWlCQSxPQUFPQSxNQUFNQTtnQkFFaEZBLFlBQVlBLDJDQUFzQkE7Z0JBQ2xDQTtnQkFDQUE7Z0JBQ0FBLGlCQUFpQkE7b0JBQVFBLGNBQVNBOztnQkFDbENBLDJCQUFzQkE7Z0JBQ3RCQSxZQUFPQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEJBOUhZQSxPQUFjQTsrREFBd0JBLE9BQU9BOzs7Ozs7Ozs7Ozs7Ozs7OEJBVzdDQSxPQUFjQSxVQUFpQkE7OzZEQUFpQkEsT0FBT0EsTUFBTUE7Z0JBRWhGQSxZQUFZQSwyQ0FBc0JBO2dCQUNsQ0E7Z0JBQ0FBO2dCQUNBQSxpQkFBaUJBO29CQUViQSxjQUFTQTs7Z0JBRWJBLDJCQUFzQkE7Z0JBQ3RCQSxZQUFPQSIsCiAgInNvdXJjZXNDb250ZW50IjogWyJ1c2luZyBCcmlkZ2U7XHJcbnVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgZW51bSBDb21ib0JveFR5cGVzXHJcbiAgICB7XHJcbiAgICAgICAgRGVmYXVsdFxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIEhUTUxFbGVtZW50IENvbnRlbnQ7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBOYW1lO1xyXG4gICAgICAgIHB1YmxpYyBib29sIEhhc1JlbmRlcmVkID0gZmFsc2U7XHJcbiAgICAgICAgcHVibGljIGNvbnN0IHN0cmluZyBDb250cm9sQ2xhc3MgPSBcImNvbnRyb2xcIjtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBUb29sVGlwIF90b29sVGlwID0gbnVsbDtcclxuICAgICAgICBwcml2YXRlIEFjdGlvbjxNb3VzZUV2ZW50PiBfT25Nb3VzZUVudGVyVG9vbFRpcCA9IG51bGw7XHJcbiAgICAgICAgcHJpdmF0ZSBBY3Rpb248TW91c2VFdmVudD4gX09uTW91c2VMZWF2ZVRvb2xUaXAgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgVG9vbFRpcCBUb29sVGlwXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90b29sVGlwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfdG9vbFRpcCAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUuQXR0YWNoZWRDb250cm9sICE9IG51bGwgJiYgdmFsdWUuQXR0YWNoZWRDb250cm9sICE9IHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLkF0dGFjaGVkQ29udHJvbCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgX3Rvb2xUaXAgPSB2YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoX3Rvb2xUaXAgIT0gbnVsbCAmJiAoIV90b29sVGlwLkhlYWRpbmcuSXNFbXB0eSgpIHx8ICFfdG9vbFRpcC5EZXNjcmlwdGlvbi5Jc0VtcHR5KCkpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX09uTW91c2VFbnRlclRvb2xUaXAgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEodGhpcyBpcyBUb29sVGlwQ29udHJvbCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ybS5BY3RpdmVUb29sVGlwID0gX3Rvb2xUaXA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9Pbk1vdXNlTGVhdmVUb29sVGlwID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighKHRoaXMgaXMgVG9vbFRpcENvbnRyb2wpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZvcm0uQWN0aXZlVG9vbFRpcCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50LkFkZEV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlRW50ZXIsIF9Pbk1vdXNlRW50ZXJUb29sVGlwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudC5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZUxlYXZlLCBfT25Nb3VzZUxlYXZlVG9vbFRpcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKF9Pbk1vdXNlRW50ZXJUb29sVGlwICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50LlJlbW92ZUV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlRW50ZXIsIF9Pbk1vdXNlRW50ZXJUb29sVGlwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX09uTW91c2VFbnRlclRvb2xUaXAgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihfT25Nb3VzZUxlYXZlVG9vbFRpcCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudC5SZW1vdmVFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZUxlYXZlLCBfT25Nb3VzZUxlYXZlVG9vbFRpcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9Pbk1vdXNlTGVhdmVUb29sVGlwID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBBY3Rpb248Q29udHJvbD4gT25SZXNpemUgPSBudWxsO1xyXG4gICAgICAgIHB1YmxpYyBBY3Rpb248Q29udHJvbD4gT25Mb2FkZWQgPSBudWxsOyAgICAgICAgXHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250ZXh0TWVudSBDb250ZXh0TWVudSA9IG51bGw7XHJcblxyXG4gICAgICAgIHB1YmxpYyBDU1NTdHlsZURlY2xhcmF0aW9uIFN0eWxlIHtnZXR7cmV0dXJuIENvbnRlbnQuU3R5bGU7fX1cclxuICAgICAgICBwdWJsaWMgRE9NVG9rZW5MaXN0IENsYXNzTGlzdCB7Z2V0e3JldHVybiBDb250ZW50LkNsYXNzTGlzdDt9fVxyXG5cclxuICAgICAgICBwdWJsaWMgQ29udHJvbCBTZXRBdHRyaWJ1dGUoc3RyaW5nIG5hbWUsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuU2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlLlRvU3RyKCkpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIEdldEF0dHJpYnV0ZShzdHJpbmcgbmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkNvbnRlbnQuR2V0QXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBHZXRBdHRyaWJ1dGVpKHN0cmluZyBuYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdsb2JhbC5QYXJzZUludCh0aGlzLkNvbnRlbnQuR2V0QXR0cmlidXRlKG5hbWUpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBmbG9hdCBHZXRBdHRyaWJ1dGVmKHN0cmluZyBuYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIChmbG9hdClHbG9iYWwuUGFyc2VGbG9hdCh0aGlzLkNvbnRlbnQuR2V0QXR0cmlidXRlKG5hbWUpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBGb3JtIExpbmtlZEZvcm0gPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyBCYXNlQ2xhc3MoYm9vbCBhZGQgPSB0cnVlLCBib29sIGFjID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBhYyA/IChhZGQgPyBcIiBcIiArIENvbnRyb2xDbGFzcyA6XHJcbiAgICAgICAgICAgICAgICBDb250cm9sQ2xhc3MpIDogXCJcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IFdpZHRoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gdGhpcy5Db250ZW50LlN0eWxlLldpZHRoOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHZhbHVlLlRvSHRtbFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICB4ID0gVmVjdG9yMi5wZih4KTtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuQ29udGVudC5TdHlsZS5XaWR0aCAhPSB4KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5TdHlsZS5XaWR0aCA9IHg7XHJcbiAgICAgICAgICAgICAgICAgICAgT25TaXplQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiBIZWlnaHRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiB0aGlzLkNvbnRlbnQuU3R5bGUuSGVpZ2h0OyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHZhbHVlLlRvSHRtbFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICB4ID0gVmVjdG9yMi5wZih4KTtcclxuICAgICAgICAgICAgICAgIGlmKHggIT0gdGhpcy5Db250ZW50LlN0eWxlLkhlaWdodClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuU3R5bGUuSGVpZ2h0ID0geDtcclxuICAgICAgICAgICAgICAgICAgICBPblNpemVDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IExlZnRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiB0aGlzLkNvbnRlbnQuU3R5bGUuTGVmdDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHggPSB2YWx1ZS5Ub0h0bWxWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgeCA9IFZlY3RvcjIucGYoeCk7XHJcbiAgICAgICAgICAgICAgICBpZih4ICE9IHRoaXMuQ29udGVudC5TdHlsZS5MZWZ0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5TdHlsZS5MZWZ0ID0geDtcclxuICAgICAgICAgICAgICAgICAgICBPbkxvY2F0aW9uQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiBUb3BcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiB0aGlzLkNvbnRlbnQuU3R5bGUuVG9wOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHZhbHVlLlRvSHRtbFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICB4ID0gVmVjdG9yMi5wZih4KTtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuQ29udGVudC5TdHlsZS5Ub3AgIT0geClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuU3R5bGUuVG9wID0geDtcclxuICAgICAgICAgICAgICAgICAgICBPbkxvY2F0aW9uQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIE9uTG9jYXRpb25DaGFuZ2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIE9uU2l6ZUNoYW5nZWQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBWZWN0b3IyIFNpemVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBuZXcgVmVjdG9yMih0aGlzLldpZHRoLCB0aGlzLkhlaWdodCk7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuV2lkdGggPSB2YWx1ZS5YO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5IZWlnaHQgPSB2YWx1ZS5ZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVmVjdG9yMiBMb2NhdGlvblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIG5ldyBWZWN0b3IyKHRoaXMuTGVmdCwgdGhpcy5Ub3ApOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkxlZnQgPSB2YWx1ZS5YO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5Ub3AgPSB2YWx1ZS5ZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVmVjdG9yNCBCb3VuZHNcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBuZXcgVmVjdG9yNCh0aGlzLkxlZnQsIHRoaXMuVG9wLCB0aGlzLldpZHRoLCB0aGlzLkhlaWdodCk7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuTGVmdCA9IHZhbHVlLlg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLlRvcCA9IHZhbHVlLlk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLldpZHRoID0gdmFsdWUuWjtcclxuICAgICAgICAgICAgICAgIHRoaXMuSGVpZ2h0ID0gdmFsdWUuTTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgR2V0SW1hZ2VTdHJpbmcoc3RyaW5nIHMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChcInVybCgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LHswfScpIG5vLXJlcGVhdFwiLCBzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEdldFBkZlN0cmluZyhzdHJpbmcgcylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KFwiZGF0YTphcHBsaWNhdGlvbi9wZGY7YmFzZTY0LHswfVwiLCBzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEdldEltYWdlU3RyaW5nVVJJKHN0cmluZyBzLCBib29sIHVzZVJlc291cmNlVVJMID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KFwidXJsKCd7MH17MX0nKSBuby1yZXBlYXRcIiwgdXNlUmVzb3VyY2VVUkwgPyBTZXR0aW5ncy5SZXNvdXJjZVVSTCA6IFwiXCIsIHMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIENvbnRyb2woYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb250ZW50ID0gRGl2KGFjKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250cm9sKEhUTUxFbGVtZW50IGVsZW1lbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb250ZW50ID0gZWxlbWVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250cm9sKHN0cmluZyBjbiwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb250ZW50ID0gRGl2KGNuLCBhYyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgQ29udHJvbChzdHJpbmcgY24sIEJ1dHRvblR5cGUgYnQsIGJvb2wgYWMgPSB0cnVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ29udGVudCA9IEJ1dHRvbihjbiwgYnQsIGFjKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250cm9sKHN0cmluZyBjbiwgQ29tYm9Cb3hUeXBlcyBjdCwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb250ZW50ID0gQ29tYm9Cb3goY24sIGN0LCBhYyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgQ29udHJvbChzdHJpbmcgY24sIElucHV0VHlwZSBpdCwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb250ZW50ID0gSW5wdXQoY24sIGl0LCBhYyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIFJlbmRlcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBIYXNSZW5kZXJlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxEaXZFbGVtZW50IERpdihib29sIGFjID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgSFRNTERpdkVsZW1lbnQoKSB7IENsYXNzTmFtZSA9IEJhc2VDbGFzcyhmYWxzZSwgYWMpIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTcGFuRWxlbWVudCBTcGFuKGJvb2wgYWMgPSB0cnVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBIVE1MU3BhbkVsZW1lbnQoKSB7IENsYXNzTmFtZSA9IEJhc2VDbGFzcyhmYWxzZSwgYWMpIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTcGFuRWxlbWVudCBMYWJlbChzdHJpbmcgQ2FwdGlvbiwgZmxvYXQgWCwgZmxvYXQgWSwgYm9vbCBJc0JvbGQgPSBmYWxzZSwgYm9vbCBJc1RpbnkgPSBmYWxzZSwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgbGJsID0gbmV3IEhUTUxTcGFuRWxlbWVudCgpIHsgQ2xhc3NOYW1lID0gQmFzZUNsYXNzKGZhbHNlLCBhYykgfTtcclxuXHJcbiAgICAgICAgICAgIGxibC5Jbm5lckhUTUwgPSBDYXB0aW9uLkh0bWxFc2NhcGUoKTtcclxuICAgICAgICAgICAgbGJsLlNldExvY2F0aW9uKFgsIFkpO1xyXG4gICAgICAgICAgICBTZXRCVChsYmwsIElzQm9sZCwgSXNUaW55KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBsYmw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTcGFuRWxlbWVudCBMYWJlbChzdHJpbmcgQ2FwdGlvbiwgZmxvYXQgWCwgZmxvYXQgWSwgZmxvYXQgd2lkdGgsIGZsb2F0IGhlaWdodCwgYm9vbCBJc0JvbGQgPSBmYWxzZSwgYm9vbCBJc1RpbnkgPSBmYWxzZSwgc3RyaW5nIGNsYXNzciA9IFwiXCIsIFRleHRBbGlnbiBBbGlnbm1lbnQgPSBUZXh0QWxpZ24uTGVmdCwgc3RyaW5nIEZvcmVjb2xvciA9IG51bGwsIGJvb2wgYWMgPSB0cnVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGxibCA9IG5ldyBIVE1MU3BhbkVsZW1lbnQoKSB7IENsYXNzTmFtZSA9IGNsYXNzciArIEJhc2VDbGFzcyghc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShjbGFzc3IpLCBhYykgfTtcclxuXHJcbiAgICAgICAgICAgIGxibC5Jbm5lckhUTUwgPSBDYXB0aW9uLkh0bWxFc2NhcGUoKTtcclxuICAgICAgICAgICAgbGJsLlNldEJvdW5kcyhYLCBZLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgaWYoQWxpZ25tZW50ICE9IFRleHRBbGlnbi5MZWZ0KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBsYmwuU3R5bGUuVGV4dEFsaWduID0gQWxpZ25tZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFNldEJUKGxibCwgSXNCb2xkLCBJc1RpbnkpO1xyXG4gICAgICAgICAgICBpZihGb3JlY29sb3IgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGJsLlN0eWxlLkNvbG9yID0gRm9yZWNvbG9yO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbGJsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBIVE1MRGl2RWxlbWVudCBEaXZMYWJlbChzdHJpbmcgQ2FwdGlvbiwgZmxvYXQgWCwgZmxvYXQgWSwgZmxvYXQgd2lkdGgsIGJvb2wgSXNCb2xkID0gZmFsc2UsIGJvb2wgSXNUaW55ID0gZmFsc2UsIHN0cmluZyBjbGFzc3IgPSBcIlwiLCBUZXh0QWxpZ24gQWxpZ25tZW50ID0gVGV4dEFsaWduLkxlZnQsIHN0cmluZyBGb3JlY29sb3IgPSBudWxsLCBib29sIGFjID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBsYmwgPSBuZXcgSFRNTERpdkVsZW1lbnQoKTtcclxuICAgICAgICAgICAgbGJsLkNsYXNzTmFtZSA9IGNsYXNzciArIEJhc2VDbGFzcyghc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShjbGFzc3IpLCBhYyk7XHJcbiAgICAgICAgICAgIGxibC5UZXh0Q29udGVudCA9IENhcHRpb247XHJcbiAgICAgICAgICAgIGxibC5TdHlsZS5MZWZ0ID0gWC5Ub1B4KCk7XHJcbiAgICAgICAgICAgIGxibC5TdHlsZS5Ub3AgPSBZLlRvUHgoKTtcclxuICAgICAgICAgICAgbGJsLlN0eWxlLldpZHRoID0gd2lkdGguVG9QeCgpO1xyXG5cclxuICAgICAgICAgICAgaWYoQWxpZ25tZW50ICE9IFRleHRBbGlnbi5MZWZ0KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihBbGlnbm1lbnQgPT0gVGV4dEFsaWduLlJpZ2h0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGxibC5TdHlsZS5EaXJlY3Rpb24gPSBEaXJlY3Rpb24uUnRsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGxibC5TdHlsZS5UZXh0QWxpZ24gPSBBbGlnbm1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoSXNCb2xkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBsYmwuU3R5bGUuRm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKElzVGlueSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGJsLlN0eWxlLkZvbnRTaXplID0gXCI2Ljc1cHRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihGb3JlY29sb3IgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGJsLlN0eWxlLkNvbG9yID0gRm9yZWNvbG9yO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbGJsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBIVE1MU3BhbkVsZW1lbnQgTGFiZWwoc3RyaW5nIENhcHRpb24sIGZsb2F0IFgsIGZsb2F0IFksIGZsb2F0IHdpZHRoLCBib29sIElzQm9sZCA9IGZhbHNlLCBib29sIElzVGlueSA9IGZhbHNlLCBzdHJpbmcgY2xhc3NyID0gXCJcIiwgVGV4dEFsaWduIEFsaWdubWVudCA9IFRleHRBbGlnbi5MZWZ0LCBzdHJpbmcgRm9yZWNvbG9yID0gbnVsbCwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgbGJsID0gbmV3IEhUTUxTcGFuRWxlbWVudCgpO1xyXG4gICAgICAgICAgICBsYmwuQ2xhc3NOYW1lID0gY2xhc3NyICsgQmFzZUNsYXNzKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGNsYXNzciksIGFjKTtcclxuICAgICAgICAgICAgbGJsLlRleHRDb250ZW50ID0gQ2FwdGlvbjtcclxuICAgICAgICAgICAgbGJsLlN0eWxlLkxlZnQgPSBYLlRvUHgoKTtcclxuICAgICAgICAgICAgbGJsLlN0eWxlLlRvcCA9IFkuVG9QeCgpO1xyXG4gICAgICAgICAgICBsYmwuU3R5bGUuV2lkdGggPSB3aWR0aC5Ub1B4KCk7XHJcblxyXG4gICAgICAgICAgICBpZihBbGlnbm1lbnQgIT0gVGV4dEFsaWduLkxlZnQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEFsaWdubWVudCA9PSBUZXh0QWxpZ24uUmlnaHQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGJsLlN0eWxlLkRpcmVjdGlvbiA9IERpcmVjdGlvbi5SdGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGJsLlN0eWxlLlRleHRBbGlnbiA9IEFsaWdubWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBTZXRCVChsYmwsIElzQm9sZCwgSXNUaW55KTtcclxuICAgICAgICAgICAgaWYoRm9yZWNvbG9yICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGxibC5TdHlsZS5Db2xvciA9IEZvcmVjb2xvcjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGxibDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEZvY3VzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEdsb2JhbC5TZXRUaW1lb3V0KChnbG9iYWw6OlN5c3RlbS5BY3Rpb24pKCgpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5Gb2N1cygpO1xyXG4gICAgICAgICAgICB9KSwgMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIFNldEJUKEhUTUxTcGFuRWxlbWVudCBsYmwsIGJvb2wgSXNCb2xkLCBib29sIElzVGlueSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKElzQm9sZClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGJsLlN0eWxlLkZvbnRXZWlnaHQgPSBcImJvbGRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihJc1RpbnkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGxibC5TdHlsZS5Gb250U2l6ZSA9IFwiNi43NXB0XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgSFRNTFNwYW5FbGVtZW50IExhYmVsKHN0cmluZyBjLCBmbG9hdCBYLCBmbG9hdCBZLCBmbG9hdCB3aWR0aCwgZmxvYXQgaGVpZ2h0LCBib29sIElzQm9sZCA9IGZhbHNlLCBib29sIElzVGlueSA9IGZhbHNlLCBzdHJpbmcgY2xhc3NyID0gXCJcIiwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgbGJsID0gbmV3IEhUTUxTcGFuRWxlbWVudCgpIHsgQ2xhc3NOYW1lID0gY2xhc3NyICsgQmFzZUNsYXNzKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGNsYXNzciksIGFjKSB9O1xyXG5cclxuICAgICAgICAgICAgbGJsLklubmVySFRNTCA9IGMuSHRtbEVzY2FwZSgpO1xyXG4gICAgICAgICAgICBsYmwuU2V0Qm91bmRzKFgsIFksIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICBTZXRCVChsYmwsIElzQm9sZCwgSXNUaW55KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBsYmw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTcGFuRWxlbWVudCBMYWJlbChzdHJpbmcgYywgaW50IFgsIGludCBZLCBpbnQgd2lkdGgsIGJvb2wgSXNCb2xkID0gZmFsc2UsIGJvb2wgSXNUaW55ID0gZmFsc2UsIHN0cmluZyBjbGFzc3IgPSBcIlwiLCBib29sIGFjID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBsYmwgPSBuZXcgSFRNTFNwYW5FbGVtZW50KCkgeyBDbGFzc05hbWUgPSBjbGFzc3IgKyBCYXNlQ2xhc3MoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoY2xhc3NyKSwgYWMpIH07XHJcblxyXG4gICAgICAgICAgICBsYmwuSW5uZXJIVE1MID0gYy5IdG1sRXNjYXBlKCk7XHJcbiAgICAgICAgICAgIGxibC5TZXRMb2NhdGlvbihYLCBZKTtcclxuICAgICAgICAgICAgbGJsLlN0eWxlLldpZHRoID0gd2lkdGguVG9QeCgpO1xyXG4gICAgICAgICAgICBTZXRCVChsYmwsIElzQm9sZCwgSXNUaW55KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBsYmw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTcGFuRWxlbWVudCBMYWJlbChzdHJpbmcgYywgaW50IFgsIGludCBZLCBib29sIElzQm9sZCA9IGZhbHNlLCBib29sIElzVGlueSA9IGZhbHNlLCBib29sIGFjID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBMYWJlbChjLCAoZmxvYXQpWCwgKGZsb2F0KVksIElzQm9sZCwgSXNUaW55LCBhYyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTcGFuRWxlbWVudCBTcGFuKHN0cmluZyBjbiwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEhUTUxTcGFuRWxlbWVudCgpIHsgQ2xhc3NOYW1lID0gY24gKyBCYXNlQ2xhc3ModHJ1ZSwgYWMpIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxTZWxlY3RFbGVtZW50IENvbWJvQm94KHN0cmluZyBjbiwgQ29tYm9Cb3hUeXBlcyBjdCwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgY29tYm8gPSBuZXcgSFRNTFNlbGVjdEVsZW1lbnQoKSB7IENsYXNzTmFtZSA9IGNuICsgQmFzZUNsYXNzKHRydWUsIGFjKSB9O1xyXG4gICAgICAgICAgICBpZihjdCA9PSBDb21ib0JveFR5cGVzLkRlZmF1bHQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY29tYm87XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxCdXR0b25FbGVtZW50IEJ1dHRvbihzdHJpbmcgY24sIEJ1dHRvblR5cGUgYnQsIGJvb2wgYWMgPSB0cnVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBIVE1MQnV0dG9uRWxlbWVudCgpIHsgQ2xhc3NOYW1lID0gY24gKyBCYXNlQ2xhc3ModHJ1ZSwgYWMpLCBUeXBlID0gYnQgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgSFRNTERpdkVsZW1lbnQgRGl2KHN0cmluZyBjbiwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEhUTUxEaXZFbGVtZW50KCkgeyBDbGFzc05hbWUgPSBjbiArIEJhc2VDbGFzcyh0cnVlLCBhYykgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgSFRNTElucHV0RWxlbWVudCBJbnB1dChzdHJpbmcgY24sIElucHV0VHlwZSBpdCwgYm9vbCBhYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSBuZXcgSFRNTElucHV0RWxlbWVudCgpO1xyXG4gICAgICAgICAgICBpbnB1dC5DbGFzc05hbWUgPSBjbiArIEJhc2VDbGFzcyghc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShjbiksIGFjKTtcclxuICAgICAgICAgICAgZHluYW1pYyB0eSA9IGl0O1xyXG4gICAgICAgICAgICBpZihCcm93c2VyLklzSUUgJiYgKHR5ID09IFwidGV4dFwiIHx8IHR5ID09IFwiZGF0ZVwiIHx8IHR5ID09IFwiY29sb3JcIiB8fCB0eSA9PSAxOSB8fCB0eSA9PSAzIHx8IHR5ID09IDIpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5wdXQuVHlwZSA9IGl0O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgSFRNTENhbnZhc0VsZW1lbnQgY3ZhID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBSZXR1cm5zIFRleHQgTWV0cmljcyBmb3IgYSBnaXZlbiBzdHJpbmdcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRcIj50aGUgc3RyaW5nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJmXCI+dGhlIGZvbnQgdXNlZDwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxyZXR1cm5zPlRleHRNZXRyaWNzPC9yZXR1cm5zPlxyXG5cdFx0cHVibGljIHN0YXRpYyBUZXh0TWV0cmljcyBHZXRUZXh0TWV0cmljcyhzdHJpbmcgdCwgc3RyaW5nIGYpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihmID09IFwiXCIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGYgPSBcIjguMjVwdCBUYWhvbWFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgYyA9IChjdmEgPz8gKGN2YSA9IG5ldyBIVE1MQ2FudmFzRWxlbWVudCgpKSkuR2V0Q29udGV4dChDYW52YXNUeXBlcy5DYW52YXNDb250ZXh0MkRUeXBlLkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCkuQXM8Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEPigpO1xyXG4gICAgICAgICAgICBjLkZvbnQgPSBmO1xyXG4gICAgICAgICAgICByZXR1cm4gYy5NZWFzdXJlVGV4dCh0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gUmV0dXJucyB0ZXh0IHdpZHRoXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0XCI+dGhlIHN0cmluZzwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwiZlwiPnRoZSBmb250IHVzZWQ8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cmV0dXJucz5kb3VibGU8L3JldHVybnM+XHJcblx0XHRwdWJsaWMgc3RhdGljIGRvdWJsZSBHZXRUZXh0V2lkdGgoc3RyaW5nIHQsIHN0cmluZyBmKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdldFRleHRNZXRyaWNzKHQsIGYpLldpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbXBsaWNpdCBvcGVyYXRvciBOb2RlKENvbnRyb2wgY29udHJvbClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFNldHRpbmdzLkF1dG9SZW5kZXIgJiYgIWNvbnRyb2wuSGFzUmVuZGVyZWQpXHJcbiAgICAgICAgICAgICAgICBjb250cm9sLlJlbmRlcigpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29udHJvbC5Db250ZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2hhbmdlU3RhdGUoYm9vbCBzLCBzdHJpbmcgc2YgPSBcImRpc2FibGVkXCIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihzKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDb250ZW50LkNsYXNzTGlzdC5SZW1vdmUoc2YpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ29udGVudC5DbGFzc0xpc3QuQWRkKHNmKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsIm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIEFwcFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFNldHRpbmdzLlNldHVwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgZW51bSBBcHBsaWNhdGlvbkRlZml0bmlvblxyXG4gICAge1xyXG4gICAgICAgIE5vbmUsXHJcbiAgICAgICAgQnJvd3NlckNvbnNvbGUsXHJcbiAgICAgICAgQnJpZGdlQ29uc29sZSxcclxuICAgICAgICBFeHByZXNzQ3JhZnRDb25zb2xlXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjbGFzcyBBcHBsaWNhdGlvblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgRm9ybSBNYWluRm9ybSA9IG51bGw7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBDbG9zZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihNYWluRm9ybSAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBNYWluRm9ybS5DbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFdpbmRvdy5DbG9zZSgpO1xyXG4gICAgICAgICAgICBXaW5kb3cuTG9jYXRpb24uUmVsb2FkKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBBcHBsaWNhdGlvbkRlZml0bmlvbiBfYXBwbGljYXRpb25EZWZpdGlvbiA9IEFwcGxpY2F0aW9uRGVmaXRuaW9uLkJyaWRnZUNvbnNvbGU7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBBcHBsaWNhdGlvbkRlZml0bmlvbiBBcGxpY2F0aW9uRGVmaXRpb24geyBnZXQgeyByZXR1cm4gX2FwcGxpY2F0aW9uRGVmaXRpb247IH0gfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgUnVuKEZvcm0gX01haW5mb3JtKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTWFpbkZvcm0gPSBfTWFpbmZvcm07XHJcbiAgICAgICAgICAgIE1haW5Gb3JtLlNob3dTdGFydE5ld0xldmVsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgU3lzdGVtO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgQmFyY29kZVF1YWdnYUpTXHJcbiAgICB7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgRXh0ZXJuYWxQbHVnaW4gRXh0ZXJuYWxRdWFnZ2FKUyA9IG5ldyBFeHRlcm5hbFBsdWdpbihcImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3F1YWdnYS8wLjEyLjEvcXVhZ2dhLm1pbi5qc1wiKTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldHVwKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEV4dGVybmFsUXVhZ2dhSlMuU2V0dXAodHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRGVjb2RlU2luZ2xlKHN0cmluZyBzb3VyY2UsIEFjdGlvbjxzdHJpbmc+IG9uRGV0ZWN0LCBBY3Rpb24gb25Ob0RldGVjdCA9IG51bGwsIGJvb2wgbG9jYXRlID0gdHJ1ZSwgUmVhZGVycyByZWFkZXIgPSBSZWFkZXJzLkNvZGVfMzlfUmVhZGVyLCBib29sIHNvdXJjZUlzQmFzZTY0ID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighRXh0ZXJuYWxRdWFnZ2FKUy5TZXR1cENvbXBsZXRlZClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmKG9uRGV0ZWN0ID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBzdHJpbmcgY29kZU5hbWUgPSByZWFkZXIuVG9TdHJpbmcoXCJHXCIpLlRvTG93ZXIoKTtcclxuICAgICAgICAgICAgaWYoY29kZU5hbWUuU3RhcnRzV2l0aChcIl9cIikpXHJcbiAgICAgICAgICAgICAgICBjb2RlTmFtZSA9IGNvZGVOYW1lLlN1YnN0cmluZygxKTtcclxuICAgICAgICAgICAgaWYoc291cmNlSXNCYXNlNjQgJiYgIXNvdXJjZS5TdGFydHNXaXRoKFwiZGF0YTppbWFnZVwiKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc291cmNlID0gXCJkYXRhOmltYWdlL2pwZztiYXNlNjQsXCIgKyBzb3VyY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLypAXHJcbiAgICAgICAgICAgIFF1YWdnYS5kZWNvZGVTaW5nbGUoe1xyXG4gICAgICAgICAgICAgICAgZGVjb2Rlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlYWRlcnM6IFtjb2RlTmFtZV0gLy8gTGlzdCBvZiBhY3RpdmUgcmVhZGVyc1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxvY2F0ZTogbG9jYXRlLFxyXG4gICAgICAgICAgICAgICAgc3JjOiBzb3VyY2VcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ob25kLCBvbm5kKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuY29kZVJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmQocmVzdWx0LmNvZGVSZXN1bHQuY29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYob25uZCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbm5kKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0ob25EZXRlY3QsIG9uTm9EZXRlY3QpKTtcclxuICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBlbnVtIFJlYWRlcnNcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENvZGVfMTI4X1JlYWRlcixcclxuICAgICAgICAgICAgRWFuX1JlYWRlcixcclxuICAgICAgICAgICAgRWFuXzhfUmVhZGVyLFxyXG4gICAgICAgICAgICBDb2RlXzM5X1JlYWRlcixcclxuICAgICAgICAgICAgQ29kZV8zOV9WaW5fUmVhZGVyLFxyXG4gICAgICAgICAgICBDb2RhYmFyX1JlYWRlcixcclxuICAgICAgICAgICAgVXBjX1JlYWRlcixcclxuICAgICAgICAgICAgVXBjX2VfUmVhZGVyLFxyXG4gICAgICAgICAgICBJMm9mNV9SZWFkZXIsXHJcbiAgICAgICAgICAgIF8yb2Y1X1JlYWRlcixcclxuICAgICAgICAgICAgQ29kZV85M19SZWFkZXIsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAgICAgICAgUXVhZ2dhLmRlY29kZVNpbmdsZSh7XHJcbiAgICAgICAgLy8gICAgZGVjb2Rlcjoge1xyXG4gICAgICAgIC8vICAgICAgICByZWFkZXJzOiBbXCJjb2RlXzEyOF9yZWFkZXJcIl0gLy8gTGlzdCBvZiBhY3RpdmUgcmVhZGVyc1xyXG4gICAgICAgIC8vICAgIH0sXHJcbiAgICAgICAgLy8gICAgbG9jYXRlOiB0cnVlLCAvLyB0cnkgdG8gbG9jYXRlIHRoZSBiYXJjb2RlIGluIHRoZSBpbWFnZVxyXG4gICAgICAgIC8vICAgIHNyYzogJy90ZXN0L2ZpeHR1cmVzL2NvZGVfMTI4L2ltYWdlLTAwMS5qcGcnIC8vIG9yICdkYXRhOmltYWdlL2pwZztiYXNlNjQsJyArIGRhdGFcclxuICAgICAgICAvL30sIGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgICAgLy8gICAgaWYocmVzdWx0LmNvZGVSZXN1bHQpIHtcclxuICAgICAgICAvLyAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHRcIiwgcmVzdWx0LmNvZGVSZXN1bHQuY29kZSk7XHJcbiAgICAgICAgLy8gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgY29uc29sZS5sb2coXCJub3QgZGV0ZWN0ZWRcIik7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vfSk7XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIFN5c3RlbTtcclxudXNpbmcgU3lzdGVtLlRleHQ7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBzdHJ1Y3QgQ29sb3JcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IENvbG9yIEVtcHR5O1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIHNob3J0IFN0YXRlS25vd25Db2xvclZhbGlkO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIHNob3J0IFN0YXRlQVJHQlZhbHVlVmFsaWQ7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgc2hvcnQgU3RhdGVWYWx1ZU1hc2s7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgc2hvcnQgU3RhdGVOYW1lVmFsaWQ7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgbG9uZyBOb3REZWZpbmVkVmFsdWU7XHJcbiAgICAgICAgcHJpdmF0ZSBjb25zdCBpbnQgQVJHQkFscGhhU2hpZnQgPSAweDE4O1xyXG4gICAgICAgIHByaXZhdGUgY29uc3QgaW50IEFSR0JSZWRTaGlmdCA9IDB4MTA7XHJcbiAgICAgICAgcHJpdmF0ZSBjb25zdCBpbnQgQVJHQkdyZWVuU2hpZnQgPSA4O1xyXG4gICAgICAgIHByaXZhdGUgY29uc3QgaW50IEFSR0JCbHVlU2hpZnQgPSAwO1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgc3RyaW5nIG5hbWU7XHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBsb25nIHZhbHVlO1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgc2hvcnQga25vd25Db2xvcjtcclxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IHNob3J0IHN0YXRlO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFRyYW5zcGFyZW50XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlRyYW5zcGFyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBBbGljZUJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQWxpY2VCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBBbnRpcXVlV2hpdGVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQW50aXF1ZVdoaXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBBcXVhXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkFxdWEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEFxdWFtYXJpbmVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQXF1YW1hcmluZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQXp1cmVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQXp1cmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEJlaWdlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkJlaWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBCaXNxdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQmlzcXVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBCbGFja1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5CbGFjayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQmxhbmNoZWRBbG1vbmRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQmxhbmNoZWRBbG1vbmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQmx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQmx1ZVZpb2xldFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5CbHVlVmlvbGV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBCcm93blxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Ccm93bik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQnVybHlXb29kXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkJ1cmx5V29vZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQ2FkZXRCbHVlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkNhZGV0Qmx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQ2hhcnRyZXVzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5DaGFydHJldXNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBDaG9jb2xhdGVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQ2hvY29sYXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBDb3JhbFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Db3JhbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQ29ybmZsb3dlckJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQ29ybmZsb3dlckJsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIENvcm5zaWxrXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkNvcm5zaWxrKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBDcmltc29uXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkNyaW1zb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEN5YW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuQ3lhbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGFya0JsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya0JsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIERhcmtDeWFuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkRhcmtDeWFuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEYXJrR29sZGVucm9kXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkRhcmtHb2xkZW5yb2QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIERhcmtHcmF5XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkRhcmtHcmF5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEYXJrR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya0dyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEYXJrS2hha2lcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya0toYWtpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEYXJrTWFnZW50YVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5EYXJrTWFnZW50YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGFya09saXZlR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya09saXZlR3JlZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIERhcmtPcmFuZ2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya09yYW5nZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGFya09yY2hpZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5EYXJrT3JjaGlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEYXJrUmVkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkRhcmtSZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIERhcmtTYWxtb25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya1NhbG1vbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGFya1NlYUdyZWVuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkRhcmtTZWFHcmVlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGFya1NsYXRlQmx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5EYXJrU2xhdGVCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEYXJrU2xhdGVHcmF5XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkRhcmtTbGF0ZUdyYXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIERhcmtUdXJxdW9pc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGFya1R1cnF1b2lzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGFya1Zpb2xldFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5EYXJrVmlvbGV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBEZWVwUGlua1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5EZWVwUGluayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRGVlcFNreUJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGVlcFNreUJsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIERpbUdyYXlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRGltR3JheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRG9kZ2VyQmx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Eb2RnZXJCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBGaXJlYnJpY2tcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRmlyZWJyaWNrKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBGbG9yYWxXaGl0ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5GbG9yYWxXaGl0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRm9yZXN0R3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRm9yZXN0R3JlZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEZ1Y2hzaWFcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuRnVjaHNpYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgR2FpbnNib3JvXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkdhaW5zYm9ybyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgR2hvc3RXaGl0ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5HaG9zdFdoaXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBHb2xkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkdvbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEdvbGRlbnJvZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Hb2xkZW5yb2QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEdyYXlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuR3JheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuR3JlZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEdyZWVuWWVsbG93XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkdyZWVuWWVsbG93KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBIb25leWRld1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Ib25leWRldyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgSG90UGlua1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Ib3RQaW5rKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBJbmRpYW5SZWRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuSW5kaWFuUmVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBJbmRpZ29cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuSW5kaWdvKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBJdm9yeVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Jdm9yeSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgS2hha2lcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuS2hha2kpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExhdmVuZGVyXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxhdmVuZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBMYXZlbmRlckJsdXNoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxhdmVuZGVyQmx1c2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExhd25HcmVlblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5MYXduR3JlZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExlbW9uQ2hpZmZvblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5MZW1vbkNoaWZmb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExpZ2h0Qmx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5MaWdodEJsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExpZ2h0Q29yYWxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGlnaHRDb3JhbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRDeWFuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxpZ2h0Q3lhbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRHb2xkZW5yb2RZZWxsb3dcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGlnaHRHb2xkZW5yb2RZZWxsb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExpZ2h0R3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGlnaHRHcmVlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRHcmF5XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxpZ2h0R3JheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRQaW5rXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxpZ2h0UGluayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRTYWxtb25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGlnaHRTYWxtb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExpZ2h0U2VhR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGlnaHRTZWFHcmVlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRTa3lCbHVlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxpZ2h0U2t5Qmx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGlnaHRTbGF0ZUdyYXlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGlnaHRTbGF0ZUdyYXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIExpZ2h0U3RlZWxCbHVlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLkxpZ2h0U3RlZWxCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBMaWdodFllbGxvd1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5MaWdodFllbGxvdyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTGltZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5MaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBMaW1lR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTGltZUdyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBMaW5lblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5MaW5lbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTWFnZW50YVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5NYWdlbnRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNYXJvb25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWFyb29uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNZWRpdW1BcXVhbWFyaW5lXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk1lZGl1bUFxdWFtYXJpbmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIE1lZGl1bUJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWVkaXVtQmx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTWVkaXVtT3JjaGlkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk1lZGl1bU9yY2hpZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTWVkaXVtUHVycGxlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk1lZGl1bVB1cnBsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTWVkaXVtU2VhR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWVkaXVtU2VhR3JlZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIE1lZGl1bVNsYXRlQmx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5NZWRpdW1TbGF0ZUJsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIE1lZGl1bVNwcmluZ0dyZWVuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk1lZGl1bVNwcmluZ0dyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNZWRpdW1UdXJxdW9pc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWVkaXVtVHVycXVvaXNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNZWRpdW1WaW9sZXRSZWRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWVkaXVtVmlvbGV0UmVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNaWRuaWdodEJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWlkbmlnaHRCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNaW50Q3JlYW1cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWludENyZWFtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNaXN0eVJvc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTWlzdHlSb3NlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBNb2NjYXNpblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Nb2NjYXNpbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgTmF2YWpvV2hpdGVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTmF2YWpvV2hpdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIE5hdnlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuTmF2eSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgT2xkTGFjZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5PbGRMYWNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBPbGl2ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5PbGl2ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgT2xpdmVEcmFiXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk9saXZlRHJhYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgT3JhbmdlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk9yYW5nZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgT3JhbmdlUmVkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk9yYW5nZVJlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgT3JjaGlkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLk9yY2hpZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgUGFsZUdvbGRlbnJvZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5QYWxlR29sZGVucm9kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBQYWxlR3JlZW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuUGFsZUdyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBQYWxlVHVycXVvaXNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlBhbGVUdXJxdW9pc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFBhbGVWaW9sZXRSZWRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuUGFsZVZpb2xldFJlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgUGFwYXlhV2hpcFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5QYXBheWFXaGlwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBQZWFjaFB1ZmZcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuUGVhY2hQdWZmKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBQZXJ1XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlBlcnUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFBpbmtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuUGluayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgUGx1bVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5QbHVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBQb3dkZXJCbHVlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlBvd2RlckJsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFB1cnBsZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5QdXJwbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFJlZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5SZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFJvc3lCcm93blxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Sb3N5QnJvd24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFJveWFsQmx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Sb3lhbEJsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFNhZGRsZUJyb3duXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNhZGRsZUJyb3duKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTYWxtb25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuU2FsbW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTYW5keUJyb3duXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNhbmR5QnJvd24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFNlYUdyZWVuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNlYUdyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTZWFTaGVsbFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5TZWFTaGVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgU2llbm5hXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNpZW5uYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgU2lsdmVyXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNpbHZlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgU2t5Qmx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5Ta3lCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTbGF0ZUJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuU2xhdGVCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTbGF0ZUdyYXlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuU2xhdGVHcmF5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTbm93XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNub3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFNwcmluZ0dyZWVuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlNwcmluZ0dyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBTdGVlbEJsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuU3RlZWxCbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBUYW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuVGFuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBUZWFsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlRlYWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFRoaXN0bGVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuVGhpc3RsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgVG9tYXRvXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlRvbWF0byk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgVHVycXVvaXNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlR1cnF1b2lzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgVmlvbGV0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlZpb2xldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgV2hlYXRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKEtub3duQ29sb3IuV2hlYXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFdoaXRlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLldoaXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBXaGl0ZVNtb2tlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLldoaXRlU21va2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFllbGxvd1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoS25vd25Db2xvci5ZZWxsb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIFllbGxvd0dyZWVuXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihLbm93bkNvbG9yLlllbGxvd0dyZWVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaW50ZXJuYWwgQ29sb3IoS25vd25Db2xvciBrbm93bkNvbG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IDBMO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGVLbm93bkNvbG9yVmFsaWQ7XHJcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMua25vd25Db2xvciA9IChzaG9ydClrbm93bkNvbG9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBDb2xvcihsb25nIHZhbHVlLCBzaG9ydCBzdGF0ZSwgc3RyaW5nIG5hbWUsIEtub3duQ29sb3Iga25vd25Db2xvcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgICAgICB0aGlzLmtub3duQ29sb3IgPSAoc2hvcnQpa25vd25Db2xvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBieXRlIFJcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGJ5dGUpKCh0aGlzLlZhbHVlID4+IDB4MTApICYgMHhmZkwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYnl0ZSBHXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChieXRlKSgodGhpcy5WYWx1ZSA+PiA4KSAmIDB4ZmZMKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJ5dGUgQlxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoYnl0ZSkodGhpcy5WYWx1ZSAmIDB4ZmZMKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJ5dGUgQVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoYnl0ZSkoKHRoaXMuVmFsdWUgPj4gMHgxOCkgJiAweGZmTCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIElzS25vd25Db2xvclxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKHRoaXMuc3RhdGUgJiBTdGF0ZUtub3duQ29sb3JWYWxpZCkgPiAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSXNFbXB0eVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5zdGF0ZSA9PSAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSXNOYW1lZENvbG9yXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoKHRoaXMuc3RhdGUgJiBTdGF0ZU5hbWVWYWxpZCkgPT0gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5Jc0tub3duQ29sb3I7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSXNTeXN0ZW1Db2xvclxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLklzS25vd25Db2xvcilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmtub3duQ29sb3IgPiAweDFhKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5rbm93bkNvbG9yID4gMHhhNyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbXBsaWNpdCBvcGVyYXRvciBzdHJpbmcoQ29sb3IgY29sb3IpICAvLyBpbXBsaWNpdCBkaWdpdCB0byBieXRlIGNvbnZlcnNpb24gb3BlcmF0b3JcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb2xvci5Ub0hleCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbXBsaWNpdCBvcGVyYXRvciBDb2xvcihzdHJpbmcgaGV4VmFsdWUpICAvLyBpbXBsaWNpdCBkaWdpdCB0byBieXRlIGNvbnZlcnNpb24gb3BlcmF0b3JcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb2xvci5Gcm9tSGV4KGhleFZhbHVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIE5hbWVBbmRBUkdCVmFsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChcInt7TmFtZT17MH0sIEFSR0I9KHsxfSwgezJ9LCB7M30sIHs0fSl9fVwiLCB0aGlzLk5hbWUsIHRoaXMuQSwgdGhpcy5SLCB0aGlzLkcsIHRoaXMuQik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgTmFtZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCh0aGlzLnN0YXRlICYgU3RhdGVOYW1lVmFsaWQpICE9IDApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLklzS25vd25Db2xvcilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29udmVydC5Ub1N0cmluZyh0aGlzLnZhbHVlLCAweDEwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0cmluZyBzdHIgPSBLbm93bkNvbG9yVGFibGUuS25vd25Db2xvclRvTmFtZSgoS25vd25Db2xvcil0aGlzLmtub3duQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgaWYoc3RyICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmtub3duQ29sb3IuVG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBsb25nIFZhbHVlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoKHRoaXMuc3RhdGUgJiBTdGF0ZVZhbHVlTWFzaykgIT0gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuSXNLbm93bkNvbG9yKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZylLbm93bkNvbG9yVGFibGUuS25vd25Db2xvclRvQXJnYigoS25vd25Db2xvcil0aGlzLmtub3duQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5vdERlZmluZWRWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBDaGVja0J5dGUoaW50IHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoKHZhbHVlIDwgMCkgfHwgKHZhbHVlID4gMHhmZikpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbihcIkludmFsaWRFeDJCb3VuZEFyZ3VtZW50XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBsb25nIE1ha2VBcmdiKGJ5dGUgYWxwaGEsIGJ5dGUgcmVkLCBieXRlIGdyZWVuLCBieXRlIGJsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gKGxvbmcpKCgodWxvbmcpKCgoKHJlZCA8PCAweDEwKSB8IChncmVlbiA8PCA4KSkgfCBibHVlKSB8IChhbHBoYSA8PCAweDE4KSkpICYgMHhmZmZmZmZmZkwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBGcm9tQXJnYihpbnQgYXJnYilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sb3IoYXJnYiAmICgobG9uZykweGZmZmZmZmZmTCksIFN0YXRlQVJHQlZhbHVlVmFsaWQsIG51bGwsIChLbm93bkNvbG9yKTApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBGcm9tQXJnYihpbnQgYWxwaGEsIGludCByZWQsIGludCBncmVlbiwgaW50IGJsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDaGVja0J5dGUoYWxwaGEpO1xyXG4gICAgICAgICAgICBDaGVja0J5dGUocmVkKTtcclxuICAgICAgICAgICAgQ2hlY2tCeXRlKGdyZWVuKTtcclxuICAgICAgICAgICAgQ2hlY2tCeXRlKGJsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbG9yKE1ha2VBcmdiKChieXRlKWFscGhhLCAoYnl0ZSlyZWQsIChieXRlKWdyZWVuLCAoYnl0ZSlibHVlKSwgU3RhdGVBUkdCVmFsdWVWYWxpZCwgbnVsbCwgKEtub3duQ29sb3IpMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbG9yIEZyb21BcmdiKGludCBhbHBoYSwgQ29sb3IgYmFzZUNvbG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ2hlY2tCeXRlKGFscGhhKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihNYWtlQXJnYigoYnl0ZSlhbHBoYSwgYmFzZUNvbG9yLlIsIGJhc2VDb2xvci5HLCBiYXNlQ29sb3IuQiksIFN0YXRlQVJHQlZhbHVlVmFsaWQsIG51bGwsIChLbm93bkNvbG9yKTApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBGcm9tQXJnYihpbnQgcmVkLCBpbnQgZ3JlZW4sIGludCBibHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEZyb21BcmdiKDB4ZmYsIHJlZCwgZ3JlZW4sIGJsdWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIElzRW51bVZhbGlkKEVudW0gZW51bVZhbHVlLCBpbnQgdmFsdWUsIGludCBtaW5WYWx1ZSwgaW50IG1heFZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuICgodmFsdWUgPj0gbWluVmFsdWUpICYmICh2YWx1ZSA8PSBtYXhWYWx1ZSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb2xvciBGcm9tS25vd25Db2xvcihLbm93bkNvbG9yIGNvbG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcihjb2xvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIGNvbXBvbmVudFRvSGV4KGJ5dGUgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgeCA9IHZhbHVlLlRvU3RyaW5nKDE2KTtcclxuICAgICAgICAgICAgcmV0dXJuICh4Lkxlbmd0aCA9PSAxID8gXCIwXCIgOiBcIlwiKSArIHg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIFRvSGV4KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKEEgIT0gMjU1KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChcIiN7MH17MX17Mn17M31cIiwgY29tcG9uZW50VG9IZXgoQSksIGNvbXBvbmVudFRvSGV4KFIpLCBjb21wb25lbnRUb0hleChHKSwgY29tcG9uZW50VG9IZXgoQikpOyAvLyBcIiNcIiArICgxNTUpLnRvU3RyaW5nKDE2KSArICgxMDIpLnRvU3RyaW5nKDE2KSArICgxMDIpLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KFwiI3swfXsxfXsyfVwiLCBjb21wb25lbnRUb0hleChSKSwgY29tcG9uZW50VG9IZXgoRyksIGNvbXBvbmVudFRvSGV4KEIpKTsgLy8gXCIjXCIgKyAoMTU1KS50b1N0cmluZygxNikgKyAoMTAyKS50b1N0cmluZygxNikgKyAoMTAyKS50b1N0cmluZygxNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgRnJvbUhleChzdHJpbmcgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih2YWx1ZS5TdGFydHNXaXRoKFwiI1wiKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBGcm9tSGV4KHZhbHVlLlN1YnN0cmluZygxKSk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvbG9yLkZyb21BcmdiKEdsb2JhbC5QYXJzZUludCh2YWx1ZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZmxvYXQgR2V0QnJpZ2h0bmVzcygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmbG9hdCB6ID0gUiAvIHE7XHJcbiAgICAgICAgICAgIGZsb2F0IHggPSBHIC8gcTtcclxuICAgICAgICAgICAgZmxvYXQgYyA9IEIgLyBxO1xyXG4gICAgICAgICAgICBmbG9hdCB2ID0gejtcclxuICAgICAgICAgICAgZmxvYXQgYiA9IHo7XHJcbiAgICAgICAgICAgIGlmKHggPiB2KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2ID0geDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihjID4gdilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdiA9IGM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoeCA8IGIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGIgPSB4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKGMgPCBiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBiID0gYztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gKCh2ICsgYikgLyAyZik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZmxvYXQgR2V0SHVlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCh0aGlzLlIgPT0gdGhpcy5HKSAmJiAodGhpcy5HID09IHRoaXMuQikpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwZjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmbG9hdCB6ID0gUiAvIHE7XHJcbiAgICAgICAgICAgIGZsb2F0IHggPSBHIC8gcTtcclxuICAgICAgICAgICAgZmxvYXQgYyA9IEIgLyBxO1xyXG4gICAgICAgICAgICBmbG9hdCB2ID0gMGY7XHJcbiAgICAgICAgICAgIGZsb2F0IGIgPSB6O1xyXG4gICAgICAgICAgICBmbG9hdCBuID0gejtcclxuICAgICAgICAgICAgaWYoeCA+IGIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGIgPSB4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKGMgPiBiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBiID0gYztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih4IDwgbilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbiA9IHg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoYyA8IG4pXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG4gPSBjO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZsb2F0IG51bTYgPSBiIC0gbjtcclxuICAgICAgICAgICAgaWYoeiA9PSBiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2ID0gKHggLSBjKSAvIG51bTY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih4ID09IGIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHYgPSAyZiArICgoYyAtIHopIC8gbnVtNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihjID09IGIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHYgPSA0ZiArICgoeiAtIHgpIC8gbnVtNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdiAqPSA2MGY7XHJcbiAgICAgICAgICAgIGlmKHYgPCAwZilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdiArPSAzNjBmO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB2O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZmxvYXQgcSA9IDI1NWY7XHJcblxyXG4gICAgICAgIHB1YmxpYyBmbG9hdCBHZXRTYXR1cmF0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZsb2F0IHogPSBSIC8gcTtcclxuICAgICAgICAgICAgZmxvYXQgeCA9IEcgLyBxO1xyXG4gICAgICAgICAgICBmbG9hdCBjID0gQiAvIHE7XHJcbiAgICAgICAgICAgIGZsb2F0IHYgPSAwZjtcclxuICAgICAgICAgICAgZmxvYXQgYiA9IHo7XHJcbiAgICAgICAgICAgIGZsb2F0IG4gPSB6O1xyXG4gICAgICAgICAgICBpZih4ID4gYilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYiA9IHg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoYyA+IGIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGIgPSBjO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHggPCBuKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuID0geDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihjIDwgbilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbiA9IGM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoYiA9PSBuKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmbG9hdCBtID0gKGIgKyBuKSAvIDJmO1xyXG4gICAgICAgICAgICBpZihtIDw9IDAuNSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICgoYiAtIG4pIC8gKGIgKyBuKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICgoYiAtIG4pIC8gKCgyZiAtIGIpIC0gbikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBUb0FyZ2IoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIChpbnQpdGhpcy5WYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBLbm93bkNvbG9yIFRvS25vd25Db2xvcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gKEtub3duQ29sb3IpdGhpcy5rbm93bkNvbG9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHN0cmluZyBUb1N0cmluZygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBTdHJpbmdCdWlsZGVyIGJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigweDIwKTtcclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoYmFzZS5HZXRUeXBlKCkuTmFtZSk7XHJcbiAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKFwiIFtcIik7XHJcbiAgICAgICAgICAgIGlmKCh0aGlzLnN0YXRlICYgU3RhdGVOYW1lVmFsaWQpICE9IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKHRoaXMuTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZigodGhpcy5zdGF0ZSAmIFN0YXRlS25vd25Db2xvclZhbGlkKSAhPSAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBidWlsZGVyLkFwcGVuZCh0aGlzLk5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoKHRoaXMuc3RhdGUgJiBTdGF0ZVZhbHVlTWFzaykgIT0gMClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmRGb3JtYXQoXCJBPXswfSwgUj17MX0sIEc9ezJ9LCBCPXszfVwiLCBBLCBSLCBHLCBCKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKFwiRW1wdHlcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJdXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gYnVpbGRlci5Ub1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIG9wZXJhdG9yID09KENvbG9yIGxlZnQsIENvbG9yIHJpZ2h0KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoKChsZWZ0LnZhbHVlICE9IHJpZ2h0LnZhbHVlKSB8fCAobGVmdC5zdGF0ZSAhPSByaWdodC5zdGF0ZSkpIHx8IChsZWZ0Lmtub3duQ29sb3IgIT0gcmlnaHQua25vd25Db2xvcikpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gKChsZWZ0Lm5hbWUgPT0gcmlnaHQubmFtZSkgfHwgKCgobGVmdC5uYW1lICE9IG51bGwpICYmIChyaWdodC5uYW1lICE9IG51bGwpKSAmJiBsZWZ0Lm5hbWUuRXF1YWxzKHJpZ2h0Lm5hbWUpKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgb3BlcmF0b3IgIT0oQ29sb3IgbGVmdCwgQ29sb3IgcmlnaHQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gIShsZWZ0ID09IHJpZ2h0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSBib29sIEVxdWFscyhvYmplY3Qgb2JqKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYob2JqIGlzIENvbG9yKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDb2xvciBjb2xvciA9IChDb2xvcilvYmo7XHJcbiAgICAgICAgICAgICAgICBpZigoKHRoaXMudmFsdWUgPT0gY29sb3IudmFsdWUpICYmICh0aGlzLnN0YXRlID09IGNvbG9yLnN0YXRlKSkgJiYgKHRoaXMua25vd25Db2xvciA9PSBjb2xvci5rbm93bkNvbG9yKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCh0aGlzLm5hbWUgPT0gY29sb3IubmFtZSkgfHwgKCgodGhpcy5uYW1lICE9IG51bGwpICYmIChjb2xvci5uYW1lICE9IG51bGwpKSAmJiB0aGlzLm5hbWUuRXF1YWxzKHRoaXMubmFtZSkpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgaW50IEdldEhhc2hDb2RlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiAoKHRoaXMudmFsdWUuR2V0SGFzaENvZGUoKSBeIHRoaXMuc3RhdGUuR2V0SGFzaENvZGUoKSkgXiB0aGlzLmtub3duQ29sb3IuR2V0SGFzaENvZGUoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzdGF0aWMgQ29sb3IoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRW1wdHkgPSBuZXcgQ29sb3IoKTtcclxuICAgICAgICAgICAgU3RhdGVLbm93bkNvbG9yVmFsaWQgPSAxO1xyXG4gICAgICAgICAgICBTdGF0ZUFSR0JWYWx1ZVZhbGlkID0gMjtcclxuICAgICAgICAgICAgU3RhdGVWYWx1ZU1hc2sgPSBTdGF0ZUFSR0JWYWx1ZVZhbGlkO1xyXG4gICAgICAgICAgICBTdGF0ZU5hbWVWYWxpZCA9IDg7XHJcbiAgICAgICAgICAgIE5vdERlZmluZWRWYWx1ZSA9IDBMO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZW51bSBLbm93bkNvbG9yXHJcbiAgICB7XHJcbiAgICAgICAgQWN0aXZlQm9yZGVyID0gMSxcclxuICAgICAgICBBY3RpdmVDYXB0aW9uID0gMixcclxuICAgICAgICBBY3RpdmVDYXB0aW9uVGV4dCA9IDMsXHJcbiAgICAgICAgQWxpY2VCbHVlID0gMHgxYyxcclxuICAgICAgICBBbnRpcXVlV2hpdGUgPSAweDFkLFxyXG4gICAgICAgIEFwcFdvcmtzcGFjZSA9IDQsXHJcbiAgICAgICAgQXF1YSA9IDMwLFxyXG4gICAgICAgIEFxdWFtYXJpbmUgPSAweDFmLFxyXG4gICAgICAgIEF6dXJlID0gMHgyMCxcclxuICAgICAgICBCZWlnZSA9IDB4MjEsXHJcbiAgICAgICAgQmlzcXVlID0gMHgyMixcclxuICAgICAgICBCbGFjayA9IDB4MjMsXHJcbiAgICAgICAgQmxhbmNoZWRBbG1vbmQgPSAweDI0LFxyXG4gICAgICAgIEJsdWUgPSAweDI1LFxyXG4gICAgICAgIEJsdWVWaW9sZXQgPSAweDI2LFxyXG4gICAgICAgIEJyb3duID0gMHgyNyxcclxuICAgICAgICBCdXJseVdvb2QgPSA0MCxcclxuICAgICAgICBCdXR0b25GYWNlID0gMHhhOCxcclxuICAgICAgICBCdXR0b25IaWdobGlnaHQgPSAweGE5LFxyXG4gICAgICAgIEJ1dHRvblNoYWRvdyA9IDE3MCxcclxuICAgICAgICBDYWRldEJsdWUgPSAweDI5LFxyXG4gICAgICAgIENoYXJ0cmV1c2UgPSAweDJhLFxyXG4gICAgICAgIENob2NvbGF0ZSA9IDB4MmIsXHJcbiAgICAgICAgQ29udHJvbCA9IDUsXHJcbiAgICAgICAgQ29udHJvbERhcmsgPSA2LFxyXG4gICAgICAgIENvbnRyb2xEYXJrRGFyayA9IDcsXHJcbiAgICAgICAgQ29udHJvbExpZ2h0ID0gOCxcclxuICAgICAgICBDb250cm9sTGlnaHRMaWdodCA9IDksXHJcbiAgICAgICAgQ29udHJvbFRleHQgPSAxMCxcclxuICAgICAgICBDb3JhbCA9IDB4MmMsXHJcbiAgICAgICAgQ29ybmZsb3dlckJsdWUgPSAweDJkLFxyXG4gICAgICAgIENvcm5zaWxrID0gMHgyZSxcclxuICAgICAgICBDcmltc29uID0gMHgyZixcclxuICAgICAgICBDeWFuID0gMHgzMCxcclxuICAgICAgICBEYXJrQmx1ZSA9IDB4MzEsXHJcbiAgICAgICAgRGFya0N5YW4gPSA1MCxcclxuICAgICAgICBEYXJrR29sZGVucm9kID0gMHgzMyxcclxuICAgICAgICBEYXJrR3JheSA9IDB4MzQsXHJcbiAgICAgICAgRGFya0dyZWVuID0gMHgzNSxcclxuICAgICAgICBEYXJrS2hha2kgPSAweDM2LFxyXG4gICAgICAgIERhcmtNYWdlbnRhID0gMHgzNyxcclxuICAgICAgICBEYXJrT2xpdmVHcmVlbiA9IDB4MzgsXHJcbiAgICAgICAgRGFya09yYW5nZSA9IDB4MzksXHJcbiAgICAgICAgRGFya09yY2hpZCA9IDB4M2EsXHJcbiAgICAgICAgRGFya1JlZCA9IDB4M2IsXHJcbiAgICAgICAgRGFya1NhbG1vbiA9IDYwLFxyXG4gICAgICAgIERhcmtTZWFHcmVlbiA9IDB4M2QsXHJcbiAgICAgICAgRGFya1NsYXRlQmx1ZSA9IDB4M2UsXHJcbiAgICAgICAgRGFya1NsYXRlR3JheSA9IDB4M2YsXHJcbiAgICAgICAgRGFya1R1cnF1b2lzZSA9IDB4NDAsXHJcbiAgICAgICAgRGFya1Zpb2xldCA9IDB4NDEsXHJcbiAgICAgICAgRGVlcFBpbmsgPSAweDQyLFxyXG4gICAgICAgIERlZXBTa3lCbHVlID0gMHg0MyxcclxuICAgICAgICBEZXNrdG9wID0gMTEsXHJcbiAgICAgICAgRGltR3JheSA9IDB4NDQsXHJcbiAgICAgICAgRG9kZ2VyQmx1ZSA9IDB4NDUsXHJcbiAgICAgICAgRmlyZWJyaWNrID0gNzAsXHJcbiAgICAgICAgRmxvcmFsV2hpdGUgPSAweDQ3LFxyXG4gICAgICAgIEZvcmVzdEdyZWVuID0gMHg0OCxcclxuICAgICAgICBGdWNoc2lhID0gMHg0OSxcclxuICAgICAgICBHYWluc2Jvcm8gPSAweDRhLFxyXG4gICAgICAgIEdob3N0V2hpdGUgPSAweDRiLFxyXG4gICAgICAgIEdvbGQgPSAweDRjLFxyXG4gICAgICAgIEdvbGRlbnJvZCA9IDB4NGQsXHJcbiAgICAgICAgR3JhZGllbnRBY3RpdmVDYXB0aW9uID0gMHhhYixcclxuICAgICAgICBHcmFkaWVudEluYWN0aXZlQ2FwdGlvbiA9IDB4YWMsXHJcbiAgICAgICAgR3JheSA9IDB4NGUsXHJcbiAgICAgICAgR3JheVRleHQgPSAxMixcclxuICAgICAgICBHcmVlbiA9IDB4NGYsXHJcbiAgICAgICAgR3JlZW5ZZWxsb3cgPSA4MCxcclxuICAgICAgICBIaWdobGlnaHQgPSAxMyxcclxuICAgICAgICBIaWdobGlnaHRUZXh0ID0gMTQsXHJcbiAgICAgICAgSG9uZXlkZXcgPSAweDUxLFxyXG4gICAgICAgIEhvdFBpbmsgPSAweDUyLFxyXG4gICAgICAgIEhvdFRyYWNrID0gMTUsXHJcbiAgICAgICAgSW5hY3RpdmVCb3JkZXIgPSAweDEwLFxyXG4gICAgICAgIEluYWN0aXZlQ2FwdGlvbiA9IDB4MTEsXHJcbiAgICAgICAgSW5hY3RpdmVDYXB0aW9uVGV4dCA9IDB4MTIsXHJcbiAgICAgICAgSW5kaWFuUmVkID0gMHg1MyxcclxuICAgICAgICBJbmRpZ28gPSAweDU0LFxyXG4gICAgICAgIEluZm8gPSAweDEzLFxyXG4gICAgICAgIEluZm9UZXh0ID0gMjAsXHJcbiAgICAgICAgSXZvcnkgPSAweDU1LFxyXG4gICAgICAgIEtoYWtpID0gMHg1NixcclxuICAgICAgICBMYXZlbmRlciA9IDB4NTcsXHJcbiAgICAgICAgTGF2ZW5kZXJCbHVzaCA9IDB4NTgsXHJcbiAgICAgICAgTGF3bkdyZWVuID0gMHg1OSxcclxuICAgICAgICBMZW1vbkNoaWZmb24gPSA5MCxcclxuICAgICAgICBMaWdodEJsdWUgPSAweDViLFxyXG4gICAgICAgIExpZ2h0Q29yYWwgPSAweDVjLFxyXG4gICAgICAgIExpZ2h0Q3lhbiA9IDB4NWQsXHJcbiAgICAgICAgTGlnaHRHb2xkZW5yb2RZZWxsb3cgPSAweDVlLFxyXG4gICAgICAgIExpZ2h0R3JheSA9IDB4NWYsXHJcbiAgICAgICAgTGlnaHRHcmVlbiA9IDB4NjAsXHJcbiAgICAgICAgTGlnaHRQaW5rID0gMHg2MSxcclxuICAgICAgICBMaWdodFNhbG1vbiA9IDB4NjIsXHJcbiAgICAgICAgTGlnaHRTZWFHcmVlbiA9IDB4NjMsXHJcbiAgICAgICAgTGlnaHRTa3lCbHVlID0gMTAwLFxyXG4gICAgICAgIExpZ2h0U2xhdGVHcmF5ID0gMHg2NSxcclxuICAgICAgICBMaWdodFN0ZWVsQmx1ZSA9IDB4NjYsXHJcbiAgICAgICAgTGlnaHRZZWxsb3cgPSAweDY3LFxyXG4gICAgICAgIExpbWUgPSAweDY4LFxyXG4gICAgICAgIExpbWVHcmVlbiA9IDB4NjksXHJcbiAgICAgICAgTGluZW4gPSAweDZhLFxyXG4gICAgICAgIE1hZ2VudGEgPSAweDZiLFxyXG4gICAgICAgIE1hcm9vbiA9IDB4NmMsXHJcbiAgICAgICAgTWVkaXVtQXF1YW1hcmluZSA9IDB4NmQsXHJcbiAgICAgICAgTWVkaXVtQmx1ZSA9IDExMCxcclxuICAgICAgICBNZWRpdW1PcmNoaWQgPSAweDZmLFxyXG4gICAgICAgIE1lZGl1bVB1cnBsZSA9IDB4NzAsXHJcbiAgICAgICAgTWVkaXVtU2VhR3JlZW4gPSAweDcxLFxyXG4gICAgICAgIE1lZGl1bVNsYXRlQmx1ZSA9IDB4NzIsXHJcbiAgICAgICAgTWVkaXVtU3ByaW5nR3JlZW4gPSAweDczLFxyXG4gICAgICAgIE1lZGl1bVR1cnF1b2lzZSA9IDB4NzQsXHJcbiAgICAgICAgTWVkaXVtVmlvbGV0UmVkID0gMHg3NSxcclxuICAgICAgICBNZW51ID0gMHgxNSxcclxuICAgICAgICBNZW51QmFyID0gMHhhZCxcclxuICAgICAgICBNZW51SGlnaGxpZ2h0ID0gMHhhZSxcclxuICAgICAgICBNZW51VGV4dCA9IDB4MTYsXHJcbiAgICAgICAgTWlkbmlnaHRCbHVlID0gMHg3NixcclxuICAgICAgICBNaW50Q3JlYW0gPSAweDc3LFxyXG4gICAgICAgIE1pc3R5Um9zZSA9IDEyMCxcclxuICAgICAgICBNb2NjYXNpbiA9IDB4NzksXHJcbiAgICAgICAgTmF2YWpvV2hpdGUgPSAweDdhLFxyXG4gICAgICAgIE5hdnkgPSAweDdiLFxyXG4gICAgICAgIE9sZExhY2UgPSAweDdjLFxyXG4gICAgICAgIE9saXZlID0gMHg3ZCxcclxuICAgICAgICBPbGl2ZURyYWIgPSAweDdlLFxyXG4gICAgICAgIE9yYW5nZSA9IDB4N2YsXHJcbiAgICAgICAgT3JhbmdlUmVkID0gMHg4MCxcclxuICAgICAgICBPcmNoaWQgPSAweDgxLFxyXG4gICAgICAgIFBhbGVHb2xkZW5yb2QgPSAxMzAsXHJcbiAgICAgICAgUGFsZUdyZWVuID0gMHg4MyxcclxuICAgICAgICBQYWxlVHVycXVvaXNlID0gMHg4NCxcclxuICAgICAgICBQYWxlVmlvbGV0UmVkID0gMHg4NSxcclxuICAgICAgICBQYXBheWFXaGlwID0gMHg4NixcclxuICAgICAgICBQZWFjaFB1ZmYgPSAweDg3LFxyXG4gICAgICAgIFBlcnUgPSAweDg4LFxyXG4gICAgICAgIFBpbmsgPSAweDg5LFxyXG4gICAgICAgIFBsdW0gPSAweDhhLFxyXG4gICAgICAgIFBvd2RlckJsdWUgPSAweDhiLFxyXG4gICAgICAgIFB1cnBsZSA9IDE0MCxcclxuICAgICAgICBSZWQgPSAweDhkLFxyXG4gICAgICAgIFJvc3lCcm93biA9IDB4OGUsXHJcbiAgICAgICAgUm95YWxCbHVlID0gMHg4ZixcclxuICAgICAgICBTYWRkbGVCcm93biA9IDB4OTAsXHJcbiAgICAgICAgU2FsbW9uID0gMHg5MSxcclxuICAgICAgICBTYW5keUJyb3duID0gMHg5MixcclxuICAgICAgICBTY3JvbGxCYXIgPSAweDE3LFxyXG4gICAgICAgIFNlYUdyZWVuID0gMHg5MyxcclxuICAgICAgICBTZWFTaGVsbCA9IDB4OTQsXHJcbiAgICAgICAgU2llbm5hID0gMHg5NSxcclxuICAgICAgICBTaWx2ZXIgPSAxNTAsXHJcbiAgICAgICAgU2t5Qmx1ZSA9IDB4OTcsXHJcbiAgICAgICAgU2xhdGVCbHVlID0gMHg5OCxcclxuICAgICAgICBTbGF0ZUdyYXkgPSAweDk5LFxyXG4gICAgICAgIFNub3cgPSAweDlhLFxyXG4gICAgICAgIFNwcmluZ0dyZWVuID0gMHg5YixcclxuICAgICAgICBTdGVlbEJsdWUgPSAweDljLFxyXG4gICAgICAgIFRhbiA9IDB4OWQsXHJcbiAgICAgICAgVGVhbCA9IDB4OWUsXHJcbiAgICAgICAgVGhpc3RsZSA9IDB4OWYsXHJcbiAgICAgICAgVG9tYXRvID0gMTYwLFxyXG4gICAgICAgIFRyYW5zcGFyZW50ID0gMHgxYixcclxuICAgICAgICBUdXJxdW9pc2UgPSAweGExLFxyXG4gICAgICAgIFZpb2xldCA9IDB4YTIsXHJcbiAgICAgICAgV2hlYXQgPSAweGEzLFxyXG4gICAgICAgIFdoaXRlID0gMHhhNCxcclxuICAgICAgICBXaGl0ZVNtb2tlID0gMHhhNSxcclxuICAgICAgICBXaW5kb3cgPSAweDE4LFxyXG4gICAgICAgIFdpbmRvd0ZyYW1lID0gMHgxOSxcclxuICAgICAgICBXaW5kb3dUZXh0ID0gMHgxYSxcclxuICAgICAgICBZZWxsb3cgPSAweGE2LFxyXG4gICAgICAgIFllbGxvd0dyZWVuID0gMHhhN1xyXG4gICAgfVxyXG5cclxuICAgIGludGVybmFsIHN0YXRpYyBjbGFzcyBLbm93bkNvbG9yVGFibGVcclxuICAgIHtcclxuICAgICAgICAvLyBGaWVsZHNcclxuICAgICAgICBwcml2YXRlIGNvbnN0IGludCBBbHBoYVNoaWZ0ID0gMHgxODtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBjb25zdCBpbnQgQmx1ZVNoaWZ0ID0gMDtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBzdHJpbmdbXSBjb2xvck5hbWVUYWJsZTtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBpbnRbXSBjb2xvclRhYmxlO1xyXG4gICAgICAgIHByaXZhdGUgY29uc3QgaW50IEdyZWVuU2hpZnQgPSA4O1xyXG4gICAgICAgIHByaXZhdGUgY29uc3QgaW50IFJlZFNoaWZ0ID0gMHgxMDtcclxuICAgICAgICBwcml2YXRlIGNvbnN0IGludCBXaW4zMkJsdWVTaGlmdCA9IDB4MTA7XHJcbiAgICAgICAgcHJpdmF0ZSBjb25zdCBpbnQgV2luMzJHcmVlblNoaWZ0ID0gODtcclxuICAgICAgICBwcml2YXRlIGNvbnN0IGludCBXaW4zMlJlZFNoaWZ0ID0gMDtcclxuXHJcbiAgICAgICAgLy8gTWV0aG9kc1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29sb3IgQXJnYlRvS25vd25Db2xvcihpbnQgdGFyZ2V0QVJHQilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEVuc3VyZUNvbG9yVGFibGUoKTtcclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGNvbG9yVGFibGUuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGludCBudW0yID0gY29sb3JUYWJsZVtpXTtcclxuICAgICAgICAgICAgICAgIGlmKG51bTIgPT0gdGFyZ2V0QVJHQilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBDb2xvciBjb2xvciA9IENvbG9yLkZyb21Lbm93bkNvbG9yKChLbm93bkNvbG9yKWkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFjb2xvci5Jc1N5c3RlbUNvbG9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gQ29sb3IuRnJvbUFyZ2IodGFyZ2V0QVJHQik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBpbnQgRW5jb2RlKGludCBhbHBoYSwgaW50IHJlZCwgaW50IGdyZWVuLCBpbnQgYmx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiAoKCgocmVkIDw8IDB4MTApIHwgKGdyZWVuIDw8IDgpKSB8IGJsdWUpIHwgKGFscGhhIDw8IDB4MTgpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIHZvaWQgRW5zdXJlQ29sb3JOYW1lVGFibGUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoY29sb3JOYW1lVGFibGUgPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgSW5pdENvbG9yTmFtZVRhYmxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIHZvaWQgRW5zdXJlQ29sb3JUYWJsZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihjb2xvclRhYmxlID09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEluaXRDb2xvclRhYmxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGludCBGcm9tV2luMzJWYWx1ZShpbnQgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gRW5jb2RlKDB4ZmYsIHZhbHVlICYgMHhmZiwgKHZhbHVlID4+IDgpICYgMHhmZiwgKHZhbHVlID4+IDB4MTApICYgMHhmZik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIEluaXRDb2xvck5hbWVUYWJsZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzdHJpbmdbXSBzID0gbmV3IHN0cmluZ1sweGFmXTtcclxuICAgICAgICAgICAgc1sxXSA9IFwiQWN0aXZlQm9yZGVyXCI7XHJcbiAgICAgICAgICAgIHNbMl0gPSBcIkFjdGl2ZUNhcHRpb25cIjtcclxuICAgICAgICAgICAgc1szXSA9IFwiQWN0aXZlQ2FwdGlvblRleHRcIjtcclxuICAgICAgICAgICAgc1s0XSA9IFwiQXBwV29ya3NwYWNlXCI7XHJcbiAgICAgICAgICAgIHNbMHhhOF0gPSBcIkJ1dHRvbkZhY2VcIjtcclxuICAgICAgICAgICAgc1sweGE5XSA9IFwiQnV0dG9uSGlnaGxpZ2h0XCI7XHJcbiAgICAgICAgICAgIHNbMTcwXSA9IFwiQnV0dG9uU2hhZG93XCI7XHJcbiAgICAgICAgICAgIHNbNV0gPSBcIkNvbnRyb2xcIjtcclxuICAgICAgICAgICAgc1s2XSA9IFwiQ29udHJvbERhcmtcIjtcclxuICAgICAgICAgICAgc1s3XSA9IFwiQ29udHJvbERhcmtEYXJrXCI7XHJcbiAgICAgICAgICAgIHNbOF0gPSBcIkNvbnRyb2xMaWdodFwiO1xyXG4gICAgICAgICAgICBzWzldID0gXCJDb250cm9sTGlnaHRMaWdodFwiO1xyXG4gICAgICAgICAgICBzWzEwXSA9IFwiQ29udHJvbFRleHRcIjtcclxuICAgICAgICAgICAgc1sxMV0gPSBcIkRlc2t0b3BcIjtcclxuICAgICAgICAgICAgc1sweGFiXSA9IFwiR3JhZGllbnRBY3RpdmVDYXB0aW9uXCI7XHJcbiAgICAgICAgICAgIHNbMHhhY10gPSBcIkdyYWRpZW50SW5hY3RpdmVDYXB0aW9uXCI7XHJcbiAgICAgICAgICAgIHNbMTJdID0gXCJHcmF5VGV4dFwiO1xyXG4gICAgICAgICAgICBzWzEzXSA9IFwiSGlnaGxpZ2h0XCI7XHJcbiAgICAgICAgICAgIHNbMTRdID0gXCJIaWdobGlnaHRUZXh0XCI7XHJcbiAgICAgICAgICAgIHNbMTVdID0gXCJIb3RUcmFja1wiO1xyXG4gICAgICAgICAgICBzWzB4MTBdID0gXCJJbmFjdGl2ZUJvcmRlclwiO1xyXG4gICAgICAgICAgICBzWzB4MTFdID0gXCJJbmFjdGl2ZUNhcHRpb25cIjtcclxuICAgICAgICAgICAgc1sweDEyXSA9IFwiSW5hY3RpdmVDYXB0aW9uVGV4dFwiO1xyXG4gICAgICAgICAgICBzWzB4MTNdID0gXCJJbmZvXCI7XHJcbiAgICAgICAgICAgIHNbMjBdID0gXCJJbmZvVGV4dFwiO1xyXG4gICAgICAgICAgICBzWzB4MTVdID0gXCJNZW51XCI7XHJcbiAgICAgICAgICAgIHNbMHhhZF0gPSBcIk1lbnVCYXJcIjtcclxuICAgICAgICAgICAgc1sweGFlXSA9IFwiTWVudUhpZ2hsaWdodFwiO1xyXG4gICAgICAgICAgICBzWzB4MTZdID0gXCJNZW51VGV4dFwiO1xyXG4gICAgICAgICAgICBzWzB4MTddID0gXCJTY3JvbGxCYXJcIjtcclxuICAgICAgICAgICAgc1sweDE4XSA9IFwiV2luZG93XCI7XHJcbiAgICAgICAgICAgIHNbMHgxOV0gPSBcIldpbmRvd0ZyYW1lXCI7XHJcbiAgICAgICAgICAgIHNbMHgxYV0gPSBcIldpbmRvd1RleHRcIjtcclxuICAgICAgICAgICAgc1sweDFiXSA9IFwiVHJhbnNwYXJlbnRcIjtcclxuICAgICAgICAgICAgc1sweDFjXSA9IFwiQWxpY2VCbHVlXCI7XHJcbiAgICAgICAgICAgIHNbMHgxZF0gPSBcIkFudGlxdWVXaGl0ZVwiO1xyXG4gICAgICAgICAgICBzWzMwXSA9IFwiQXF1YVwiO1xyXG4gICAgICAgICAgICBzWzB4MWZdID0gXCJBcXVhbWFyaW5lXCI7XHJcbiAgICAgICAgICAgIHNbMHgyMF0gPSBcIkF6dXJlXCI7XHJcbiAgICAgICAgICAgIHNbMHgyMV0gPSBcIkJlaWdlXCI7XHJcbiAgICAgICAgICAgIHNbMHgyMl0gPSBcIkJpc3F1ZVwiO1xyXG4gICAgICAgICAgICBzWzB4MjNdID0gXCJCbGFja1wiO1xyXG4gICAgICAgICAgICBzWzB4MjRdID0gXCJCbGFuY2hlZEFsbW9uZFwiO1xyXG4gICAgICAgICAgICBzWzB4MjVdID0gXCJCbHVlXCI7XHJcbiAgICAgICAgICAgIHNbMHgyNl0gPSBcIkJsdWVWaW9sZXRcIjtcclxuICAgICAgICAgICAgc1sweDI3XSA9IFwiQnJvd25cIjtcclxuICAgICAgICAgICAgc1s0MF0gPSBcIkJ1cmx5V29vZFwiO1xyXG4gICAgICAgICAgICBzWzB4MjldID0gXCJDYWRldEJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDJhXSA9IFwiQ2hhcnRyZXVzZVwiO1xyXG4gICAgICAgICAgICBzWzB4MmJdID0gXCJDaG9jb2xhdGVcIjtcclxuICAgICAgICAgICAgc1sweDJjXSA9IFwiQ29yYWxcIjtcclxuICAgICAgICAgICAgc1sweDJkXSA9IFwiQ29ybmZsb3dlckJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDJlXSA9IFwiQ29ybnNpbGtcIjtcclxuICAgICAgICAgICAgc1sweDJmXSA9IFwiQ3JpbXNvblwiO1xyXG4gICAgICAgICAgICBzWzB4MzBdID0gXCJDeWFuXCI7XHJcbiAgICAgICAgICAgIHNbMHgzMV0gPSBcIkRhcmtCbHVlXCI7XHJcbiAgICAgICAgICAgIHNbNTBdID0gXCJEYXJrQ3lhblwiO1xyXG4gICAgICAgICAgICBzWzB4MzNdID0gXCJEYXJrR29sZGVucm9kXCI7XHJcbiAgICAgICAgICAgIHNbMHgzNF0gPSBcIkRhcmtHcmF5XCI7XHJcbiAgICAgICAgICAgIHNbMHgzNV0gPSBcIkRhcmtHcmVlblwiO1xyXG4gICAgICAgICAgICBzWzB4MzZdID0gXCJEYXJrS2hha2lcIjtcclxuICAgICAgICAgICAgc1sweDM3XSA9IFwiRGFya01hZ2VudGFcIjtcclxuICAgICAgICAgICAgc1sweDM4XSA9IFwiRGFya09saXZlR3JlZW5cIjtcclxuICAgICAgICAgICAgc1sweDM5XSA9IFwiRGFya09yYW5nZVwiO1xyXG4gICAgICAgICAgICBzWzB4M2FdID0gXCJEYXJrT3JjaGlkXCI7XHJcbiAgICAgICAgICAgIHNbMHgzYl0gPSBcIkRhcmtSZWRcIjtcclxuICAgICAgICAgICAgc1s2MF0gPSBcIkRhcmtTYWxtb25cIjtcclxuICAgICAgICAgICAgc1sweDNkXSA9IFwiRGFya1NlYUdyZWVuXCI7XHJcbiAgICAgICAgICAgIHNbMHgzZV0gPSBcIkRhcmtTbGF0ZUJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDNmXSA9IFwiRGFya1NsYXRlR3JheVwiO1xyXG4gICAgICAgICAgICBzWzB4NDBdID0gXCJEYXJrVHVycXVvaXNlXCI7XHJcbiAgICAgICAgICAgIHNbMHg0MV0gPSBcIkRhcmtWaW9sZXRcIjtcclxuICAgICAgICAgICAgc1sweDQyXSA9IFwiRGVlcFBpbmtcIjtcclxuICAgICAgICAgICAgc1sweDQzXSA9IFwiRGVlcFNreUJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDQ0XSA9IFwiRGltR3JheVwiO1xyXG4gICAgICAgICAgICBzWzB4NDVdID0gXCJEb2RnZXJCbHVlXCI7XHJcbiAgICAgICAgICAgIHNbNzBdID0gXCJGaXJlYnJpY2tcIjtcclxuICAgICAgICAgICAgc1sweDQ3XSA9IFwiRmxvcmFsV2hpdGVcIjtcclxuICAgICAgICAgICAgc1sweDQ4XSA9IFwiRm9yZXN0R3JlZW5cIjtcclxuICAgICAgICAgICAgc1sweDQ5XSA9IFwiRnVjaHNpYVwiO1xyXG4gICAgICAgICAgICBzWzB4NGFdID0gXCJHYWluc2Jvcm9cIjtcclxuICAgICAgICAgICAgc1sweDRiXSA9IFwiR2hvc3RXaGl0ZVwiO1xyXG4gICAgICAgICAgICBzWzB4NGNdID0gXCJHb2xkXCI7XHJcbiAgICAgICAgICAgIHNbMHg0ZF0gPSBcIkdvbGRlbnJvZFwiO1xyXG4gICAgICAgICAgICBzWzB4NGVdID0gXCJHcmF5XCI7XHJcbiAgICAgICAgICAgIHNbMHg0Zl0gPSBcIkdyZWVuXCI7XHJcbiAgICAgICAgICAgIHNbODBdID0gXCJHcmVlblllbGxvd1wiO1xyXG4gICAgICAgICAgICBzWzB4NTFdID0gXCJIb25leWRld1wiO1xyXG4gICAgICAgICAgICBzWzB4NTJdID0gXCJIb3RQaW5rXCI7XHJcbiAgICAgICAgICAgIHNbMHg1M10gPSBcIkluZGlhblJlZFwiO1xyXG4gICAgICAgICAgICBzWzB4NTRdID0gXCJJbmRpZ29cIjtcclxuICAgICAgICAgICAgc1sweDU1XSA9IFwiSXZvcnlcIjtcclxuICAgICAgICAgICAgc1sweDU2XSA9IFwiS2hha2lcIjtcclxuICAgICAgICAgICAgc1sweDU3XSA9IFwiTGF2ZW5kZXJcIjtcclxuICAgICAgICAgICAgc1sweDU4XSA9IFwiTGF2ZW5kZXJCbHVzaFwiO1xyXG4gICAgICAgICAgICBzWzB4NTldID0gXCJMYXduR3JlZW5cIjtcclxuICAgICAgICAgICAgc1s5MF0gPSBcIkxlbW9uQ2hpZmZvblwiO1xyXG4gICAgICAgICAgICBzWzB4NWJdID0gXCJMaWdodEJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDVjXSA9IFwiTGlnaHRDb3JhbFwiO1xyXG4gICAgICAgICAgICBzWzB4NWRdID0gXCJMaWdodEN5YW5cIjtcclxuICAgICAgICAgICAgc1sweDVlXSA9IFwiTGlnaHRHb2xkZW5yb2RZZWxsb3dcIjtcclxuICAgICAgICAgICAgc1sweDVmXSA9IFwiTGlnaHRHcmF5XCI7XHJcbiAgICAgICAgICAgIHNbMHg2MF0gPSBcIkxpZ2h0R3JlZW5cIjtcclxuICAgICAgICAgICAgc1sweDYxXSA9IFwiTGlnaHRQaW5rXCI7XHJcbiAgICAgICAgICAgIHNbMHg2Ml0gPSBcIkxpZ2h0U2FsbW9uXCI7XHJcbiAgICAgICAgICAgIHNbMHg2M10gPSBcIkxpZ2h0U2VhR3JlZW5cIjtcclxuICAgICAgICAgICAgc1sxMDBdID0gXCJMaWdodFNreUJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDY1XSA9IFwiTGlnaHRTbGF0ZUdyYXlcIjtcclxuICAgICAgICAgICAgc1sweDY2XSA9IFwiTGlnaHRTdGVlbEJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDY3XSA9IFwiTGlnaHRZZWxsb3dcIjtcclxuICAgICAgICAgICAgc1sweDY4XSA9IFwiTGltZVwiO1xyXG4gICAgICAgICAgICBzWzB4NjldID0gXCJMaW1lR3JlZW5cIjtcclxuICAgICAgICAgICAgc1sweDZhXSA9IFwiTGluZW5cIjtcclxuICAgICAgICAgICAgc1sweDZiXSA9IFwiTWFnZW50YVwiO1xyXG4gICAgICAgICAgICBzWzB4NmNdID0gXCJNYXJvb25cIjtcclxuICAgICAgICAgICAgc1sweDZkXSA9IFwiTWVkaXVtQXF1YW1hcmluZVwiO1xyXG4gICAgICAgICAgICBzWzExMF0gPSBcIk1lZGl1bUJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDZmXSA9IFwiTWVkaXVtT3JjaGlkXCI7XHJcbiAgICAgICAgICAgIHNbMHg3MF0gPSBcIk1lZGl1bVB1cnBsZVwiO1xyXG4gICAgICAgICAgICBzWzB4NzFdID0gXCJNZWRpdW1TZWFHcmVlblwiO1xyXG4gICAgICAgICAgICBzWzB4NzJdID0gXCJNZWRpdW1TbGF0ZUJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDczXSA9IFwiTWVkaXVtU3ByaW5nR3JlZW5cIjtcclxuICAgICAgICAgICAgc1sweDc0XSA9IFwiTWVkaXVtVHVycXVvaXNlXCI7XHJcbiAgICAgICAgICAgIHNbMHg3NV0gPSBcIk1lZGl1bVZpb2xldFJlZFwiO1xyXG4gICAgICAgICAgICBzWzB4NzZdID0gXCJNaWRuaWdodEJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDc3XSA9IFwiTWludENyZWFtXCI7XHJcbiAgICAgICAgICAgIHNbMTIwXSA9IFwiTWlzdHlSb3NlXCI7XHJcbiAgICAgICAgICAgIHNbMHg3OV0gPSBcIk1vY2Nhc2luXCI7XHJcbiAgICAgICAgICAgIHNbMHg3YV0gPSBcIk5hdmFqb1doaXRlXCI7XHJcbiAgICAgICAgICAgIHNbMHg3Yl0gPSBcIk5hdnlcIjtcclxuICAgICAgICAgICAgc1sweDdjXSA9IFwiT2xkTGFjZVwiO1xyXG4gICAgICAgICAgICBzWzB4N2RdID0gXCJPbGl2ZVwiO1xyXG4gICAgICAgICAgICBzWzB4N2VdID0gXCJPbGl2ZURyYWJcIjtcclxuICAgICAgICAgICAgc1sweDdmXSA9IFwiT3JhbmdlXCI7XHJcbiAgICAgICAgICAgIHNbMHg4MF0gPSBcIk9yYW5nZVJlZFwiO1xyXG4gICAgICAgICAgICBzWzB4ODFdID0gXCJPcmNoaWRcIjtcclxuICAgICAgICAgICAgc1sxMzBdID0gXCJQYWxlR29sZGVucm9kXCI7XHJcbiAgICAgICAgICAgIHNbMHg4M10gPSBcIlBhbGVHcmVlblwiO1xyXG4gICAgICAgICAgICBzWzB4ODRdID0gXCJQYWxlVHVycXVvaXNlXCI7XHJcbiAgICAgICAgICAgIHNbMHg4NV0gPSBcIlBhbGVWaW9sZXRSZWRcIjtcclxuICAgICAgICAgICAgc1sweDg2XSA9IFwiUGFwYXlhV2hpcFwiO1xyXG4gICAgICAgICAgICBzWzB4ODddID0gXCJQZWFjaFB1ZmZcIjtcclxuICAgICAgICAgICAgc1sweDg4XSA9IFwiUGVydVwiO1xyXG4gICAgICAgICAgICBzWzB4ODldID0gXCJQaW5rXCI7XHJcbiAgICAgICAgICAgIHNbMHg4YV0gPSBcIlBsdW1cIjtcclxuICAgICAgICAgICAgc1sweDhiXSA9IFwiUG93ZGVyQmx1ZVwiO1xyXG4gICAgICAgICAgICBzWzE0MF0gPSBcIlB1cnBsZVwiO1xyXG4gICAgICAgICAgICBzWzB4OGRdID0gXCJSZWRcIjtcclxuICAgICAgICAgICAgc1sweDhlXSA9IFwiUm9zeUJyb3duXCI7XHJcbiAgICAgICAgICAgIHNbMHg4Zl0gPSBcIlJveWFsQmx1ZVwiO1xyXG4gICAgICAgICAgICBzWzB4OTBdID0gXCJTYWRkbGVCcm93blwiO1xyXG4gICAgICAgICAgICBzWzB4OTFdID0gXCJTYWxtb25cIjtcclxuICAgICAgICAgICAgc1sweDkyXSA9IFwiU2FuZHlCcm93blwiO1xyXG4gICAgICAgICAgICBzWzB4OTNdID0gXCJTZWFHcmVlblwiO1xyXG4gICAgICAgICAgICBzWzB4OTRdID0gXCJTZWFTaGVsbFwiO1xyXG4gICAgICAgICAgICBzWzB4OTVdID0gXCJTaWVubmFcIjtcclxuICAgICAgICAgICAgc1sxNTBdID0gXCJTaWx2ZXJcIjtcclxuICAgICAgICAgICAgc1sweDk3XSA9IFwiU2t5Qmx1ZVwiO1xyXG4gICAgICAgICAgICBzWzB4OThdID0gXCJTbGF0ZUJsdWVcIjtcclxuICAgICAgICAgICAgc1sweDk5XSA9IFwiU2xhdGVHcmF5XCI7XHJcbiAgICAgICAgICAgIHNbMHg5YV0gPSBcIlNub3dcIjtcclxuICAgICAgICAgICAgc1sweDliXSA9IFwiU3ByaW5nR3JlZW5cIjtcclxuICAgICAgICAgICAgc1sweDljXSA9IFwiU3RlZWxCbHVlXCI7XHJcbiAgICAgICAgICAgIHNbMHg5ZF0gPSBcIlRhblwiO1xyXG4gICAgICAgICAgICBzWzB4OWVdID0gXCJUZWFsXCI7XHJcbiAgICAgICAgICAgIHNbMHg5Zl0gPSBcIlRoaXN0bGVcIjtcclxuICAgICAgICAgICAgc1sxNjBdID0gXCJUb21hdG9cIjtcclxuICAgICAgICAgICAgc1sweGExXSA9IFwiVHVycXVvaXNlXCI7XHJcbiAgICAgICAgICAgIHNbMHhhMl0gPSBcIlZpb2xldFwiO1xyXG4gICAgICAgICAgICBzWzB4YTNdID0gXCJXaGVhdFwiO1xyXG4gICAgICAgICAgICBzWzB4YTRdID0gXCJXaGl0ZVwiO1xyXG4gICAgICAgICAgICBzWzB4YTVdID0gXCJXaGl0ZVNtb2tlXCI7XHJcbiAgICAgICAgICAgIHNbMHhhNl0gPSBcIlllbGxvd1wiO1xyXG4gICAgICAgICAgICBzWzB4YTddID0gXCJZZWxsb3dHcmVlblwiO1xyXG4gICAgICAgICAgICBjb2xvck5hbWVUYWJsZSA9IHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIEluaXRDb2xvclRhYmxlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludFtdIGMgPSBuZXcgaW50WzB4YWZdO1xyXG5cclxuICAgICAgICAgICAgY1sweDFiXSA9IDB4ZmZmZmZmO1xyXG4gICAgICAgICAgICBjWzB4MWNdID0gLTk4NDgzMztcclxuICAgICAgICAgICAgY1sweDFkXSA9IC0zMzI4NDE7XHJcbiAgICAgICAgICAgIGNbMzBdID0gLTE2NzExNjgxO1xyXG4gICAgICAgICAgICBjWzB4MWZdID0gLTgzODg2NTI7XHJcbiAgICAgICAgICAgIGNbMHgyMF0gPSAtOTgzMDQxO1xyXG4gICAgICAgICAgICBjWzB4MjFdID0gLTY1Nzk1NjtcclxuICAgICAgICAgICAgY1sweDIyXSA9IC02OTcyO1xyXG4gICAgICAgICAgICBjWzB4MjNdID0gLTE2Nzc3MjE2O1xyXG4gICAgICAgICAgICBjWzB4MjRdID0gLTUxNzE7XHJcbiAgICAgICAgICAgIGNbMHgyNV0gPSAtMTY3NzY5NjE7XHJcbiAgICAgICAgICAgIGNbMHgyNl0gPSAtNzcyMjAxNDtcclxuICAgICAgICAgICAgY1sweDI3XSA9IC01OTUyOTgyO1xyXG4gICAgICAgICAgICBjWzQwXSA9IC0yMTgwOTg1O1xyXG4gICAgICAgICAgICBjWzB4MjldID0gLTEwNTEwNjg4O1xyXG4gICAgICAgICAgICBjWzB4MmFdID0gLTgzODg4NjQ7XHJcbiAgICAgICAgICAgIGNbMHgyYl0gPSAtMjk4Nzc0NjtcclxuICAgICAgICAgICAgY1sweDJjXSA9IC0zMjk0NDtcclxuICAgICAgICAgICAgY1sweDJkXSA9IC0xMDE4NTIzNTtcclxuICAgICAgICAgICAgY1sweDJlXSA9IC0xODI4O1xyXG4gICAgICAgICAgICBjWzB4MmZdID0gLTIzNTQxMTY7XHJcbiAgICAgICAgICAgIGNbMHgzMF0gPSAtMTY3MTE2ODE7XHJcbiAgICAgICAgICAgIGNbMHgzMV0gPSAtMTY3NzcwNzc7XHJcbiAgICAgICAgICAgIGNbNTBdID0gLTE2NzQxNDkzO1xyXG4gICAgICAgICAgICBjWzB4MzNdID0gLTQ2ODQyNzc7XHJcbiAgICAgICAgICAgIGNbMHgzNF0gPSAtNTY1ODE5OTtcclxuICAgICAgICAgICAgY1sweDM1XSA9IC0xNjc1MTYxNjtcclxuICAgICAgICAgICAgY1sweDM2XSA9IC00MzQzOTU3O1xyXG4gICAgICAgICAgICBjWzB4MzddID0gLTc2Njc1NzM7XHJcbiAgICAgICAgICAgIGNbMHgzOF0gPSAtMTExNzkyMTc7XHJcbiAgICAgICAgICAgIGNbMHgzOV0gPSAtMjk2OTY7XHJcbiAgICAgICAgICAgIGNbMHgzYV0gPSAtNjczNzIwNDtcclxuICAgICAgICAgICAgY1sweDNiXSA9IC03NjY3NzEyO1xyXG4gICAgICAgICAgICBjWzYwXSA9IC0xNDY4ODA2O1xyXG4gICAgICAgICAgICBjWzB4M2RdID0gLTczNTczMDE7XHJcbiAgICAgICAgICAgIGNbMHgzZV0gPSAtMTIwNDI4Njk7XHJcbiAgICAgICAgICAgIGNbMHgzZl0gPSAtMTM2NzY3MjE7XHJcbiAgICAgICAgICAgIGNbMHg0MF0gPSAtMTY3MjQyNzE7XHJcbiAgICAgICAgICAgIGNbMHg0MV0gPSAtNzA3NzY3NztcclxuICAgICAgICAgICAgY1sweDQyXSA9IC02MDI2OTtcclxuICAgICAgICAgICAgY1sweDQzXSA9IC0xNjcyODA2NTtcclxuICAgICAgICAgICAgY1sweDQ0XSA9IC05ODY4OTUxO1xyXG4gICAgICAgICAgICBjWzB4NDVdID0gLTE0Nzc0MDE3O1xyXG4gICAgICAgICAgICBjWzcwXSA9IC01MTAzMDcwO1xyXG4gICAgICAgICAgICBjWzB4NDddID0gLTEyOTY7XHJcbiAgICAgICAgICAgIGNbMHg0OF0gPSAtMTQ1MTMzNzQ7XHJcbiAgICAgICAgICAgIGNbMHg0OV0gPSAtNjUyODE7XHJcbiAgICAgICAgICAgIGNbMHg0YV0gPSAtMjMwMjc1NjtcclxuICAgICAgICAgICAgY1sweDRiXSA9IC00NjA1NDU7XHJcbiAgICAgICAgICAgIGNbMHg0Y10gPSAtMTA0OTY7XHJcbiAgICAgICAgICAgIGNbMHg0ZF0gPSAtMjQ0ODA5NjtcclxuICAgICAgICAgICAgY1sweDRlXSA9IC04MzU1NzEyO1xyXG4gICAgICAgICAgICBjWzB4NGZdID0gLTE2NzQ0NDQ4O1xyXG4gICAgICAgICAgICBjWzgwXSA9IC01Mzc0MTYxO1xyXG4gICAgICAgICAgICBjWzB4NTFdID0gLTk4MzA1NjtcclxuICAgICAgICAgICAgY1sweDUyXSA9IC0zODQ3NjtcclxuICAgICAgICAgICAgY1sweDUzXSA9IC0zMzE4NjkyO1xyXG4gICAgICAgICAgICBjWzB4NTRdID0gLTExODYxODg2O1xyXG4gICAgICAgICAgICBjWzB4NTVdID0gLTE2O1xyXG4gICAgICAgICAgICBjWzB4NTZdID0gLTk4OTU1NjtcclxuICAgICAgICAgICAgY1sweDU3XSA9IC0xNjQ0ODA2O1xyXG4gICAgICAgICAgICBjWzB4NThdID0gLTM4NTE7XHJcbiAgICAgICAgICAgIGNbMHg1OV0gPSAtODU4NjI0MDtcclxuICAgICAgICAgICAgY1s5MF0gPSAtMTMzMTtcclxuICAgICAgICAgICAgY1sweDViXSA9IC01MzgzOTYyO1xyXG4gICAgICAgICAgICBjWzB4NWNdID0gLTEwMTU2ODA7XHJcbiAgICAgICAgICAgIGNbMHg1ZF0gPSAtMjAzMTYxNztcclxuICAgICAgICAgICAgY1sweDVlXSA9IC0zMjkwMDY7XHJcbiAgICAgICAgICAgIGNbMHg1Zl0gPSAtMjg5NDg5MztcclxuICAgICAgICAgICAgY1sweDYwXSA9IC03Mjc4OTYwO1xyXG4gICAgICAgICAgICBjWzB4NjFdID0gLTE4NzUxO1xyXG4gICAgICAgICAgICBjWzB4NjJdID0gLTI0NDU0O1xyXG4gICAgICAgICAgICBjWzB4NjNdID0gLTE0NjM0MzI2O1xyXG4gICAgICAgICAgICBjWzEwMF0gPSAtNzg3Njg3MDtcclxuICAgICAgICAgICAgY1sweDY1XSA9IC04OTQzNDYzO1xyXG4gICAgICAgICAgICBjWzB4NjZdID0gLTUxOTI0ODI7XHJcbiAgICAgICAgICAgIGNbMHg2N10gPSAtMzI7XHJcbiAgICAgICAgICAgIGNbMHg2OF0gPSAtMTY3MTE5MzY7XHJcbiAgICAgICAgICAgIGNbMHg2OV0gPSAtMTM0NDc4ODY7XHJcbiAgICAgICAgICAgIGNbMHg2YV0gPSAtMzMxNTQ2O1xyXG4gICAgICAgICAgICBjWzB4NmJdID0gLTY1MjgxO1xyXG4gICAgICAgICAgICBjWzB4NmNdID0gLTgzODg2MDg7XHJcbiAgICAgICAgICAgIGNbMHg2ZF0gPSAtMTAwMzk4OTQ7XHJcbiAgICAgICAgICAgIGNbMTEwXSA9IC0xNjc3NzAxMTtcclxuICAgICAgICAgICAgY1sweDZmXSA9IC00NTY1NTQ5O1xyXG4gICAgICAgICAgICBjWzB4NzBdID0gLTcxMTQ1MzM7XHJcbiAgICAgICAgICAgIGNbMHg3MV0gPSAtMTI3OTkxMTk7XHJcbiAgICAgICAgICAgIGNbMHg3Ml0gPSAtODY4OTQyNjtcclxuICAgICAgICAgICAgY1sweDczXSA9IC0xNjcxMzA2MjtcclxuICAgICAgICAgICAgY1sweDc0XSA9IC0xMjAwNDkxNjtcclxuICAgICAgICAgICAgY1sweDc1XSA9IC0zNzMwMDQzO1xyXG4gICAgICAgICAgICBjWzB4NzZdID0gLTE1MTMyMzA0O1xyXG4gICAgICAgICAgICBjWzB4NzddID0gLTY1NTM2NjtcclxuICAgICAgICAgICAgY1sxMjBdID0gLTY5NDM7XHJcbiAgICAgICAgICAgIGNbMHg3OV0gPSAtNjk4NztcclxuICAgICAgICAgICAgY1sweDdhXSA9IC04NTMxO1xyXG4gICAgICAgICAgICBjWzB4N2JdID0gLTE2Nzc3MDg4O1xyXG4gICAgICAgICAgICBjWzB4N2NdID0gLTEzMzY1ODtcclxuICAgICAgICAgICAgY1sweDdkXSA9IC04MzU1ODQwO1xyXG4gICAgICAgICAgICBjWzB4N2VdID0gLTk3Mjg0Nzc7XHJcbiAgICAgICAgICAgIGNbMHg3Zl0gPSAtMjMyOTY7XHJcbiAgICAgICAgICAgIGNbMHg4MF0gPSAtNDc4NzI7XHJcbiAgICAgICAgICAgIGNbMHg4MV0gPSAtMjQ2MTQ4MjtcclxuICAgICAgICAgICAgY1sxMzBdID0gLTExMjAwODY7XHJcbiAgICAgICAgICAgIGNbMHg4M10gPSAtNjc1MTMzNjtcclxuICAgICAgICAgICAgY1sweDg0XSA9IC01MjQ3MjUwO1xyXG4gICAgICAgICAgICBjWzB4ODVdID0gLTIzOTYwMTM7XHJcbiAgICAgICAgICAgIGNbMHg4Nl0gPSAtNDEzOTtcclxuICAgICAgICAgICAgY1sweDg3XSA9IC05NTQzO1xyXG4gICAgICAgICAgICBjWzB4ODhdID0gLTMzMDgyMjU7XHJcbiAgICAgICAgICAgIGNbMHg4OV0gPSAtMTYxODE7XHJcbiAgICAgICAgICAgIGNbMHg4YV0gPSAtMjI1MjU3OTtcclxuICAgICAgICAgICAgY1sweDhiXSA9IC01MTg1MzA2O1xyXG4gICAgICAgICAgICBjWzE0MF0gPSAtODM4ODQ4MDtcclxuICAgICAgICAgICAgY1sweDhkXSA9IC02NTUzNjtcclxuICAgICAgICAgICAgY1sweDhlXSA9IC00NDE5Njk3O1xyXG4gICAgICAgICAgICBjWzB4OGZdID0gLTEyNDkwMjcxO1xyXG4gICAgICAgICAgICBjWzB4OTBdID0gLTc2NTAwMjk7XHJcbiAgICAgICAgICAgIGNbMHg5MV0gPSAtMzYwMzM0O1xyXG4gICAgICAgICAgICBjWzB4OTJdID0gLTc0NDM1MjtcclxuICAgICAgICAgICAgY1sweDkzXSA9IC0xMzcyNjg4OTtcclxuICAgICAgICAgICAgY1sweDk0XSA9IC0yNTc4O1xyXG4gICAgICAgICAgICBjWzB4OTVdID0gLTYyNzA0MTk7XHJcbiAgICAgICAgICAgIGNbMTUwXSA9IC00MTQ0OTYwO1xyXG4gICAgICAgICAgICBjWzB4OTddID0gLTc4NzY4ODU7XHJcbiAgICAgICAgICAgIGNbMHg5OF0gPSAtOTgwNzE1NTtcclxuICAgICAgICAgICAgY1sweDk5XSA9IC05NDA0MjcyO1xyXG4gICAgICAgICAgICBjWzB4OWFdID0gLTEyODY7XHJcbiAgICAgICAgICAgIGNbMHg5Yl0gPSAtMTY3MTE4MDk7XHJcbiAgICAgICAgICAgIGNbMHg5Y10gPSAtMTIxNTYyMzY7XHJcbiAgICAgICAgICAgIGNbMHg5ZF0gPSAtMjk2ODQzNjtcclxuICAgICAgICAgICAgY1sweDllXSA9IC0xNjc0NDMyMDtcclxuICAgICAgICAgICAgY1sweDlmXSA9IC0yNTcyMzI4O1xyXG4gICAgICAgICAgICBjWzE2MF0gPSAtNDAxMjE7XHJcbiAgICAgICAgICAgIGNbMHhhMV0gPSAtMTI1MjUzNjA7XHJcbiAgICAgICAgICAgIGNbMHhhMl0gPSAtMTE0NjEzMDtcclxuICAgICAgICAgICAgY1sweGEzXSA9IC02NjM4ODU7XHJcbiAgICAgICAgICAgIGNbMHhhNF0gPSAtMTtcclxuICAgICAgICAgICAgY1sweGE1XSA9IC02NTc5MzE7XHJcbiAgICAgICAgICAgIGNbMHhhNl0gPSAtMjU2O1xyXG4gICAgICAgICAgICBjWzB4YTddID0gLTY2MzIxNDI7XHJcbiAgICAgICAgICAgIGNvbG9yVGFibGUgPSBjO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgS25vd25Db2xvclRvQXJnYihLbm93bkNvbG9yIGNvbG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRW5zdXJlQ29sb3JUYWJsZSgpO1xyXG4gICAgICAgICAgICBpZihjb2xvciA8PSBLbm93bkNvbG9yLk1lbnVIaWdobGlnaHQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvclRhYmxlWyhpbnQpY29sb3JdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgS25vd25Db2xvclRvTmFtZShLbm93bkNvbG9yIGNvbG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRW5zdXJlQ29sb3JOYW1lVGFibGUoKTtcclxuICAgICAgICAgICAgaWYoY29sb3IgPD0gS25vd25Db2xvci5NZW51SGlnaGxpZ2h0KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JOYW1lVGFibGVbKGludCljb2xvcl07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcbnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgQ29udGV4dE1lbnUgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBGb3IgaW50ZXJuYWwgdXNlIG9ubHkgLSBzbyBpZiB3ZSBjbGljayBvbiBkb2N1bWVudCAtIHdlIGNhbiBjbG9zZSBhbGwgY29udGV4dCBtZW51cyAtLS1cclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIHByb3RlY3RlZCBDb250ZXh0TWVudSBTdWJDb250ZXh0T3BlbmVkID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIExpc3Q8Q29udGV4dEl0ZW0+IENvbnRleHRJdGVtcyA9IG5ldyBMaXN0PENvbnRleHRJdGVtPigpO1xyXG4gICAgICAgIHByb3RlY3RlZCBib29sIFZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBUb3RhbENvbnRleHRIYW5kbGVzID0gMDtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb250ZXh0TWVudSBNYWluQ29udGV4dE1lbnUgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgQ29udGV4dE1lbnUoKSA6IGJhc2UoXCJjb250ZXh0bWVudVwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5Db250ZW50Lk9uTW91c2VMZWF2ZSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5DbG9zZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIHZvaWQgUmVuZGVyQ29udGV4dE1lbnUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy8gV2hhdCB3ZSBuZWVkIHRvIGRvIGZpcnN0IGlzIGdldCB0aGUgbWF4ZWQgc2l6ZSB0ZXh0Li4uXHJcbiAgICAgICAgICAgIGludCB4ID0gMDtcclxuICAgICAgICAgICAgaW50IGlpID0gLTE7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuRW1wdHkoKTtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBDb250ZXh0SXRlbXMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW50IHkgPSBDb250ZXh0SXRlbXNbaV0uQ2FwdGlvbi5MZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBpZih5ID4geCkgeyB4ID0geTsgaWkgPSBpOyB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKGlpID09IC0xKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpbnQgY2Fsd2lkdGggPSAoaW50KUdldFRleHRXaWR0aChDb250ZXh0SXRlbXNbaWldLkNhcHRpb24sIFNldHRpbmdzLkRlZmF1bHRGb250KTtcclxuICAgICAgICAgICAgaWYoY2Fsd2lkdGggPCBTZXR0aW5ncy5Db250ZXh0TWVudU1pbldpZHRoKVxyXG4gICAgICAgICAgICAgICAgY2Fsd2lkdGggPSBTZXR0aW5ncy5Db250ZXh0TWVudU1pbldpZHRoO1xyXG4gICAgICAgICAgICBpbnQgd2lkdGggPSAoY2Fsd2lkdGggKyAzNCArIDggKyAyKTtcclxuXHJcbiAgICAgICAgICAgIGludCB0b3AgPSAxO1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbnRleHRJdGVtcy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dEl0ZW0gPSBDb250ZXh0SXRlbXNbaV07XHJcbiAgICAgICAgICAgICAgICBpbnQgeSA9IGNvbnRleHRJdGVtLkNhcHRpb24uTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBMYWJlbChjb250ZXh0SXRlbS5DYXB0aW9uLCAxLCB0b3AsIHdpZHRoIC0gMiwgZmFsc2UsIGZhbHNlLCBcImNvbnRleHRpdGVtXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGl0ZW0uT25DbGljayA9IChldikgPT5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihjb250ZXh0SXRlbS5FbmFibGVkKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udGV4dEl0ZW0uT25JdGVtQ2xpY2sgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dEl0ZW0uT25JdGVtQ2xpY2soY29udGV4dEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoaXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdG9wICs9IDI0O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKENvbnRleHRJdGVtc1tpXS5CZWdpbkdyb3VwICYmIGkgIT0gQ29udGV4dEl0ZW1zLkNvdW50KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXAgPSBEaXYoXCJjb250ZXh0aXRlbXNlcGVyYXRvclwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VwLlN0eWxlLlRvcCA9IHRvcC5Ub1B4KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VwLlN0eWxlLldpZHRoID0gY2Fsd2lkdGguVG9QeCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKHNlcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRvcCArPSAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b3ArKztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5TZXRTaXplKHdpZHRoLCB0b3ApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2hvdyhWZWN0b3IyIExvY2F0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoTWFpbkNvbnRleHRNZW51ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIE1haW5Db250ZXh0TWVudS5DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgTWFpbkNvbnRleHRNZW51ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBNYWluQ29udGV4dE1lbnUgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgaWYoVmlzaWJsZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5DbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKCFWaXNpYmxlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDb250ZW50LlNldExvY2F0aW9uKExvY2F0aW9uLlhpIC0gNSwgTG9jYXRpb24uWWkgLSA1KTtcclxuICAgICAgICAgICAgICAgIFJlbmRlckNvbnRleHRNZW51KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgVG90YWxDb250ZXh0SGFuZGxlcysrO1xyXG4gICAgICAgICAgICAgICAgQ29udGVudC5TdHlsZS5aSW5kZXggPSAoVG90YWxDb250ZXh0SGFuZGxlcyArIFNldHRpbmdzLkNvbnRleHRNZW51U3RhcnRpbmdaSW5kZXgpLlRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBEb2N1bWVudC5Cb2R5LkFwcGVuZENoaWxkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsb3NlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFZpc2libGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFRvdGFsQ29udGV4dEhhbmRsZXMtLTtcclxuICAgICAgICAgICAgICAgIERvY3VtZW50LkJvZHkuUmVtb3ZlQ2hpbGQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKFN1YkNvbnRleHRPcGVuZWQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU3ViQ29udGV4dE9wZW5lZC5DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgU3ViQ29udGV4dE9wZW5lZCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIENvbnRleHRJdGVtXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBDYXB0aW9uID0gXCJcIjtcclxuICAgICAgICBwdWJsaWMgQWN0aW9uPENvbnRleHRJdGVtPiBPbkl0ZW1DbGljayA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIGJvb2wgQmVnaW5Hcm91cCA9IGZhbHNlO1xyXG4gICAgICAgIHB1YmxpYyBib29sIEVuYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgQ29udGV4dEl0ZW0oKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250ZXh0SXRlbShzdHJpbmcgY2FwdGlvbiwgYm9vbCBiZWdpbkdyb3VwID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDYXB0aW9uID0gY2FwdGlvbjtcclxuICAgICAgICAgICAgQmVnaW5Hcm91cCA9IGJlZ2luR3JvdXA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgQ29udGV4dEl0ZW0oc3RyaW5nIGNhcHRpb24sIEFjdGlvbjxDb250ZXh0SXRlbT4gX09uSXRlbUNsaWNrLCBib29sIGJlZ2luR3JvdXAgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENhcHRpb24gPSBjYXB0aW9uO1xyXG4gICAgICAgICAgICBCZWdpbkdyb3VwID0gYmVnaW5Hcm91cDtcclxuICAgICAgICAgICAgT25JdGVtQ2xpY2sgPSBfT25JdGVtQ2xpY2s7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgU3lzdGVtO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGVudW0gRGF0YVR5cGVcclxuICAgIHtcclxuICAgICAgICBPYmplY3QsXHJcbiAgICAgICAgRGF0ZVRpbWUsXHJcbiAgICAgICAgU3RyaW5nLFxyXG4gICAgICAgIEludGVnZXIsXHJcbiAgICAgICAgTG9uZyxcclxuICAgICAgICBGbG9hdCxcclxuICAgICAgICBEb3VibGUsXHJcbiAgICAgICAgRGVjaW1hbCxcclxuICAgICAgICBCb29sLFxyXG4gICAgICAgIEJ5dGUsXHJcbiAgICAgICAgU2hvcnRcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgRGF0YVRhYmxlXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIExpc3Q8RGF0YUNvbHVtbj4gQ29sdW1ucyA9IG5ldyBMaXN0PERhdGFDb2x1bW4+KCk7XHJcblxyXG4gICAgICAgIHB1YmxpYyBldmVudCBFdmVudEhhbmRsZXIgT25EYXRhU291cmNlQ2hhbmdlZCA9IG51bGw7XHJcblxyXG4gICAgICAgIHByaXZhdGUgYm9vbCBfaW5EYXRhQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgcHJpdmF0ZSBib29sIF9yZXF1ZXN0ZWRPbkRhdGFDaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUmVxdWlyZU9uRGF0YUNoYW5nZUV2ZW50KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFfaW5EYXRhQ2hhbmdlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBfcmVxdWVzdGVkT25EYXRhQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZihPbkRhdGFTb3VyY2VDaGFuZ2VkICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25EYXRhU291cmNlQ2hhbmdlZCh0aGlzLCBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIF9yZXF1ZXN0ZWRPbkRhdGFDaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbGVhclJvd3MoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgX1Jvd0NvdW50ID0gMDtcclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbHVtbnMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2xlYXJDZWxscyhDb2x1bW5zW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgX0NvbENvdW50O1xyXG5cclxuICAgICAgICBwdWJsaWMgaW50IENvbHVtbkNvdW50XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9Db2xDb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBfUm93Q291bnQ7XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgUm93Q291bnRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX1Jvd0NvdW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIExpc3Q8RGF0YVJvdz4gTmV3Um93cyA9IG5ldyBMaXN0PERhdGFSb3c+KCk7XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsZWFyQ2VsbHM8VD4oRGF0YUNvbHVtbiBfY29sdW1uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZHluYW1pYyBfY29sID0gX2NvbHVtbjtcclxuICAgICAgICAgICAgX2NvbC5DZWxscyA9IG5ldyBMaXN0PFQ+KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbGVhckNlbGxzKERhdGFDb2x1bW4gX2NvbHVtbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHN3aXRjaChfY29sdW1uLkRhdGFUeXBlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5PYmplY3Q6XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJDZWxsczxvYmplY3Q+KF9jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGF0ZVRpbWU6XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJDZWxsczxEYXRlVGltZT8+KF9jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuU3RyaW5nOlxyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyQ2VsbHM8c3RyaW5nPihfY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkludGVnZXI6XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJDZWxsczxpbnQ/PihfY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkxvbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJDZWxsczxsb25nPz4oX2NvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5GbG9hdDpcclxuICAgICAgICAgICAgICAgICAgICBDbGVhckNlbGxzPGZsb2F0Pz4oX2NvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Eb3VibGU6XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJDZWxsczxkb3VibGU/PihfY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRlY2ltYWw6XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJDZWxsczxkZWNpbWFsPz4oX2NvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Cb29sOlxyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyQ2VsbHM8Ym9vbD8+KF9jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQnl0ZTpcclxuICAgICAgICAgICAgICAgICAgICBDbGVhckNlbGxzPGJ5dGU/PihfY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLlNob3J0OlxyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyQ2VsbHM8c2hvcnQ/PihfY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBSZXF1aXJlT25EYXRhQ2hhbmdlRXZlbnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBEYXRhQ29sdW1uIEdldENvbHVtbkJ5RGF0YVR5cGUoRGF0YVR5cGUgdHlwZSA9IERhdGFUeXBlLk9iamVjdClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHN3aXRjaCh0eXBlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5PYmplY3Q6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhQ29sdW1uT2JqZWN0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5EYXRlVGltZTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGFDb2x1bW5EYXRlVGltZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuU3RyaW5nOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YUNvbHVtblN0cmluZygpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuSW50ZWdlcjpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGFDb2x1bW5JbnRlZ2VyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Mb25nOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YUNvbHVtbkxvbmcoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkZsb2F0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YUNvbHVtbkZsb2F0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Eb3VibGU6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhQ29sdW1uRG91YmxlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5EZWNpbWFsOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YUNvbHVtbkRlY2ltYWwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkJvb2w6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhQ29sdW1uQm9vbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQnl0ZTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGFDb2x1bW5CeXRlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TaG9ydDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGFDb2x1bW5TaG9ydCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBZGRDb2x1bW4oc3RyaW5nIGZpZWxkTmFtZSwgRGF0YVR5cGUgdHlwZSA9IERhdGFUeXBlLk9iamVjdClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBjb2wgPSBHZXRDb2x1bW5CeURhdGFUeXBlKHR5cGUpO1xyXG4gICAgICAgICAgICBjb2wuRmllbGROYW1lID0gZmllbGROYW1lO1xyXG5cclxuICAgICAgICAgICAgQ29sdW1ucy5BZGQoY29sKTtcclxuICAgICAgICAgICAgX0NvbENvdW50ID0gQ29sdW1ucy5Db3VudDtcclxuXHJcbiAgICAgICAgICAgIFJlcXVpcmVPbkRhdGFDaGFuZ2VFdmVudCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGFSb3cgdGhpc1tpbnQgcm93SW5kZXhdXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhUm93KHRoaXMsIHJvd0luZGV4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQmVnaW5OZXdSb3coaW50IEVzdGltYXRlZE5ld1Jvd3MpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBOZXdSb3dzID0gbmV3IExpc3Q8RGF0YVJvdz4oRXN0aW1hdGVkTmV3Um93cyk7XHJcbiAgICAgICAgICAgIEJlZ2luRGF0YVVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGFSb3cgQWRkUm93KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBkciA9IG5ldyBEYXRhUm93KHRoaXMsIF9Sb3dDb3VudCsrKTtcclxuICAgICAgICAgICAgaW50IGNvbExlbmd0aCA9IENvbHVtbnMuQ291bnQ7XHJcbiAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCBjb2xMZW5ndGg7IHgrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZHluYW1pYyBjb2wgPSBDb2x1bW5zW3hdO1xyXG4gICAgICAgICAgICAgICAgY29sLkNlbGxzLmFkZChudWxsKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgUmVxdWlyZU9uRGF0YUNoYW5nZUV2ZW50KCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZHI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBZGRSb3cocGFyYW1zIG9iamVjdFtdIHJvdylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHJvdy5MZW5ndGggPT0gQ29sdW1uQ291bnQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIF9Sb3dDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgaW50IGNvbExlbmd0aCA9IENvbHVtbnMuQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IHggPSAwOyB4IDwgY29sTGVuZ3RoOyB4KyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHluYW1pYyBjb2wgPSBDb2x1bW5zW3hdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbC5DZWxscy5hZGQocm93W3hdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFJlcXVpcmVPbkRhdGFDaGFuZ2VFdmVudCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgRGF0YVJvdyBOZXdSb3coKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGRyID0gbmV3IERhdGFSb3codGhpcyk7XHJcblxyXG4gICAgICAgICAgICBOZXdSb3dzLkFkZChkcik7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZHI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBY2NlcHROZXdSb3dzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKE5ld1Jvd3MgPT0gbnVsbCB8fCBOZXdSb3dzLkNvdW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGludCBjb2xMZW5ndGggPSBDb2x1bW5zLkNvdW50O1xyXG4gICAgICAgICAgICBpbnQgcm93TGVuZ3RoID0gTmV3Um93cy5Db3VudDtcclxuICAgICAgICAgICAgaW50IGNvbE4xID0gY29sTGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCBjb2xMZW5ndGg7IHgrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZHluYW1pYyBjb2wgPSBDb2x1bW5zW3hdO1xyXG4gICAgICAgICAgICAgICAgdmFyIERhdGFDZWxscyA9IG5ldyBvYmplY3Rbcm93TGVuZ3RoXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih4ID09IDApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCB5ID0gMDsgeSA8IHJvd0xlbmd0aDsgeSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTmV3Um93c1t5XS5Sb3dJbmRleCA9IF9Sb3dDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBEYXRhQ2VsbHNbeV0gPSBOZXdSb3dzW3ldLmJhdGNoRGF0YVt4XTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHggPT0gY29sTjEpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCB5ID0gMDsgeSA8IHJvd0xlbmd0aDsgeSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgRGF0YUNlbGxzW3ldID0gTmV3Um93c1t5XS5iYXRjaERhdGFbeF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE5ld1Jvd3NbeV0uYmF0Y2hEYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCB5ID0gMDsgeSA8IHJvd0xlbmd0aDsgeSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgRGF0YUNlbGxzW3ldID0gTmV3Um93c1t5XS5iYXRjaERhdGFbeF07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29sLkNlbGxzLmFkZFJhbmdlKERhdGFDZWxscyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgTmV3Um93cy5DbGVhcigpO1xyXG5cclxuICAgICAgICAgICAgRW5kRGF0YVVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQmVnaW5EYXRhVXBkYXRlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9pbkRhdGFDaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICBfcmVxdWVzdGVkT25EYXRhQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBFbmREYXRhVXBkYXRlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9pbkRhdGFDaGFuZ2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYoX3JlcXVlc3RlZE9uRGF0YUNoYW5nZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgX3JlcXVlc3RlZE9uRGF0YUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYoT25EYXRhU291cmNlQ2hhbmdlZCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIE9uRGF0YVNvdXJjZUNoYW5nZWQodGhpcywgbnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFJlamVjdE5ld1Jvd3MoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTmV3Um93cy5DbGVhcigpO1xyXG4gICAgICAgICAgICBfaW5EYXRhQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBEYXRhUm93XHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIERhdGFUYWJsZSBQYXJlbnRUYWJsZTtcclxuICAgICAgICBwdWJsaWMgaW50IFJvd0luZGV4ID0gLTE7XHJcbiAgICAgICAgcHVibGljIG9iamVjdFtdIGJhdGNoRGF0YTtcclxuXHJcbiAgICAgICAgcHVibGljIERhdGFSb3cgR2V0T2ZmbGluZURhdGFSb3coKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGRyID0gbmV3IERhdGFSb3coUGFyZW50VGFibGUuQ29sdW1uQ291bnQpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBvYmplY3RbUGFyZW50VGFibGUuQ29sdW1uQ291bnRdO1xyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgUGFyZW50VGFibGUuQ29sdW1uQ291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZGF0YVtpXSA9IHRoaXNbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZHIuYmF0Y2hEYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIGRyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGFSb3coKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBEYXRhUm93KGludCBjb2x1bW5MZW5ndGgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBQYXJlbnRUYWJsZSA9IG51bGw7XHJcbiAgICAgICAgICAgIFJvd0luZGV4ID0gLTE7XHJcbiAgICAgICAgICAgIGJhdGNoRGF0YSA9IG5ldyBvYmplY3RbY29sdW1uTGVuZ3RoXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBEYXRhUm93KERhdGFUYWJsZSBwYXJlbnRUYWJsZSwgaW50IHJvd0luZGV4ID0gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBQYXJlbnRUYWJsZSA9IHBhcmVudFRhYmxlO1xyXG4gICAgICAgICAgICBSb3dJbmRleCA9IHJvd0luZGV4O1xyXG4gICAgICAgICAgICBpZihyb3dJbmRleCA9PSAtMSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYmF0Y2hEYXRhID0gbmV3IG9iamVjdFtwYXJlbnRUYWJsZS5Db2x1bW5Db3VudF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNldFZhbHVlKHN0cmluZyBmaWVsZE5hbWUsIG9iamVjdCB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBQYXJlbnRUYWJsZS5Db2x1bW5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihQYXJlbnRUYWJsZS5Db2x1bW5zW2ldLkZpZWxkTmFtZSA9PSBmaWVsZE5hbWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoUm93SW5kZXggPT0gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihiYXRjaERhdGFbaV0gIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoRGF0YVtpXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFyZW50VGFibGUuUmVxdWlyZU9uRGF0YUNoYW5nZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZHluYW1pYyBjb2wgPSBQYXJlbnRUYWJsZS5Db2x1bW5zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNvbC5DZWxscy5pdGVtc1tSb3dJbmRleF0gIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wuQ2VsbHMuaXRlbXNbUm93SW5kZXhdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcmVudFRhYmxlLlJlcXVpcmVPbkRhdGFDaGFuZ2VFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgR2V0VmFsdWUoc3RyaW5nIGZpZWxkTmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBQYXJlbnRUYWJsZS5Db2x1bW5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihQYXJlbnRUYWJsZS5Db2x1bW5zW2ldLkZpZWxkTmFtZSA9PSBmaWVsZE5hbWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoUm93SW5kZXggPT0gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmF0Y2hEYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkeW5hbWljIGNvbCA9IFBhcmVudFRhYmxlLkNvbHVtbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbC5DZWxscy5pdGVtc1tSb3dJbmRleF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldFZhbHVlKGludCBjb2x1bW5JbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFJvd0luZGV4ID09IC0xKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYmF0Y2hEYXRhW2NvbHVtbkluZGV4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkeW5hbWljIGNvbCA9IFBhcmVudFRhYmxlLkNvbHVtbnNbY29sdW1uSW5kZXhdO1xyXG4gICAgICAgICAgICByZXR1cm4gY29sLkNlbGxzLml0ZW1zW1Jvd0luZGV4XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNldFZhbHVlKGludCBjb2x1bW5JbmRleCwgb2JqZWN0IHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoUm93SW5kZXggPT0gLTEpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGJhdGNoRGF0YVtjb2x1bW5JbmRleF0gIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmF0Y2hEYXRhW2NvbHVtbkluZGV4XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFBhcmVudFRhYmxlLlJlcXVpcmVPbkRhdGFDaGFuZ2VFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkeW5hbWljIGNvbCA9IFBhcmVudFRhYmxlLkNvbHVtbnNbY29sdW1uSW5kZXhdO1xyXG4gICAgICAgICAgICBpZihjb2wuQ2VsbHMuaXRlbXNbUm93SW5kZXhdICE9IHZhbHVlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjb2wuQ2VsbHMuaXRlbXNbUm93SW5kZXhdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBQYXJlbnRUYWJsZS5SZXF1aXJlT25EYXRhQ2hhbmdlRXZlbnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG9iamVjdCB0aGlzW2ludCBjb2x1bW5JbmRleF1cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gR2V0VmFsdWUoY29sdW1uSW5kZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTZXRWYWx1ZShjb2x1bW5JbmRleCwgdmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBEYXRhQ29sdW1uXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBGaWVsZE5hbWU7XHJcbiAgICAgICAgcHVibGljIERhdGFUeXBlIERhdGFUeXBlO1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBMaXN0PG9iamVjdD4gQ2VsbHMgPSBuZXcgTGlzdDxvYmplY3Q+KCk7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBHZXREaXNwbGF5VmFsdWUoaW50IHJvd0luZGV4LCBzdHJpbmcgZm9ybWF0U3RyaW5nKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc3dpdGNoKERhdGFUeXBlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5PYmplY3Q6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Gb3JtYXQoZm9ybWF0U3RyaW5nLCAoKChEYXRhQ29sdW1uT2JqZWN0KXRoaXMpLkNlbGxzW3Jvd0luZGV4XSkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGF0ZVRpbWU6XHJcbiAgICAgICAgICAgICAgICAgICAgZHluYW1pYyBvYmogPSAoKERhdGFDb2x1bW5EYXRlVGltZSl0aGlzKS5DZWxsc1tyb3dJbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkVtcHR5O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihvYmogaXMgRGF0ZVRpbWUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChmb3JtYXRTdHJpbmcsIChEYXRlVGltZSlvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBEYXRlVGltZSBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKERhdGVUaW1lLlRyeVBhcnNlKG9iaiwgb3V0IGQpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Gb3JtYXQoZm9ybWF0U3RyaW5nLCBkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9IG9iaiBhcyBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShzdHIpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5FbXB0eTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Gb3JtYXQoZm9ybWF0U3RyaW5nLCBzdHIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuU3RyaW5nOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KGZvcm1hdFN0cmluZywgKChEYXRhQ29sdW1uU3RyaW5nKXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5JbnRlZ2VyOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KGZvcm1hdFN0cmluZywgKChEYXRhQ29sdW1uSW50ZWdlcil0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuTG9uZzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChmb3JtYXRTdHJpbmcsICgoRGF0YUNvbHVtbkxvbmcpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkZsb2F0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KGZvcm1hdFN0cmluZywgKChEYXRhQ29sdW1uRmxvYXQpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRvdWJsZTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChmb3JtYXRTdHJpbmcsICgoRGF0YUNvbHVtbkRvdWJsZSl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGVjaW1hbDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChmb3JtYXRTdHJpbmcsICgoRGF0YUNvbHVtbkRlY2ltYWwpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkJ5dGU6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Gb3JtYXQoZm9ybWF0U3RyaW5nLCAoKERhdGFDb2x1bW5CeXRlKXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TaG9ydDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nLkZvcm1hdChmb3JtYXRTdHJpbmcsICgoRGF0YUNvbHVtblNob3J0KXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Cb29sOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KGZvcm1hdFN0cmluZywgKChEYXRhQ29sdW1uQm9vbCl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldENlbGxWYWx1ZShpbnQgcm93SW5kZXgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzd2l0Y2goRGF0YVR5cGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLk9iamVjdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChEYXRhQ29sdW1uT2JqZWN0KXRoaXMpLkNlbGxzW3Jvd0luZGV4XTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRhdGVUaW1lOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKERhdGFDb2x1bW5EYXRlVGltZSl0aGlzKS5DZWxsc1tyb3dJbmRleF07XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TdHJpbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoRGF0YUNvbHVtblN0cmluZyl0aGlzKS5DZWxsc1tyb3dJbmRleF07XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5JbnRlZ2VyOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKChEYXRhQ29sdW1uSW50ZWdlcil0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuTG9uZzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCgoRGF0YUNvbHVtbkxvbmcpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkZsb2F0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKChEYXRhQ29sdW1uRmxvYXQpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRvdWJsZTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCgoRGF0YUNvbHVtbkRvdWJsZSl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGVjaW1hbDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCgoRGF0YUNvbHVtbkRlY2ltYWwpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkJ5dGU6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoKERhdGFDb2x1bW5CeXRlKXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Cb29sOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKChEYXRhQ29sdW1uQm9vbCl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuU2hvcnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoKERhdGFDb2x1bW5TaG9ydCl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIEdldERpc3BsYXlWYWx1ZShpbnQgcm93SW5kZXgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzd2l0Y2goRGF0YVR5cGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLk9iamVjdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29udmVydC5Ub1N0cmluZygoKERhdGFDb2x1bW5PYmplY3QpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRhdGVUaW1lOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDb252ZXJ0LlRvU3RyaW5nKCgoRGF0YUNvbHVtbkRhdGVUaW1lKXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TdHJpbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoRGF0YUNvbHVtblN0cmluZyl0aGlzKS5DZWxsc1tyb3dJbmRleF07XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5JbnRlZ2VyOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDb252ZXJ0LlRvU3RyaW5nKCgoRGF0YUNvbHVtbkludGVnZXIpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkxvbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENvbnZlcnQuVG9TdHJpbmcoKChEYXRhQ29sdW1uTG9uZyl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRmxvYXQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENvbnZlcnQuVG9TdHJpbmcoKChEYXRhQ29sdW1uRmxvYXQpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRvdWJsZTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29udmVydC5Ub1N0cmluZygoKERhdGFDb2x1bW5Eb3VibGUpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRlY2ltYWw6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENvbnZlcnQuVG9TdHJpbmcoKChEYXRhQ29sdW1uRGVjaW1hbCl0aGlzKS5DZWxsc1tyb3dJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQnl0ZTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29udmVydC5Ub1N0cmluZygoKERhdGFDb2x1bW5CeXRlKXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Cb29sOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDb252ZXJ0LlRvU3RyaW5nKCgoRGF0YUNvbHVtbkJvb2wpdGhpcykuQ2VsbHNbcm93SW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLlNob3J0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDb252ZXJ0LlRvU3RyaW5nKCgoRGF0YUNvbHVtblNob3J0KXRoaXMpLkNlbGxzW3Jvd0luZGV4XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIERhdGFDb2x1bW5TdHJpbmcgOiBEYXRhQ29sdW1uXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIERhdGFDb2x1bW5TdHJpbmcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5EYXRhVHlwZSA9IERhdGFUeXBlLlN0cmluZztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PHN0cmluZz4gQ2VsbHMgPSBuZXcgTGlzdDxzdHJpbmc+KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIERhdGFDb2x1bW5EYXRlVGltZSA6IERhdGFDb2x1bW5cclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgRGF0YUNvbHVtbkRhdGVUaW1lKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuRGF0YVR5cGUgPSBEYXRhVHlwZS5EYXRlVGltZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PERhdGVUaW1lPz4gQ2VsbHMgPSBuZXcgTGlzdDxEYXRlVGltZT8+KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIERhdGFDb2x1bW5JbnRlZ2VyIDogRGF0YUNvbHVtblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBEYXRhQ29sdW1uSW50ZWdlcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLkRhdGFUeXBlID0gRGF0YVR5cGUuSW50ZWdlcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PGludD8+IENlbGxzID0gbmV3IExpc3Q8aW50Pz4oKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgRGF0YUNvbHVtbkxvbmcgOiBEYXRhQ29sdW1uXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIERhdGFDb2x1bW5Mb25nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuRGF0YVR5cGUgPSBEYXRhVHlwZS5Mb25nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExpc3Q8bG9uZz8+IENlbGxzID0gbmV3IExpc3Q8bG9uZz8+KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIERhdGFDb2x1bW5PYmplY3QgOiBEYXRhQ29sdW1uXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIERhdGFDb2x1bW5PYmplY3QoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5EYXRhVHlwZSA9IERhdGFUeXBlLk9iamVjdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PG9iamVjdD4gQ2VsbHMgPSBuZXcgTGlzdDxvYmplY3Q+KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIERhdGFDb2x1bW5EZWNpbWFsIDogRGF0YUNvbHVtblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBEYXRhQ29sdW1uRGVjaW1hbCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLkRhdGFUeXBlID0gRGF0YVR5cGUuRGVjaW1hbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PGRlY2ltYWw/PiBDZWxscyA9IG5ldyBMaXN0PGRlY2ltYWw/PigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBEYXRhQ29sdW1uRmxvYXQgOiBEYXRhQ29sdW1uXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIERhdGFDb2x1bW5GbG9hdCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLkRhdGFUeXBlID0gRGF0YVR5cGUuRmxvYXQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGlzdDxmbG9hdD8+IENlbGxzID0gbmV3IExpc3Q8ZmxvYXQ/PigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBEYXRhQ29sdW1uRG91YmxlIDogRGF0YUNvbHVtblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBEYXRhQ29sdW1uRG91YmxlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuRGF0YVR5cGUgPSBEYXRhVHlwZS5Eb3VibGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGlzdDxkb3VibGU/PiBDZWxscyA9IG5ldyBMaXN0PGRvdWJsZT8+KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIERhdGFDb2x1bW5Cb29sIDogRGF0YUNvbHVtblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBEYXRhQ29sdW1uQm9vbCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLkRhdGFUeXBlID0gRGF0YVR5cGUuQm9vbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PGJvb2w/PiBDZWxscyA9IG5ldyBMaXN0PGJvb2w/PigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBEYXRhQ29sdW1uQnl0ZSA6IERhdGFDb2x1bW5cclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgRGF0YUNvbHVtbkJ5dGUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5EYXRhVHlwZSA9IERhdGFUeXBlLkJ5dGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGlzdDxieXRlPz4gQ2VsbHMgPSBuZXcgTGlzdDxieXRlPz4oKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgRGF0YUNvbHVtblNob3J0IDogRGF0YUNvbHVtblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBEYXRhQ29sdW1uU2hvcnQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5EYXRhVHlwZSA9IERhdGFUeXBlLlNob3J0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExpc3Q8c2hvcnQ/PiBDZWxscyA9IG5ldyBMaXN0PHNob3J0Pz4oKTtcclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgQnJpZGdlLmpRdWVyeTI7XHJcbnVzaW5nIFN5c3RlbTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIENvbWJvQm94RWRpdCA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgSFRNTFNlbGVjdEVsZW1lbnQgQ29tYm9Cb3hCYXNlO1xyXG4gICAgICAgIHByaXZhdGUgaW50IHByZXZpb3VzU2VsZWN0ZWRJbmRleCA9IC0xO1xyXG5cclxuICAgICAgICBwdWJsaWMgQWN0aW9uPENvbWJvQm94RWRpdD4gU2VsZWN0ZWRJbmRleENoYW5nZWQgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgQ29tYm9Cb3hFZGl0KCkgOiBiYXNlKFwiaW5wdXRjb250cm9sXCIsIENvbWJvQm94VHlwZXMuRGVmYXVsdClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENvbWJvQm94QmFzZSA9IHRoaXMuQ29udGVudCBhcyBIVE1MU2VsZWN0RWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5PbkNvbnRleHRNZW51ID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIENvbWJvQm94QmFzZS5PbkNoYW5nZSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYocHJldmlvdXNTZWxlY3RlZEluZGV4ICE9IENvbWJvQm94QmFzZS5TZWxlY3RlZEluZGV4KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKFNlbGVjdGVkSW5kZXhDaGFuZ2VkICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNlbGVjdGVkSW5kZXhDaGFuZ2VkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1NlbGVjdGVkSW5kZXggPSBDb21ib0JveEJhc2UuU2VsZWN0ZWRJbmRleDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgRmlsbERhdGEocGFyYW1zIERhdGFJdGVtW10gZGF0YWl0ZW1zKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgalF1ZXJ5LlNlbGVjdChDb21ib0JveEJhc2UpLkVtcHR5KCk7XHJcblxyXG4gICAgICAgICAgICBpZihkYXRhaXRlbXMgPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGRhdGFpdGVtcy5MZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBDb21ib0JveEJhc2UuQXBwZW5kQ2hpbGQobmV3IEhUTUxPcHRpb25FbGVtZW50KClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIElubmVySFRNTCA9IGRhdGFpdGVtc1tpXS5UZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSA9IGRhdGFpdGVtc1tpXS5WYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBSZW5kZXIoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5SZW5kZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgVGV4dFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKENvbWJvQm94QmFzZS5TZWxlY3RlZEluZGV4ID09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRW1wdHk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29tYm9Cb3hCYXNlLk9wdGlvbnNbQ29tYm9Cb3hCYXNlLlNlbGVjdGVkSW5kZXhdLklubmVySFRNTDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbWJvQm94QmFzZS5PcHRpb25zLkxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKENvbWJvQm94QmFzZS5PcHRpb25zW2ldLklubmVySFRNTCA9PSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29tYm9Cb3hCYXNlLlNlbGVjdGVkSW5kZXggPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgQ29tYm9Cb3hCYXNlLlNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBWYWx1ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKENvbWJvQm94QmFzZS5TZWxlY3RlZEluZGV4ID09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRW1wdHk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29tYm9Cb3hCYXNlLk9wdGlvbnNbQ29tYm9Cb3hCYXNlLlNlbGVjdGVkSW5kZXhdLlZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgQ29tYm9Cb3hCYXNlLk9wdGlvbnMuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQ29tYm9Cb3hCYXNlLk9wdGlvbnNbaV0uVmFsdWUgPT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvbWJvQm94QmFzZS5TZWxlY3RlZEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIENvbWJvQm94QmFzZS5TZWxlY3RlZEluZGV4ID0gLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgYm9vbCBlbmFibGVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgRW5hYmxlZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIGVuYWJsZWQ7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5TZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCAoIWVuYWJsZWQpLlRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgX3JlYWRvbmx5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFJlYWRvbmx5XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX3JlYWRvbmx5OyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBfcmVhZG9ubHkgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5TZXRBdHRyaWJ1dGUoXCJyZWFkb25seVwiLCAoX3JlYWRvbmx5KS5Ub1N0cmluZygpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgRGF0YUl0ZW1cclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgc3RyaW5nIFRleHQ7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBWYWx1ZTtcclxuXHJcbiAgICAgICAgcHVibGljIERhdGFJdGVtKHN0cmluZyB0ZXh0LCBzdHJpbmcgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBUZXh0ID0gdGV4dDtcclxuICAgICAgICAgICAgVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBEYXRhSXRlbShzdHJpbmcgdGV4dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFRleHQgPSB0ZXh0O1xyXG4gICAgICAgICAgICBWYWx1ZSA9IHRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgU3lzdGVtO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgRGlhbG9nUmVzdWx0XHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIERpYWxvZ1Jlc3VsdEVudW0gUmVzdWx0RW51bSA9IERpYWxvZ1Jlc3VsdEVudW0uTm9uZTtcclxuICAgICAgICBwdWJsaWMgQWN0aW9uIENhbGxCYWNrID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIERpYWxvZ1Jlc3VsdChEaWFsb2dSZXN1bHRFbnVtIHJlc3VsdEVudW0sIEFjdGlvbiBjYWxsQmFjaylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFJlc3VsdEVudW0gPSByZXN1bHRFbnVtO1xyXG4gICAgICAgICAgICBDYWxsQmFjayA9IGNhbGxCYWNrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgSW52b2tlSWZSZXN1bHQoRGlhbG9nUmVzdWx0RW51bSByZXN1bHRFbnVtKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYocmVzdWx0RW51bSA9PSBSZXN1bHRFbnVtICYmIENhbGxCYWNrICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBDYWxsQmFjay5JbnZva2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudW0gRGlhbG9nUmVzdWx0RW51bVxyXG4gICAge1xyXG4gICAgICAgIE5vbmUsXHJcbiAgICAgICAgT0ssXHJcbiAgICAgICAgQ2FuY2VsLFxyXG4gICAgICAgIEFib3J0LFxyXG4gICAgICAgIFNlbmQsXHJcbiAgICAgICAgSWdub3JlLFxyXG4gICAgICAgIFllcyxcclxuICAgICAgICBOb1xyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBFeHRlcm5hbFBsdWdpblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgU291cmNlVXJsO1xyXG4gICAgICAgIHB1YmxpYyBib29sIFNldHVwQ29tcGxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgcHVibGljIGJvb2wgSW5Mb2FkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBBY3Rpb24gT25SZWFkeSA9IG51bGw7XHJcblxyXG4gICAgICAgIHB1YmxpYyBFeHRlcm5hbFBsdWdpbihzdHJpbmcgc291cmNlVXJsKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU291cmNlVXJsID0gc291cmNlVXJsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2V0dXAoYm9vbCBhc3luYyA9IGZhbHNlLCBib29sIGRlZmVyID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighU2V0dXBDb21wbGV0ZWQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEluTG9hZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgSW5Mb2FkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBuZXcgSFRNTFNjcmlwdEVsZW1lbnQoKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIE9uTG9hZCA9IChlbGUpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXR1cENvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEluTG9hZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihPblJlYWR5ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPblJlYWR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBTcmMgPSBTb3VyY2VVcmxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZihhc3luYylcclxuICAgICAgICAgICAgICAgICAgICBzY3JpcHQuQXN5bmMgPSBhc3luYztcclxuICAgICAgICAgICAgICAgIGlmKGRlZmVyKVxyXG4gICAgICAgICAgICAgICAgICAgIHNjcmlwdC5EZWZlciA9IGRlZmVyO1xyXG4gICAgICAgICAgICAgICAgRG9jdW1lbnQuSGVhZC5BcHBlbmRDaGlsZChzY3JpcHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBVc2FnZUNoZWNrKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFTZXR1cENvbXBsZXRlZClcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCInXCIgKyBTb3VyY2VVcmwgKyBcIicgcmVxdWlyZXMgdG8gYmUgc2V0dXAhXCIpO1xyXG4gICAgICAgICAgICBpZihJbkxvYWQpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiJ1wiICsgU291cmNlVXJsICsgXCInIGlzIGN1cnJlbnRseSBsb2FkaW5nLCBQbGVhc2UgdHJ5IGFnYWluIGluIGEgZmV3IHNlY29uZHMhXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxudXNpbmcgU3lzdGVtO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgRmlyZWJhc2VcclxuICAgIHtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBFeHRlcm5hbFBsdWdpbiBFeHRlcm5hbEZpcmVCYXNlID0gbmV3IEV4dGVybmFsUGx1Z2luKFwiaHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vZmlyZWJhc2Vqcy8zLjYuOC9maXJlYmFzZS5qc1wiKTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgRGlzcGxheU5hbWU7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgUGhvdG9VUkw7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIFVzZXJTaWduZWRJbjtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldHVwKEFjdGlvbiBPblJlYWR5ID0gbnVsbClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEV4dGVybmFsRmlyZUJhc2UuT25SZWFkeSA9IE9uUmVhZHk7XHJcbiAgICAgICAgICAgIEV4dGVybmFsRmlyZUJhc2UuU2V0dXAoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBJbml0aWFsaXplQXBwKHN0cmluZyBBcGlLZXksIHN0cmluZyBBdXRoRG9tYWluLCBzdHJpbmcgRGF0YWJhc2VVUkwsIHN0cmluZyBQcm9qZWN0SWQsIHN0cmluZyBTdG9yYWdlQnVja2V0LCBzdHJpbmcgTWVzc2FnaW5nU2VuZGVySWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBFeHRlcm5hbEZpcmVCYXNlLlVzYWdlQ2hlY2soKTtcclxuICAgICAgICAgICAgaWYoc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShBcGlLZXkpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihzdHJpbmcuRm9ybWF0KFwiSW52YWxpZCBGaXJlYmFzZSB7MH0gIVwiLFwiQXBpS2V5XCIpKTtcclxuICAgICAgICAgICAgaWYoc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShBdXRoRG9tYWluKSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oc3RyaW5nLkZvcm1hdChcIkludmFsaWQgRmlyZWJhc2UgezB9IVwiLFwiQXV0aERvbWFpblwiKSk7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoRGF0YWJhc2VVUkwpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihzdHJpbmcuRm9ybWF0KFwiSW52YWxpZCBGaXJlYmFzZSB7MH0hXCIsXCJEYXRhYmFzZVVSTFwiKSk7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoUHJvamVjdElkKSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oc3RyaW5nLkZvcm1hdChcIkludmFsaWQgRmlyZWJhc2UgezB9IVwiLFwiUHJvamVjdElkXCIpKTtcclxuICAgICAgICAgICAgaWYoc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShTdG9yYWdlQnVja2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oc3RyaW5nLkZvcm1hdChcIkludmFsaWQgRmlyZWJhc2UgezB9IVwiLFwiU3RvcmFnZUJ1Y2tldFwiKSk7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoTWVzc2FnaW5nU2VuZGVySWQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihzdHJpbmcuRm9ybWF0KFwiSW52YWxpZCBGaXJlYmFzZSB7MH0hXCIsXCJNZXNzYWdpbmdTZW5kZXJJZFwiKSk7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0ZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcCh7YXBpS2V5OiBBcGlLZXksIGF1dGhEb21haW46IEF1dGhEb21haW4sIGRhdGFiYXNlVVJMOiBEYXRhYmFzZVVSTCwgcHJvamVjdElkIDogUHJvamVjdElkLCBzdG9yYWdlQnVja2V0OiBTdG9yYWdlQnVja2V0LCBtZXNzYWdpbmdTZW5kZXJJZDogTWVzc2FnaW5nU2VuZGVySWQgfSk7XHJcblx0XHRcdGZpcmViYXNlLmF1dGgoKS5vbkF1dGhTdGF0ZUNoYW5nZWQoZnVuY3Rpb24odXNlcikge1xyXG5cdFx0XHRcdGlmICh1c2VyKSB7XHJcblx0XHRcdFx0XHR0aGlzLlVzZXJTaWduZWRJbiA9IHRydWU7XHJcblx0XHRcdFx0XHR0aGlzLkRpc3BsYXlOYW1lID0gdXNlci5kaXNwbGF5TmFtZTtcclxuXHRcdFx0XHRcdHRoaXMuUGhvdG9VUkwgPSB1c2VyLnBob3RvVVJMO1xyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0dGhpcy5Vc2VyU2lnbmVkSW4gPSBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQqL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNpZ25JbigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0ZmlyZWJhc2UuYXV0aCgpLnNpZ25JbldpdGhQb3B1cChuZXcgZmlyZWJhc2UuYXV0aC5Hb29nbGVBdXRoUHJvdmlkZXIoKSk7XHJcblx0XHRcdCovXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2lnbk91dCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0ZmlyZWJhc2UuYXV0aCgpLnNpZ25PdXQoKTtcclxuXHRcdFx0Ki9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgb2JqZWN0IERhdGFiYXNlUmVmKHN0cmluZyBuYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGRhdGFSZWYgPSBTY3JpcHQuV3JpdGU8ZHluYW1pYz4oXCJmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihuYW1lKVwiKTtcclxuICAgICAgICAgICAgZGF0YVJlZi5vZmYoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGFSZWY7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgSXNTaWduZWRJbldpdGhGaXJlYmFzZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gU2NyaXB0LldyaXRlPGJvb2w+KEBcIlxyXG5cdFx0XHRpZihmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fWVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIEZvcm1Db2xsZWN0aW9uXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIEZvcm0gRm9ybU93bmVyO1xyXG4gICAgICAgIHB1YmxpYyBMaXN0PEZvcm0+IFZpc2libGVGb3JtcyA9IG5ldyBMaXN0PEZvcm0+KCk7XHJcblxyXG4gICAgICAgIHB1YmxpYyBGb3JtQ29sbGVjdGlvbihGb3JtIGZvcm1Pd25lcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEZvcm1Pd25lciA9IGZvcm1Pd25lcjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIEJyaWRnZS5qUXVlcnkyO1xyXG51c2luZyBTeXN0ZW07XHJcbnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG51c2luZyBTeXN0ZW0uVGV4dDtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIHN0YXRpYyBjbGFzcyBHbWFpbFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgRXh0ZXJuYWxQbHVnaW4gRXh0ZXJuYWxHbWFpbCA9IG5ldyBFeHRlcm5hbFBsdWdpbihcImh0dHBzOi8vYXBpcy5nb29nbGUuY29tL2pzL2FwaS5qc1wiKTtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyBDbGllbnRJZDtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIG9iamVjdCBHb29nbGVBdXRoO1xyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBMaXN0PEFjdGlvbj4gX29uZVRpbWVDYWxsID0gbmV3IExpc3Q8QWN0aW9uPigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgQXV0aG9yaXplKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFFeHRlcm5hbEdtYWlsLlNldHVwQ29tcGxldGVkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYoSXNTaWduZWRJbigpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgLypAXHJcbiAgICAgICAgICAgICAgICBFeHByZXNzQ3JhZnQuR21haWwuR29vZ2xlQXV0aCA9IGdhcGkuYXV0aDIuZ2V0QXV0aEluc3RhbmNlKClcclxuICAgICAgICAgICAgICAgIGdhcGkuYXV0aDIuZ2V0QXV0aEluc3RhbmNlKCkuc2lnbkluKCk7XHJcbiAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgX2hhc1JhbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgUHVzaEV2ZW50c1RpbWVDYWxsKCk7XHJcbiAgICAgICAgICAgICAgICBXaW5kb3cuRm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYm9vbCBfaGFzUmFuID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBQdXNoRXZlbnRzVGltZUNhbGwoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoX2hhc1JhbilcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgX2hhc1JhbiA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZm9yZWFjaCh2YXIgY2FsbHB1bXAgaW4gX29uZVRpbWVDYWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNhbGxwdW1wICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxwdW1wKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX29uZVRpbWVDYWxsID0gbmV3IExpc3Q8QWN0aW9uPigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIE9uU2lnbmVkSW4oQWN0aW9uIG1ldGhvZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKG1ldGhvZCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYoX2hhc1JhbilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdHJ5XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBfb25lVGltZUNhbGwuQWRkKChnbG9iYWw6OlN5c3RlbS5BY3Rpb24pbWV0aG9kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIElzU2lnbmVkSW4oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoIUV4dGVybmFsR21haWwuU2V0dXBDb21wbGV0ZWQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJTZXR1cCBmb3IgZ21haWwgaXMgbm90IHJlYWR5IHlldCFcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoR29vZ2xlQXV0aCA9PSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKFwiR29vZ2xlQXV0aFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBib29sIHNpZ25lZEluID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0c2lnbmVkSW4gPSBFeHByZXNzQ3JhZnQuR21haWwuR29vZ2xlQXV0aC5pc1NpZ25lZEluLmdldCgpO1xyXG5cdFx0XHQqL1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNpZ25lZEluO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgQWNjZXNzVG9rZW4oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoIUV4dGVybmFsR21haWwuU2V0dXBDb21wbGV0ZWQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJTZXR1cCBmb3IgZ21haWwgaXMgbm90IHJlYWR5IHlldCFcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoR29vZ2xlQXV0aCA9PSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKFwiR29vZ2xlQXV0aFwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RyaW5nIGFjY2Vzc190b2tlbiA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0YWNjZXNzX3Rva2VuID0gRXhwcmVzc0NyYWZ0LkdtYWlsLkdvb2dsZUF1dGguY3VycmVudFVzZXIuQWIuWmkuYWNjZXNzX3Rva2VuO1xyXG5cdFx0XHQqL1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGFjY2Vzc190b2tlbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEZ1bGxuYW1lKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFFeHRlcm5hbEdtYWlsLlNldHVwQ29tcGxldGVkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiU2V0dXAgZm9yIGdtYWlsIGlzIG5vdCByZWFkeSB5ZXQhXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKEdvb2dsZUF1dGggPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEV4Y2VwdGlvbihcIkdvb2dsZUF1dGhcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0cmluZyBmdWxsbmFtZSA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0ZnVsbG5hbWUgPSBFeHByZXNzQ3JhZnQuR21haWwuR29vZ2xlQXV0aC5jdXJyZW50VXNlci5BYi53My5pZztcclxuXHRcdFx0Ki9cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmdWxsbmFtZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEVtYWlsKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFFeHRlcm5hbEdtYWlsLlNldHVwQ29tcGxldGVkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiU2V0dXAgZm9yIGdtYWlsIGlzIG5vdCByZWFkeSB5ZXQhXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKEdvb2dsZUF1dGggPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEV4Y2VwdGlvbihcIkdvb2dsZUF1dGhcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0cmluZyBlbWFpbCA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0ZW1haWwgPSBFeHByZXNzQ3JhZnQuR21haWwuR29vZ2xlQXV0aC5jdXJyZW50VXNlci5BYi53My5VMztcclxuXHRcdFx0Ki9cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBlbWFpbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEdldENvbnRlbnRUeXBlRnJvbUZpbGVOYW1lKHN0cmluZyBmaWxlbmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoZmlsZW5hbWUpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCI7XHJcblxyXG4gICAgICAgICAgICBmaWxlbmFtZSA9IGZpbGVuYW1lLlRvTG93ZXIoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGZpbGVuYW1lLkVuZHNXaXRoKFwiLnBkZlwiKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImFwcGxpY2F0aW9uL3BkZlwiO1xyXG4gICAgICAgICAgICBlbHNlIGlmKGZpbGVuYW1lLkVuZHNXaXRoKFwiLnBuZ1wiKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImltYWdlL3BuZ1wiO1xyXG4gICAgICAgICAgICBlbHNlIGlmKGZpbGVuYW1lLkVuZHNXaXRoKFwiLmpwZ1wiKSB8fCBmaWxlbmFtZS5FbmRzV2l0aChcIi5qcGVnXCIpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaW1hZ2UvanBlZ1wiO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZW5kRW1haWwoR21haWxNZXNzYWdlIG1lc3NhZ2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihtZXNzYWdlID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICB2YXIgYnVpbGRlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7XHJcblxyXG4gICAgICAgICAgICBidWlsZGVyLkFwcGVuZChcIkNvbnRlbnQtVHlwZTogbXVsdGlwYXJ0L21peGVkOyBib3VuZGFyeT1cXFwiX2ludGVsb2d5XzhhYjMzN2VjMmUzOGUxYThiODJhMDFhNTcxMmE4YmRiXFxcIlxcclxcblwiKTtcclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJNSU1FLVZlcnNpb246IDEuMFxcclxcblwiKTtcclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJGcm9tOiBcIiArIEVtYWlsKCkgKyBcIlxcclxcblwiKTtcclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJUbzogXCIgKyBtZXNzYWdlLlRvRW1haWwgKyBcIlxcclxcblwiKTtcclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJTdWJqZWN0OiBcIiArIG1lc3NhZ2UuU3ViamVjdCArIFwiXFxyXFxuXFxyXFxuXCIpO1xyXG5cclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCItLV9pbnRlbG9neV84YWIzMzdlYzJlMzhlMWE4YjgyYTAxYTU3MTJhOGJkYlxcclxcblwiKTtcclxuICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJDb250ZW50LVR5cGU6IHRleHQvXCIgKyAobWVzc2FnZS5Jc0hUTUwgPyBcImh0bWxcIiA6IFwicGxhaW5cIikgKyBcIjsgY2hhcnNldD1cXFwiVVRGLThcXFwiXFxyXFxuXCIpO1xyXG4gICAgICAgICAgICBidWlsZGVyLkFwcGVuZChcIk1JTUUtVmVyc2lvbjogMS4wXFxyXFxuXCIpO1xyXG4gICAgICAgICAgICBidWlsZGVyLkFwcGVuZChcIkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IDdiaXRcXHJcXG5cXHJcXG5cIik7XHJcblxyXG4gICAgICAgICAgICBpZihtZXNzYWdlLklzSFRNTClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoKG1lc3NhZ2UuQm9keSArIFwiXCIpLlJlcGxhY2UoXCJcXHJcXG5cIiwgXCI8YnIgLz5cIikgKyBcIlxcclxcblxcclxcblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKG1lc3NhZ2UuQm9keSArIFwiXFxyXFxuXFxyXFxuXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBidWlsZGVyLkFwcGVuZChcIi0tX2ludGVsb2d5XzhhYjMzN2VjMmUzOGUxYThiODJhMDFhNTcxMmE4YmRiXFxyXFxuXCIpO1xyXG5cclxuICAgICAgICAgICAgaWYobWVzc2FnZS5BdHRhY2htZW50cyAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmb3JlYWNoKHZhciBhdHRhY2htZW50IGluIG1lc3NhZ2UuQXR0YWNobWVudHMpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoYXR0YWNobWVudC5EYXRhKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKFwiLS1faW50ZWxvZ3lfOGFiMzM3ZWMyZTM4ZTFhOGI4MmEwMWE1NzEyYThiZGJcXHJcXG5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKFwiQ29udGVudC1UeXBlOiBcIiArIEdldENvbnRlbnRUeXBlRnJvbUZpbGVOYW1lKGF0dGFjaG1lbnQuRmlsZW5hbWUpICsgXCI7IGNoYXJzZXQ9XFxcIlVURi04XFxcIlxcclxcblwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJNSU1FLVZlcnNpb246IDEuMFxcclxcblwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCJDb250ZW50LVRyYW5zZmVyLUVuY29kaW5nOiBiYXNlNjRcXHJcXG5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKFwiQ29udGVudC1EaXNwb3NpdGlvbjogYXR0YWNobWVudDsgZmlsZW5hbWU9XFxcIlwiICsgKGF0dGFjaG1lbnQuRmlsZW5hbWUpLlJlcGxhY2UoXCJcXFwiXCIsIFwiXCIpICsgXCJcXFwiXFxyXFxuXFxyXFxuXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXR0YWNobWVudC5Jc0Jhc2U2NClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoYXR0YWNobWVudC5EYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKEdsb2JhbC5CdG9hKGF0dGFjaG1lbnQuRGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLkFwcGVuZChcIlxcclxcblxcclxcblwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKFwiLS1faW50ZWxvZ3lfOGFiMzM3ZWMyZTM4ZTFhOGI4MmEwMWE1NzEyYThiZGJcXHJcXG5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgc2V0dGluZ3MgPSBuZXcgQWpheE9wdGlvbnMoKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBUeXBlID0gXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBVcmwgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3VwbG9hZC9nbWFpbC92MS91c2Vycy9tZS9tZXNzYWdlcy9zZW5kP3VwbG9hZFR5cGU9bXVsdGlwYXJ0XCIsXHJcbiAgICAgICAgICAgICAgICBDb250ZW50VHlwZSA9IFwibWVzc2FnZS9yZmM4MjJcIixcclxuICAgICAgICAgICAgICAgIERhdGEgPSBidWlsZGVyLlRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBIZWFkZXJzID0gbmV3XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbiA9IFwiQmVhcmVyIFwiICsgQWNjZXNzVG9rZW4oKVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIEVycm9yID0gKGEsIGIsIGMpID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgQ29tcGxldGUgPSAoanEsIGRhdGEpID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgU3VjY2VzcyA9IChvYmosIGRhdGEsIGpxKSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgalF1ZXJ5LkFqYXgoc2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgSWNvblVSTCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighRXh0ZXJuYWxHbWFpbC5TZXR1cENvbXBsZXRlZClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIlNldHVwIGZvciBnbWFpbCBpcyBub3QgcmVhZHkgeWV0IVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihHb29nbGVBdXRoID09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFeGNlcHRpb24oXCJHb29nbGVBdXRoXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdHJpbmcgaWNvblVybCA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuXHRcdFx0aWNvblVybCA9IEV4cHJlc3NDcmFmdC5HbWFpbC5Hb29nbGVBdXRoLmN1cnJlbnRVc2VyLkFiLnczLlBhYTtcclxuXHRcdFx0Ki9cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBpY29uVXJsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldHVwKHN0cmluZyBjbGllbnRJZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENsaWVudElkID0gY2xpZW50SWQ7XHJcblxyXG4gICAgICAgICAgICBFeHRlcm5hbEdtYWlsLk9uUmVhZHkgPSAoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvKkBcclxuXHRcdFx0ICAgIGdhcGkubG9hZCgnY2xpZW50OmF1dGgyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2FwaS5jbGllbnQuaW5pdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICBkaXNjb3ZlcnlEb2NzOiBbXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9kaXNjb3ZlcnkvdjEvYXBpcy9nbWFpbC92MS9yZXN0XCJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQ6IEV4cHJlc3NDcmFmdC5HbWFpbC5DbGllbnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9nbWFpbC5zZW5kJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgLy8gTGlzdGVuIGZvciBzaWduLWluIHN0YXRlIGNoYW5nZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgICBFeHByZXNzQ3JhZnQuR21haWwuR29vZ2xlQXV0aCA9IGdhcGkuYXV0aDIuZ2V0QXV0aEluc3RhbmNlKClcclxuICAgICAgICAgICAgICAgICAgICAgIGdhcGkuYXV0aDIuZ2V0QXV0aEluc3RhbmNlKCkuc2lnbkluKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgRXhwcmVzc0NyYWZ0LkdtYWlsLlB1c2hFdmVudHNUaW1lQ2FsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdCAgICAqL1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBFeHRlcm5hbEdtYWlsLlNldHVwKHRydWUsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgR21haWxNZXNzYWdlXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBUb0VtYWlsIHsgZ2V0OyBzZXQ7IH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBTdWJqZWN0IHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIEJvZHkgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHB1YmxpYyBib29sIElzSFRNTCB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBHbWFpbE1lc3NhZ2Uoc3RyaW5nIHRvRW1haWwsIHN0cmluZyBzdWJqZWN0LCBzdHJpbmcgYm9keSwgYm9vbCBpc0hUTUwpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBUb0VtYWlsID0gdG9FbWFpbDtcclxuICAgICAgICAgICAgU3ViamVjdCA9IHN1YmplY3Q7XHJcbiAgICAgICAgICAgIEJvZHkgPSBib2R5O1xyXG4gICAgICAgICAgICBJc0hUTUwgPSBpc0hUTUw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGlzdDxHbWFpbE1lc3NhZ2VBdHRhY2htZW50PiBBdHRhY2htZW50cyB7IGdldDsgc2V0OyB9XHJcblxuICAgIFxucHJpdmF0ZSBMaXN0PEdtYWlsTWVzc2FnZUF0dGFjaG1lbnQ+IF9fUHJvcGVydHlfX0luaXRpYWxpemVyX19BdHRhY2htZW50cz1uZXcgTGlzdDxHbWFpbE1lc3NhZ2VBdHRhY2htZW50PigpO31cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgR21haWxNZXNzYWdlQXR0YWNobWVudFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgRmlsZW5hbWUgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgRGF0YSB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHVibGljIGJvb2wgSXNCYXNlNjQgeyBnZXQ7IHNldDsgfVxyXG5cclxuICAgICAgICBwdWJsaWMgR21haWxNZXNzYWdlQXR0YWNobWVudChzdHJpbmcgZmlsZW5hbWUsIHN0cmluZyBkYXRhLCBib29sIGlzQmFzZTY0ID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBGaWxlbmFtZSA9IGZpbGVuYW1lOyBEYXRhID0gZGF0YTsgSXNCYXNlNjQgPSBpc0Jhc2U2NDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UualF1ZXJ5MjtcclxudXNpbmcgU3lzdGVtO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgR29vZ2xlQ2xvdWRQcmludFxyXG4gICAge1xyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIF9zb3VyY2U7XHJcbiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgX21pbWV0eXBlO1xyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIF9lbmNvZGluZyA9IFwiXCI7XHJcbiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgX3RpdGxlO1xyXG4gICAgICAgIHByaXZhdGUgb2JqZWN0IF9nYWRnZXQgPSBudWxsO1xyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBFeHRlcm5hbFBsdWdpbiBFeHRlcm5hbEdvb2dsZUNsb3VkUHJpbnQgPSBuZXcgRXh0ZXJuYWxQbHVnaW4oXCJodHRwczovL3d3dy5nb29nbGUuY29tL2Nsb3VkcHJpbnQvY2xpZW50L2NwZ2FkZ2V0LmpzXCIpO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0dXAoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRXh0ZXJuYWxHb29nbGVDbG91ZFByaW50LlNldHVwKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgR29vZ2xlQ2xvdWRQcmludChzdHJpbmcgc291cmNlLCBzdHJpbmcgdGl0bGUgPSBcIlwiLCBHb29nbGVDbG91ZFByaW50aW5nTWltZVR5cGUgZ2NwbXQgPSBHb29nbGVDbG91ZFByaW50aW5nTWltZVR5cGUuVXJsLCBzdHJpbmcgZW5jb2RpbmcgPSBcIlwiKSA6IGJhc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgX3RpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgICAgIF9zb3VyY2UgPSBzb3VyY2U7XHJcbiAgICAgICAgICAgIF9lbmNvZGluZyA9IGVuY29kaW5nO1xyXG4gICAgICAgICAgICBfbWltZXR5cGUgPSBnY3BtdC5Ub1N0cmluZyhcIkdcIikuVG9Mb3dlcigpLlJlcGxhY2UoXCJfXCIsIFwiLlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNob3coKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRXh0ZXJuYWxHb29nbGVDbG91ZFByaW50LlVzYWdlQ2hlY2soKTtcclxuXHJcbiAgICAgICAgICAgIC8qQFxyXG5cdFx0XHR0aGlzLl9nYWRnZXQgPSBuZXcgY2xvdWRwcmludC5HYWRnZXQoKTtcclxuXHRcdFx0Ki9cclxuICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoX2VuY29kaW5nKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgLypAXHJcblx0XHRcdFx0dGhpcy5fZ2FkZ2V0LnNldFByaW50RG9jdW1lbnQodGhpcy5fbWltZXR5cGUsIHRoaXMuX3RpdGxlLCB0aGlzLl9zb3VyY2UsIHRoaXMuX2VuY29kaW5nKTtcclxuXHRcdFx0XHQqL1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgLypAXHJcblx0XHRcdFx0dGhpcy5fZ2FkZ2V0LnNldFByaW50RG9jdW1lbnQodGhpcy5fbWltZXR5cGUsIHRoaXMuX3RpdGxlLCB0aGlzLl9zb3VyY2UpO1xyXG5cdFx0XHRcdCovXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLypAXHJcblx0XHRcdHRoaXMuX2dhZGdldC5vcGVuUHJpbnREaWFsb2coKTtcclxuXHRcdFx0dGhpcy5fZ2FkZ2V0LnNldE9uQ2xvc2VDYWxsYmFjayh0aGlzLmNsZWFyQ29udGVudCk7XHJcblx0XHRcdCovXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBjbGVhckNvbnRlbnQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdHJ5XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGpRdWVyeS5TZWxlY3QoXCIuX19nY3BfZGlhbG9nX2NvbnRhaW5lcl9jbHNcIikuUGFyZW50KCkuR2V0KDApLkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbG9zZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0aGlzLl9nYWRnZXQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgLypAXHJcblx0XHRcdFx0dGhpcy5fZ2FkZ2V0LmNsb3NlUHJpbnREaWFsb2coKTtcclxuXHRcdFx0XHR0aGlzLl9nYWRnZXQgPSBudWxsO1xyXG5cdFx0XHRcdCovXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vPHNjcmlwdCBzcmMgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vY2xvdWRwcmludC9jbGllbnQvY3BnYWRnZXQuanNcIiA+XHJcbi8vPC8gc2NyaXB0ID5cclxuLy88IHNjcmlwdCA+XHJcbi8vICB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbi8vICAgIHZhciBnYWRnZXQgPSBuZXcgY2xvdWRwcmludC5HYWRnZXQoKTtcclxuLy9nYWRnZXQuc2V0UHJpbnREb2N1bWVudChcInVybFwiLCBcIlRlc3QgUGFnZVwiLCBcImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20uYXUvP2dmZV9yZD1jciZlaT1KcHFHV0p3NXhPdndCOEdXb2NBQlwiKTtcclxuLy9cdGdhZGdldC5vcGVuUHJpbnREaWFsb2coKTtcclxuLy8gIH1cclxuLy88L3NjcmlwdD4iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBHcmlkVmlld0NlbGxBcHBhcmVuY2VcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgYm9vbCBJc0JvbGQgPSBmYWxzZTtcclxuICAgICAgICBwdWJsaWMgVGV4dEFsaWduIEFsaWdubWVudCA9IFRleHRBbGlnbi5MZWZ0O1xyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgRm9yZWNvbG9yID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3Q2VsbEFwcGFyZW5jZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3Q2VsbEFwcGFyZW5jZShib29sIGlzQm9sZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIElzQm9sZCA9IGlzQm9sZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlld0NlbGxBcHBhcmVuY2UoYm9vbCBpc0JvbGQsIFRleHRBbGlnbiBhbGlnbm1lbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBJc0JvbGQgPSBpc0JvbGQ7XHJcbiAgICAgICAgICAgIEFsaWdubWVudCA9IGFsaWdubWVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlld0NlbGxBcHBhcmVuY2UoYm9vbCBpc0JvbGQsIFRleHRBbGlnbiBhbGlnbm1lbnQsIHN0cmluZyBmb3JlY29sb3IpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBJc0JvbGQgPSBpc0JvbGQ7XHJcbiAgICAgICAgICAgIEFsaWdubWVudCA9IGFsaWdubWVudDtcclxuICAgICAgICAgICAgRm9yZWNvbG9yID0gZm9yZWNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGFic3RyYWN0IGNsYXNzIEdyaWRWaWV3Q2VsbERpc3BsYXlcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgYm9vbCBVc2VEZWZhdWx0RWxlbWVudDtcclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgSFRNTEVsZW1lbnQgT25DcmVhdGUoR3JpZFZpZXcgZ3JpZFZpZXcsIGludCBkYXRhUm93SW5kZXgsIGludCBjb2x1bW5JbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgSFRNTEVsZW1lbnQgT25DcmVhdGVEZWZhdWx0KEhUTUxFbGVtZW50IG9yaWdpbmFsRWxlbWVudCwgR3JpZFZpZXcgZ3JpZFZpZXcsIGludCBkYXRhUm93SW5kZXgsIGludCBjb2x1bW5JbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbEVsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwibmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgR3JpZFZpZXdDb2x1bW5cclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgRGF0YUNvbHVtbiBDb2x1bW47XHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3IFZpZXc7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBDYXB0aW9uO1xyXG4gICAgICAgIHB1YmxpYyBib29sIFZpc2libGU7XHJcbiAgICAgICAgcHVibGljIGZsb2F0IENhY2hlZFg7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBGb3JtYXRTdHJpbmcgPSBzdHJpbmcuRW1wdHk7XHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3Q2VsbEFwcGFyZW5jZSBIZWFkaW5nQXBwYXJlbmNlID0gbmV3IEdyaWRWaWV3Q2VsbEFwcGFyZW5jZSgpO1xyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlld0NlbGxBcHBhcmVuY2UgQm9keUFwcGFyZW5jZSA9IG5ldyBHcmlkVmlld0NlbGxBcHBhcmVuY2UoKTtcclxuICAgICAgICBwdWJsaWMgR3JpZFZpZXdDZWxsRGlzcGxheSBDZWxsRGlzcGxheSA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3U29ydE1vZGUgU29ydGVkTW9kZSA9IEdyaWRWaWV3U29ydE1vZGUuTm9uZTtcclxuXHJcbiAgICAgICAgcHVibGljIFRleHRJbnB1dCBGaWx0ZXJFZGl0ID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBvYmplY3QgZmlsdGVyVmFsdWU7XHJcblxyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgRmlsdGVyVmFsdWVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBmaWx0ZXJWYWx1ZTsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoZmlsdGVyVmFsdWUgIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZihWaWV3LlNob3dBdXRvRmlsdGVyUm93KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVmlldy5DYWxjdWxhdGVWaXNpYmxlUm93cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgVmFsdWVNYXRjaEZpbHRlcihpbnQgaW5kZXgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihmaWx0ZXJWYWx1ZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgICAgICAgICBvYmplY3QgYWJjID0gR2V0RGlzcGxheVZhbHVlQnlEYXRhUm93SGFuZGxlKGluZGV4KTtcclxuXHJcbiAgICAgICAgICAgIHN3aXRjaChDb2x1bW4uRGF0YVR5cGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLk9iamVjdDpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuSW50ZWdlcjpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuTG9uZzpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRmxvYXQ6XHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRvdWJsZTpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGVjaW1hbDpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQm9vbDpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQnl0ZTpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuU2hvcnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFiYyA9PSBmaWx0ZXJWYWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkRhdGVUaW1lOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TdHJpbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhYmMgKyBcIlwiKS5TdGFydHNXaXRoKGZpbHRlclZhbHVlICsgXCJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIEFsbG93RWRpdCA9IHRydWU7XHJcbiAgICAgICAgcHVibGljIGJvb2wgUmVhZE9ubHkgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIGludCBHZXREYXRhQ29sdW1uSW5kZXgoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IFZpZXcuRGF0YVNvdXJjZS5Db2x1bW5Db3VudDtcclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihWaWV3LkRhdGFTb3VyY2UuQ29sdW1uc1tpXSA9PSBDb2x1bW4pXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBHZXREaXNwbGF5VmFsdWVCeURhdGFSb3dIYW5kbGUoaW50IFJvd0hhbmRsZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoRm9ybWF0U3RyaW5nKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvbHVtbi5HZXREaXNwbGF5VmFsdWUoUm93SGFuZGxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb2x1bW4uR2V0RGlzcGxheVZhbHVlKFJvd0hhbmRsZSwgRm9ybWF0U3RyaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBHZXREaXNwbGF5VmFsdWUoaW50IFJvd0hhbmRsZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFZpZXcuVmlzaWJsZVJvd0hhbmRsZXMgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUm93SGFuZGxlID0gVmlldy5WaXNpYmxlUm93SGFuZGxlc1tSb3dIYW5kbGVdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKEZvcm1hdFN0cmluZykpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb2x1bW4uR2V0RGlzcGxheVZhbHVlKFJvd0hhbmRsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29sdW1uLkdldERpc3BsYXlWYWx1ZShSb3dIYW5kbGUsIEZvcm1hdFN0cmluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW50IF93aWR0aDtcclxuXHJcbiAgICAgICAgcHVibGljIGludCBXaWR0aFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfd2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlIDwgMjQpXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAyNDtcclxuICAgICAgICAgICAgICAgIGlmKF93aWR0aCAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfd2lkdGggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBWaWV3LlJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3Q29sdW1uKEdyaWRWaWV3IHZpZXcsIGludCB3aWR0aCA9IDEwMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFZpZXcgPSB2aWV3O1xyXG4gICAgICAgICAgICBfd2lkdGggPSB3aWR0aDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIEluZGV4VmFsdWU8VD5cclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgcmVhZG9ubHkgaW50IEluZGV4O1xyXG4gICAgICAgIHB1YmxpYyBUIFZhbHVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgSW5kZXhWYWx1ZShpbnQgaW5kZXgsIFQgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBJbmRleCA9IGluZGV4O1xyXG4gICAgICAgICAgICBWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgSGFyZFNvZnRMaXN0PFQ+XHJcbiAgICB7XHJcbiAgICAgICAgcHJpdmF0ZSBMaXN0PFQ+IF9oaGwgPSBuZXcgTGlzdDxUPigpO1xyXG4gICAgICAgIHByb3RlY3RlZCBMaXN0PEluZGV4VmFsdWU8VD4+IF9obCA9IG5ldyBMaXN0PEluZGV4VmFsdWU8VD4+KCk7XHJcbiAgICAgICAgcHVibGljIExpc3Q8aW50PiBTTCA9IG5ldyBMaXN0PGludD4oKTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgTGltaXQ7XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW50IEhhcmRMZW5ndGggPSAwO1xyXG5cclxuICAgICAgICBwdWJsaWMgSW5kZXhWYWx1ZTxUPiBHZXRJbmRleFZhbHVlQnlIYXJkTGlzdEluZGV4KGludCBpbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBfaGxbaW5kZXhdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFQgRGVmYXVsdFZhbHVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgSGFyZFNvZnRMaXN0KFQgZGVmYXVsdFZhbHVlLCBpbnQgbGltaXQgPSAxMDAwMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIERlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcclxuICAgICAgICAgICAgTGltaXQgPSBsaW1pdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsZWFyQWxsKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9oaGwgPSBuZXcgTGlzdDxUPigpO1xyXG4gICAgICAgICAgICBfaGwgPSBuZXcgTGlzdDxJbmRleFZhbHVlPFQ+PigpO1xyXG4gICAgICAgICAgICBTTCA9IG5ldyBMaXN0PGludD4oKTtcclxuICAgICAgICAgICAgSGFyZExlbmd0aCA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbGVhckFsbFNldEhhcmRSYW5nZShUIHZhbHVlLCBwYXJhbXMgaW50W10gSW5kZXhzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgSGFyZExlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIGlmKEluZGV4cyA9PSBudWxsIHx8IEluZGV4cy5MZW5ndGggPT0gMClcclxuICAgICAgICAgICAgICAgIENsZWFyQWxsKCk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoSW5kZXhzLkxlbmd0aCA+IExpbWl0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIEhhcmRMZW5ndGggPSBJbmRleHMuTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIF9obCA9IG5ldyBMaXN0PEluZGV4VmFsdWU8VD4+KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgU0wgPSBuZXcgTGlzdDxpbnQ+KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGludCBtYXggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBIYXJkTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihJbmRleHNbaV0gPiBtYXgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXggPSBJbmRleHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGludCBsZW5ndGggPSBtYXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIF9oaGwgPSBuZXcgTGlzdDxUPihsZW5ndGgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihsZW5ndGggPT0gSW5kZXhzLkxlbmd0aClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBIYXJkTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oaGwuQWRkKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oaGwuQWRkKERlZmF1bHRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IEhhcmRMZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hobFtJbmRleHNbaV1dID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2hobCA9IG5ldyBMaXN0PFQ+KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgSGFyZExlbmd0aCA9IEluZGV4cy5MZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgX2hsID0gbmV3IExpc3Q8SW5kZXhWYWx1ZTxUPj4oSGFyZExlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IEhhcmRMZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9obC5BZGQobmV3IEluZGV4VmFsdWU8VD4oSW5kZXhzW2ldLCB2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBTTCA9IG5ldyBMaXN0PGludD4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2xlYXJTb2Z0TGlzdCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBTTCA9IG5ldyBMaXN0PGludD4oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsZWFyQW5kQWRkT3JTZXQoVCB2YWx1ZSwgaW50IGluZGV4LCBib29sIEFkZFRvU29mdExpc3QgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9oaGwgPSBuZXcgTGlzdDxUPigpO1xyXG4gICAgICAgICAgICBfaGwgPSBuZXcgTGlzdDxJbmRleFZhbHVlPFQ+PigpO1xyXG4gICAgICAgICAgICBTTCA9IG5ldyBMaXN0PGludD4oKTtcclxuICAgICAgICAgICAgSGFyZExlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIEFkZE9yU2V0KHZhbHVlLCBpbmRleCwgQWRkVG9Tb2Z0TGlzdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgSW5kZXhWYWx1ZTxUPiBHZXRIYXJkT3JTb2Z0SW5kZXhWYWx1ZShpbnQgaW5kZXgsIGJvb2wgQWRkVG9Tb2Z0TGlzdCA9IGZhbHNlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaW50IGxlbmd0aCA9IFNMLkNvdW50O1xyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBzbEkgPSBTTFtpXTtcclxuICAgICAgICAgICAgICAgIGlmKF9obFtzbEldLkluZGV4ID09IGluZGV4KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfaGxbc2xJXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGVuZ3RoID0gX2hsLkNvdW50O1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaGxpID0gX2hsW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYoaGxpLkluZGV4ID09IGluZGV4KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKEFkZFRvU29mdExpc3QpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTTC5BZGQoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBobGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIEluZGV4VmFsdWU8VD4gR2V0SGFyZEluZGV4VmFsdWUocmVmIGludCBpbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludCBsZW5ndGggPSBfaGwuQ291bnQ7XHJcblxyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBobGkgPSBfaGxbaV07XHJcbiAgICAgICAgICAgICAgICBpZihobGkuSW5kZXggPT0gaW5kZXgpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBobGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5kZXggPSBsZW5ndGg7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBUIEdldFZhbHVlKGludCBpbmRleCwgYm9vbCBBZGRUb1NvZnRMaXN0ID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihIYXJkTGVuZ3RoID4gTGltaXQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfaGhsW2luZGV4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaGl2ID0gR2V0SGFyZE9yU29mdEluZGV4VmFsdWUoaW5kZXgsIEFkZFRvU29mdExpc3QpO1xyXG4gICAgICAgICAgICBpZihoaXYgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBEZWZhdWx0VmFsdWU7XHJcbiAgICAgICAgICAgIHJldHVybiBoaXYuVmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgaW50IEdldEluZGV4KGludCBpbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKEhhcmRMZW5ndGggPiBMaW1pdClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgaGl2ID0gR2V0SGFyZE9yU29mdEluZGV4VmFsdWUoaW5kZXgpO1xyXG4gICAgICAgICAgICBpZihoaXYgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgcmV0dXJuIGhpdi5JbmRleDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEFkZE9yU2V0KFQgdmFsdWUsIGludCBpbmRleCwgYm9vbCBBZGRUb1NvZnRMaXN0ID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihIYXJkTGVuZ3RoID4gTGltaXQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGluZGV4ID49IEhhcmRMZW5ndGgpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW50IGFkZERpZmYgPSAoaW5kZXggKyAxKSAtIF9oaGwuQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoYWRkRGlmZiA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBUW10gZGF0YSA9IG5ldyBUW2FkZERpZmZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgYWRkRGlmZjsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhW2ldID0gRGVmYXVsdFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oaGwuQWRkUmFuZ2UoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIF9oaGwuQWRkKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBIYXJkTGVuZ3RoID0gX2hobC5Db3VudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaGhsW2luZGV4XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbnQgbGVuZ3RoID0gU0wuQ291bnQ7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGhsaSA9IF9obFtTTFtpXV07XHJcbiAgICAgICAgICAgICAgICBpZihobGkuSW5kZXggPT0gaW5kZXgpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGxpLlZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbnQgaGluZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICAgIHZhciBoaXYgPSBHZXRIYXJkSW5kZXhWYWx1ZShyZWYgaGluZGV4KTtcclxuICAgICAgICAgICAgaWYoaGl2ID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICBfaGwuQWRkKChoaXYgPSBuZXcgSW5kZXhWYWx1ZTxUPihpbmRleCwgdmFsdWUpKSk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIGhpdi5WYWx1ZSA9IHZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYoQWRkVG9Tb2Z0TGlzdClcclxuICAgICAgICAgICAgICAgIFNMLkFkZChoaW5kZXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUmVtb3ZlKGludCBpbmRleCwgYm9vbCBPbmx5U29mdExpc3QgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKEhhcmRMZW5ndGggPiBMaW1pdClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoSGFyZExlbmd0aCAtIDEgPiBMaW1pdClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaGhsW2luZGV4XSA9IERlZmF1bHRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgSGFyZExlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSAhPSBpbmRleCAmJiAhX2hobFtpXS5FcXVhbHMoRGVmYXVsdFZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hsLkFkZChuZXcgSW5kZXhWYWx1ZTxUPihpLCBfaGhsW2ldKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIEhhcmRMZW5ndGggLT0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGludCBMZW5ndGggPSBTTC5Db3VudDtcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBMZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2xpID0gU0xbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoX2hsW3NsaV0uSW5kZXggPT0gaW5kZXgpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTTC5SZW1vdmVBdChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoT25seVNvZnRMaXN0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaGwuUmVtb3ZlQXQoc2xpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGludCBsZW5ndGggPSBfaGwuQ291bnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBobGkgPSBfaGxbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaGxpLkluZGV4ID09IGluZGV4KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2hsLlJlbW92ZUF0KGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlO1xyXG51c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIFN5c3RlbTtcclxudXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWM7XHJcbnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljcztcclxudXNpbmcgU3lzdGVtLlRleHQ7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgSGVscGVyXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIGNsYXNzIERhdGFUYWJsZUpzb25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHB1YmxpYyBzdHJpbmdbXSBmaWVsZE5hbWVzID0gbnVsbDtcclxuICAgICAgICAgICAgcHVibGljIG9iamVjdFtdW10gcm93cyA9IG51bGw7XHJcbiAgICAgICAgICAgIHB1YmxpYyBEYXRhVHlwZVtdIGRhdGFUeXBlcyA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBwdWJsaWMgc3RhdGljIERhdGFUYWJsZUpzb24gRnJvbUV4dGVybmFsKG9iamVjdCBvKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBEYXRhVGFibGVKc29uIHg7XHJcbiAgICAgICAgICAgICAgICB4ID0gU2NyaXB0LldyaXRlPERhdGFUYWJsZUpzb24+KFwiQnJpZGdlLm1lcmdlKEJyaWRnZS5jcmVhdGVJbnN0YW5jZShFeHByZXNzQ3JhZnQuSGVscGVyLkRhdGFUYWJsZUpzb24pLCBvKTtcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcHVibGljIHN0YXRpYyBEYXRhVGFibGUgUGFyc2UoZHluYW1pYyBvKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBEYXRhVGFibGUgZHQgPSBuZXcgRGF0YVRhYmxlKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gby5maWVsZE5hbWVzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkdC5BZGRDb2x1bW4oby5maWVsZE5hbWVzW2ldLCBvLmRhdGFUeXBlc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihvLnJvd3MgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSBvLnJvd3MubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIGR0LkJlZ2luTmV3Um93KGxlbmd0aCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkciA9IGR0Lk5ld1JvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkci5iYXRjaERhdGEgPSBvLnJvd3NbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGR0LkFjY2VwdE5ld1Jvd3MoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkdDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcHVibGljIERhdGFUYWJsZSBUb1RhYmxlKClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGR0ID0gbmV3IERhdGFUYWJsZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBmaWVsZE5hbWVzLkxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGR0LkFkZENvbHVtbihmaWVsZE5hbWVzW2ldLCBkYXRhVHlwZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKHJvd3MgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkdC5CZWdpbk5ld1Jvdyhyb3dzLkxlbmd0aCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCByb3dzLkxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRyID0gZHQuTmV3Um93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyLmJhdGNoRGF0YSA9IHJvd3NbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGR0LkFjY2VwdE5ld1Jvd3MoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBJc0lQaG9uZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBib29sIHIgPSBmYWxzZTtcclxuICAgICAgICAgICAgLypAXHJcbiAgICAgICAgICAgciA9ICEhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpO1xyXG4gICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIElzSVBhZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBib29sIHIgPSBmYWxzZTtcclxuICAgICAgICAgICAgLypAXHJcbiAgICAgICAgICAgciA9ICEhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKTtcclxuICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICByZXR1cm4gcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGJvb2wgX25vdERlc2t0b3A7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIF9zZXR1cERlc2t0b3A7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBOb3REZXNrdG9wXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IF9zZXR1cERlc2t0b3AgPyBfbm90RGVza3RvcCA6IF9ub3REZXNrdG9wID0gKCFCcm93c2VyLklzRGVza3RvcCB8fCBJc0lQaG9uZSgpIHx8IElzSVBhZCgpKTtcclxuICAgICAgICAgICAgICAgIF9zZXR1cERlc2t0b3AgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgSXNUcnVlKHRoaXMgc3RyaW5nIHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuICgodmFsdWUgPSB2YWx1ZS5Ub0xvd2VyKCkpID09IFwidHJ1ZVwiIHx8IHZhbHVlID09IFwiMVwiIHx8IHZhbHVlID09IFwib25cIikgPyAxIDogMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IFRvSW50KHRoaXMgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBHbG9iYWwuUGFyc2VJbnQodmFsdWUuQXM8c3RyaW5nPigpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgZmxvYXQgVG9GbG9hdCh0aGlzIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gKGZsb2F0KUdsb2JhbC5QYXJzZUZsb2F0KHZhbHVlLkFzPHN0cmluZz4oKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyBUb1N0cih0aGlzIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUuQXM8c3RyaW5nPigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIElzRmlyZUZveCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBib29sIHZhbHVlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvKkBcclxuaWYobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2ZpcmVmb3gnKSA+IC0xKVxyXG57XHJcbiAgICB2YWx1ZSA9IHRydWU7XHJcbn1cclxuXHRcdFx0Ki9cclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEZvY3VzRWxlbWVudCh0aGlzIEhUTUxFbGVtZW50IGVsZW1lbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBHbG9iYWwuU2V0VGltZW91dCgoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uKSgoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LkZvY3VzKCk7XHJcbiAgICAgICAgICAgIH0pLCAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgZGVjaW1hbCBTdHJpcE5vbk51bWJlclN0cmluZyh0aGlzIHN0cmluZyB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UodmFsdWUpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcblxyXG4gICAgICAgICAgICB2YXIgYnVpbGRlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7XHJcblxyXG4gICAgICAgICAgICBib29sIEFkZGVkRGlnaXRzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgdmFsdWUuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGNoYXIuSXNEaWdpdCh2YWx1ZVtpXSkgfHwgdmFsdWVbaV0gPT0gJy4nKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKHZhbHVlW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICBBZGRlZERpZ2l0cyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHZhbHVlW2ldID09ICctJyAmJiAhQWRkZWREaWdpdHMpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQodmFsdWVbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIEFkZGVkRGlnaXRzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVjaW1hbCB2YWx1ZTEgPSAwO1xyXG4gICAgICAgICAgICBkZWNpbWFsLlRyeVBhcnNlKGJ1aWxkZXIuVG9TdHJpbmcoKSwgb3V0IHZhbHVlMSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBEYXRlVGltZSBTdHJpcE5vbkRhdGVTdHJpbmcodGhpcyBzdHJpbmcgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKHZhbHVlKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBEYXRlVGltZS5NaW5WYWx1ZTtcclxuXHJcbiAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLlRyaW0oKS5SZXBsYWNlKCdcXFxcJywgRXhwcmVzc0NyYWZ0LlNldHRpbmdzLkRhdGVTZXBlcmF0b3IpO1xyXG5cclxuICAgICAgICAgICAgICAgIGJvb2wgc3RhcnRzV2l0aFBsdXMgPSAodmFsdWUuU3RhcnRzV2l0aChcIitcIikpO1xyXG4gICAgICAgICAgICAgICAgYm9vbCBzdGFydHNXaXRoTXVudXMgPSAhc3RhcnRzV2l0aFBsdXMgJiYgKHZhbHVlLlN0YXJ0c1dpdGgoXCItXCIpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihzdGFydHNXaXRoTXVudXMpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5TdWJzdHJpbmcoMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5SZXBsYWNlKCctJywgRXhwcmVzc0NyYWZ0LlNldHRpbmdzLkRhdGVTZXBlcmF0b3IpO1xyXG5cclxuICAgICAgICAgICAgICAgIGJvb2wgZW5kc1dpdGhNb250aCA9IChzdGFydHNXaXRoUGx1cyB8fCBzdGFydHNXaXRoTXVudXMpICYmICh2YWx1ZS5Ub0xvd2VyKCkuRW5kc1dpdGgoXCJtXCIpKTtcclxuICAgICAgICAgICAgICAgIGJvb2wgZW5kc1dpdGh5ZWFyID0gIWVuZHNXaXRoTW9udGggJiYgKHN0YXJ0c1dpdGhQbHVzIHx8IHN0YXJ0c1dpdGhNdW51cykgJiYgKHZhbHVlLlRvTG93ZXIoKS5FbmRzV2l0aChcInlcIikpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlLlRvTG93ZXIoKSA9PSBcImRcIilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRGF0ZVRpbWUuVG9kYXk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpO1xyXG5cclxuICAgICAgICAgICAgICAgIExpc3Q8aW50PiBWYWx1ZXMgPSBuZXcgTGlzdDxpbnQ+KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IHZhbHVlLkxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNoYXIuSXNEaWdpdCh2YWx1ZVtpXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKHZhbHVlW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHZhbHVlW2ldID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlU2VwZXJhdG9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWVzLkFkZChpbnQuUGFyc2UoYnVpbGRlci5Ub1N0cmluZygpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihidWlsZGVyLkxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVmFsdWVzLkFkZChpbnQuUGFyc2UoYnVpbGRlci5Ub1N0cmluZygpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYnVpbGRlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZihWYWx1ZXMuQ291bnQgPj0gMylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGVUaW1lKFZhbHVlc1soaW50KUV4cHJlc3NDcmFmdC5TZXR0aW5ncy5ZZWFyUG9zaXRpb25dLCBWYWx1ZXNbKGludClFeHByZXNzQ3JhZnQuU2V0dGluZ3MuTW9udGhQb3NpdGlvbl0sIFZhbHVlc1soaW50KUV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXlQb3NpdGlvbl0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZihWYWx1ZXMuQ291bnQgPT0gMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihFeHByZXNzQ3JhZnQuU2V0dGluZ3MuRGF5UG9zaXRpb24gPT0gRXhwcmVzc0NyYWZ0LlNldHRpbmdzLkRhdGVQb3NpdGlvbi5GaXJzdClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN0YXJ0c1dpdGhQbHVzIHx8IHN0YXJ0c1dpdGhNdW51cylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBEYXRlVGltZS5Ub2RheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVuZHNXaXRoTW9udGgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IGRhdGUuQWRkTW9udGhzKHN0YXJ0c1dpdGhNdW51cyA/IC1WYWx1ZXNbMF0gOiBWYWx1ZXNbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihlbmRzV2l0aHllYXIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3RhcnRzV2l0aE11bnVzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IGRhdGUuQWRkWWVhcnMoLVZhbHVlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlLkFkZFllYXJzKFZhbHVlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlLkFkZERheXMoc3RhcnRzV2l0aE11bnVzID8gLVZhbHVlc1swXSA6IFZhbHVlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRlLkhvdXIgPT0gMjMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5BZGRIb3VycygxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlVGltZShEYXRlVGltZS5Ub2RheS5ZZWFyLCBEYXRlVGltZS5Ub2RheS5Nb250aCwgVmFsdWVzWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5Nb250aFBvc2l0aW9uID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlUG9zaXRpb24uRmlyc3QpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGVUaW1lKERhdGVUaW1lLlRvZGF5LlllYXIsIFZhbHVlc1swXSwgRGF0ZVRpbWUuVG9kYXkuRGF5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihFeHByZXNzQ3JhZnQuU2V0dGluZ3MuWWVhclBvc2l0aW9uID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlUG9zaXRpb24uRmlyc3QpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGVUaW1lKFZhbHVlc1swXSwgRGF0ZVRpbWUuVG9kYXkuTW9udGgsIERhdGVUaW1lLlRvZGF5LkRheSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZihWYWx1ZXMuQ291bnQgPT0gMilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihFeHByZXNzQ3JhZnQuU2V0dGluZ3MuRGF5UG9zaXRpb24gPT0gRXhwcmVzc0NyYWZ0LlNldHRpbmdzLkRhdGVQb3NpdGlvbiAuRmlyc3QgJiYgRXhwcmVzc0NyYWZ0LlNldHRpbmdzLk1vbnRoUG9zaXRpb24gPT0gRXhwcmVzc0NyYWZ0LlNldHRpbmdzLkRhdGVQb3NpdGlvbi5TZWNvbmQpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGVUaW1lKERhdGVUaW1lLlRvZGF5LlllYXIsIFZhbHVlc1sxXSwgVmFsdWVzWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihFeHByZXNzQ3JhZnQuU2V0dGluZ3MuRGF5UG9zaXRpb24gPT0gRXhwcmVzc0NyYWZ0LlNldHRpbmdzLkRhdGVQb3NpdGlvbiAuU2Vjb25kICYmIEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5Nb250aFBvc2l0aW9uID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlUG9zaXRpb24uRmlyc3QpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGVUaW1lKERhdGVUaW1lLlRvZGF5LlllYXIsIFZhbHVlc1swXSwgVmFsdWVzWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihFeHByZXNzQ3JhZnQuU2V0dGluZ3MuWWVhclBvc2l0aW9uID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlUG9zaXRpb24gLlNlY29uZCAmJiBFeHByZXNzQ3JhZnQuU2V0dGluZ3MuTW9udGhQb3NpdGlvbiA9PSBFeHByZXNzQ3JhZnQuU2V0dGluZ3MuRGF0ZVBvc2l0aW9uLkZpcnN0KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlVGltZShWYWx1ZXNbMV0sIFZhbHVlc1swXSwgRGF0ZVRpbWUuVG9kYXkuRGF5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihFeHByZXNzQ3JhZnQuU2V0dGluZ3MuWWVhclBvc2l0aW9uID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlUG9zaXRpb24gLkZpcnN0ICYmIEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5Nb250aFBvc2l0aW9uID09IEV4cHJlc3NDcmFmdC5TZXR0aW5ncy5EYXRlUG9zaXRpb24uU2Vjb25kKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlVGltZShWYWx1ZXNbMF0sIFZhbHVlc1sxXSwgRGF0ZVRpbWUuVG9kYXkuRGF5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBEYXRlVGltZS5NaW5WYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgZGVjaW1hbCBBZGRUYXgoZGVjaW1hbCB2YWx1ZSwgZGVjaW1hbCB0YXhQZXJjZW50ID0gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih2YWx1ZSA9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYodGF4UGVyY2VudCA9PSAtMSlcclxuICAgICAgICAgICAgICAgIHRheFBlcmNlbnQgPSBTZXR0aW5ncy5UYXhQZXJjZW50O1xyXG4gICAgICAgICAgICBpZih0YXhQZXJjZW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgKiAoMSArIHRheFBlcmNlbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBkZWNpbWFsIEdldFBvcnRpb25UYXgoZGVjaW1hbCB2YWx1ZSwgZGVjaW1hbCB0YXhQZXJjZW50ID0gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih2YWx1ZSA9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYodGF4UGVyY2VudCA9PSAtMSlcclxuICAgICAgICAgICAgICAgIHRheFBlcmNlbnQgPSBTZXR0aW5ncy5UYXhQZXJjZW50O1xyXG4gICAgICAgICAgICBpZih0YXhQZXJjZW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAtIHZhbHVlIC8gKDEgKyB0YXhQZXJjZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgZGVjaW1hbCBEZWR1Y3RUYXgoZGVjaW1hbCB2YWx1ZSwgZGVjaW1hbCB0YXhQZXJjZW50ID0gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih2YWx1ZSA9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYodGF4UGVyY2VudCA9PSAtMSlcclxuICAgICAgICAgICAgICAgIHRheFBlcmNlbnQgPSBTZXR0aW5ncy5UYXhQZXJjZW50O1xyXG4gICAgICAgICAgICBpZih0YXhQZXJjZW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgLSBHZXRQb3J0aW9uVGF4KHZhbHVlLCB0YXhQZXJjZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBJc051bWJlcih0aGlzIG9iamVjdCB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSBpcyBzYnl0ZVxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlIGlzIGJ5dGVcclxuICAgICAgICAgICAgICAgICAgICB8fCB2YWx1ZSBpcyBzaG9ydFxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlIGlzIHVzaG9ydFxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlIGlzIGludFxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlIGlzIHVpbnRcclxuICAgICAgICAgICAgICAgICAgICB8fCB2YWx1ZSBpcyBsb25nXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgdmFsdWUgaXMgdWxvbmdcclxuICAgICAgICAgICAgICAgICAgICB8fCB2YWx1ZSBpcyBmbG9hdFxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlIGlzIGRvdWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlIGlzIGRlY2ltYWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRW1wdHkodGhpcyBIVE1MRWxlbWVudCBlbGVtZW50KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLypAXHJcblx0XHRcdHZhciBsZW4gPSBlbGVtZW50LmNoaWxkTm9kZXMubGVuZ3RoO1xyXG5cdFx0XHR3aGlsZShsZW4tLSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5sYXN0Q2hpbGQpO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHQqL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBWZWN0b3IyIEdldENsaWVudE1vdXNlTG9jYXRpb24ob2JqZWN0IGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgeCA9IDA7XHJcbiAgICAgICAgICAgIHZhciB5ID0gMDtcclxuICAgICAgICAgICAgLypAXHJcblx0XHRcdCAgaWYgKCFlKSB2YXIgZSA9IHdpbmRvdy5ldmVudDtcclxuXHJcblx0XHRcdCAgaWYgKGUucGFnZVggfHwgZS5wYWdlWSkge1xyXG5cdFx0XHRcdHggPSBlLnBhZ2VYO1xyXG5cdFx0XHRcdHkgPSBlLnBhZ2VZO1xyXG5cdFx0XHQgIH0gZWxzZSBpZiAoZS5jbGllbnRYIHx8IGUuY2xpZW50WSkge1xyXG5cdFx0XHRcdHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgK1xyXG5cdFx0XHRcdFx0XHRcdFx0ICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7XHJcblx0XHRcdFx0eSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICtcclxuXHRcdFx0XHRcdFx0XHRcdCAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XHJcblx0XHRcdCAgfVxyXG5cdFx0XHQqL1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIoeCwgeSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0Q2hlY2tlZCh0aGlzIENvbnRyb2wgaW5wdXQsIG9iamVjdCB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlucHV0LkNvbnRlbnQuU2V0Q2hlY2tlZCh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0Q2hlY2tlZCh0aGlzIEhUTUxFbGVtZW50IGlucHV0LCBvYmplY3QgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBib29sIGNoZWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmKHZhbHVlICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlIGlzIGJvb2wgfHwgdmFsdWUuSXNOdW1iZXIoKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGVjayA9IChib29sKXZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZih2YWx1ZSBpcyBzdHJpbmcpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nIHN0clZhbHVlID0gKChzdHJpbmcpdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrID0gKHN0clZhbHVlID09IFwiMVwiIHx8IHN0cmluZy5Db21wYXJlKHN0clZhbHVlLlRvTG93ZXIoKSwgXCJ0cnVlXCIpID09IDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKCFjaGVjaylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW5wdXQuUmVtb3ZlQXR0cmlidXRlKEdyaWRWaWV3Q2VsbERpc3BsYXlDaGVja0JveC5yZXNvdXJjZV9jaGVja2VkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlucHV0LlNldEF0dHJpYnV0ZShHcmlkVmlld0NlbGxEaXNwbGF5Q2hlY2tCb3gucmVzb3VyY2VfY2hlY2tlZCwgbnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gSUUgZG9lcyBub3Qgc3VwcG9ydCAucmVtb3ZlIG9uIEVsZW1lbnQgdXNlIGRlbGV0ZVxyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwiY1wiPjwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIERlbGV0ZSh0aGlzIEVsZW1lbnQgYylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGMgIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgYy5QYXJlbnRFbGVtZW50ICE9IG51bGwgJiZcclxuICAgICAgICAgICAgICAgIGMuUGFyZW50RWxlbWVudC5Db250YWlucyhjKSlcclxuICAgICAgICAgICAgICAgIGMuUGFyZW50RWxlbWVudC5SZW1vdmVDaGlsZChjKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIFRvUHgodGhpcyBvYmplY3QgaSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBTY3JpcHQuV3JpdGU8c3RyaW5nPihcImkgKyAncHgnXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIExvZyhvYmplY3QganNvKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU2NyaXB0LkNhbGwoXCJjb25zb2xlLmxvZ1wiLCBqc28pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEFwcGVuZENoaWxkcmVuKHRoaXMgTm9kZSBjLCBwYXJhbXMgTm9kZVtdIE5vZGVzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoTm9kZXMgIT0gbnVsbCAmJiBOb2Rlcy5MZW5ndGggPiAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgTm9kZXMuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYy5BcHBlbmRDaGlsZChOb2Rlc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBBcHBlbmRDaGlsZHJlblRhYkluZGV4KHRoaXMgTm9kZSBjLCBwYXJhbXMgQ29udHJvbFtdIE5vZGVzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoTm9kZXMgIT0gbnVsbCAmJiBOb2Rlcy5MZW5ndGggPiAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgTm9kZXMuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgTm9kZXNbaV0uQ29udGVudC5UYWJJbmRleCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgYy5BcHBlbmRDaGlsZChOb2Rlc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBBcHBlbmRDaGlsZHJlblRhYkluZGV4KHRoaXMgQ29udHJvbCBjLCBwYXJhbXMgQ29udHJvbFtdIE5vZGVzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYy5Db250ZW50LkFwcGVuZENoaWxkcmVuVGFiSW5kZXgoTm9kZXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb250cm9sIEFwcGVuZENoaWxkKHRoaXMgQ29udHJvbCBjLCBDb250cm9sIE5vZGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjLkNvbnRlbnQuQXBwZW5kQ2hpbGQoTm9kZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBDb250cm9sIEFwcGVuZENoaWxkcmVuKHRoaXMgQ29udHJvbCBjLCBwYXJhbXMgQ29udHJvbFtdIE5vZGVzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYy5Db250ZW50LkFwcGVuZENoaWxkcmVuKE5vZGVzKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEFwcGVuZENoaWxkcmVuKHRoaXMgTm9kZSBjLCBwYXJhbXMgQ29udHJvbFtdIE5vZGVzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoTm9kZXMgIT0gbnVsbCAmJiBOb2Rlcy5MZW5ndGggPiAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgTm9kZXMuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYy5BcHBlbmRDaGlsZChOb2Rlc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgQ29udHJvbCBTZXRCb3VuZHModGhpcyBDb250cm9sIGMsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gbGVmdCwgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB0b3AsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gd2lkdGgsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gaGVpZ2h0KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYy5Db250ZW50LlNldEJvdW5kcyhsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbnRyb2wgU2V0Qm91bmRzRnVsbCh0aGlzIENvbnRyb2wgYylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGMuQ29udGVudC5TZXRCb3VuZHNGdWxsKCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gYztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZXRCb3VuZHNGdWxsKHRoaXMgSFRNTEVsZW1lbnQgYylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGMuU2V0Qm91bmRzKDAsIDAsIFwiMTAwJVwiLCBcIjEwMCVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIENvbnRyb2wgU2V0U2l6ZSh0aGlzIENvbnRyb2wgYywgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB3aWR0aCwgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiBoZWlnaHQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjLkNvbnRlbnQuU2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldEJvdW5kcyh0aGlzIEhUTUxFbGVtZW50IGMsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gbGVmdCwgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB0b3AsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gd2lkdGgsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gaGVpZ2h0KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYy5TdHlsZS5MZWZ0ID0gbGVmdC5Ub0h0bWxWYWx1ZSgpO1xyXG4gICAgICAgICAgICBjLlN0eWxlLlRvcCA9IHRvcC5Ub0h0bWxWYWx1ZSgpO1xyXG4gICAgICAgICAgICBjLlN0eWxlLldpZHRoID0gd2lkdGguVG9IdG1sVmFsdWUoKTtcclxuICAgICAgICAgICAgYy5TdHlsZS5IZWlnaHQgPSBoZWlnaHQuVG9IdG1sVmFsdWUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIFRvSHRtbFZhbHVlKHRoaXMgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHZhbHVlLklzPHN0cmluZz4oKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBWZWN0b3IyLnBmKHZhbHVlLkFzPHN0cmluZz4oKSk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYodmFsdWUuSXM8aW50PigpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLkFzPGludD4oKS5Ub1B4KCk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5BczxmbG9hdD4oKS5Ub1B4KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0SW1hZ2UodGhpcyBDb250cm9sIGMsIHN0cmluZyBzdHIsIGJvb2wgdXNlVVJMID0gdHJ1ZSwgYm9vbCB1c2VSZXNvdXJjZSA9IHRydWUsIGJvb2wgY2VudGVyID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFzdHIuU3RhcnRzV2l0aChcInVybChcIikpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0ciA9IHVzZVVSTCA/IENvbnRyb2wuR2V0SW1hZ2VTdHJpbmdVUkkoc3RyLCB1c2VSZXNvdXJjZSkgOiBDb250cm9sLkdldEltYWdlU3RyaW5nKHN0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgU2V0SW1hZ2UoYy5Db250ZW50LCBzdHIsIHVzZVVSTCwgY2VudGVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZXRJbWFnZSh0aGlzIEhUTUxFbGVtZW50IGMsIHN0cmluZyBzdHIsIGJvb2wgdXNlVVJMID0gdHJ1ZSwgYm9vbCBjZW50ZXIgPSB0cnVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShzdHIpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjLlN0eWxlLkJhY2tncm91bmQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgYy5TdHlsZS5CYWNrZ3JvdW5kU2l6ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZighc3RyLlN0YXJ0c1dpdGgoXCJ1cmwoXCIpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzdHIgPSB1c2VVUkwgPyBDb250cm9sLkdldEltYWdlU3RyaW5nVVJJKHN0cikgOiBDb250cm9sLkdldEltYWdlU3RyaW5nKHN0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYy5TdHlsZS5CYWNrZ3JvdW5kID0gc3RyO1xyXG4gICAgICAgICAgICBpZihjZW50ZXIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGMuU3R5bGUuQmFja2dyb3VuZFNpemUgPSBcIjEwMCUgMTAwJVwiO1xyXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldFNpemUodGhpcyBIVE1MRWxlbWVudCBjLCBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IHdpZHRoLCBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IGhlaWdodClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGMuU3R5bGUuV2lkdGggPSB3aWR0aC5Ub0h0bWxWYWx1ZSgpO1xyXG4gICAgICAgICAgICBjLlN0eWxlLkhlaWdodCA9IGhlaWdodC5Ub0h0bWxWYWx1ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldExvY2F0aW9uKHRoaXMgQ29udHJvbCBjLCBpbnQgbGVmdCwgaW50IHRvcClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGMuQ29udGVudC5TZXRMb2NhdGlvbihsZWZ0LlRvUHgoKSwgdG9wLlRvUHgoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0TG9jYXRpb24odGhpcyBDb250cm9sIGMsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gbGVmdCwgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB0b3ApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjLkNvbnRlbnQuU2V0TG9jYXRpb24obGVmdCwgdG9wKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZXRMb2NhdGlvbih0aGlzIEhUTUxFbGVtZW50IGMsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gbGVmdCwgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB0b3ApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjLlN0eWxlLkxlZnQgPSBsZWZ0LlRvSHRtbFZhbHVlKCk7XHJcbiAgICAgICAgICAgIGMuU3R5bGUuVG9wID0gdG9wLlRvSHRtbFZhbHVlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vIEh0bWxFc2NhcGUgWFNTXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJvYmpcIj48L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cmV0dXJucz48L3JldHVybnM+XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgSHRtbEVzY2FwZSh0aGlzIG9iamVjdCBvYmopXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gKG9iaiBhcyBzdHJpbmcpLkh0bWxFc2NhcGUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gSHRtbFVybFVuZXNjYXBlIFhTU1xyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxyZXR1cm5zPjwvcmV0dXJucz5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyBIdG1sVXJsVW5lc2NhcGUodGhpcyBzdHJpbmcgaW5wdXQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gIXN0cmluZy5Jc051bGxPckVtcHR5KGlucHV0KVxyXG4gICAgICAgICAgICAgICAgPyBpbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgIC5SZXBsYWNlKFwiJmFtcFwiLCBcIiZcIilcclxuICAgICAgICAgICAgICAgICAgICAuUmVwbGFjZShcIiZsdFwiLCBcIjxcIilcclxuICAgICAgICAgICAgICAgICAgICAuUmVwbGFjZShcIiZndFwiLCBcIj5cIilcclxuICAgICAgICAgICAgICAgICAgICAuUmVwbGFjZShcIiYjeDI3XCIsIFwiJ1wiKVxyXG4gICAgICAgICAgICAgICAgOiBcIlwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBIdG1sVXJsRXNjYXBlIFhTU1xyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwiaW5wdXRcIj48L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cmV0dXJucz48L3JldHVybnM+XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgSHRtbFVybEVzY2FwZSh0aGlzIHN0cmluZyBpbnB1dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiAhc3RyaW5nLklzTnVsbE9yRW1wdHkoaW5wdXQpXHJcbiAgICAgICAgICAgICAgICA/IGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgLlJlcGxhY2UoXCImXCIsIFwiJmFtcFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5SZXBsYWNlKFwiPFwiLCBcIiZsdFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5SZXBsYWNlKFwiPlwiLCBcIiZndFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5SZXBsYWNlKFwiJ1wiLCBcIiYjeDI3XCIpXHJcbiAgICAgICAgICAgICAgICA6IHN0cmluZy5FbXB0eTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gSHRtbEVzY2FwZSBYU1NcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cImlucHV0XCI+PC9wYXJhbT5cclxuICAgICAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPlxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEh0bWxFc2NhcGUodGhpcyBzdHJpbmcgaW5wdXQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gIXN0cmluZy5Jc051bGxPckVtcHR5KGlucHV0KSA/XHJcbiAgICAgICAgICAgICAgICBIdG1sVXJsRXNjYXBlKGlucHV0KS5SZXBsYWNlKEBcIlxcL1wiLCBcIiYjeDJGXCIpLlJlcGxhY2UoXCJcXFwiXCIsIFwiJnF1b3RcIikgOlxyXG4gICAgICAgICAgICAgICAgc3RyaW5nLkVtcHR5O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBIdG1sVW5lc2NhcGUgWFNTXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPlxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIEh0bWxVbmVzY2FwZSh0aGlzIHN0cmluZyBpbnB1dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiAhSXNFbXB0eShpbnB1dCkgP1xyXG4gICAgICAgICAgICAgICAgSHRtbFVybFVuZXNjYXBlKGlucHV0KS5SZXBsYWNlKFwiJiN4MkZcIiwgQFwiXFwvXCIpLlJlcGxhY2UoXCImcXVvdFwiLCBcIlxcXCJcIikgOlxyXG4gICAgICAgICAgICAgICAgc3RyaW5nLkVtcHR5O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEV4Y2hhbmdlQ2xhc3ModGhpcyBDb250cm9sIGNvbnRyb2wsIHN0cmluZyBvbGRDbGFzcywgc3RyaW5nIG5ld0NsYXNzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRXhjaGFuZ2VDbGFzcyhjb250cm9sLkNvbnRlbnQsIG9sZENsYXNzLCBuZXdDbGFzcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRXhjaGFuZ2VDbGFzcyh0aGlzIEhUTUxFbGVtZW50IGNvbnRyb2wsIHN0cmluZyBvbGRDbGFzcywgc3RyaW5nIG5ld0NsYXNzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoIUlzRW1wdHkob2xkQ2xhc3MpICYmIGNvbnRyb2wuQ2xhc3NMaXN0LkNvbnRhaW5zKG9sZENsYXNzKSlcclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuQ2xhc3NMaXN0LlJlbW92ZShvbGRDbGFzcyk7XHJcbiAgICAgICAgICAgIGlmKCFJc0VtcHR5KG5ld0NsYXNzKSAmJiAhY29udHJvbC5DbGFzc0xpc3QuQ29udGFpbnMobmV3Q2xhc3MpKVxyXG4gICAgICAgICAgICAgICAgY29udHJvbC5DbGFzc0xpc3QuQWRkKG5ld0NsYXNzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBJc0VtcHR5KHRoaXMgc3RyaW5nIHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UodmFsdWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFN0b3BBbmRMb2codGhpcyBTdG9wd2F0Y2ggc3csIHN0cmluZyBsb2dOYW1lID0gXCJUYXNrXCIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzdy5TdG9wKCk7XHJcbiAgICAgICAgICAgIENvbnNvbGVGb3JtLkxvZyhsb2dOYW1lICsgXCIgdG9vayBcIiArIHN3LkVsYXBzZWRNaWxsaXNlY29uZHMgKyBcIm1zIHRvIGZpbmlzaFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJuYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgS2V5Q29kZXNcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgY29uc3QgaW50IE1vZGlmaWVycyA9IC02NTUzNixcclxuICAgICAgICBOb25lID0gMCxcclxuICAgICAgICBMQnV0dG9uID0gMSxcclxuICAgICAgICBSQnV0dG9uID0gMixcclxuICAgICAgICBDYW5jZWwgPSAzLFxyXG4gICAgICAgIE1CdXR0b24gPSA0LFxyXG4gICAgICAgIFhCdXR0b24xID0gNSxcclxuICAgICAgICBYQnV0dG9uMiA9IDYsXHJcbiAgICAgICAgQmFjayA9IDgsXHJcbiAgICAgICAgVGFiID0gOSxcclxuICAgICAgICBMaW5lRmVlZCA9IDEwLFxyXG4gICAgICAgIENsZWFyID0gMTIsXHJcbiAgICAgICAgUmV0dXJuID0gMTMsXHJcbiAgICAgICAgRW50ZXIgPSAxMyxcclxuICAgICAgICBTaGlmdEtleSA9IDE2LFxyXG4gICAgICAgIENvbnRyb2xLZXkgPSAxNyxcclxuICAgICAgICBNZW51ID0gMTgsXHJcbiAgICAgICAgUGF1c2UgPSAxOSxcclxuICAgICAgICBDYXBpdGFsID0gMjAsXHJcbiAgICAgICAgQ2Fwc0xvY2sgPSAyMCxcclxuICAgICAgICBLYW5hTW9kZSA9IDIxLFxyXG4gICAgICAgIEhhbmd1ZWxNb2RlID0gMjEsXHJcbiAgICAgICAgSGFuZ3VsTW9kZSA9IDIxLFxyXG4gICAgICAgIEp1bmphTW9kZSA9IDIzLFxyXG4gICAgICAgIEZpbmFsTW9kZSA9IDI0LFxyXG4gICAgICAgIEhhbmphTW9kZSA9IDI1LFxyXG4gICAgICAgIEthbmppTW9kZSA9IDI1LFxyXG4gICAgICAgIEVzY2FwZSA9IDI3LFxyXG4gICAgICAgIElNRUNvbnZlcnQgPSAyOCxcclxuICAgICAgICBJTUVOb25jb252ZXJ0ID0gMjksXHJcbiAgICAgICAgSU1FQWNjZXB0ID0gMzAsXHJcbiAgICAgICAgSU1FQWNlZXB0ID0gMzAsXHJcbiAgICAgICAgSU1FTW9kZUNoYW5nZSA9IDMxLFxyXG4gICAgICAgIFNwYWNlID0gMzIsXHJcbiAgICAgICAgUHJpb3IgPSAzMyxcclxuICAgICAgICBQYWdlVXAgPSAzMyxcclxuICAgICAgICBOZXh0ID0gMzQsXHJcbiAgICAgICAgUGFnZURvd24gPSAzNCxcclxuICAgICAgICBFbmQgPSAzNSxcclxuICAgICAgICBIb21lID0gMzYsXHJcbiAgICAgICAgTGVmdCA9IDM3LFxyXG4gICAgICAgIFVwID0gMzgsXHJcbiAgICAgICAgUmlnaHQgPSAzOSxcclxuICAgICAgICBEb3duID0gNDAsXHJcbiAgICAgICAgU2VsZWN0ID0gNDEsXHJcbiAgICAgICAgUHJpbnQgPSA0MixcclxuICAgICAgICBFeGVjdXRlID0gNDMsXHJcbiAgICAgICAgU25hcHNob3QgPSA0NCxcclxuICAgICAgICBQcmludFNjcmVlbiA9IDQ0LFxyXG4gICAgICAgIEluc2VydCA9IDQ1LFxyXG4gICAgICAgIERlbGV0ZSA9IDQ2LFxyXG4gICAgICAgIEhlbHAgPSA0NyxcclxuICAgICAgICBEMCA9IDQ4LFxyXG4gICAgICAgIEQxID0gNDksXHJcbiAgICAgICAgRDIgPSA1MCxcclxuICAgICAgICBEMyA9IDUxLFxyXG4gICAgICAgIEQ0ID0gNTIsXHJcbiAgICAgICAgRDUgPSA1MyxcclxuICAgICAgICBENiA9IDU0LFxyXG4gICAgICAgIEQ3ID0gNTUsXHJcbiAgICAgICAgRDggPSA1NixcclxuICAgICAgICBEOSA9IDU3LFxyXG4gICAgICAgIEEgPSA2NSxcclxuICAgICAgICBCID0gNjYsXHJcbiAgICAgICAgQyA9IDY3LFxyXG4gICAgICAgIEQgPSA2OCxcclxuICAgICAgICBFID0gNjksXHJcbiAgICAgICAgRiA9IDcwLFxyXG4gICAgICAgIEcgPSA3MSxcclxuICAgICAgICBIID0gNzIsXHJcbiAgICAgICAgSSA9IDczLFxyXG4gICAgICAgIEogPSA3NCxcclxuICAgICAgICBLID0gNzUsXHJcbiAgICAgICAgTCA9IDc2LFxyXG4gICAgICAgIE0gPSA3NyxcclxuICAgICAgICBOID0gNzgsXHJcbiAgICAgICAgTyA9IDc5LFxyXG4gICAgICAgIFAgPSA4MCxcclxuICAgICAgICBRID0gODEsXHJcbiAgICAgICAgUiA9IDgyLFxyXG4gICAgICAgIFMgPSA4MyxcclxuICAgICAgICBUID0gODQsXHJcbiAgICAgICAgVSA9IDg1LFxyXG4gICAgICAgIFYgPSA4NixcclxuICAgICAgICBXID0gODcsXHJcbiAgICAgICAgWCA9IDg4LFxyXG4gICAgICAgIFkgPSA4OSxcclxuICAgICAgICBaID0gOTAsXHJcbiAgICAgICAgTFdpbiA9IDkxLFxyXG4gICAgICAgIFJXaW4gPSA5MixcclxuICAgICAgICBBcHBzID0gOTMsXHJcbiAgICAgICAgU2xlZXAgPSA5NSxcclxuICAgICAgICBOdW1QYWQwID0gOTYsXHJcbiAgICAgICAgTnVtUGFkMSA9IDk3LFxyXG4gICAgICAgIE51bVBhZDIgPSA5OCxcclxuICAgICAgICBOdW1QYWQzID0gOTksXHJcbiAgICAgICAgTnVtUGFkNCA9IDEwMCxcclxuICAgICAgICBOdW1QYWQ1ID0gMTAxLFxyXG4gICAgICAgIE51bVBhZDYgPSAxMDIsXHJcbiAgICAgICAgTnVtUGFkNyA9IDEwMyxcclxuICAgICAgICBOdW1QYWQ4ID0gMTA0LFxyXG4gICAgICAgIE51bVBhZDkgPSAxMDUsXHJcbiAgICAgICAgTXVsdGlwbHkgPSAxMDYsXHJcbiAgICAgICAgQWRkID0gMTA3LFxyXG4gICAgICAgIFNlcGFyYXRvciA9IDEwOCxcclxuICAgICAgICBTdWJ0cmFjdCA9IDEwOSxcclxuICAgICAgICBEZWNpbWFsID0gMTEwLFxyXG4gICAgICAgIERpdmlkZSA9IDExMSxcclxuICAgICAgICBGMSA9IDExMixcclxuICAgICAgICBGMiA9IDExMyxcclxuICAgICAgICBGMyA9IDExNCxcclxuICAgICAgICBGNCA9IDExNSxcclxuICAgICAgICBGNSA9IDExNixcclxuICAgICAgICBGNiA9IDExNyxcclxuICAgICAgICBGNyA9IDExOCxcclxuICAgICAgICBGOCA9IDExOSxcclxuICAgICAgICBGOSA9IDEyMCxcclxuICAgICAgICBGMTAgPSAxMjEsXHJcbiAgICAgICAgRjExID0gMTIyLFxyXG4gICAgICAgIEYxMiA9IDEyMyxcclxuICAgICAgICBGMTMgPSAxMjQsXHJcbiAgICAgICAgRjE0ID0gMTI1LFxyXG4gICAgICAgIEYxNSA9IDEyNixcclxuICAgICAgICBGMTYgPSAxMjcsXHJcbiAgICAgICAgRjE3ID0gMTI4LFxyXG4gICAgICAgIEYxOCA9IDEyOSxcclxuICAgICAgICBGMTkgPSAxMzAsXHJcbiAgICAgICAgRjIwID0gMTMxLFxyXG4gICAgICAgIEYyMSA9IDEzMixcclxuICAgICAgICBGMjIgPSAxMzMsXHJcbiAgICAgICAgRjIzID0gMTM0LFxyXG4gICAgICAgIEYyNCA9IDEzNSxcclxuICAgICAgICBOdW1Mb2NrID0gMTQ0LFxyXG4gICAgICAgIFNjcm9sbCA9IDE0NSxcclxuICAgICAgICBMU2hpZnRLZXkgPSAxNjAsXHJcbiAgICAgICAgUlNoaWZ0S2V5ID0gMTYxLFxyXG4gICAgICAgIExDb250cm9sS2V5ID0gMTYyLFxyXG4gICAgICAgIFJDb250cm9sS2V5ID0gMTYzLFxyXG4gICAgICAgIExNZW51ID0gMTY0LFxyXG4gICAgICAgIFJNZW51ID0gMTY1LFxyXG4gICAgICAgIEJyb3dzZXJCYWNrID0gMTY2LFxyXG4gICAgICAgIEJyb3dzZXJGb3J3YXJkID0gMTY3LFxyXG4gICAgICAgIEJyb3dzZXJSZWZyZXNoID0gMTY4LFxyXG4gICAgICAgIEJyb3dzZXJTdG9wID0gMTY5LFxyXG4gICAgICAgIEJyb3dzZXJTZWFyY2ggPSAxNzAsXHJcbiAgICAgICAgQnJvd3NlckZhdm9yaXRlcyA9IDE3MSxcclxuICAgICAgICBCcm93c2VySG9tZSA9IDE3MixcclxuICAgICAgICBWb2x1bWVNdXRlID0gMTczLFxyXG4gICAgICAgIFZvbHVtZURvd24gPSAxNzQsXHJcbiAgICAgICAgVm9sdW1lVXAgPSAxNzUsXHJcbiAgICAgICAgTWVkaWFOZXh0VHJhY2sgPSAxNzYsXHJcbiAgICAgICAgTWVkaWFQcmV2aW91c1RyYWNrID0gMTc3LFxyXG4gICAgICAgIE1lZGlhU3RvcCA9IDE3OCxcclxuICAgICAgICBNZWRpYVBsYXlQYXVzZSA9IDE3OSxcclxuICAgICAgICBMYXVuY2hNYWlsID0gMTgwLFxyXG4gICAgICAgIFNlbGVjdE1lZGlhID0gMTgxLFxyXG4gICAgICAgIExhdW5jaEFwcGxpY2F0aW9uMSA9IDE4MixcclxuICAgICAgICBMYXVuY2hBcHBsaWNhdGlvbjIgPSAxODMsXHJcbiAgICAgICAgT2VtU2VtaWNvbG9uID0gMTg2LFxyXG4gICAgICAgIE9lbTEgPSAxODYsXHJcbiAgICAgICAgT2VtcGx1cyA9IDE4NyxcclxuICAgICAgICBPZW1jb21tYSA9IDE4OCxcclxuICAgICAgICBPZW1NaW51cyA9IDE4OSxcclxuICAgICAgICBPZW1QZXJpb2QgPSAxOTAsXHJcbiAgICAgICAgT2VtUXVlc3Rpb24gPSAxOTEsXHJcbiAgICAgICAgT2VtMiA9IDE5MSxcclxuICAgICAgICBPZW10aWxkZSA9IDE5MixcclxuICAgICAgICBPZW0zID0gMTkyLFxyXG4gICAgICAgIE9lbU9wZW5CcmFja2V0cyA9IDIxOSxcclxuICAgICAgICBPZW00ID0gMjE5LFxyXG4gICAgICAgIE9lbVBpcGUgPSAyMjAsXHJcbiAgICAgICAgT2VtNSA9IDIyMCxcclxuICAgICAgICBPZW1DbG9zZUJyYWNrZXRzID0gMjIxLFxyXG4gICAgICAgIE9lbTYgPSAyMjEsXHJcbiAgICAgICAgT2VtUXVvdGVzID0gMjIyLFxyXG4gICAgICAgIE9lbTcgPSAyMjIsXHJcbiAgICAgICAgT2VtOCA9IDIyMyxcclxuICAgICAgICBPZW1CYWNrc2xhc2ggPSAyMjYsXHJcbiAgICAgICAgT2VtMTAyID0gMjI2LFxyXG4gICAgICAgIFByb2Nlc3NLZXkgPSAyMjksXHJcbiAgICAgICAgUGFja2V0ID0gMjMxLFxyXG4gICAgICAgIEF0dG4gPSAyNDYsXHJcbiAgICAgICAgQ3JzZWwgPSAyNDcsXHJcbiAgICAgICAgRXhzZWwgPSAyNDgsXHJcbiAgICAgICAgRXJhc2VFb2YgPSAyNDksXHJcbiAgICAgICAgUGxheSA9IDI1MCxcclxuICAgICAgICBab29tID0gMjUxLFxyXG4gICAgICAgIE5vTmFtZSA9IDI1MixcclxuICAgICAgICBQYTEgPSAyNTMsXHJcbiAgICAgICAgT2VtQ2xlYXIgPSAyNTQsXHJcbiAgICAgICAgS2V5Q29kZSA9IDY1NTM1LFxyXG4gICAgICAgIFNoaWZ0ID0gNjU1MzYsXHJcbiAgICAgICAgQ29udHJvbCA9IDEzMTA3MixcclxuICAgICAgICBBbHQgPSAyNjIxNDQ7XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2U7XHJcbnVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxudXNpbmcgU3lzdGVtLkxpbnE7XHJcbnVzaW5nIFN5c3RlbS5UZXh0O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgTGF5b3V0Q29udGFpbmVyXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIExpc3Q8TGF5b3V0Q29sdW1uPiBDb2x1bW5zID0gbmV3IExpc3Q8TGF5b3V0Q29sdW1uPigpO1xyXG4gICAgICAgIHB1YmxpYyBpbnQgQ29sdW1uV2lkdGg7XHJcbiAgICAgICAgcHVibGljIGludCBDb250cm9sTWFyZ2luO1xyXG4gICAgICAgIHByaXZhdGUgYm9vbCBhcHBsaWVkTGF5b3V0ID0gZmFsc2U7XHJcbiAgICAgICAgcHVibGljIGludCBCdXR0aW5XaWR0aCA9IDczO1xyXG4gICAgICAgIHB1YmxpYyBMaXN0PExheW91dENvbnRyb2w+IENvbnRyb2xzID0gbmV3IExpc3Q8TGF5b3V0Q29udHJvbD4oKTtcclxuICAgICAgICBwdWJsaWMgTGlzdDxMYXlvdXRDb250cm9sPiBDb250cm9sRWRpdGFibGUgPSBuZXcgTGlzdDxMYXlvdXRDb250cm9sPigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBZGRJbnB1dChzdHJpbmcgbGlua0ZpZWxkLCBUZXh0SW5wdXQgaW5wdXQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgY2wgPSBuZXcgTGF5b3V0Q29udHJvbChsaW5rRmllbGQsIGlucHV0KTtcclxuICAgICAgICAgICAgQ29udHJvbHMuQWRkKGNsKTtcclxuICAgICAgICAgICAgaWYoIWlucHV0LlJlYWRvbmx5KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDb250cm9sRWRpdGFibGUuQWRkKGNsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgVGFiSW5kZXggPSAyO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBBcHBsaWVkTGF5b3V0KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBhcHBsaWVkTGF5b3V0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExheW91dENvbnRyb2wgR2V0Q29udHJvbChzdHJpbmcgbmFtZSwgYm9vbCBhbGxvd1JlYWRvbmx5ID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lID0gbmFtZS5Ub0xvd2VyKCk7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmKGFsbG93UmVhZG9ubHkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBDb250cm9scy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKENvbnRyb2xzW2ldLkxpbmtGaWVsZE5hbWUuVG9Mb3dlcigpID09IG5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29udHJvbHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgQ29udHJvbEVkaXRhYmxlLkNvdW50OyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQ29udHJvbEVkaXRhYmxlW2ldLkxpbmtGaWVsZE5hbWUuVG9Mb3dlcigpID09IG5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29udHJvbEVkaXRhYmxlW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIEdldFRleHQoc3RyaW5nIG5hbWUsIGJvb2wgYWxsb3dSZWFkeU9ubHkgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWw6OkJyaWRnZS5TY3JpcHQuVG9UZW1wKFwia2V5MVwiLEdldENvbnRyb2wobmFtZSwgYWxsb3dSZWFkeU9ubHkpKSE9bnVsbCYmZ2xvYmFsOjpCcmlkZ2UuU2NyaXB0LlRvVGVtcChcImtleTJcIixnbG9iYWw6OkJyaWRnZS5TY3JpcHQuRnJvbVRlbXA8TGF5b3V0Q29udHJvbD4oXCJrZXkxXCIpLklucHV0KSE9bnVsbD9nbG9iYWw6OkJyaWRnZS5TY3JpcHQuRnJvbVRlbXA8VGV4dElucHV0PihcImtleTJcIikuVGV4dDooc3RyaW5nKW51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldEVkaXRWYWx1ZShzdHJpbmcgbmFtZSwgYm9vbCBhbGxvd1JlYWR5T25seSA9IGZhbHNlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbDo6QnJpZGdlLlNjcmlwdC5Ub1RlbXAoXCJrZXkzXCIsR2V0Q29udHJvbChuYW1lLCBhbGxvd1JlYWR5T25seSkpIT1udWxsJiZnbG9iYWw6OkJyaWRnZS5TY3JpcHQuVG9UZW1wKFwia2V5NFwiLGdsb2JhbDo6QnJpZGdlLlNjcmlwdC5Gcm9tVGVtcDxMYXlvdXRDb250cm9sPihcImtleTNcIikuSW5wdXQpIT1udWxsP2dsb2JhbDo6QnJpZGdlLlNjcmlwdC5Gcm9tVGVtcDxUZXh0SW5wdXQ+KFwia2V5NFwiKS5HZXRFZGl0VmFsdWUoKToob2JqZWN0KW51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTZXRUZXh0KHN0cmluZyBuYW1lLCBzdHJpbmcgdmFsdWUsIGJvb2wgYWxsb3dSZWFkeU9ubHkgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IGdsb2JhbDo6QnJpZGdlLlNjcmlwdC5Ub1RlbXAoXCJrZXk1XCIsR2V0Q29udHJvbChuYW1lLCBhbGxvd1JlYWR5T25seSkpIT1udWxsP2dsb2JhbDo6QnJpZGdlLlNjcmlwdC5Gcm9tVGVtcDxMYXlvdXRDb250cm9sPihcImtleTVcIikuSW5wdXQ6KFRleHRJbnB1dCludWxsO1xyXG4gICAgICAgICAgICBpZihpbnB1dCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgaW5wdXQuVGV4dCA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgRm9jdXMoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGlmKENvbnRyb2xzID09IG51bGwgfHwgQ29udHJvbHMuQ291bnQgPT0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdmFyIGlucHV0ID0gU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5GaXJzdE9yRGVmYXVsdDxnbG9iYWw6OkV4cHJlc3NDcmFmdC5MYXlvdXRDb250cm9sPihDb250cm9scykuSW5wdXQ7XHJcbiAgICAgICAgICAgIHZhciB4ID0gaW5wdXQuR2V0SW5wdXQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKHggIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgeC5Gb2N1c0VsZW1lbnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlucHV0LkNvbnRlbnQuRm9jdXNFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMYXlvdXRDb250YWluZXIoaW50IGNvbHVtbldpZHRoID0gNTAwLCBpbnQgY29udHJvbE1hcmdpbiA9IDYsIHBhcmFtcyBMYXlvdXRDb2x1bW5bXSBjb2x1bW5zKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ29sdW1uV2lkdGggPSBjb2x1bW5XaWR0aDtcclxuICAgICAgICAgICAgQ29udHJvbE1hcmdpbiA9IGNvbnRyb2xNYXJnaW47XHJcblxyXG4gICAgICAgICAgICBpZihjb2x1bW5zICE9IG51bGwgJiYgY29sdW1ucy5MZW5ndGggPiAwKVxyXG4gICAgICAgICAgICAgICAgQ29sdW1ucy5BZGRSYW5nZShjb2x1bW5zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMYXlvdXRDb250YWluZXIoaW50IGNvbHVtbldpZHRoID0gNTAwLCBpbnQgY29udHJvbE1hcmdpbiA9IDYsIGludCBidXR0b25XaWR0aCA9IDczLCBwYXJhbXMgTGF5b3V0Q29sdW1uW10gY29sdW1ucylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENvbHVtbldpZHRoID0gY29sdW1uV2lkdGg7XHJcbiAgICAgICAgICAgIENvbnRyb2xNYXJnaW4gPSBjb250cm9sTWFyZ2luO1xyXG4gICAgICAgICAgICBCdXR0aW5XaWR0aCA9IGJ1dHRvbldpZHRoO1xyXG5cclxuICAgICAgICAgICAgaWYoY29sdW1ucyAhPSBudWxsICYmIGNvbHVtbnMuTGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgIENvbHVtbnMuQWRkUmFuZ2UoY29sdW1ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGF5b3V0Q29udGFpbmVyKHBhcmFtcyBMYXlvdXRDb2x1bW5bXSBjb2x1bW5zKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ29sdW1uV2lkdGggPSA1MDA7XHJcbiAgICAgICAgICAgIENvbnRyb2xNYXJnaW4gPSA2O1xyXG5cclxuICAgICAgICAgICAgaWYoY29sdW1ucyAhPSBudWxsICYmIGNvbHVtbnMuTGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgIENvbHVtbnMuQWRkUmFuZ2UoY29sdW1ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIENyZWF0ZUxvYWRTUUwoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGJ1aWxkZXJTUUwgPSBuZXcgU3RyaW5nQnVpbGRlcigpO1xyXG5cclxuICAgICAgICAgICAgaW50IGxlbmd0aCA9IENvbnRyb2xzLkNvdW50O1xyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKENvbnRyb2xzW2ldID09IG51bGwgfHwgQ29udHJvbHNbaV0uSW5wdXQgPT0gbnVsbCB8fCBzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKENvbnRyb2xzW2ldLkxpbmtGaWVsZE5hbWUpKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgYnVpbGRlclNRTC5BcHBlbmQoXCJgXCIgKyBDb250cm9sc1tpXS5MaW5rRmllbGROYW1lICsgXCJgLCBcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRyb2wgPSBDb250cm9sc1tpXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihjb250cm9sLklucHV0IGlzIFNlYXJjaElucHV0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2ggPSBjb250cm9sLklucHV0LkFzPFNlYXJjaElucHV0PigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdFZhbHVlID0gKHNlYXJjaC5FZGl0VmFsdWUgKyBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2guRGlzcGxheU1lbWJlciA9PSBzZWFyY2guVmFsdWVNZW1iZXIgfHwgc2VhcmNoLlZhbHVlTWVtYmVyID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudFRyYW5zYWN0aW9uLkFkZENvbWJvKGNvbnRyb2wuTGlua0ZpZWxkTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9zZWFyY2guVGV4dCwgc2VhcmNoLlRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsb25nIGVkaXR2ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9uZy5UcnlQYXJzZShlZGl0VmFsdWUsIG91dCBlZGl0dik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudFRyYW5zYWN0aW9uLkFkZENvbWJvKGNvbnRyb2wuTGlua0ZpZWxkTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9lZGl0diwgc2VhcmNoLlRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKGNvbnRyb2wuSW5wdXQuQ29udHJvbGxlciAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNvbnRyb2wuSW5wdXQuQ29udHJvbGxlciBpcyBDaGVja0VkaXQpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RvY3VtZW50VHJhbnNhY3Rpb24uQWRkQm9vbGVhbihjb250cm9sLkxpbmtGaWVsZE5hbWUsIChjb250cm9sLklucHV0LkNvbnRyb2xsZXIuQXM8Q2hlY2tFZGl0PigpLkNoZWNrZWQpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihjb250cm9sLklucHV0LklzTnVtZXJpY1R5cGUoKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3ZhciBkZWMgPSBjb250cm9sLklucHV0LkdldE51bWJlclZhbHVlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vZG9jdW1lbnRUcmFuc2FjdGlvbi5BZGROdW1lcihjb250cm9sLkxpbmtGaWVsZE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgLy9kZWMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZihjb250cm9sLklucHV0LklzRGF0ZVR5cGUoKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3ZhciBkYXRlID0gY29udHJvbC5JbnB1dC5HZXREYXRlVGltZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2RvY3VtZW50VHJhbnNhY3Rpb24uQWRkRGF0ZShjb250cm9sLkxpbmtGaWVsZE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgLy9kYXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2RvY3VtZW50VHJhbnNhY3Rpb24uQWRkU3RyaW5nKGNvbnRyb2wuTGlua0ZpZWxkTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2wuSW5wdXQuVGV4dCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBidWlsZGVyU1FMLlRvU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBcHBseVJlYWRPbmx5KGJvb2wgZG9jdW1lbnRyZWFkb25seSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludCBsZW5ndGggPSBDb250cm9sRWRpdGFibGUuQ291bnQ7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQXBwbHlSZWFkT25seU9uQ29udHJvbChkb2N1bWVudHJlYWRvbmx5LCBDb250cm9sRWRpdGFibGVbaV0uSW5wdXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgdm9pZCBBcHBseVJlYWRPbmx5T25Db250cm9sKGJvb2wgZG9jdW1lbnRyZWFkb25seSwgVGV4dElucHV0IGlucHV0KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoaW5wdXQuQ29udHJvbGxlciAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihpbnB1dC5Db250cm9sbGVyIGlzIENoZWNrRWRpdClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnB1dC5FbmFibGVkID0gIWRvY3VtZW50cmVhZG9ubHk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihpbnB1dCBpcyBUZXh0SW5wdXREcm9wRG93bilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnB1dC5BczxUZXh0SW5wdXREcm9wRG93bj4oKS5HZXRJbnB1dCgpLlJlYWRPbmx5ID0gZG9jdW1lbnRyZWFkb25seTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlucHV0LlJlYWRvbmx5ID0gZG9jdW1lbnRyZWFkb25seTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgdm9pZCBPbkNvbnRyb2xDcmVhdGVkKExheW91dENvbnRyb2wgQ29udHJvbClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBcHBseShDb250cm9sIHBhcmVudCwgYm9vbCBkb2N1bWVudHJlYWRvbmx5ID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihwYXJlbnQgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFeGNlcHRpb24oKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGFwcGxpZWRMYXlvdXQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGFwcGxpZWRMYXlvdXQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaW50IGxlZnRNYXJnaW4gPSAxMDtcclxuICAgICAgICAgICAgaW50IHRvcE1hcmdpbiA9IDU7XHJcblxyXG4gICAgICAgICAgICBpbnQgbGVmdExhYmVsID0gMTU7XHJcblxyXG4gICAgICAgICAgICBpbnQgY3VycmVudExlZnQgPSBsZWZ0TWFyZ2luO1xyXG4gICAgICAgICAgICBpbnQgQXBwZW5kWCA9IDA7XHJcbiAgICAgICAgICAgIGludCBBcHBlbmRZID0gMDtcclxuXHJcbiAgICAgICAgICAgIGludCBFZGl0U3RhcnRYID0gMTI1O1xyXG5cclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEVkaXRTdGFydFggPSAxNTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGludCBYSW5jcmVtZW50ID0gbGVmdE1hcmdpbiArIENvbHVtbldpZHRoO1xyXG5cclxuICAgICAgICAgICAgaW50IGlucHV0SGVpZ2h0O1xyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQnV0dGluV2lkdGggPSAwO1xyXG4gICAgICAgICAgICAgICAgaW5wdXRIZWlnaHQgPSA0NTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlucHV0SGVpZ2h0ID0gMjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW50IEdyb3VwTGFiZWxJbmNyZW1lbnQgPSBDb250cm9sTWFyZ2luICsgKEhlbHBlci5Ob3REZXNrdG9wID8gKGlucHV0SGVpZ2h0IC0gMzApIDogKGlucHV0SGVpZ2h0IC0gNCkpO1xyXG4gICAgICAgICAgICBpbnQgUm93SW5jcmVtZW50ID0gaW5wdXRIZWlnaHQgKyBDb250cm9sTWFyZ2luO1xyXG5cclxuICAgICAgICAgICAgaW50IFRpbnlMYWJlbEluY3JlbWVudCA9IGlucHV0SGVpZ2h0IC0gODtcclxuXHJcbiAgICAgICAgICAgIGZvcmVhY2godmFyIGNvbHVtbiBpbiBDb2x1bW5zKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXV0b0RpdiA9IG5ldyBDb250cm9sKCk7XHJcbiAgICAgICAgICAgICAgICBmbG9hdCB5ID0gdG9wTWFyZ2luO1xyXG4gICAgICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0b0Rpdi5XaWR0aCA9IFwiKDEwMCUgLSAxMnB4KVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dG9EaXYuVG9wID0gQXBwZW5kWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRvRGl2LlRvcCA9IHk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0b0Rpdi5XaWR0aCA9IENvbHVtbldpZHRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYXV0b0Rpdi5MZWZ0ID0gQXBwZW5kWDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jRnJhZ21lbnQgPSBEb2N1bWVudC5DcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IGNvbHVtbi5Hcm91cHM7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yZWFjaCh2YXIgZ3JvdXAgaW4gZ3JvdXBzKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGdyb3VwLkdyb3VwTGFiZWwpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gQ29udHJvbC5MYWJlbChncm91cC5Hcm91cExhYmVsLCBjdXJyZW50TGVmdCwgeSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbC5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY0ZyYWdtZW50LkFwcGVuZENoaWxkKGxhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeSArPSBHcm91cExhYmVsSW5jcmVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcm93cyA9IGdyb3VwLlJvd3M7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvcmVhY2godmFyIHJvdyBpbiByb3dzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocm93IGlzIExheW91dFJvd0NvbnRyb2wpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0IGhlaWdodCA9IHJvdy5BczxMYXlvdXRSb3dDb250cm9sPigpLkhlaWdodDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udHJvbCA9IHJvdy5BczxMYXlvdXRSb3dDb250cm9sPigpLkNvbnRyb2w7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udHJvbCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuSGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuTGVmdCA9IGN1cnJlbnRMZWZ0ICsgbGVmdExhYmVsOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5Ub3AgPSB5O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuV2lkdGggPSBcIigxMDAlIC0gXCIgKyAoY3VycmVudExlZnQgKyAobGVmdExhYmVsICogMi4wZikpICsgXCJweClcIjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5XaWR0aCA9IENvbHVtbldpZHRoIC0gY3VycmVudExlZnQgLSAobGVmdExhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY0ZyYWdtZW50LkFwcGVuZENoaWxkKGNvbnRyb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICs9IENvbnRyb2xNYXJnaW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSArPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShyb3cuTGFiZWwpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBDb250cm9sLkxhYmVsKHJvdy5MYWJlbCwgY3VycmVudExlZnQgKyBsZWZ0TGFiZWwgKyAoZmxvYXQpcm93Lk9mZnNldCwgeSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwuU3R5bGUuRm9udFNpemUgPSBcIjEycHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICs9IEdyb3VwTGFiZWxJbmNyZW1lbnQgLSA1O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jRnJhZ21lbnQuQXBwZW5kQ2hpbGQobGFiZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihyb3cgaXMgTGF5b3V0Um93R2FwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICs9IHJvdy5BczxMYXlvdXRSb3dHYXA+KCkuSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJvdy5CdXR0b24gIT0gbnVsbCAmJiAhSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5CdXR0b24uTG9jYXRpb24gPSBuZXcgVmVjdG9yMihDb2x1bW5XaWR0aCAtIEJ1dHRpbldpZHRoICsgNiwgeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cuQnV0dG9uLldpZHRoID0gQnV0dGluV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2NGcmFnbWVudC5BcHBlbmRDaGlsZChyb3cuQnV0dG9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRyb2xzID0gcm93LkNvbnRyb2xzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBib29sIEhhc1RpbnlMYWJlbCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udHJvbHMuQ291bnQgPiAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNpbWFsIFRvdGFsUGVyY2VudCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVG90YWxQZXJjZW50ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBBZGRXaWR0aCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKHZhciBjb250cm9sIGluIGNvbnRyb2xzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNvbnRyb2wuUGVyY2VudCA+IDEuMG0gfHwgY29udHJvbC5QZXJjZW50IDw9IDAuMG0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuUGVyY2VudCA9IDEuMG07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvdGFsUGVyY2VudCArPSBjb250cm9sLlBlcmNlbnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKFRvdGFsUGVyY2VudCA+IDEuMG0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjb250cm9sLklucHV0IGlzIE1lbW9JbnB1dClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSArPSBjb250cm9sLklucHV0LkhlaWdodC5Ub0ludCgpICsgQ29udHJvbE1hcmdpbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgKz0gUm93SW5jcmVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyb3cuTm9HYXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5IC09IENvbnRyb2xNYXJnaW4gKyAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoSGFzVGlueUxhYmVsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICs9IFRpbnlMYWJlbEluY3JlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhhc1RpbnlMYWJlbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb3RhbFBlcmNlbnQgLT0gMS4wbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWRkV2lkdGggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdCBBZGQgPSAoY3VycmVudExlZnQgKyBBZGRXaWR0aCArIEVkaXRTdGFydFggKyBCdXR0aW5XaWR0aCArIChmbG9hdClyb3cuT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgbzEwMFBlcmNlbnQgPSBcIigoMTAwJSAtIFwiICsgQWRkLlRvUHgoKSArIFwiKSAqIFwiICsgKFRvdGFsUGVyY2VudCAtIGNvbnRyb2wuUGVyY2VudCkgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgbzEwMFBlcmNlbnQyID0gXCIoMTAwJSAtIFwiICsgQWRkLlRvUHgoKSArIFwiKVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IHdpZHRoID0gXCIoXCIgKyBvMTAwUGVyY2VudDIgKyBcIiAqIFwiICsgY29udHJvbC5QZXJjZW50ICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMiBsb2MgPSBuZXcgVmVjdG9yMihcIihcIiArIG8xMDBQZXJjZW50ICsgXCIgKyBcIiArIChBZGQgLSBCdXR0aW5XaWR0aCkuVG9QeCgpICsgXCIpXCIsIHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFyb3cuTm9HYXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGRXaWR0aCArPSA2O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udHJvbC5JbnB1dC5Db250cm9sbGVyICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLklucHV0LkNvbnRyb2xsZXIuV2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5JbnB1dC5Db250cm9sbGVyLkxvY2F0aW9uID0gbG9jO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLklucHV0LkNvbnRlbnQuVGFiSW5kZXggPSBUYWJJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5JbnB1dC5DbGFzc0xpc3QuUmVtb3ZlKFwiY29udHJvbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udHJvbC5JbnB1dC5Db250cm9sbGVyIGlzIENoZWNrRWRpdClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBjb250cm9sLklucHV0LkNvbnRyb2xsZXIuQXM8Q2hlY2tFZGl0PigpLnNwYW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLlN0eWxlLlRvcCA9IFwiMFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbi5TdHlsZS5MZWZ0ID0gKGlucHV0SGVpZ2h0IC0gMikuVG9QeCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4uU3R5bGUuUG9zaXRpb24gPSBQb3NpdGlvbi5BYnNvbHV0ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLlN0eWxlLldoaXRlU3BhY2UgPSBXaGl0ZVNwYWNlLlByZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc3Bhbi5TdHlsZS5UcmFuc2Zvcm0gPSBcInRyYW5zbGF0ZSgzcHgsIDUwJSlcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4uU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLlN0eWxlLldoaXRlU3BhY2UgPSBXaGl0ZVNwYWNlLk5vcm1hbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjb250cm9sLklucHV0LkNvbnRlbnQuQXM8SFRNTElucHV0RWxlbWVudD4oKS5UeXBlID09IElucHV0VHlwZS5DaGVja2JveClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLklucHV0LldpZHRoID0gKGlucHV0SGVpZ2h0IC0gNCkuVG9QeCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuSW5wdXQuSGVpZ2h0ID0gKGlucHV0SGVpZ2h0IC0gNCkuVG9QeCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2NGcmFnbWVudC5BcHBlbmRDaGlsZChjb250cm9sLklucHV0LkNvbnRyb2xsZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLklucHV0LldpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuSW5wdXQuTG9jYXRpb24gPSBsb2M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuSW5wdXQuR2V0SW5wdXQoKS5UYWJJbmRleCA9IFRhYkluZGV4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jRnJhZ21lbnQuQXBwZW5kQ2hpbGQoY29udHJvbC5JbnB1dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5JbnB1dC5IZWlnaHQgPSBpbnB1dEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5JbnB1dC5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udHJvbC5JbnB1dC5HZXRJbnB1dCgpICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuSW5wdXQuR2V0SW5wdXQoKS5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPbkNvbnRyb2xDcmVhdGVkKGNvbnRyb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighcm93Lk5vR2FwICYmICFyb3cuSGlkZVRpbnlMYWJlbCAmJiAhc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShjb250cm9sLlRpbnlMYWJlbCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBDb250cm9sLkxhYmVsKGNvbnRyb2wuVGlueUxhYmVsLCAwLCB5ICsgKGlucHV0SGVpZ2h0ICsgMyksIGZhbHNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwuU3R5bGUuTGVmdCA9IFwiY2FsYyhcIiArIG8xMDBQZXJjZW50ICsgXCIgKyBcIiArIChBZGQgLSBCdXR0aW5XaWR0aCkuVG9QeCgpICsgXCIpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY0ZyYWdtZW50LkFwcGVuZENoaWxkKGxhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsLlN0eWxlLkZvbnRTaXplID0gXCIxMnB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGFzVGlueUxhYmVsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJvdy5Vc2VQbGFjZWhvbGRlciAmJiAhc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShjb250cm9sLlRpbnlMYWJlbCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLklucHV0LlNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIGNvbnRyb2wuVGlueUxhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29udHJvbC5JbnB1dC5Ub29sVGlwID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2Uocm93LkxhYmVsKSAmJiBzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGdyb3VwLkdyb3VwTGFiZWwpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuSW5wdXQuVG9vbFRpcCA9IG5ldyBUb29sVGlwKGNvbnRyb2wuVGlueUxhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLklucHV0LlRvb2xUaXAgPSBuZXcgVG9vbFRpcChzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKHJvdy5MYWJlbCkgPyBncm91cC5Hcm91cExhYmVsIDogcm93LkxhYmVsLCBjb250cm9sLlRpbnlMYWJlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhYkluZGV4Kys7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFjb250cm9sLklucHV0LlJlYWRvbmx5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXBwbHlSZWFkT25seU9uQ29udHJvbChkb2N1bWVudHJlYWRvbmx5LCBjb250cm9sLklucHV0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udHJvbEVkaXRhYmxlLkFkZChjb250cm9sKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udHJvbHMuQWRkKGNvbnRyb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEhhc1RpbnlMYWJlbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICs9IFRpbnlMYWJlbEluY3JlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0ID0gU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5MYXN0T3JEZWZhdWx0PGdsb2JhbDo6RXhwcmVzc0NyYWZ0LkxheW91dENvbnRyb2w+KHJvdy5Db250cm9scyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsYXN0ICE9IG51bGwgJiYgbGFzdC5JbnB1dCBpcyBNZW1vSW5wdXQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSArPSBsYXN0LklucHV0LkhlaWdodC5Ub0ludCgpICsgQ29udHJvbE1hcmdpbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICs9IFJvd0luY3JlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGF1dG9EaXYuSGVpZ2h0ID0geTtcclxuICAgICAgICAgICAgICAgIGlmKCFIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBBcHBlbmRYICs9IFhJbmNyZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQXBwZW5kWSArPSAoaW50KXk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhdXRvRGl2LkNvbnRlbnQuQXBwZW5kQ2hpbGQoZG9jRnJhZ21lbnQpO1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LkNvbnRlbnQuQXBwZW5kQ2hpbGQoYXV0b0Rpdik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIExhc3RDb250cm9sID0gU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5MYXN0T3JEZWZhdWx0PGdsb2JhbDo6RXhwcmVzc0NyYWZ0LkxheW91dENvbnRyb2w+KENvbnRyb2xzKTtcclxuICAgICAgICAgICAgaWYoTGFzdENvbnRyb2wgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIEZpcnN0Q29udHJvbCA9IFN5c3RlbS5MaW5xLkVudW1lcmFibGUuRmlyc3RPckRlZmF1bHQ8Z2xvYmFsOjpFeHByZXNzQ3JhZnQuTGF5b3V0Q29udHJvbD4oQ29udHJvbHMpO1xyXG5cclxuICAgICAgICAgICAgICAgIEFjdGlvbjxLZXlib2FyZEV2ZW50PiBQcmV2ZW50RGVmYXVsdE1vdmVGb3J3YXJkID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGV2LktleUNvZGUgPT0gOSAmJiAhZXYuU2hpZnRLZXkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IEZpcnN0Q29udHJvbC5JbnB1dC5HZXRJbnB1dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih4ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4LkZvY3VzRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhc3RDb250cm9sLklucHV0LkNvbnRlbnQuRm9jdXNFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIEFjdGlvbjxLZXlib2FyZEV2ZW50PiBQcmV2ZW50RGVmYXVsdE1vdmVCYWNrID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGV2LktleUNvZGUgPT0gOSAmJiBldi5TaGlmdEtleSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gTGFzdENvbnRyb2wuSW5wdXQuR2V0SW5wdXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeC5Gb2N1c0VsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXN0Q29udHJvbC5JbnB1dC5Db250ZW50LkZvY3VzRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBMYXN0Q29udHJvbC5JbnB1dC5Db250ZW50Lk9uS2V5RG93biA9IFByZXZlbnREZWZhdWx0TW92ZUZvcndhcmQ7XHJcbiAgICAgICAgICAgICAgICBGaXJzdENvbnRyb2wuSW5wdXQuQ29udGVudC5PbktleURvd24gPSBQcmV2ZW50RGVmYXVsdE1vdmVCYWNrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBMYXlvdXRDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBMaW5rRmllbGROYW1lIHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwdWJsaWMgVGV4dElucHV0IElucHV0IHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIFRpbnlMYWJlbCB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHVibGljIGRlY2ltYWwgUGVyY2VudCB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gQ2FsY3VsYXRlZFxyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBXaWR0aCB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gQ2FsY3VsYXRlZFxyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgcHVibGljIGRlY2ltYWwgTGluZU51bWJlciB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMYXlvdXRDb250cm9sKHN0cmluZyBsaW5rRmllbGROYW1lLCBUZXh0SW5wdXQgaW5wdXQsIHN0cmluZyB0aW55TGFiZWwgPSBcIlwiLCBkZWNpbWFsIHBlcmNlbnQgPSAxKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTGlua0ZpZWxkTmFtZSA9IGxpbmtGaWVsZE5hbWU7XHJcbiAgICAgICAgICAgIElucHV0ID0gaW5wdXQ7XHJcbiAgICAgICAgICAgIFRpbnlMYWJlbCA9IHRpbnlMYWJlbDtcclxuICAgICAgICAgICAgUGVyY2VudCA9IHBlcmNlbnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGF5b3V0Q29udHJvbChzdHJpbmcgbGlua0ZpZWxkTmFtZSwgVGV4dElucHV0IGlucHV0LCBkZWNpbWFsIHBlcmNlbnQgPSAxKSA6IHRoaXMobGlua0ZpZWxkTmFtZSwgaW5wdXQsIFwiXCIsIHBlcmNlbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExheW91dENvbnRyb2woc3RyaW5nIGxpbmtGaWVsZE5hbWUsIFRleHRJbnB1dCBpbnB1dCkgOiB0aGlzKGxpbmtGaWVsZE5hbWUsIGlucHV0LCBcIlwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIExheW91dENvbHVtblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBMaXN0PExheW91dEdyb3VwPiBHcm91cHMgPSBuZXcgTGlzdDxMYXlvdXRHcm91cD4oKTtcclxuXHJcbiAgICAgICAgcHVibGljIExheW91dENvbHVtbihwYXJhbXMgTGF5b3V0R3JvdXBbXSBncm91cHMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihncm91cHMgIT0gbnVsbCAmJiBncm91cHMuTGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgIEdyb3Vwcy5BZGRSYW5nZShncm91cHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgTGF5b3V0R3JvdXBcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgTGlzdDxMYXlvdXRSb3c+IFJvd3MgPSBuZXcgTGlzdDxMYXlvdXRSb3c+KCk7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBHcm91cExhYmVsIHsgZ2V0OyBzZXQ7IH1cclxuXHJcbiAgICAgICAgcHVibGljIExheW91dEdyb3VwKHBhcmFtcyBMYXlvdXRSb3dbXSByb3dzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgR3JvdXBMYWJlbCA9IHN0cmluZy5FbXB0eTtcclxuICAgICAgICAgICAgaWYocm93cyAhPSBudWxsICYmIHJvd3MuTGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgIFJvd3MuQWRkUmFuZ2Uocm93cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgTGF5b3V0R3JvdXAoc3RyaW5nIGdyb3VwTGFiZWwsIHBhcmFtcyBMYXlvdXRSb3dbXSByb3dzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgR3JvdXBMYWJlbCA9IGdyb3VwTGFiZWw7XHJcbiAgICAgICAgICAgIGlmKHJvd3MgIT0gbnVsbCAmJiByb3dzLkxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICBSb3dzLkFkZFJhbmdlKHJvd3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgTGF5b3V0Um93R2FwIDogTGF5b3V0Um93XHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIGZsb2F0IEhlaWdodDtcclxuXHJcbiAgICAgICAgcHVibGljIExheW91dFJvd0dhcChmbG9hdCBoZWlnaHQsIHN0cmluZyBsYWJlbCA9IFwiXCIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBIZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgIExhYmVsID0gbGFiZWw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBMYXlvdXRSb3dDb250cm9sIDogTGF5b3V0Um93XHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIGZsb2F0IEhlaWdodDtcclxuICAgICAgICBwdWJsaWMgQ29udHJvbCBDb250cm9sO1xyXG5cclxuICAgICAgICBwdWJsaWMgTGF5b3V0Um93Q29udHJvbChmbG9hdCBoZWlnaHQsIENvbnRyb2wgY29udHJvbClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgTGFiZWwgPSBcIlwiO1xyXG4gICAgICAgICAgICBDb250cm9sID0gY29udHJvbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIExheW91dFJvd1xyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBMaXN0PExheW91dENvbnRyb2w+IENvbnRyb2xzID0gbmV3IExpc3Q8TGF5b3V0Q29udHJvbD4oKTtcclxuICAgICAgICBwdWJsaWMgc3RyaW5nIExhYmVsIHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIEJ1dHRvbiB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gSWYgdGhpcyBpcyB0cnVlIC0gdGlueSBsYWJlbHMgYXJlIGlnbm9yZWRcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIHB1YmxpYyBib29sIE5vR2FwIHsgZ2V0OyBzZXQ7IH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgVXNlUGxhY2Vob2xkZXIgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHB1YmxpYyBib29sIEhpZGVUaW55TGFiZWwgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHB1YmxpYyBkZWNpbWFsIE9mZnNldCB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMYXlvdXRSb3coc3RyaW5nIGxhYmVsLCBwYXJhbXMgTGF5b3V0Q29udHJvbFtdIGNvbnRyb2xzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTGFiZWwgPSBsYWJlbDtcclxuICAgICAgICAgICAgaWYoY29udHJvbHMgIT0gbnVsbCAmJiBjb250cm9scy5MZW5ndGggPiAwKVxyXG4gICAgICAgICAgICAgICAgQ29udHJvbHMuQWRkUmFuZ2UoY29udHJvbHMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExheW91dFJvdyhwYXJhbXMgTGF5b3V0Q29udHJvbFtdIGNvbnRyb2xzKSA6IHRoaXMoXCJcIiwgY29udHJvbHMpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExheW91dFJvdyhkZWNpbWFsIG9mZnNldCwgcGFyYW1zIExheW91dENvbnRyb2xbXSBjb250cm9scykgOiB0aGlzKFwiXCIsIGNvbnRyb2xzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgT2Zmc2V0ID0gb2Zmc2V0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExheW91dFJvdyhzdHJpbmcgbGFiZWwsIFNpbXBsZUJ1dHRvbiBidXR0b24sIHBhcmFtcyBMYXlvdXRDb250cm9sW10gY29udHJvbHMpIDogdGhpcyhsYWJlbCwgY29udHJvbHMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBCdXR0b24gPSBidXR0b247XHJcbiAgICAgICAgfVxyXG5cbiAgICBcbnByaXZhdGUgYm9vbCBfX1Byb3BlcnR5X19Jbml0aWFsaXplcl9fTm9HYXA9ZmFsc2U7cHJpdmF0ZSBib29sIF9fUHJvcGVydHlfX0luaXRpYWxpemVyX19Vc2VQbGFjZWhvbGRlcj1mYWxzZTtwcml2YXRlIGJvb2wgX19Qcm9wZXJ0eV9fSW5pdGlhbGl6ZXJfX0hpZGVUaW55TGFiZWw9ZmFsc2U7cHJpdmF0ZSBkZWNpbWFsIF9fUHJvcGVydHlfX0luaXRpYWxpemVyX19PZmZzZXQ9MDt9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIEJyaWRnZS5qUXVlcnkyO1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTmV0d29ya1xyXG4gICAge1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIEFqYXhPcHRpb25zIEdldEFqYXhPcHRpb25zKG9iamVjdCBKc29uRmlsZSwgYm9vbCBBc3luYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEFqYXhPcHRpb25zKClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQXN5bmMgPSBBc3luYyxcclxuICAgICAgICAgICAgICAgIFVybCA9IFNldHRpbmdzLk5ldHdvcmtVUkwsXHJcbiAgICAgICAgICAgICAgICBDYWNoZSA9IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgRGF0YSA9IEpzb25GaWxlID09IG51bGwgPyBzdHJpbmcuRW1wdHkgOiBKU09OLlN0cmluZ2lmeShKc29uRmlsZSksXHJcbiAgICAgICAgICAgICAgICBEYXRhVHlwZSA9IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgQ29udGVudFR5cGUgPSBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgICAgICAgIFR5cGUgPSBcIlBPU1RcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNsYXNzIE1ldGhvZFJlcXVlc3RcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHB1YmxpYyBzdHJpbmcgTWV0aG9kO1xyXG4gICAgICAgICAgICBwdWJsaWMgb2JqZWN0W10gQXJndW1lbnRzO1xyXG4gICAgICAgICAgICBwdWJsaWMgc3RyaW5nIEludGVyZmFjZTtcclxuXHJcbiAgICAgICAgICAgIHB1YmxpYyBNZXRob2RSZXF1ZXN0KHN0cmluZyBpbnRlcmZhY2VOYW1lLCBzdHJpbmcgbWV0aG9kLCBwYXJhbXMgb2JqZWN0W10gYXJndW1lbnRzKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBNZXRob2QgPSBtZXRob2Q7XHJcbiAgICAgICAgICAgICAgICBBcmd1bWVudHMgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgICAgICAgICBJbnRlcmZhY2UgPSBpbnRlcmZhY2VOYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgSW52b2tlTWV0aG9kVUkoc3RyaW5nIGludGVyZmFjZU5hbWUsIHN0cmluZyBtZXRob2QsIEFjdGlvbjxvYmplY3QsIHN0cmluZywganFYSFI+IFN1Y2Nlc3MgPSBudWxsLCBBY3Rpb248anFYSFIsIHN0cmluZywgc3RyaW5nPiBFcnJvciA9IG51bGwsIHBhcmFtcyBvYmplY3RbXSBhcmd1bWVudHMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBQb3N0SnNvblByb2dyZXNzRm9ybShuZXcgTWV0aG9kUmVxdWVzdChpbnRlcmZhY2VOYW1lLCBtZXRob2QsIGFyZ3VtZW50cyksIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248b2JqZWN0LCBzdHJpbmcsIGdsb2JhbDo6QnJpZGdlLmpRdWVyeTIuanFYSFI+KVN1Y2Nlc3MsIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UualF1ZXJ5Mi5qcVhIUiwgc3RyaW5nLCBzdHJpbmc+KUVycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBJbnZva2VNZXRob2RVSUNvbnRyb2woc3RyaW5nIGludGVyZmFjZU5hbWUsIHN0cmluZyBtZXRob2QsIFByb2dyZXNzQ29udHJvbCBwcm9ncmVzc0NvbnRyb2wsIEFjdGlvbjxvYmplY3QsIHN0cmluZywganFYSFI+IFN1Y2Nlc3MgPSBudWxsLCBBY3Rpb248anFYSFIsIHN0cmluZywgc3RyaW5nPiBFcnJvciA9IG51bGwsIHBhcmFtcyBvYmplY3RbXSBhcmd1bWVudHMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBQb3N0SnNvblByb2dyZXNzQ29udHJvbChuZXcgTWV0aG9kUmVxdWVzdChpbnRlcmZhY2VOYW1lLCBtZXRob2QsIGFyZ3VtZW50cyksIHByb2dyZXNzQ29udHJvbCwgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbjxvYmplY3QsIHN0cmluZywgZ2xvYmFsOjpCcmlkZ2UualF1ZXJ5Mi5qcVhIUj4pU3VjY2VzcywgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbjxnbG9iYWw6OkJyaWRnZS5qUXVlcnkyLmpxWEhSLCBzdHJpbmcsIHN0cmluZz4pRXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEludm9rZU1ldGhvZChzdHJpbmcgaW50ZXJmYWNlTmFtZSwgc3RyaW5nIG1ldGhvZCwgQWN0aW9uPG9iamVjdCwgc3RyaW5nLCBqcVhIUj4gU3VjY2VzcyA9IG51bGwsIEFjdGlvbjxqcVhIUiwgc3RyaW5nLCBzdHJpbmc+IEVycm9yID0gbnVsbCwgcGFyYW1zIG9iamVjdFtdIGFyZ3VtZW50cylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFBvc3RKc29uKG5ldyBNZXRob2RSZXF1ZXN0KGludGVyZmFjZU5hbWUsIG1ldGhvZCwgYXJndW1lbnRzKSwgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbjxvYmplY3QsIHN0cmluZywgZ2xvYmFsOjpCcmlkZ2UualF1ZXJ5Mi5qcVhIUj4pU3VjY2VzcywgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbjxnbG9iYWw6OkJyaWRnZS5qUXVlcnkyLmpxWEhSLCBzdHJpbmcsIHN0cmluZz4pRXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFBvc3RKc29uKG9iamVjdCBKc29uRmlsZSwgQWN0aW9uPG9iamVjdCwgc3RyaW5nLCBqcVhIUj4gU3VjY2VzcyA9IG51bGwsIEFjdGlvbjxqcVhIUiwgc3RyaW5nLCBzdHJpbmc+IEVycm9yID0gbnVsbCwgYm9vbCBBc3luYyA9IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvLyBsZXRzIGNvbnZlcnQgdGhlIEpzb25GaWxlT2JqZWN0IHRvIGEgc3RyaW5nO1xyXG4gICAgICAgICAgICB2YXIgYWpvID0gR2V0QWpheE9wdGlvbnMoSnNvbkZpbGUsIEFzeW5jKTtcclxuICAgICAgICAgICAgYWpvLlN1Y2Nlc3MgPSBTdWNjZXNzO1xyXG4gICAgICAgICAgICBham8uRXJyb3IgPSBFcnJvcjtcclxuXHJcbiAgICAgICAgICAgIGpRdWVyeS5BamF4KGFqbyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgUG9zdEpzb25Qcm9ncmVzc0NvbnRyb2wob2JqZWN0IEpzb25GaWxlLCBQcm9ncmVzc0NvbnRyb2wgcHJvZ3Jlc3NDb250cm9sLCBBY3Rpb248b2JqZWN0LCBzdHJpbmcsIGpxWEhSPiBTdWNjZXNzID0gbnVsbCwgQWN0aW9uPGpxWEhSLCBzdHJpbmcsIHN0cmluZz4gRXJyb3IgPSBudWxsLCBib29sIEFzeW5jID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vIGxldHMgY29udmVydCB0aGUgSnNvbkZpbGVPYmplY3QgdG8gYSBzdHJpbmc7XHJcbiAgICAgICAgICAgIHZhciBham8gPSBHZXRBamF4T3B0aW9ucyhKc29uRmlsZSwgQXN5bmMpO1xyXG4gICAgICAgICAgICBham8uWGhyID0gKCkgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHhtbFJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICAgICAgICAgIHhtbFJlcXVlc3QuQWRkRXZlbnRMaXN0ZW5lcihFdmVudFR5cGUuUHJvZ3Jlc3MsIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZSkgPT5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGUgPSBlIGFzIFByb2dyZXNzRXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYocHJvZ3Jlc3NDb250cm9sID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGMgPSBwcm9ncmVzc0NvbnRyb2w7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZsb2F0IFBlcmNlbnQgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihwZS5Mb2FkZWQgIT0gMCAmJiBwZS5Ub3RhbCAhPSAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGVyY2VudCA9ICgoZmxvYXQpcGUuTG9hZGVkIC8gKGZsb2F0KXBlLlRvdGFsKSAqIDEwMC4wZjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGMuaW50ZXJuYWxQcm9ncmVzc0NvbnRyb2wuU3R5bGUuV2lkdGggPSBQZXJjZW50LlRvU3RyaW5nKCkgKyBcIiVcIjtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4geG1sUmVxdWVzdDtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgYWpvLlN1Y2Nlc3MgPSBTdWNjZXNzO1xyXG4gICAgICAgICAgICBham8uRXJyb3IgPSBFcnJvcjtcclxuXHJcbiAgICAgICAgICAgIGpRdWVyeS5BamF4KGFqbyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgUG9zdEpzb25Qcm9ncmVzc0Zvcm0ob2JqZWN0IEpzb25GaWxlLCBBY3Rpb248b2JqZWN0LCBzdHJpbmcsIGpxWEhSPiBTdWNjZXNzID0gbnVsbCwgQWN0aW9uPGpxWEhSLCBzdHJpbmcsIHN0cmluZz4gRXJyb3IgPSBudWxsLCBib29sIEFzeW5jID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vIGxldHMgY29udmVydCB0aGUgSnNvbkZpbGVPYmplY3QgdG8gYSBzdHJpbmc7XHJcbiAgICAgICAgICAgIHZhciBucGYgPSBuZXcgTmV0d29ya1Byb2dyZXNzRm9ybSgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGFqbyA9IEdldEFqYXhPcHRpb25zKEpzb25GaWxlLCBBc3luYyk7XHJcbiAgICAgICAgICAgIGFqby5YaHIgPSAoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeG1sUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgICAgICAgICAgeG1sUmVxdWVzdC5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Qcm9ncmVzcywgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbjxnbG9iYWw6OkJyaWRnZS5IdG1sNS5FdmVudD4pKChlKSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwZSA9IGUgYXMgUHJvZ3Jlc3NFdmVudDtcclxuICAgICAgICAgICAgICAgICAgICBpZihucGYgPT0gbnVsbCB8fCBucGYucHJvZ3Jlc3NDb250cm9sID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGMgPSBucGYucHJvZ3Jlc3NDb250cm9sO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmbG9hdCBQZXJjZW50ID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYocGUuTG9hZGVkICE9IDAgJiYgcGUuVG90YWwgIT0gMClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBlcmNlbnQgPSAoKGZsb2F0KXBlLkxvYWRlZCAvIChmbG9hdClwZS5Ub3RhbCkgKiAxMDAuMGY7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBjLmludGVybmFsUHJvZ3Jlc3NDb250cm9sLlN0eWxlLldpZHRoID0gUGVyY2VudC5Ub1N0cmluZygpICsgXCIlXCI7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHhtbFJlcXVlc3Q7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGFqby5TdWNjZXNzID0gKG8sIHMsIGpxKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBucGYuRGlhbG9nUmVzdWx0ID0gRGlhbG9nUmVzdWx0RW51bS5PSztcclxuICAgICAgICAgICAgICAgIFN1Y2Nlc3MobywgcywganEpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBham8uRXJyb3IgPSAoanEsIHMxLCBzMikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbnBmLkRpYWxvZ1Jlc3VsdCA9IERpYWxvZ1Jlc3VsdEVudW0uQ2FuY2VsO1xyXG4gICAgICAgICAgICAgICAgRXJyb3IoanEsIHMxLCBzMik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGFqby5Db21wbGV0ZSA9IChqcSwgc3RyKSA9PiB7IG5wZi5DbG9zZSgpOyB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGFqciA9IGpRdWVyeS5BamF4KGFqbyk7XHJcblxyXG4gICAgICAgICAgICBucGYuU2hvd0RpYWxvZyhuZXcgRGlhbG9nUmVzdWx0KERpYWxvZ1Jlc3VsdEVudW0uQ2FuY2VsLCAoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBhanIuQWJvcnQoKTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNsYXNzIE5ldHdvcmtQcm9ncmVzc0Zvcm0gOiBGb3JtXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwdWJsaWMgUHJvZ3Jlc3NDb250cm9sIHByb2dyZXNzQ29udHJvbDtcclxuICAgICAgICAgICAgcHVibGljIFNpbXBsZURpYWxvZ0J1dHRvbiBidXR0b25DYW5jZWw7XHJcblxyXG4gICAgICAgICAgICBwdWJsaWMgTmV0d29ya1Byb2dyZXNzRm9ybShzdHJpbmcgX3RleHQgPSBcIkxvYWRpbmcuLi5cIilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5UZXh0ID0gX3RleHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLldpZHRoID0gNDAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5IZWlnaHQgPSAyMDA7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3NDb250cm9sID0gbmV3IFByb2dyZXNzQ29udHJvbCgpO1xyXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3NDb250cm9sLlNldEJvdW5kcyg1MCwgNTAsIFwiKDEwMCUgLSAxMDBweClcIiwgXCIyM3B4XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ1dHRvbkNhbmNlbCA9IG5ldyBTaW1wbGVEaWFsb2dCdXR0b24odGhpcywgRGlhbG9nUmVzdWx0RW51bS5DYW5jZWwpIHsgVGV4dCA9IFwiQ2FuY2VsXCIgfTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbkNhbmNlbC5TZXRMb2NhdGlvbihcIigxMDAlIC0gNzhweClcIiwgXCIoMTAwJSAtIDI2cHgpXCIpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uQ2FuY2VsLkNvbnRlbnQuVGFiSW5kZXggPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIEJvZHkuQXBwZW5kQ2hpbGRyZW4oYnV0dG9uQ2FuY2VsLCBwcm9ncmVzc0NvbnRyb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgIEFsbG93U2l6ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWM7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgUmVzb3VyY2VNYW5hZ2VyXHJcbiAgICB7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz4gY2FjaGVSZXNvdXJjZVN0cmluZyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyBHZXRSZXNvdXJjZVN0cmluZyhzdHJpbmcgbmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGNhY2hlUmVzb3VyY2VTdHJpbmcuQ29udGFpbnNLZXkobmFtZSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVSZXNvdXJjZVN0cmluZ1tuYW1lXTtcclxuICAgICAgICAgICAgcmV0dXJuIChjYWNoZVJlc291cmNlU3RyaW5nW25hbWVdID0gU2V0dGluZ3MuR2V0U3R5bGVSdWxlVmFsdWUoU2V0dGluZ3MucmVzb3VyY2VNYW5hbmdlclNoZWV0cywgXCJjb250ZW50XCIsIFwiLlwiICsgbmFtZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxudXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcbnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFNldHRpbmdzXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgTmV0d29ya1VSTCA9IFwiSG9zdC5hc2h4XCI7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBzdHJpbmcgUmVzb3VyY2VVUkwgPSBcIi4vaW1hZ2VzL1wiO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBBdXRvUmVuZGVyID0gdHJ1ZTtcclxuICAgICAgICBwdWJsaWMgY29uc3Qgc3RyaW5nIEZvbnQgPSBcIjguMjVwdCBUYWhvbWFcIjtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGRlY2ltYWwgVGF4UGVyY2VudCB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgc3RyaW5nIERlZmF1bHRGb250ID0gRm9udDtcclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBPbmx5IGZvciBmaXJlZm94IC0gYXMgbm8gZXJyb3Igd2l0aCBudW1iZXIgaW5wdXRcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBPbkZvY3VzU2VsZWN0QWxsID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBTdHlsZVNoZWV0IERlZmF1bHRTdHlsZVNoZWV0O1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgU3R5bGVTaGVldCBQbHVnaW5TdHlsZVNoZWV0O1xyXG4gICAgICAgIGludGVybmFsIHN0YXRpYyBMaXN0PFN0eWxlU2hlZXQ+IHJlc291cmNlTWFuYW5nZXJTaGVldHMgPSBuZXcgTGlzdDxTdHlsZVNoZWV0PigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgR3JpZFZpZXdBdXRvQ29sdW1uR2VuZXJhdGVGb3JtYXRBc0RhdGUgPSBmYWxzZTtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgR3JpZFZpZXdBdXRvQ29sdW1uRm9ybWF0RGF0ZXMgPSB0cnVlO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBHcmlkVmlld0JsdXJPblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IEdyaWRWaWV3Um93U2Nyb2xsUGFkZGluZyA9IDA7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBHcmlkVmlld1Njcm9sbERlbGF5ZWQgPSBmYWxzZTtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBHcmlkVmlld1Njcm9sbERlbGF5TVMgPSAyNTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgQ29udGV4dE1lbnVTdGFydGluZ1pJbmRleCA9IDUwMDtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBDb250ZXh0TWVudU1pbldpZHRoID0gMjAwO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBNZXNzYWdlRm9ybVRleHRNYXhpbXVtSGVpZ2h0SW5QeCA9IDUwMDtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBNZXNzYWdlRm9ybVRleHRNaW5pbXVtSGVpZ2h0SW5QeCA9IDMyO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IE1lc3NhZ2VGb3JtTWluaW11bVdpZHRoSW5QeCA9IDE5NTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBEYXRlUG9zaXRpb24gRGF5UG9zaXRpb24gPSBEYXRlUG9zaXRpb24uRmlyc3Q7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBEYXRlUG9zaXRpb24gTW9udGhQb3NpdGlvbiA9IERhdGVQb3NpdGlvbi5TZWNvbmQ7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBEYXRlUG9zaXRpb24gWWVhclBvc2l0aW9uID0gRGF0ZVBvc2l0aW9uLlRoaXJkO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgRGlzYWJsZVRleHRQb3B1cEVkaXRvciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGNoYXIgRGF0ZVNlcGVyYXRvciA9ICcvJztcclxuXHJcbiAgICAgICAgcHVibGljIGVudW0gRGF0ZVBvc2l0aW9uXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBGaXJzdCxcclxuICAgICAgICAgICAgU2Vjb25kLFxyXG4gICAgICAgICAgICBUaGlyZFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBWZWN0b3IyIENvbnNvbGVEZWZhdWx0U2l6ZSA9IG5ldyBWZWN0b3IyKDU0MCwgMjQwKTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIE1lc3NhZ2VGb3JtQmVlcCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBNYXhpbXVtUGl4ZWxTY3JvbGxpbmdSb3dzID0gNTAwMDAwO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEFjdGlvbjxzdHJpbmc+IE9uU2VuZEVycm9yID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIElzQ2hyb21lID0gQnJvd3Nlci5Jc0Nocm9tZTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIEFsbG93Q2xvc2VXaXRob3V0UXVlc3Rpb24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBBY3Rpb24gT25BcHBsaWNhdGlvbkNsb3NlID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIFNob3dFeGNlcHRpb25EaWFsb2cgPSB0cnVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBGb3JtRmFkZUR1cmF0aW9uID0gMTAwO1xyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vIEluY3JlYXNlIFJlbmRlciBTcGVlZFxyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIFJlbW92ZUF0dHJpYnV0ZXNPZmZFbGVtZW50c1doZW5Mb3NlRm9jdXM7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZXR1cCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBBY3RpdmVUaGVtZSA9IFRoZW1lLlRoZW1lMTtcclxuICAgICAgICAgICAgU2V0dXBTdHlsZURlZmF1bHRzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0dXBTdHlsZURlZmF1bHRzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTdHlsZVNoZWV0TGlzdCBzaGVldHMgPSBEb2N1bWVudC5TdHlsZVNoZWV0cztcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBzaGVldHMuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG93bmVyTm9kZSA9IHNoZWV0c1tpXS5Pd25lck5vZGUgYXMgSFRNTExpbmtFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKG93bmVyTm9kZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZihvd25lck5vZGUuSWQuVG9Mb3dlcigpID09IFwiZXhwcmVzc2NyYWZ0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0U3R5bGVTaGVldCA9IHNoZWV0c1tpXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYob3duZXJOb2RlLklkLlRvTG93ZXIoKSA9PSBcImV4cHJlc3NjcmFmdHBsdWdpblwiKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGx1Z2luU3R5bGVTaGVldCA9IHNoZWV0c1tpXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYob3duZXJOb2RlLklkLlRvTG93ZXIoKSA9PSBcInJlc291cmNlbWFuYWdlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VNYW5hbmdlclNoZWV0cy5BZGQoc2hlZXRzW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihEZWZhdWx0U3R5bGVTaGVldCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIHZhciBkZiA9IEdldEV4cHJlc3NTdHlsZVJ1bGVWYWx1ZShcImZvbnRcIiwgXCIuY29udHJvbFwiKTtcclxuICAgICAgICAgICAgICAgIGlmKGRmICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgRGVmYXVsdEZvbnQgPSBkZjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBkeW5hbWljIEdldFN0eWxlUnVsZVZhbHVlKExpc3Q8U3R5bGVTaGVldD4gY3NzRmlsZSwgc3RyaW5nIHN0eWxlLCBzdHJpbmcgY2xhc3NOYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdHJ5XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGNzc0ZpbGUgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKHZhciBpdGVtIGluIGNzc0ZpbGUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkeW5hbWljIHZhbHVlID0gR2V0U3R5bGVSdWxlVmFsdWUoaXRlbSwgc3R5bGUsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHZhbHVlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgZHluYW1pYyBHZXRTdHlsZVJ1bGVWYWx1ZShTdHlsZVNoZWV0IGNzc0ZpbGUsIHN0cmluZyBzdHlsZSwgc3RyaW5nIGNsYXNzTmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihjc3NGaWxlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHluYW1pYyBwU3R5bGVzID0gY3NzRmlsZTtcclxuICAgICAgICAgICAgICAgICAgICBpZihwU3R5bGVzLmNzc1J1bGVzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IHBTdHlsZXMuY3NzUnVsZXMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR5bmFtaWMgcnVsZSA9IHBTdHlsZXMuY3NzUnVsZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihydWxlLnNlbGVjdG9yVGV4dCAmJiBydWxlLnNlbGVjdG9yVGV4dC5zcGxpdCgnLCcpLmluZGV4T2YoY2xhc3NOYW1lKSAhPSAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5zdHlsZVtzdHlsZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGR5bmFtaWMgR2V0RXhwcmVzc1N0eWxlUnVsZVZhbHVlKHN0cmluZyBzdHlsZSwgc3RyaW5nIGNsYXNzTmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGR5bmFtaWMgdmFsdWUgPSBHZXRTdHlsZVJ1bGVWYWx1ZShQbHVnaW5TdHlsZVNoZWV0LCBzdHlsZSwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgaWYodmFsdWUgPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBHZXRTdHlsZVJ1bGVWYWx1ZShEZWZhdWx0U3R5bGVTaGVldCwgc3R5bGUsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgSFRNTFN0eWxlRWxlbWVudCB0aGVtZUVsZW1lbnQgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgQXBwbHlBY3RpdmVUaGVtZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0aGVtZUVsZW1lbnQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhlbWVFbGVtZW50LlBhcmVudEVsZW1lbnQuUmVtb3ZlQ2hpbGQodGhlbWVFbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihfYWN0aXZlVGhlbWUgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIF9hY3RpdmVUaGVtZSA9IFRoZW1lLlRoZW1lMTtcclxuICAgICAgICAgICAgdmFyIG9iakxpc3QgPSBuZXcgTGlzdDxvYmplY3Q+KCk7XHJcbiAgICAgICAgICAgIG9iakxpc3QuQWRkUmFuZ2UoX2FjdGl2ZVRoZW1lLkNvbG9ycyk7XHJcbiAgICAgICAgICAgIG9iakxpc3QuQWRkUmFuZ2UobmV3IG9iamVjdFtdIHsgXCJjb250cm9sXCIsIFwiYmFja2dyb3VuZC1jb2xvclwiLCBcImJvcmRlclwiLCBcInJpYmJvblwiLCBcIi1sZWZ0LWNvbG9yXCIsIFwiLXRvcC1jb2xvclwiLCBcIi1yaWdodC1jb2xvclwiLCBcIi1ib3R0b20tY29sb3JcIiwgXCJidXR0b25cIiwgXCJmb3JtLWhlYWRpbmdcIiwgXCJwYWdlaGVhZGVyXCIsIFwiaGVhZGluZ1wiIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhlbWVFbGVtZW50ID0gbmV3IEhUTUxTdHlsZUVsZW1lbnQoKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBJbm5lckhUTUwgPSBzdHJpbmcuRm9ybWF0KHRoZW1lVGVtcGxhdGUuUmVwbGFjZShcIiNmb2N1c0xpbmU7XCIsIF9pbmNsdWRlRm9jdXNSZWdpb24gPyB0aGVtZWZvY3VzVmFsdWUgOiBzdHJpbmcuRW1wdHkpLFxyXG4gICAgICAgICAgICAgICAgb2JqTGlzdC5Ub0FycmF5KCkpXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBEb2N1bWVudC5Cb2R5LkFwcGVuZENoaWxkKHRoZW1lRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBib29sIF9pbmNsdWRlRm9jdXNSZWdpb24gPSB0cnVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgSW5jbHVkZUZvY3VzUmVnaW9uXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9pbmNsdWRlRm9jdXNSZWdpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9pbmNsdWRlRm9jdXNSZWdpb24gIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2luY2x1ZGVGb2N1c1JlZ2lvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIEFwcGx5QWN0aXZlVGhlbWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgVGhlbWUgX2FjdGl2ZVRoZW1lID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBUaGVtZSBBY3RpdmVUaGVtZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF9hY3RpdmVUaGVtZTsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX2FjdGl2ZVRoZW1lICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hY3RpdmVUaGVtZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIEFwcGx5QWN0aXZlVGhlbWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9UaGVtZUZvcm1cclxuXHJcbiAgICAgICAgI3JlZ2lvbiBUaGVtZVRlbXBsYXRlQ29kZVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBzdHJpbmcgdGhlbWVmb2N1c1ZhbHVlID0gQFwiLnsyNX06Zm9jdXM6bm90KC5ncmlkKXt7XHJcbmJvcmRlcjogc29saWQgMXB4IHswfTtcclxufX1cIjtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgc3RyaW5nIHRoZW1lVGVtcGxhdGUgPSBAXCIuezI1fXt7XHJcbiAgICBjb2xvcjp7MjJ9O1xyXG59fVxyXG4jZm9jdXNMaW5lO1xyXG4uezI1fTo6c2VsZWN0aW9ue3tcclxuezI2fTp7MX07XHJcbn19XHJcbi57MjV9OjotbW96LXNlbGVjdGlvbnt7XHJcbnsyNn06ezF9O1xyXG59fVxyXG4uezI1fTpkaXNhYmxlZHt7XHJcbnsyNn06ezJ9O1xyXG59fVxyXG4uaW5wdXR7MjV9OnJlYWQtb25seXt7XHJcbnsyNn06ezN9O1xyXG59fVxyXG4uezI4fXsyNX17e1xyXG57MjZ9OnswfTtcclxuezI3fXsyOX06ezB9O1xyXG57Mjd9ezMxfTp7MH07XHJcbnsyN317MzJ9OnsxfTtcclxufX1cclxuLnsyOH1wYWdle3tcclxuezI2fTp7M307XHJcbn19XHJcbi57Mjh9Z3JvdXB7e1xyXG57MjZ9OnszfTtcclxufX1cclxuLnsyOH17MzN9e3tcclxuezI2fTp7M307XHJcbn19XHJcbi57Mjh9ezMzfTpob3Zlcjpub3QoOmFjdGl2ZSk6bm90KC5kaXNhYmxlZClcclxue3tcclxuezI2fTp7NH07XHJcbn19XHJcbi57Mjh9ezMzfTphY3RpdmU6bm90KC5kaXNhYmxlZCl7e1xyXG57MjZ9Ons1fTtcclxufX1cclxuLnsyOH17MzN9c21hbGx7e1xyXG57MjZ9OnszfTtcclxufX1cclxuLnsyOH17MzN9c21hbGw6aG92ZXI6bm90KDphY3RpdmUpOm5vdCguZGlzYWJsZWQpXHJcbnt7XHJcbnsyNn06ezR9O1xyXG59fVxyXG4uezI4fXszM31zbWFsbDphY3RpdmU6bm90KC5kaXNhYmxlZCl7e1xyXG57MjZ9Ons1fTtcclxufX1cclxuLnsyOH1zZXBlcmF0b3J7e1xyXG57MjZ9OnsxfTtcclxufX1cclxuLnsyOH17MzV9LWhpZGRlbnt7XHJcbnsyNn06ezB9O1xyXG5jb2xvcjp7MjN9O1xyXG59fVxyXG4uezI4fXszNX0taGlkZGVuOmhvdmVye3tcclxuezI2fTp7Nn07XHJcbn19XHJcbi57Mjh9ezM1fS1hY3RpdmV7e1xyXG57MjZ9OnszfTtcclxufX1cclxuLnRhYnsyNX17e1xyXG57MjZ9OnszfTtcclxufX1cclxuLnRhYnsyNX1wYWdle3tcclxuezI2fTp7M307XHJcbnsyN317Mjl9OnsxfTtcclxuezI3fXszMX06ezF9O1xyXG57Mjd9ezMyfTp7MX07XHJcbn19XHJcbi50YWJ7MjV9ezM1fSB7e1xyXG57MjZ9OnszfTtcclxufX1cclxuLnRhYnsyNX17MzV9LWhpZGRlbnt7XHJcbnsyN317MzB9OnszfTtcclxuezI3fXsyOX06ezN9O1xyXG57Mjd9ezMxfTp7M307XHJcbnsyN317MzJ9OnRyYW5zcGFyZW50O1xyXG59fVxyXG4udGFiezI1fXszNX0taGlkZGVuOmhvdmVye3tcclxuezI2fTp7N307XHJcbnsyN317Mjl9Ons3fTtcclxuezI3fXszMX06ezd9O1xyXG59fVxyXG4udGFiezI1fXszNX0tYWN0aXZle3tcclxuezI3fXszMH06ezB9O1xyXG57Mjd9ezI5fTp7MX07XHJcbnsyN317MzF9OnsxfTtcclxuezI3fXszMn06ezN9O1xyXG5ib3JkZXItdG9wLXdpZHRoOjJweDtcclxubGluZS1oZWlnaHQ6MThweDtcclxudG9wOjJweDtcclxufX1cclxuLnRhYnsyNX17MzV9LWNsb3NlezMzfXt7XHJcbmNvbG9yOnsxfTtcclxufX1cclxuLnRhYnsyNX17MzV9LWNsb3NlezMzfTpob3Zlcnt7XHJcbmNvbG9yOnsyNH07XHJcblx0ezI2fTp7Mn07XHJcblx0ezI3fToxcHggc29saWQgezE5fTtcclxufX1cclxuLmlucHV0ezI1fSB7e1xyXG57Mjd9OjFweCBzb2xpZCB7MX07XHJcbnsyNn06ezE0fTtcclxufX1cclxuLnNpbXBsZXszM317e1xyXG57Mjd9OjFweCBzb2xpZCB7MTl9O1xyXG57MjZ9OnszfTtcclxufX1cclxuLnNpbXBsZXszM306aG92ZXI6bm90KC5kaXNhYmxlZClcclxue3tcclxuXHR7MjZ9OnsxfTtcclxufX1cclxuLnNpbXBsZXszM306YWN0aXZlOm5vdCguZGlzYWJsZWQpXHJcbnt7XHJcblx0ezI2fTp7MTJ9O1xyXG57Mjd9OiAxcHggc29saWQgezIwfTtcclxufX1cclxuQGtleWZyYW1lcyBDb2xvckZsYXNoIHt7XHJcbmZyb20ge3sgezI2fTogezIzfTt9fVxyXG50byB7eyB7MjZ9OiB7MH07fX1cclxufX1cclxuLmZvcm0tYmFzZXt7XHJcbnsyN30tY29sb3I6ezB9O1xyXG59fVxyXG4uezM0fXt7XHJcbnsyNn06ezB9O1xyXG59fVxyXG4uezM0fS10aXRsZXt7XHJcbmNvbG9yOnsyM307XHJcbn19XHJcbi57MzR9LXszM317e1xyXG5jb2xvcjp7MjN9O1xyXG59fVxyXG4uezM0fS17MzN9OmhvdmVyOm5vdCguezM0fS17MzN9LWNsb3NlKXt7XHJcbnsyNn06ezh9O1xyXG59fVxyXG4uezM0fS17MzN9OmFjdGl2ZTpub3QoLnszNH0tezMzfS1jbG9zZSl7e1xyXG57MjZ9Ons5fTtcclxufX1cclxuLnszNH0tezMzfS1jbG9zZTpob3Zlcnt7XHJcbnsyNn06ezEwfTtcclxufX1cclxuLnszNH0tezMzfS1jbG9zZTphY3RpdmV7e1xyXG57MjZ9OnsxMX07XHJcbn19XHJcbi5jZWxse3tcclxuezI3fTogMXB4IHNvbGlkIHszfTtcclxufX1cclxuLmNlbGxyb3d7e1xyXG57MjZ9OnsxNH07XHJcbn19XHJcbi5jZWxscm93OmhvdmVye3tcclxuezI2fTp7M30gIWltcG9ydGFudDtcclxufX1cclxuLmNlbGxyb3c6YWN0aXZle3tcclxuezI2fTp7MTJ9ICFpbXBvcnRhbnQ7XHJcbn19XHJcbi5ldmVue3tcclxuICAgezI2fTp7MTN9ICFpbXBvcnRhbnQ7XHJcbn19XHJcbi5jZWxscm93LXNlbGVjdGVke3tcclxuezI2fTp7MTd9ICFpbXBvcnRhbnQ7XHJcbn19XHJcbi5jZWxscm93LXNlbGVjdGVkOmhvdmVye3tcclxuezI2fTp7MTh9ICFpbXBvcnRhbnQ7XHJcbn19XHJcbi57MzZ9e3tcclxuezI2fTp7M307XHJcbnsyN30tcmlnaHQ6MXB4IHNvbGlkIHsxOX0gIWltcG9ydGFudDtcclxufX1cclxuLnszNn06aG92ZXJ7e1xyXG57MjZ9OnsxfTtcclxufX1cclxuLnszNn06YWN0aXZle3tcclxuezI2fTp7MTJ9O1xyXG59fVxyXG4uezM2fS1jb250YWluZXJ7e1xyXG57MjZ9OnszfTtcclxuezI3fS1ib3R0b206MXB4IHNvbGlkIHsxOX0gIWltcG9ydGFudDtcclxufX1cclxuLmdyaWR7e1xyXG57MjZ9OnsxNH07XHJcbnsyN306MXB4IHNvbGlkIHsxOX07XHJcbn19XHJcbi5wcm9ncmVzc2Jhcnt7XHJcbnsyN306MXB4IHNvbGlkIHsxOX07XHJcbnsyNn06ezE0fTtcclxufX1cclxuLnByb2dyZXNzYmFyYm9keXt7XHJcbnsyNn06ezB9O1xyXG59fVxyXG4uY29udGV4dG1lbnV7e1xyXG57MjZ9OnsxNH07XHJcbnsyN306IHNvbGlkIDFweCB7MjF9O1xyXG59fVxyXG4uY29udGV4dGl0ZW06aG92ZXJ7e1xyXG57MjZ9OnsxNX07XHJcbn19XHJcbi5jb250ZXh0aXRlbXNlcGVyYXRvcnt7XHJcbnsyNn06ezE2fTtcclxufX1cclxuLmRpYWxvZ3szM31zZWN0aW9ue3tcclxuezI2fTp7M307XHJcbn19XHJcbi5zcGxpdHsyNX1cclxue3tcclxuezI3fToxcHggc29saWQgezE5fTtcclxufX1cclxuLnNwbGl0dGVydmVydGljYWwge3tcclxuezI3fS1sZWZ0OiAxcHggezR9IHNvbGlkO1xyXG57Mjd9LXJpZ2h0OiAxcHggezR9IHNvbGlkO1xyXG59fVxyXG4uc3BsaXR0ZXJob3Jpem9udGFsIHt7XHJcbnsyN30tdG9wOiAxcHggezR9IHNvbGlkO1xyXG57Mjd9LWJvdHRvbTogMXB4IHs0fSBzb2xpZDtcclxufX1cclxuLnNwbGl0dGVyaG9yaXpvbnRhbDpob3ZlciB7e1xyXG57MjZ9Ons0fTtcclxufX1cclxuLnNwbGl0dGVydmVydGljYWw6aG92ZXIge3tcclxuezI2fTp7NH07XHJcbn19XHJcbi50b29sLXRpcHt7XHJcbnsyNn06ezE0fTtcclxuezI3fTogc29saWQgMXB4IHsyMX07XHJcbn19XHJcbi57MzR9LW1pbjpob3Zlcnt7XHJcblx0ezI2fTp7OH07XHJcbn19XHJcbi5zaW1wbGVidXR0b24tYWN0aXZlXHJcbnt7XHJcblx0ezI2fTp7MTJ9O1xyXG57Mjd9OiAxcHggc29saWQgezIwfTtcclxufX1cclxuLnByaW1hcnl7e1xyXG4gICAgezI2fTp7MH07XHJcbn19XHJcbi50YWJoZWFkZXItY29udGFpbmVye3tcclxuICAgIGJvcmRlci1ib3R0b206IDJweCB7MH0gc29saWQ7XHJcbn19XHJcblwiO1xyXG5cclxuICAgICAgICAjZW5kcmVnaW9uIFRoZW1lVGVtcGxhdGVDb2RlXHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBPbkYyU2hvd1RoZW1lRm9ybSA9IHRydWU7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IFRvb2xUaXBQb3B1cERlbGF5TXMgPSAxMDAwO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IFRvb2xUaXBQb3B1cFN0YXlPcGVuRGVsYXlQZXJXb3JkTXMgPSAyNTA7XHJcblxuICAgIFxucHJpdmF0ZSBzdGF0aWMgZGVjaW1hbCBfX1Byb3BlcnR5X19Jbml0aWFsaXplcl9fVGF4UGVyY2VudD0wLjFtO31cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgVGhlbWVcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgc3RyaW5nW10gQ29sb3JzIHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMTsgLy8gIzAxNzNDNyB7MH0gZm9ybSBoZWFkZXIgY29sb3IgcmliYm9uIGNvbG9yIGV0YywgcmliYm9uIGhlYWRlciBoaWRkZW4gLSBub3QgYWN0aXZlLi5cclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMjsgLy8gI0M1QzVDNSB7MX0gdGV4dCBzZWxlY3Rpb24gYmFjayBjb2xvciwgcmliYm9uIHNwbGl0ZXJcclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMzsgLy8gI0NDQ0NDQyB7Mn0gZGlzYWJsZWQgYmFja2NvbG9yXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjQ7IC8vICNGMEYwRjAgezN9IGlucHV0IGJhY2tjb2xvci4uLiAtIHJpYmJvbiBwYWdlIGJhY2ssIHJpYmJvbiBncm91cCwgcmliYm9uIGJ1dHRvbiwgcmliYm9uc21hbGwsIHJpYmJvbiBoZWFkZXIgYWN0aXZlIGNvbHJvXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjU7IC8vICNDM0MzQzMgezR9cmliYm9uIGl0ZW1zIGRpc2FibGVkLCByaWJib24gaG92ZXJcclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yNjsgLy8gI0FEQURBRCB7NX0gcmliYm9uIGJ1dHRvbiBBY3RpdmVcclxuXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjc7IC8vICMyQThBRDAgezZ9IHJpYmJvbiBoZWFkZXIgaGlkZGVuIGhvdmVyXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjg7IC8vICNEM0QzRDMgezd9IHRhYmNvbnRyb2wgaGVhZGVyIGhpZGRlblxyXG4gICAgICAgIC8vcHVibGljIHN0cmluZyBCYWNrZ3JvdW5kQ29sb3I5OyAvLyAjMkE4QUQ0IHs4fSBGb3JtIEhlYWRpbmcgQnV0dG9uIG5vdCBjbG9zZSBIb3Zlci5cclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMTA7IC8vICMwMTVDOUYgezl9IEZvcm0gSGVhZGluZyBCdXR0b24gbm90IGNsb3NlIEFjdGl2ZS5cclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMTE7IC8vICNFODExMjMgezEwfSBGb3JtIEhlYWRpbmcgQnV0dG9uIGNsb3NlIEhvdmVyLlxyXG4gICAgICAgIC8vcHVibGljIHN0cmluZyBCYWNrZ3JvdW5kQ29sb3IxMjsgLy8gI0YxNzA3QSB7MTF9IEZvcm0gSGVhZGluZyBCdXR0b24gY2xvc2UgQWN0aXZlLlxyXG4gICAgICAgIC8vcHVibGljIHN0cmluZyBCYWNrZ3JvdW5kQ29sb3IxMzsgLy8gI0FFQUVBRSB7MTJ9IENlbGxSb3cgQWN0aXZlXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjE0OyAvLyAjRkFGQUZBIHsxM307IFJvdyBFdmVuXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjE1OyAvLyB3aGl0ZSB7MTR9IENvbnRleHQgTWVudSBCYWNrIENvbG9yXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjE2OyAvLyAjQ0ZDRkNGIHsxNX0gQ29udGV4dCBNZW51IEl0ZW0gSG92ZXJcclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMTc7IC8vICNCOUI5QjkgezE2fSBDb250ZXh0IE1lbnUgSXRlbSBTcGxpdHRlclxyXG5cclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQmFja2dyb3VuZENvbG9yMTg7IC8vIHJnYmEoMSwgMTE1LCAxOTksIDAuMykgezE3fSBDZWxsUm93LVNlbGVjdGVkXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJhY2tncm91bmRDb2xvcjE5OyAvLyByZ2JhKDEsIDExNSwgMTk5LCAwLjUpIHsxOH0gQ2VsbFJvdy1TZWxlY3RlZFxyXG5cclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgQm9yZGVyQ29sb3IxOyAvLyAjQTZBNkE2IHsxOX0gQnV0dG9uIEJvcmRlciwgc3BsaXR0ZXIgQm9yZGVyXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJvcmRlckNvbG9yMjsgLy8gIzc3Nzc3NyB7MjB9IGJ1dHRvbiBCb3JkZXIgQWN0aXZlXHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEJvcmRlckNvbG9yMzsgLy8gIzgwODY4QSB7MjF9IENvbnRleHQgTWVudSBCb3JkZXIgQ29sb3JcclxuICAgICAgICAvL3B1YmxpYyBzdHJpbmcgRm9yZUNvbG9yMTsgLy8gIzQwNDA0MCB7MjJ9XHJcbiAgICAgICAgLy9wdWJsaWMgc3RyaW5nIEZvcmVDb2xvcjI7IC8vIHJpYmJvbnBhZ2VoZWFkZXIgd2hpdGUgezIzfSByaWJib25wYWdlaGVhZGVyLWhpZGRlblxyXG4gICAgICAgIC8vcHVibGljIHN0cmluZyBGb3JlQ29sb3IzOyAvLyByaWJib25wYWdlaGVhZGVyIGJsYWNrIHsyNH0gSG92ZXIgdGFiY29udHJvbHBhZ2VoZWFkZXItY2xvc2VidXR0b25cclxuICAgICAgICAvLyBjb250cm9sIHsyNX1cclxuICAgICAgICAvLyBiYWNrZ3JvdW5kLWNvbG9yIHsyNn1cclxuICAgICAgICAvLyBib3JkZXIgezI3fVxyXG4gICAgICAgIC8vIHJpYmJvbiB7Mjh9XHJcbiAgICAgICAgLy8gLWxlZnQtY29sb3IgezI5fVxyXG4gICAgICAgIC8vIC10b3AtY29sb3IgezMwfVxyXG4gICAgICAgIC8vIC1yaWdodC1jb2xvciB7MzF9XHJcbiAgICAgICAgLy8gLWJvdHRvbS1jb2xvciB7MzJ9XHJcbiAgICAgICAgLy8gYnV0dG9uIHszM31cclxuICAgICAgICAvLyBmb3JtLWhlYWRpbmcgezM0fVxyXG4gICAgICAgIC8vIHBhZ2VoZWFkZXIgezM1fVxyXG4gICAgICAgIC8vIGhlYWRpbmcgezM2fVxyXG5cclxuICAgICAgICBwdWJsaWMgVGhlbWUocGFyYW1zIHN0cmluZ1tdIGNvbG9ycylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGNvbG9ycyAhPSBudWxsICYmIGNvbG9ycy5MZW5ndGggPT0gMjUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENvbG9ycyA9IGNvbG9ycztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IxID0gYmdjMTtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IyID0gYmdjMjtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IzID0gYmdjMztcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3I0ID0gYmdjNDtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3I1ID0gYmdjNTtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3I2ID0gYmdjNjtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3I3ID0gYmdjNztcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3I4ID0gYmdjODtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3I5ID0gYmdjOTtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IxMCA9IGJnYzEwO1xyXG4gICAgICAgICAgICAvL0JhY2tncm91bmRDb2xvcjExID0gYmdjMTE7XHJcbiAgICAgICAgICAgIC8vQmFja2dyb3VuZENvbG9yMTIgPSBiZ2MxMjtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IxMyA9IGJnYzEzO1xyXG4gICAgICAgICAgICAvL0JhY2tncm91bmRDb2xvcjE0ID0gYmdjMTQ7XHJcbiAgICAgICAgICAgIC8vQmFja2dyb3VuZENvbG9yMTUgPSBiZ2MxNTtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IxNiA9IGJnYzE2O1xyXG4gICAgICAgICAgICAvL0JhY2tncm91bmRDb2xvcjE3ID0gYmdjMTc7XHJcbiAgICAgICAgICAgIC8vQmFja2dyb3VuZENvbG9yMTggPSBiZ2MxODtcclxuICAgICAgICAgICAgLy9CYWNrZ3JvdW5kQ29sb3IxOSA9IGJnYzE5O1xyXG4gICAgICAgICAgICAvL0JvcmRlckNvbG9yMSA9IGJjMTtcclxuICAgICAgICAgICAgLy9Cb3JkZXJDb2xvcjIgPSBiYzI7XHJcbiAgICAgICAgICAgIC8vQm9yZGVyQ29sb3IzID0gYmMzO1xyXG4gICAgICAgICAgICAvL0ZvcmVDb2xvcjEgPSBmYzE7XHJcbiAgICAgICAgICAgIC8vRm9yZUNvbG9yMiA9IGZjMjtcclxuICAgICAgICAgICAgLy9Gb3JlQ29sb3IzID0gZmMzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBUaGVtZSBUaGVtZTEgPSBuZXcgVGhlbWUoXHJcbiAgICAgICAgICAgIFwiIzAxNzNDN1wiLCBcIiNDNUM1QzVcIiwgXCIjQ0NDQ0NDXCIsXHJcbiAgICAgICAgICAgIFwiI0YwRjBGMFwiLCBcIiNDM0MzQzNcIiwgXCIjQURBREFEXCIsXHJcbiAgICAgICAgICAgIFwiIzJBOEFEMFwiLCBcIiNEM0QzRDNcIiwgXCIjMkE4QUQ0XCIsXHJcbiAgICAgICAgICAgIFwiIzAxNUM5RlwiLCBcIiNFODExMjNcIiwgXCIjRjE3MDdBXCIsXHJcbiAgICAgICAgICAgIFwiI0FFQUVBRVwiLCBcIiNGQUZBRkFcIiwgXCIjZmZmZmZmXCIsXHJcbiAgICAgICAgICAgIFwiI0NGQ0ZDRlwiLCBcIiNCOUI5QjlcIiwgXCJyZ2JhKDEsIDExNSwgMTk5LCAwLjMpXCIsXHJcbiAgICAgICAgICAgIFwicmdiYSgxLCAxMTUsIDE5OSwgMC41KVwiLCBcIiNBNkE2QTZcIixcclxuICAgICAgICAgICAgXCIjNzc3Nzc3XCIsIFwiIzgwODY4QVwiLCBcIiM0MDQwNDBcIixcclxuICAgICAgICAgICAgXCIjZmZmZmZmXCIsIFwiIzAwMDAwMFwiKTtcclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgVGV4dEJsb2NrXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBPcmlnaW5hbFNvdXJjZTtcclxuICAgICAgICBwdWJsaWMgaW50IE1heFdpZHRoO1xyXG5cclxuICAgICAgICBwdWJsaWMgZmxvYXQgQ29tcHV0ZWRIZWlnaHQ7XHJcbiAgICAgICAgcHVibGljIGludCBMaW5lc0NvbXB1dGVkO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBFbGVsZW10c092ZXJNYXggPSBmYWxzZTtcclxuICAgICAgICBwdWJsaWMgZmxvYXQgTWF4Q2FsY3VsYXRlZFdpZHRoID0gMDtcclxuXHJcbiAgICAgICAgcHVibGljIFRleHRCbG9jayhzdHJpbmcgc291cmNlLCBpbnQgbWF4V2lkdGgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBPcmlnaW5hbFNvdXJjZSA9IHNvdXJjZTtcclxuICAgICAgICAgICAgTWF4V2lkdGggPSBtYXhXaWR0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENvbXB1dGVTdHJpbmcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRWxlbGVtdHNPdmVyTWF4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHN0cmluZ1tdIExpbmVzID0gT3JpZ2luYWxTb3VyY2UuU3BsaXQobmV3IGNoYXJbXSB7ICdcXHInLCAnXFxuJyB9KTtcclxuXHJcbiAgICAgICAgICAgIGRvdWJsZSBzaXplUGVyQ2hhciA9IENvbnRyb2wuR2V0VGV4dFdpZHRoKFwiTVwiLCBTZXR0aW5ncy5EZWZhdWx0Rm9udCk7XHJcblxyXG4gICAgICAgICAgICBMaW5lc0NvbXB1dGVkID0gMDtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBMaW5lcy5MZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RyaW5nIGxpbmUgPSBMaW5lc1tpXTtcclxuXHJcbiAgICAgICAgICAgICAgICBkb3VibGUgbGluZVdpZHRoID0gQ29udHJvbC5HZXRUZXh0V2lkdGgoT3JpZ2luYWxTb3VyY2UsIFNldHRpbmdzLkRlZmF1bHRGb250KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihsaW5lV2lkdGggPiBNYXhXaWR0aClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBFbGVsZW10c092ZXJNYXggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIE1heENhbGN1bGF0ZWRXaWR0aCA9IE1heFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGludCB5eSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCB4ID0gMDsgeCA8IGxpbmUuTGVuZ3RoOyB4KyspXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5eSsrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoeXkgKiBzaXplUGVyQ2hhciA+IE1heFdpZHRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5lc0NvbXB1dGVkKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5eSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHl5ID4gMClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmVzQ29tcHV0ZWQrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgTGluZXNDb21wdXRlZCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGxpbmVXaWR0aCA+IE1heENhbGN1bGF0ZWRXaWR0aClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1heENhbGN1bGF0ZWRXaWR0aCA9IChmbG9hdClsaW5lV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIENvbXB1dGVkSGVpZ2h0ID0gR2V0Rm9udFNpemUoU2V0dGluZ3MuRGVmYXVsdEZvbnQpICogTGluZXNDb21wdXRlZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBmbG9hdCBHZXRGb250U2l6ZShzdHJpbmcgZm9udFdpdGhTaXplKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc3RyaW5nW10gc3RycyA9IGZvbnRXaXRoU2l6ZS5TcGxpdChuZXcgY2hhcltdIHsgJyAnIH0sIFN0cmluZ1NwbGl0T3B0aW9ucy5SZW1vdmVFbXB0eUVudHJpZXMpO1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IHN0cnMuTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHN0cnNbaV0uRW5kc1dpdGgoXCJwdFwiKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGZsb2F0KUdsb2JhbC5QYXJzZUZsb2F0KHN0cnNbaV0pICogMS4zMzMzMzNGO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZihzdHJzW2ldLkVuZHNXaXRoKFwicHhcIikpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChmbG9hdClHbG9iYWwuUGFyc2VGbG9hdChzdHJzW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIDguMjVGICogMS4zMzMzMzNGO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgQnJpZGdlLmpRdWVyeTI7XHJcbnVzaW5nIFN5c3RlbS5UZXh0O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBpbnRlcm5hbCBjbGFzcyBUb29sVGlwQ29udHJvbCA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwcml2YXRlIGJvb2wgdmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHByaXZhdGUgVG9vbFRpcCBfdG9vbFRpcDtcclxuXHJcbiAgICAgICAgcHVibGljIFRvb2xUaXBDb250cm9sKFRvb2xUaXAgdG9vbFRpcCkgOiBiYXNlKFwidG9vbC10aXBcIilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF90b29sVGlwID0gdG9vbFRpcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNob3coTW91c2VFdmVudCBldilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5Db250ZW50LkVtcHR5KCk7XHJcblxyXG4gICAgICAgICAgICBpZihfdG9vbFRpcCAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZighX3Rvb2xUaXAuSGVhZGluZy5Jc0VtcHR5KCkpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5Db250ZW50LkFwcGVuZENoaWxkKG5ldyBIVE1MUGFyYWdyYXBoRWxlbWVudCgpIHsgQ2xhc3NOYW1lID0gXCJ0b29sLXRpcC1oZWFkaW5nXCIsIElubmVySFRNTCA9IF90b29sVGlwLkhlYWRpbmcuSHRtbEVzY2FwZSgpLlJlcGxhY2UoXCJcXHJcXG5cIiwgXCI8YnI+XCIpIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoIV90b29sVGlwLkRlc2NyaXB0aW9uLklzRW1wdHkoKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuQXBwZW5kQ2hpbGQobmV3IEhUTUxQYXJhZ3JhcGhFbGVtZW50KCkgeyBDbGFzc05hbWUgPSBcInRvb2wtdGlwLWJvZHlcIiwgSW5uZXJIVE1MID0gX3Rvb2xUaXAuRGVzY3JpcHRpb24uSHRtbEVzY2FwZSgpLlJlcGxhY2UoXCJcXHJcXG5cIiwgXCI8YnI+XCIpIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtb3VzZSA9IEhlbHBlci5HZXRDbGllbnRNb3VzZUxvY2F0aW9uKGV2KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuTG9jYXRpb24gPSBuZXcgVmVjdG9yMihtb3VzZS5YLCBtb3VzZS5ZLlRvSW50KCkgKyAyMik7XHJcblxyXG4gICAgICAgICAgICBpZighdmlzaWJsZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBDb250ZXh0TWVudS5Ub3RhbENvbnRleHRIYW5kbGVzKys7XHJcbiAgICAgICAgICAgICAgICBDb250ZW50LlN0eWxlLlpJbmRleCA9IChDb250ZXh0TWVudS5Ub3RhbENvbnRleHRIYW5kbGVzICsgU2V0dGluZ3MuQ29udGV4dE1lbnVTdGFydGluZ1pJbmRleCkuVG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgIERvY3VtZW50LkJvZHkuQXBwZW5kQ2hpbGQodGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsb3NlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHZpc2libGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuQ29udGVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGpRdWVyeS5TZWxlY3QodGhpcy5Db250ZW50KS5GYWRlT3V0KDEwMCwgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbikoKCkgPT5cclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5EZWxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBDb250ZXh0TWVudS5Ub3RhbENvbnRleHRIYW5kbGVzLS07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIFRvb2xUaXBcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgc3RyaW5nIERlc2NyaXB0aW9uO1xyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgSGVhZGluZztcclxuXHJcbiAgICAgICAgcHVibGljIENvbnRyb2wgQXR0YWNoZWRDb250cm9sO1xyXG5cclxuICAgICAgICBwdWJsaWMgVG9vbFRpcChzdHJpbmcgY29udGVudClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIERlc2NyaXB0aW9uID0gY29udGVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBUb29sVGlwKHN0cmluZyBoZWFkaW5nLCBzdHJpbmcgZGVzY3JpcHRpb24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBEZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICBIZWFkaW5nID0gaGVhZGluZztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgR2V0V29yZENvdW50KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBmdWxsQ29udGVudCA9IHN0cmluZy5Db25jYXQoSGVhZGluZywgXCIgXCIsIERlc2NyaXB0aW9uKS5UcmltKCk7XHJcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBmdWxsQ29udGVudC5MZW5ndGg7XHJcbiAgICAgICAgICAgIGNoYXIgcHJldkNoYXIgPSAnXFwwJztcclxuICAgICAgICAgICAgdmFyIGJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpO1xyXG4gICAgICAgICAgICBjaGFyIGN1cnJlbnQ7XHJcbiAgICAgICAgICAgIGludCBXb3JkQ291bnQgPSAxO1xyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBmdWxsQ29udGVudFtpXTtcclxuICAgICAgICAgICAgICAgIGlmKGNoYXIuSXNXaGl0ZVNwYWNlKGN1cnJlbnQpKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNoYXIuSXNXaGl0ZVNwYWNlKHByZXZDaGFyKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDaGFyID0gY3VycmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFdvcmRDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHByZXZDaGFyID0gY3VycmVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gV29yZENvdW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIHN0cnVjdCBWZWN0b3IyXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gWDtcclxuICAgICAgICBwdWJsaWMgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiBZO1xyXG5cclxuICAgICAgICBwdWJsaWMgaW50IFhpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gKGludClYOyB9XHJcbiAgICAgICAgICAgIHNldCB7IFggPSB2YWx1ZTsgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBZaVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIChpbnQpWTsgfVxyXG4gICAgICAgICAgICBzZXQgeyBZID0gdmFsdWU7IH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBmbG9hdCBYZlxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIChmbG9hdClYOyB9XHJcbiAgICAgICAgICAgIHNldCB7IFggPSB2YWx1ZTsgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGZsb2F0IFlmXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gKGZsb2F0KVk7IH1cclxuICAgICAgICAgICAgc2V0IHsgWSA9IHZhbHVlOyB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vIGFkZHMgY2FsYyB0byAoMTAwJSAtIDUwcHgpIHR1cm5zIHRvIGNhbGMoMTAwJSAtIDUwcHgpXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJhXCI+PC9wYXJhbT5cclxuICAgICAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPlxyXG4gICAgICAgIGludGVybmFsIHN0YXRpYyBzdHJpbmcgcGYoc3RyaW5nIGEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoYSkgJiYgYS5TdGFydHNXaXRoKFwiKFwiKSAmJiBhLkVuZHNXaXRoKFwiKVwiKSA/IFwiY2FsY1wiICsgYSA6IGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVmVjdG9yMihVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IHgsIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4geSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFggPSB4O1xyXG4gICAgICAgICAgICBZID0geTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2U7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBzdHJ1Y3QgVmVjdG9yNFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IFg7XHJcbiAgICAgICAgcHVibGljIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gWTtcclxuICAgICAgICBwdWJsaWMgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiBaO1xyXG4gICAgICAgIHB1YmxpYyBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IE07XHJcblxyXG4gICAgICAgIHB1YmxpYyBWZWN0b3I0KFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4geCwgVW5pb248c3RyaW5nLCBpbnQsIGZsb2F0PiB5LCBVbmlvbjxzdHJpbmcsIGludCwgZmxvYXQ+IHosIFVuaW9uPHN0cmluZywgaW50LCBmbG9hdD4gbSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFggPSB4O1xyXG4gICAgICAgICAgICBZID0geTtcclxuICAgICAgICAgICAgWiA9IHo7XHJcbiAgICAgICAgICAgIE0gPSBtO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxudXNpbmcgQnJpZGdlLkh0bWw1O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgQWNlQ29kZUVkaXRvciA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBFeHRlcm5hbFBsdWdpbiBFeHRlcm5hbEFjZUNvZGVFZGl0b3IgPSBuZXcgRXh0ZXJuYWxQbHVnaW4oXCJodHRwczovL2FjZS5jOS5pby9idWlsZC9zcmMvYWNlLmpzXCIpO1xyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgZWRpdG9yID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2xlYXJTZWxlY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU2NyaXB0LkNhbGwoXCJ0aGlzLmVkaXRvci5jbGVhclNlbGVjdGlvblwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFJlYWRPbmx5XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFNjcmlwdC5Xcml0ZTxib29sPihcInRoaXMuZWRpdG9yLmdldFJlYWRPbmx5KClcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0IHsgU2NyaXB0LkNhbGwoXCJ0aGlzLmVkaXRvci5zZXRSZWFkT25seVwiLCB2YWx1ZSk7IH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgU291cmNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFNjcmlwdC5Xcml0ZTxzdHJpbmc+KFwidGhpcy5lZGl0b3IuZ2V0VmFsdWUoKVwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0IHsgU2NyaXB0LkNhbGwoXCJ0aGlzLmVkaXRvci5zZXRWYWx1ZVwiLCB2YWx1ZSk7IH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZXR1cCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBFeHRlcm5hbEFjZUNvZGVFZGl0b3IuU2V0dXAoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgQWNlTW9kZVR5cGVzIF9tb2RlVHlwZTtcclxuICAgICAgICBwcml2YXRlIEFjZVRoZW1lVHlwZXMgX3RoZW1lVHlwZTtcclxuXHJcbiAgICAgICAgcHVibGljIEFjZUNvZGVFZGl0b3IoQWNlTW9kZVR5cGVzIG1vZGVUeXBlID0gQWNlTW9kZVR5cGVzLmNzaGFycCwgQWNlVGhlbWVUeXBlcyB0aGVtZVR5cGUgPSBBY2VUaGVtZVR5cGVzLnhjb2RlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgX21vZGVUeXBlID0gbW9kZVR5cGU7XHJcbiAgICAgICAgICAgIF90aGVtZVR5cGUgPSB0aGVtZVR5cGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBSZW5kZXIoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRXh0ZXJuYWxBY2VDb2RlRWRpdG9yLlVzYWdlQ2hlY2soKTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0aGVtZSA9IF9tb2RlVHlwZS5Ub1N0cmluZyhcIkdcIik7XHJcbiAgICAgICAgICAgIHZhciBtb2RlID0gX21vZGVUeXBlLlRvU3RyaW5nKFwiR1wiKTtcclxuXHJcbiAgICAgICAgICAgIC8qQFxyXG5cdFx0XHR0aGlzLmVkaXRvciA9IGFjZS5lZGl0KHRoaXMuY29udGVudCk7XHJcblx0XHRcdHRoaXMuZWRpdG9yLnNldFRoZW1lKFwiYWNlL3RoZW1lL1wiICsgdGhlbWUpO1xyXG5cdFx0XHR0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuc2V0TW9kZShcImFjZS9tb2RlL1wiICsgbW9kZSk7XHJcblx0XHRcdCovXHJcbiAgICAgICAgICAgIHRoaXMuT25SZXNpemUgPSAoY29udCkgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgLypAXHJcblx0XHRcdFx0dGhpcy5lZGl0b3IucmVzaXplKHRydWUpO1xyXG5cdFx0XHRcdCovXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuQWRkRXZlbnRMaXN0ZW5lcihFdmVudFR5cGUuTW91c2VEb3duLCAoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uPGdsb2JhbDo6QnJpZGdlLkh0bWw1LkV2ZW50PikoKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBGb3JtLkluRXh0ZXJuYWxNb3VzZUV2ZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5Db250ZW50LkFkZEV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlVXAsIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEZvcm0uSW5FeHRlcm5hbE1vdXNlRXZlbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgYmFzZS5SZW5kZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudW0gQWNlVGhlbWVUeXBlc1xyXG4gICAge1xyXG4gICAgICAgIGxhYmVsLCAvLyBicmlnaHRcclxuICAgICAgICBjaHJvbWUsIC8vIGNocm9tZVxyXG4gICAgICAgIGNsb3VkcywgLy8gY2xvdWRzXHJcbiAgICAgICAgY3JpbXNvbl9lZGl0b3IsIC8vIGNyaW1zb25fZWRpdG9yXHJcbiAgICAgICAgZGF3biwgLy8gZGF3blxyXG4gICAgICAgIGRyZWFtd2VhdmVyLCAvLyBkcmVhbXdlYXZlclxyXG4gICAgICAgIGVjbGlwc2UsIC8vIGVjbGlwc2VcclxuICAgICAgICBnaXRodWIsIC8vIGdpdGh1YlxyXG4gICAgICAgIHNvbGFyaXplZF9saWdodCwgLy8gc29sYXJpemVkX2xpZ2h0XHJcbiAgICAgICAgdGV4dG1hdGUsIC8vIHRleHRtYXRlXHJcbiAgICAgICAgdG9tb3Jyb3csIC8vIHRvbW9ycm93XHJcbiAgICAgICAgeGNvZGUsIC8vIHhjb2RlXHJcbiAgICAgICAgY2xvdWRzX21pZG5pZ2h0LCAvLyBjbG91ZHNfbWlkbmlnaHRcclxuICAgICAgICBjb2JhbHQsIC8vIGNvYmFsdFxyXG4gICAgICAgIGlkbGVfZmluZ2VycywgLy8gaWRsZV9maW5nZXJzXHJcbiAgICAgICAga3JfdGhlbWUsIC8vIGtyX3RoZW1lXHJcbiAgICAgICAgbWVyYml2b3JlLCAvLyBtZXJiaXZvcmVcclxuICAgICAgICBtZXJiaXZvcmVfc29mdCwgLy8gbWVyYml2b3JlX3NvZnRcclxuICAgICAgICBtb25vX2luZHVzdHJpYWwsIC8vIG1vbm9faW5kdXN0cmlhbFxyXG4gICAgICAgIG1vbm9rYWksIC8vIG1vbm9rYWlcclxuICAgICAgICBwYXN0ZWxfb25fZGFyaywgLy8gcGFzdGVsX29uX2RhcmtcclxuICAgICAgICBzb2xhcml6ZWRfZGFyaywgLy8gc29sYXJpemVkX2RhcmtcclxuICAgICAgICB0ZXJtaW5hbCwgLy8gdGVybWluYWxcclxuICAgICAgICB0b21vcnJvd19uaWdodCwgLy8gdG9tb3Jyb3dfbmlnaHRcclxuICAgICAgICB0b21vcnJvd19uaWdodF9ibHVlLCAvLyB0b21vcnJvd19uaWdodF9ibHVlXHJcbiAgICAgICAgdG9tb3Jyb3dfbmlnaHRfYnJpZ2h0LCAvLyB0b21vcnJvd19uaWdodF9icmlnaHRcclxuICAgICAgICB0b21vcnJvd19uaWdodF9laWdodGllcywgLy8gdG9tb3Jyb3dfbmlnaHRfZWlnaHRpZXNcclxuICAgICAgICB0d2lsaWdodCwgLy8gdHdpbGlnaHRcclxuICAgICAgICB2aWJyYW50X2luayAvLyB2aWJyYW50X2luazwvb3B0aW9uPjwvb3B0Z3JvdXA+XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudW0gQWNlTW9kZVR5cGVzXHJcbiAgICB7XHJcbiAgICAgICAgYWJhcCwgLy8gQUJBUFxyXG4gICAgICAgIGFiYywgLy8gQUJDXHJcbiAgICAgICAgYWN0aW9uc2NyaXB0LCAvLyBBY3Rpb25TY3JpcHRcclxuICAgICAgICBhZGEsIC8vIEFEQVxyXG4gICAgICAgIGFwYWNoZV9jb25mLCAvLyBBcGFjaGUsIC8vIENvbmZcclxuICAgICAgICBhc2NpaWRvYywgLy8gQXNjaWlEb2NcclxuICAgICAgICBhc3NlbWJseV94ODYsIC8vIEFzc2VtYmx5LCAvLyB4ODZcclxuICAgICAgICBhdXRvaG90a2V5LCAvLyBBdXRvSG90S2V5XHJcbiAgICAgICAgYmF0Y2hmaWxlLCAvLyBCYXRjaEZpbGVcclxuICAgICAgICBicm8sIC8vIEJyb1xyXG4gICAgICAgIGNfY3BwLCAvLyBDLCAvLyBhbmQsIC8vIEMrK1xyXG4gICAgICAgIGM5c2VhcmNoLCAvLyBDOVNlYXJjaFxyXG4gICAgICAgIGNpcnJ1LCAvLyBDaXJydVxyXG4gICAgICAgIGNsb2p1cmUsIC8vIENsb2p1cmVcclxuICAgICAgICBjb2JvbCwgLy8gQ29ib2xcclxuICAgICAgICBjb2ZmZWUsIC8vIENvZmZlZVNjcmlwdFxyXG4gICAgICAgIGNvbGRmdXNpb24sIC8vIENvbGRGdXNpb25cclxuICAgICAgICBjc2hhcnAsIC8vIEMjXHJcbiAgICAgICAgY3NzLCAvLyBDU1NcclxuICAgICAgICBjdXJseSwgLy8gQ3VybHlcclxuICAgICAgICBkLCAvLyBEXHJcbiAgICAgICAgZGFydCwgLy8gRGFydFxyXG4gICAgICAgIGRpZmYsIC8vIERpZmZcclxuICAgICAgICBkb2NrZXJmaWxlLCAvLyBEb2NrZXJmaWxlXHJcbiAgICAgICAgZG90LCAvLyBEb3RcclxuICAgICAgICBkcm9vbHMsIC8vIERyb29sc1xyXG4gICAgICAgIGR1bW15LCAvLyBEdW1teVxyXG4gICAgICAgIGR1bW15c3ludGF4LCAvLyBEdW1teVN5bnRheFxyXG4gICAgICAgIGVpZmZlbCwgLy8gRWlmZmVsXHJcbiAgICAgICAgZWpzLCAvLyBFSlNcclxuICAgICAgICBlbGl4aXIsIC8vIEVsaXhpclxyXG4gICAgICAgIGVsbSwgLy8gRWxtXHJcbiAgICAgICAgZXJsYW5nLCAvLyBFcmxhbmdcclxuICAgICAgICBmb3J0aCwgLy8gRm9ydGhcclxuICAgICAgICBmb3J0cmFuLCAvLyBGb3J0cmFuXHJcbiAgICAgICAgZnRsLCAvLyBGcmVlTWFya2VyXHJcbiAgICAgICAgZ2NvZGUsIC8vIEdjb2RlXHJcbiAgICAgICAgZ2hlcmtpbiwgLy8gR2hlcmtpblxyXG4gICAgICAgIGdpdGlnbm9yZSwgLy8gR2l0aWdub3JlXHJcbiAgICAgICAgZ2xzbCwgLy8gR2xzbFxyXG4gICAgICAgIGdvYnN0b25lcywgLy8gR29ic3RvbmVzXHJcbiAgICAgICAgZ29sYW5nLCAvLyBHb1xyXG4gICAgICAgIGdyb292eSwgLy8gR3Jvb3Z5XHJcbiAgICAgICAgaGFtbCwgLy8gSEFNTFxyXG4gICAgICAgIGhhbmRsZWJhcnMsIC8vIEhhbmRsZWJhcnNcclxuICAgICAgICBoYXNrZWxsLCAvLyBIYXNrZWxsXHJcbiAgICAgICAgaGFza2VsbF9jYWJhbCwgLy8gSGFza2VsbCwgLy8gQ2FiYWxcclxuICAgICAgICBoYXhlLCAvLyBoYVhlXHJcbiAgICAgICAgaGpzb24sIC8vIEhqc29uXHJcbiAgICAgICAgaHRtbCwgLy8gSFRNTFxyXG4gICAgICAgIGh0bWxfZWxpeGlyLCAvLyBIVE1MLCAvLyAoRWxpeGlyKVxyXG4gICAgICAgIGh0bWxfcnVieSwgLy8gSFRNTCwgLy8gKFJ1YnkpXHJcbiAgICAgICAgaW5pLCAvLyBJTklcclxuICAgICAgICBpbywgLy8gSW9cclxuICAgICAgICBqYWNrLCAvLyBKYWNrXHJcbiAgICAgICAgamFkZSwgLy8gSmFkZVxyXG4gICAgICAgIGphdmEsIC8vIEphdmFcclxuICAgICAgICBqYXZhc2NyaXB0LCAvLyBKYXZhU2NyaXB0XHJcbiAgICAgICAganNvbiwgLy8gSlNPTlxyXG4gICAgICAgIGpzb25pcSwgLy8gSlNPTmlxXHJcbiAgICAgICAganNwLCAvLyBKU1BcclxuICAgICAgICBqc3gsIC8vIEpTWFxyXG4gICAgICAgIGp1bGlhLCAvLyBKdWxpYVxyXG4gICAgICAgIGtvdGxpbiwgLy8gS290bGluXHJcbiAgICAgICAgbGF0ZXgsIC8vIExhVGVYXHJcbiAgICAgICAgbGVzcywgLy8gTEVTU1xyXG4gICAgICAgIGxpcXVpZCwgLy8gTGlxdWlkXHJcbiAgICAgICAgbGlzcCwgLy8gTGlzcFxyXG4gICAgICAgIGxpdmVzY3JpcHQsIC8vIExpdmVTY3JpcHRcclxuICAgICAgICBsb2dpcWwsIC8vIExvZ2lRTFxyXG4gICAgICAgIGxzbCwgLy8gTFNMXHJcbiAgICAgICAgbHVhLCAvLyBMdWFcclxuICAgICAgICBsdWFwYWdlLCAvLyBMdWFQYWdlXHJcbiAgICAgICAgbHVjZW5lLCAvLyBMdWNlbmVcclxuICAgICAgICBtYWtlZmlsZSwgLy8gTWFrZWZpbGVcclxuICAgICAgICBtYXJrZG93biwgLy8gTWFya2Rvd25cclxuICAgICAgICBtYXNrLCAvLyBNYXNrXHJcbiAgICAgICAgbWF0bGFiLCAvLyBNQVRMQUJcclxuICAgICAgICBtYXplLCAvLyBNYXplXHJcbiAgICAgICAgbWVsLCAvLyBNRUxcclxuICAgICAgICBtdXNoY29kZSwgLy8gTVVTSENvZGVcclxuICAgICAgICBteXNxbCwgLy8gTXlTUUxcclxuICAgICAgICBuaXgsIC8vIE5peFxyXG4gICAgICAgIG5zaXMsIC8vIE5TSVNcclxuICAgICAgICBvYmplY3RpdmVjLCAvLyBPYmplY3RpdmUtQ1xyXG4gICAgICAgIG9jYW1sLCAvLyBPQ2FtbFxyXG4gICAgICAgIHBhc2NhbCwgLy8gUGFzY2FsXHJcbiAgICAgICAgcGVybCwgLy8gUGVybFxyXG4gICAgICAgIHBnc3FsLCAvLyBwZ1NRTFxyXG4gICAgICAgIHBocCwgLy8gUEhQXHJcbiAgICAgICAgcG93ZXJzaGVsbCwgLy8gUG93ZXJzaGVsbFxyXG4gICAgICAgIHByYWF0LCAvLyBQcmFhdFxyXG4gICAgICAgIHByb2xvZywgLy8gUHJvbG9nXHJcbiAgICAgICAgcHJvcGVydGllcywgLy8gUHJvcGVydGllc1xyXG4gICAgICAgIHByb3RvYnVmLCAvLyBQcm90b2J1ZlxyXG4gICAgICAgIHB5dGhvbiwgLy8gUHl0aG9uXHJcbiAgICAgICAgciwgLy8gUlxyXG4gICAgICAgIHJhem9yLCAvLyBSYXpvclxyXG4gICAgICAgIHJkb2MsIC8vIFJEb2NcclxuICAgICAgICByaHRtbCwgLy8gUkhUTUxcclxuICAgICAgICByc3QsIC8vIFJTVFxyXG4gICAgICAgIHJ1YnksIC8vIFJ1YnlcclxuICAgICAgICBydXN0LCAvLyBSdXN0XHJcbiAgICAgICAgc2FzcywgLy8gU0FTU1xyXG4gICAgICAgIHNjYWQsIC8vIFNDQURcclxuICAgICAgICBzY2FsYSwgLy8gU2NhbGFcclxuICAgICAgICBzY2hlbWUsIC8vIFNjaGVtZVxyXG4gICAgICAgIHNjc3MsIC8vIFNDU1NcclxuICAgICAgICBzaCwgLy8gU0hcclxuICAgICAgICBzanMsIC8vIFNKU1xyXG4gICAgICAgIHNtYXJ0eSwgLy8gU21hcnR5XHJcbiAgICAgICAgc25pcHBldHMsIC8vIHNuaXBwZXRzXHJcbiAgICAgICAgc295X3RlbXBsYXRlLCAvLyBTb3ksIC8vIFRlbXBsYXRlXHJcbiAgICAgICAgc3BhY2UsIC8vIFNwYWNlXHJcbiAgICAgICAgc3FsLCAvLyBTUUxcclxuICAgICAgICBzcWxzZXJ2ZXIsIC8vIFNRTFNlcnZlclxyXG4gICAgICAgIHN0eWx1cywgLy8gU3R5bHVzXHJcbiAgICAgICAgc3ZnLCAvLyBTVkdcclxuICAgICAgICBzd2lmdCwgLy8gU3dpZnRcclxuICAgICAgICB0Y2wsIC8vIFRjbFxyXG4gICAgICAgIHRleCwgLy8gVGV4XHJcbiAgICAgICAgdGV4dCwgLy8gVGV4dFxyXG4gICAgICAgIHRleHRpbGUsIC8vIFRleHRpbGVcclxuICAgICAgICB0b21sLCAvLyBUb21sXHJcbiAgICAgICAgdHN4LCAvLyBUU1hcclxuICAgICAgICB0d2lnLCAvLyBUd2lnXHJcbiAgICAgICAgdHlwZXNjcmlwdCwgLy8gVHlwZXNjcmlwdFxyXG4gICAgICAgIHZhbGEsIC8vIFZhbGFcclxuICAgICAgICB2YnNjcmlwdCwgLy8gVkJTY3JpcHRcclxuICAgICAgICB2ZWxvY2l0eSwgLy8gVmVsb2NpdHlcclxuICAgICAgICB2ZXJpbG9nLCAvLyBWZXJpbG9nXHJcbiAgICAgICAgdmhkbCwgLy8gVkhETFxyXG4gICAgICAgIHdvbGxvaywgLy8gV29sbG9rXHJcbiAgICAgICAgeG1sLCAvLyBYTUxcclxuICAgICAgICB4cXVlcnksIC8vIFhRdWVyeVxyXG4gICAgICAgIHlhbWwsIC8vIFlBTUxcclxuICAgICAgICBkamFuZ28gLy8gRGphbmdvXHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2U7XHJcbnVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgQnJpZGdlLmpRdWVyeTI7XHJcbnVzaW5nIFN5c3RlbTtcclxudXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWM7XHJcbnVzaW5nIFN5c3RlbS5MaW5xO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgRm9ybSA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIEhUTUxEaXZFbGVtZW50IFdpbmRvd0hvbGRlcjtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIExpc3Q8Rm9ybT4gTWluaW1pemVkRm9ybXMgPSBuZXcgTGlzdDxGb3JtPigpO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgSFRNTERpdkVsZW1lbnQgV2luZG93TG9hZGVyO1xyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBUb29sVGlwIF9hY3RpdmVUb29sVGlwO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGludCBfdG9vbFRpcFRpbWVySGFuZGxlID0gLTE7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgQWN0aW9uPE1vdXNlRXZlbnQ+IF9hY3RpdmVUb29sVGlwTW91c2VNb3ZlO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIFRvb2xUaXBDb250cm9sIF9hY3RpdmVUb29sVGlwQ29udHJvbCA9IG51bGw7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgaW50IF9vZXBudG9vbFRpcFRpbWVySGFuZGxlID0gLTE7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgVG9vbFRpcCBBY3RpdmVUb29sVGlwXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX2FjdGl2ZVRvb2xUaXA7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9hY3RpdmVUb29sVGlwICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZhbHVlICE9IG51bGwgJiYgdmFsdWUuQXR0YWNoZWRDb250cm9sICE9IG51bGwgJiYgdmFsdWUuQXR0YWNoZWRDb250cm9sLkNvbnRlbnQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9hY3RpdmVUb29sVGlwTW91c2VNb3ZlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLkF0dGFjaGVkQ29udHJvbC5Db250ZW50LlJlbW92ZUV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlTW92ZSwgX2FjdGl2ZVRvb2xUaXBNb3VzZU1vdmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVRvb2xUaXBNb3VzZU1vdmUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKF9hY3RpdmVUb29sVGlwQ29udHJvbCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVRvb2xUaXBDb250cm9sLkNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hY3RpdmVUb29sVGlwQ29udHJvbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKF90b29sVGlwVGltZXJIYW5kbGUgPiAtMSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEdsb2JhbC5DbGVhclRpbWVvdXQoX3Rvb2xUaXBUaW1lckhhbmRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90b29sVGlwVGltZXJIYW5kbGUgPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF9hY3RpdmVUb29sVGlwID0gdmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGludCBtZXNzYWdlTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKF9hY3RpdmVUb29sVGlwICE9IG51bGwgJiYgKG1lc3NhZ2VMZW5ndGggPSBfYWN0aXZlVG9vbFRpcC5HZXRXb3JkQ291bnQoKSkgPiAwICYmIF9hY3RpdmVUb29sVGlwLkF0dGFjaGVkQ29udHJvbCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVRvb2xUaXBNb3VzZU1vdmUgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKF90b29sVGlwVGltZXJIYW5kbGUgPiAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHbG9iYWwuQ2xlYXJUaW1lb3V0KF90b29sVGlwVGltZXJIYW5kbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Rvb2xUaXBUaW1lckhhbmRsZSA9IEdsb2JhbC5TZXRUaW1lb3V0KChnbG9iYWw6OlN5c3RlbS5BY3Rpb24pKCgpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoX2FjdGl2ZVRvb2xUaXBDb250cm9sICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWN0aXZlVG9vbFRpcENvbnRyb2wuQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVRvb2xUaXBDb250cm9sID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoX29lcG50b29sVGlwVGltZXJIYW5kbGUgPiAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdsb2JhbC5DbGVhclRpbWVvdXQoX29lcG50b29sVGlwVGltZXJIYW5kbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2VwbnRvb2xUaXBUaW1lckhhbmRsZSA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWN0aXZlVG9vbFRpcENvbnRyb2wgPSBuZXcgVG9vbFRpcENvbnRyb2woX2FjdGl2ZVRvb2xUaXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hY3RpdmVUb29sVGlwQ29udHJvbC5TaG93KGV2KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29lcG50b29sVGlwVGltZXJIYW5kbGUgPSBHbG9iYWwuU2V0VGltZW91dCgoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uKSgoKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoX2FjdGl2ZVRvb2xUaXBDb250cm9sICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hY3RpdmVUb29sVGlwQ29udHJvbC5DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVRvb2xUaXBDb250cm9sID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBNYXRoLk1heCgxMDAwLCBtZXNzYWdlTGVuZ3RoICogTWF0aC5NYXgoU2V0dGluZ3MuVG9vbFRpcFBvcHVwU3RheU9wZW5EZWxheVBlcldvcmRNcywgMTApKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9hY3RpdmVUb29sVGlwTW91c2VNb3ZlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5BdHRhY2hlZENvbnRyb2wuQ29udGVudC5SZW1vdmVFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZU1vdmUsIF9hY3RpdmVUb29sVGlwTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVRvb2xUaXBNb3VzZU1vdmUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBNYXRoLk1heCgxLCBTZXR0aW5ncy5Ub29sVGlwUG9wdXBEZWxheU1zKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLkF0dGFjaGVkQ29udHJvbC5Db250ZW50LkFkZEV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlTW92ZSwgX2FjdGl2ZVRvb2xUaXBNb3VzZU1vdmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSW5EZXNpZ24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgUmVzaXplQ29ybmVycyA9IDI7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBGb3JtIE1vdmluZ0Zvcm0gPSBudWxsO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgSFRNTEVsZW1lbnQgUGFyZW50ID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGJvb2wgTW91c2VfRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBNZW51T3BlbiA9IGZhbHNlO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgSFRNTEVsZW1lbnQgRm9ybU92ZXJMYXk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYm9vbCBfaGFzU2V0dXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSGFzU2V0dXAgeyBnZXQgeyByZXR1cm4gX2hhc1NldHVwOyB9IH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBib29sIFByZXZpb3VzU2l6ZUNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgcHJpdmF0ZSBib29sIFByZXZpb3VzTW92ZUNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgcHJpdmF0ZSBib29sIFByZXZpb3VzU2hvd01heCA9IHRydWU7XHJcbiAgICAgICAgcHJpdmF0ZSBib29sIFByZXZpb3VzU2hvd01pbiA9IHRydWU7XHJcbiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgUHJldmlvdXNPcGFjaXR5ID0gXCJcIjtcclxuICAgICAgICBwcm90ZWN0ZWQgYm9vbCBIYXNSZW1vdmVkUGxhY2VIb2xkZXI7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIEFsbG93U2l6ZUNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgcHVibGljIGJvb2wgQWxsb3dNb3ZlQ2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcHVibGljIEhUTUxDb2xsZWN0aW9uIENvbnRyb2xzIHtnZXR7cmV0dXJuIEJvZHkuQ2hpbGRyZW47fX1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIEluRXh0ZXJuYWxNb3VzZUV2ZW50ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFNob3dNaW5pbWl6ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIEJ1dHRvbk1pbmltaXplICE9IG51bGw7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENoYW5nZUhlYWRpbmdCdXR0b24oRm9ybUJ1dHRvblR5cGUuTWluaW1pemUsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIENTU1N0eWxlRGVjbGFyYXRpb24gQm9keVN0eWxlIHtnZXR7cmV0dXJuIEJvZHkuU3R5bGU7fX1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgU2hvd0Nsb3NlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gQnV0dG9uQ2xvc2UgIT0gbnVsbDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2hhbmdlSGVhZGluZ0J1dHRvbihGb3JtQnV0dG9uVHlwZS5DbG9zZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBTaG93TWF4aW1pemVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBCdXR0b25FeHBhbmQgIT0gbnVsbDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2hhbmdlSGVhZGluZ0J1dHRvbihGb3JtQnV0dG9uVHlwZS5NYXhpbWl6ZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBTaG93TWVudVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIEJ1dHRvbk1lbnUgIT0gbnVsbDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2hhbmdlSGVhZGluZ0J1dHRvbihGb3JtQnV0dG9uVHlwZS5NZW51LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIEZvclJldXNlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBzdGF0aWMgYm9vbCBJbkVycm9yRGlhbG9nID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBqUXVlcnkgU2VsZjtcclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIGJvb2wgX0lzRGlhbG9nID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIElzRGlhbG9nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBfSXNEaWFsb2c7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIExpc3Q8Q29udHJvbD4gQ2hpbGRyZW4gPSBuZXcgTGlzdDxDb250cm9sPigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBMaW5rY2hpbGRUb0Zvcm0oQ29udHJvbCBjaGlsZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGNoaWxkID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIENoaWxkcmVuLkFkZChjaGlsZCk7XHJcbiAgICAgICAgICAgIGNoaWxkLkxpbmtlZEZvcm0gPSB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgTGlua2NoaWxkcmVuVG9Gb3JtKHBhcmFtcyBDb250cm9sW10gY2hpbGRyZW4pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihjaGlsZHJlbiA9PSBudWxsIHx8IGNoaWxkcmVuLkxlbmd0aCA9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBDaGlsZHJlbi5BZGRSYW5nZShjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBjaGlsZHJlbi5MZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW5baV0uTGlua2VkRm9ybSA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBGb3JtIEFwcGVuZENoaWxkKENvbnRyb2wgbm9kZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5BcHBlbmRDaGlsZChub2RlKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEZvcm0gQXBwZW5kQ2hpbGRyZW4ocGFyYW1zIENvbnRyb2xbXSBub2RlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5Cb2R5LkFwcGVuZENoaWxkcmVuKG5vZGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgRm9ybSBBcHBlbmRDaGlsZChIVE1MRWxlbWVudCBub2RlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5Cb2R5LkFwcGVuZENoaWxkKG5vZGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgRm9ybSBBcHBlbmRDaGlsZHJlbihwYXJhbXMgSFRNTEVsZW1lbnRbXSBub2RlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5Cb2R5LkFwcGVuZENoaWxkcmVuKG5vZGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgc3RhdGljIEZvcm1Db2xsZWN0aW9uIHN0YW5kQWxvbmVGb3JtcyA9IG5ldyBGb3JtQ29sbGVjdGlvbihudWxsKTtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIExpc3Q8Rm9ybUNvbGxlY3Rpb24+IEZvcm1Db2xsZWN0aW9ucyA9IG5ldyBMaXN0PEZvcm1Db2xsZWN0aW9uPigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgRm9ybVN0YXJ0UG9zaXRpb24gU3RhcnRQb3NpdGlvbiA9IEZvcm1TdGFydFBvc2l0aW9uLldpbmRvd3NEZWZhdWx0TG9jYXRpb247XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBTaG93Qm9keU92ZXJMYXkgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgV2luZG93X0RlZmF1bHRIZWlnaHQgPSA0ODA7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgV2luZG93X0RlZmF1bHRXaWR0aCA9IDY0MDtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgRm9ybSBfQWN0aXZlRm9ybTtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBGb3JtIF9QcmV2QWN0aXZlRm9ybTtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBNb3VzZU1vdmVBY3Rpb24gTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5Nb3ZlO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBUb3BNb3N0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBEaWFsb2dSZXN1bHRFbnVtIERpYWxvZ1Jlc3VsdCA9IERpYWxvZ1Jlc3VsdEVudW0uTm9uZTtcclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgV2luZG93SG9sZGVyU2VsZWN0aW9uQm94WDtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBXaW5kb3dIb2xkZXJTZWxlY3Rpb25Cb3hZO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGludCBXaW5kb3dIb2xkZXJTZWxlY3Rpb25Cb3hYT2ZmO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgaW50IFdpbmRvd0hvbGRlclNlbGVjdGlvbkJveFlPZmY7XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBIVE1MRGl2RWxlbWVudCBIZWFkaW5nO1xyXG4gICAgICAgIHByb3RlY3RlZCBIVE1MRGl2RWxlbWVudCBCdXR0b25DbG9zZTtcclxuICAgICAgICBwcm90ZWN0ZWQgSFRNTERpdkVsZW1lbnQgQnV0dG9uRXhwYW5kO1xyXG4gICAgICAgIHByb3RlY3RlZCBIVE1MRGl2RWxlbWVudCBCdXR0b25NaW5pbWl6ZTtcclxuICAgICAgICBwcm90ZWN0ZWQgSFRNTERpdkVsZW1lbnQgQnV0dG9uTWVudTtcclxuICAgICAgICBwcm90ZWN0ZWQgSFRNTFNwYW5FbGVtZW50IEhlYWRpbmdUaXRsZTtcclxuXHJcbiAgICAgICAgcHVibGljIEhUTUxEaXZFbGVtZW50IEJvZHk7XHJcbiAgICAgICAgcHVibGljIEhUTUxEaXZFbGVtZW50IEJvZHlPdmVyTGF5O1xyXG5cclxuICAgICAgICBwdWJsaWMgZmxvYXQgcHJldl9weDtcclxuICAgICAgICBwdWJsaWMgZmxvYXQgcHJldl9weTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgcHJldl93aWR0aDtcclxuICAgICAgICBwcml2YXRlIGludCBwcmV2X2hlaWdodDtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgcHJldl90b3A7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgcHJldl9sZWZ0O1xyXG5cclxuICAgICAgICBwdWJsaWMgaW50IE1pbldpZHRoID0gMjAwO1xyXG4gICAgICAgIHB1YmxpYyBpbnQgTWluSGVpZ2h0ID0gNTA7XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFJlc2l6ZUNoaWxkcmVuKEhUTUxFbGVtZW50IHBhcmVudClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKE9uUmVzaXplICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBPblJlc2l6ZSh0aGlzKTtcclxuICAgICAgICAgICAgT25SZXNpemluZygpO1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCB4ID0gMDsgeCA8IHBhcmVudC5DaGlsZHJlbi5MZW5ndGg7IHgrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIXBhcmVudC5DaGlsZHJlblt4XS5DbGFzc0xpc3QuQ29udGFpbnMoXCJjb250cm9sXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENoaWxkcmVuLkNvdW50OyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQ2hpbGRyZW5baV0gIT0gbnVsbCAmJiBDaGlsZHJlbltpXS5PblJlc2l6ZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoQ2hpbGRyZW5baV0uQ29udGVudCA9PSBwYXJlbnQuQ2hpbGRyZW5beF0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENoaWxkcmVuW2ldLk9uUmVzaXplKENoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgUmVzaXplQ2hpbGRyZW4ocGFyZW50LkNoaWxkcmVuW3hdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUmVzaXppbmcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoT25SZXNpemUgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIE9uUmVzaXplKHRoaXMpO1xyXG4gICAgICAgICAgICBPblJlc2l6aW5nKCk7XHJcblxyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgQ2hpbGRyZW4uQ291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoQ2hpbGRyZW5baV0gIT0gbnVsbCAmJiBDaGlsZHJlbltpXS5PblJlc2l6ZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIENoaWxkcmVuW2ldLk9uUmVzaXplKENoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgdm9pZCBPblJlc2l6aW5nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIFdpbmRvd1N0YXRlVHlwZSB3aW5kb3dTdGF0ZTtcclxuICAgICAgICBwcml2YXRlIFdpbmRvd1N0YXRlVHlwZSBfcHJldndpbmRvd1N0YXRlID0gV2luZG93U3RhdGVUeXBlLk5vcm1hbDtcclxuXHJcbiAgICAgICAgcHVibGljIFdpbmRvd1N0YXRlVHlwZSBXaW5kb3dTdGF0ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIHdpbmRvd1N0YXRlOyB9XHJcbiAgICAgICAgICAgIHNldCB7IFNldFdpbmRvd1N0YXRlKHZhbHVlKTsgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIE1pZGxlT2ZBY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1vdmluZ0Zvcm0gIT0gbnVsbDsgLy8gV2luZG93SG9sZGVyU2VsZWN0aW9uQm94ICE9IG51bGwgfHxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIElzQ29udGVudFZpc2libGUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIENvbnRlbnQgIT0gbnVsbCAmJiBDb250ZW50LlN0eWxlLlZpc2liaWxpdHkuRXF1YWxzKFZpc2liaWxpdHkuVmlzaWJsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDaGFuZ2VIZWFkaW5nQnV0dG9uKEZvcm1CdXR0b25UeXBlIGJ1dHRvbiwgYm9vbCB2aXNpYmxlID0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHN3aXRjaChidXR0b24pXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgRm9ybUJ1dHRvblR5cGUuTWluaW1pemU6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQnV0dG9uTWluaW1pemUgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbk1pbmltaXplLkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25NaW5pbWl6ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZpc2libGUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25NaW5pbWl6ZSA9IENyZWF0ZUZvcm1CdXR0b24oYnV0dG9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRm9ybUJ1dHRvblR5cGUuTWF4aW1pemU6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQnV0dG9uRXhwYW5kICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25FeHBhbmQuRGVsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbkV4cGFuZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZpc2libGUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25FeHBhbmQgPSBDcmVhdGVGb3JtQnV0dG9uKGJ1dHRvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRm9ybUJ1dHRvblR5cGUuQ2xvc2U6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQnV0dG9uQ2xvc2UgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbkNsb3NlLkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25DbG9zZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZpc2libGUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25DbG9zZSA9IENyZWF0ZUZvcm1CdXR0b24oYnV0dG9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBGb3JtQnV0dG9uVHlwZS5NZW51OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmKEJ1dHRvbk1lbnUgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbk1lbnUuRGVsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbk1lbnUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZih2aXNpYmxlKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uTWVudSA9IENyZWF0ZUZvcm1CdXR0b24oYnV0dG9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgQ2FsY3VsYXRlQnV0dG9uTG9jYXRpb25zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCB2b2lkIEluaXRpYWxpc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCB2aXJ0dWFsIHZvaWQgT25TaG93aW5nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCB2b2lkIE9uU2hvd2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCB2b2lkIE9uQ2xvc2luZygpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIHZpcnR1YWwgdm9pZCBPbkNsb3NlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEFjdGlvbiBPbkZvcm1DbG9zZWQgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIEZvcm1Db2xsZWN0aW9uIEdldEFjdGl2ZUZvcm1Db2xsZWN0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IEZvcm1Db2xsZWN0aW9ucy5Db3VudCAtIDE7IGkgPj0gMDsgaS0tKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZnJtQ29sID0gRm9ybUNvbGxlY3Rpb25zW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYoZnJtQ29sLkZvcm1Pd25lciA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCBmcm1Db2wuVmlzaWJsZUZvcm1zLkNvdW50OyB4KyspXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihmcm1Db2wuVmlzaWJsZUZvcm1zW3hdICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZybUNvbC5WaXNpYmxlRm9ybXNbeF0uQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBGb3JtQ29sbGVjdGlvbnMuUmVtb3ZlQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZybUNvbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0Qm9keU92ZXJMYXkoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIEFjdGl2ZUNvbGxlY3Rpb24gPSBHZXRBY3RpdmVGb3JtQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICBpZihBY3RpdmVDb2xsZWN0aW9uID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBBY3RpdmVDb2xsZWN0aW9uLkZvcm1Pd25lci5TaG93Qm9keU92ZXJMYXlTdHlsZSgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIFZpc2libGVGb3JtcyA9IEFjdGl2ZUNvbGxlY3Rpb24uVmlzaWJsZUZvcm1zO1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IFZpc2libGVGb3Jtcy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IFZpc2libGVGb3Jtc1tpXTtcclxuICAgICAgICAgICAgICAgIGlmKGZvcm0gIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3JtLlNob3dCb2R5T3ZlckxheVN0eWxlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNob3dCb2R5T3ZlckxheVN0eWxlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKEJvZHlPdmVyTGF5ICE9IG51bGwgJiZcclxuICAgICAgICAgICAgICAgIEJvZHlPdmVyTGF5LlN0eWxlLlZpc2liaWxpdHkuRXF1YWxzKFZpc2liaWxpdHkuQ29sbGFwc2UpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihJbkRlc2lnbilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBCb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5WaXNpYmxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgdmlydHVhbCB2b2lkIE9uR290Rm9jdXMoKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCB2aXJ0dWFsIHZvaWQgT25Mb3N0Rm9jdXMoKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgRm9ybSBBY3RpdmVGb3JtXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX0FjdGl2ZUZvcm07IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9BY3RpdmVGb3JtICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9QcmV2QWN0aXZlRm9ybSA9IF9BY3RpdmVGb3JtO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihfQWN0aXZlRm9ybSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX0FjdGl2ZUZvcm0uT25Mb3N0Rm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoX0FjdGl2ZUZvcm0uQ29udGVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihfQWN0aXZlRm9ybS5JbkRlc2lnbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfQWN0aXZlRm9ybS5Cb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5Db2xsYXBzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfQWN0aXZlRm9ybS5Cb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5WaXNpYmxlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIF9BY3RpdmVGb3JtID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoX0FjdGl2ZUZvcm0gIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9BY3RpdmVGb3JtLk9uR290Rm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoX0FjdGl2ZUZvcm0uQ29udGVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfQWN0aXZlRm9ybS5Cb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5Db2xsYXBzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9BY3RpdmVGb3JtLkJyaW5nVG9Gcm9udCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKF9QcmV2QWN0aXZlRm9ybSBpcyBGb3JtUG9wdXAgJiYgKChfQWN0aXZlRm9ybSAhPSBudWxsICYmICEoX0FjdGl2ZUZvcm0gaXMgRm9ybVBvcHVwKSkgfHwgX0FjdGl2ZUZvcm0gPT0gbnVsbCkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDbG9zZUZvcm1Qb3B1cHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBDaGFuZ2VTdGF0ZVRleHRTZWxlY3Rpb24oSFRNTEVsZW1lbnQgZWxlbWVudCwgYm9vbCBzdGF0ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGpRdWVyeS5TZWxlY3QoZWxlbWVudCkuQ3NzKFwidXNlci1zZWxlY3RcIiwgc3RhdGUgPyBcInRleHRcIiA6IFwibm9uZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBQZXJmb3JtRm9jdXNTaGFrZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihBY3RpdmVGb3JtICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBmb3JtID0gQWN0aXZlRm9ybTtcclxuICAgICAgICAgICAgICAgIGZvcm0uSGVhZGluZy5DbGFzc0xpc3QuQWRkKFwiZm9ybS1oZWFkaW5nLWZsYXNoXCIpO1xyXG4gICAgICAgICAgICAgICAgR2xvYmFsLlNldFRpbWVvdXQoKGdsb2JhbDo6U3lzdGVtLkFjdGlvbikoKCkgPT5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3JtLkhlYWRpbmcuQ2xhc3NMaXN0LlJlbW92ZShcImZvcm0taGVhZGluZy1mbGFzaFwiKTtcclxuICAgICAgICAgICAgICAgIH0pLCA4MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgRGlzYWJsZVN0YXRlRHJhZyhIVE1MRWxlbWVudCBlbGVtZW50KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoZWxlbWVudCBpcyBIVE1MSW1hZ2VFbGVtZW50KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LkFzPEhUTUxJbWFnZUVsZW1lbnQ+KCkuT25EcmFnU3RhcnQgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBqUXVlcnkuU2VsZWN0KGVsZW1lbnQpLkNzcyhcInVzZXItZHJhZzpcIiwgXCJub25lXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0dXBIaWRlRWxlbWVudHNPblZpZXcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgV2luZG93Lk9uQmx1ciA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5Db250YWluczxnbG9iYWw6OkJyaWRnZS5IdG1sNS5Ob2RlPihEb2N1bWVudC5Cb2R5LkNoaWxkTm9kZXMsV2luZG93SG9sZGVyKSlcclxuICAgICAgICAgICAgICAgICAgICBEb2N1bWVudC5Cb2R5LlJlbW92ZUNoaWxkKFdpbmRvd0hvbGRlcik7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBXaW5kb3cuT25Gb2N1cyA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIVN5c3RlbS5MaW5xLkVudW1lcmFibGUuQ29udGFpbnM8Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuTm9kZT4oRG9jdW1lbnQuQm9keS5DaGlsZE5vZGVzLFdpbmRvd0hvbGRlcikpXHJcbiAgICAgICAgICAgICAgICAgICAgRG9jdW1lbnQuQm9keS5BcHBlbmRDaGlsZChXaW5kb3dIb2xkZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIENsb3NlRm9ybVBvcHVwcygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHggPSBHZXRBY3RpdmVGb3JtQ29sbGVjdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCB4LlZpc2libGVGb3Jtcy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHguVmlzaWJsZUZvcm1zW2ldICE9IG51bGwgJiYgeC5WaXNpYmxlRm9ybXNbaV0gaXMgRm9ybVBvcHVwICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHguVmlzaWJsZUZvcm1zW2ldLklzQ29udGVudFZpc2libGUoKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHguVmlzaWJsZUZvcm1zW2ldLkNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoeC5Gb3JtT3duZXIgaXMgRm9ybVBvcHVwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHguRm9ybU93bmVyLkNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGludCBMb2FkaW5nQ291bnQgPSAwO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgQmVnaW5Mb2FkaW5nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIExvYWRpbmdDb3VudCsrO1xyXG4gICAgICAgICAgICBXaW5kb3dMb2FkZXIuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuVmlzaWJsZTtcclxuICAgICAgICAgICAgV2luZG93TG9hZGVyLlN0eWxlLk9wYWNpdHkgPSBcIjAuNFwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEVuZExvYWRpbmcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTG9hZGluZ0NvdW50LS07XHJcbiAgICAgICAgICAgIGlmKExvYWRpbmdDb3VudCA9PSAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBXaW5kb3dMb2FkZXIuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuSGlkZGVuO1xyXG4gICAgICAgICAgICAgICAgV2luZG93TG9hZGVyLlN0eWxlLk9wYWNpdHkgPSBcIjBcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIFNldHVwKEhUTUxFbGVtZW50IHBhcmVudCA9IG51bGwpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvL1NldHRpbmdzLlNldHVwKCk7XHJcbiAgICAgICAgICAgIGlmKF9oYXNTZXR1cClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgX2hhc1NldHVwID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIGlmKHBhcmVudCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgUGFyZW50ID0gRG9jdW1lbnQuQm9keTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgUGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgV2luZG93SG9sZGVyID0gRGl2KFwiZm9ybS1jb250YWluZXJcIik7XHJcblxyXG4gICAgICAgICAgICBGb3JtT3ZlckxheSA9IERpdihcInN5c3RlbS1mb3JtLWNvbGxlY3Rpb24tb3ZlcmxheVwiKTtcclxuXHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlciA9IG5ldyBIVE1MRGl2RWxlbWVudCgpO1xyXG4gICAgICAgICAgICBXaW5kb3dMb2FkZXIuQ2xhc3NOYW1lID0gXCJhamF4LWxvYWRpbmctc2NyZWVuXCI7XHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlci5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5IaWRkZW47XHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlci5TdHlsZS5PcGFjaXR5ID0gXCIwXCI7XHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlci5TdHlsZS5CYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlci5TZXRCb3VuZHNGdWxsKCk7XHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlci5TdHlsZS5Qb3NpdGlvbiA9IFBvc2l0aW9uLkZpeGVkO1xyXG4gICAgICAgICAgICBXaW5kb3dMb2FkZXIuU3R5bGUuWkluZGV4ID0gXCIxMDAwMDBcIjtcclxuICAgICAgICAgICAgV2luZG93TG9hZGVyLk9uQ29udGV4dE1lbnUgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFdpbmRvd0xvYWRlci5Pbk1vdXNlRG93biA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBXaW5kb3dMb2FkZXIuU3R5bGUuVHJhbnNpdGlvbiA9IFwib3BhY2l0eSAxcyBlYXNlXCI7XHJcblxyXG4gICAgICAgICAgICBEb2N1bWVudC5Cb2R5LkFwcGVuZENoaWxkKFdpbmRvd0xvYWRlcik7XHJcblxyXG4gICAgICAgICAgICBGb3JtT3ZlckxheS5Pbk1vdXNlRG93biA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoQWN0aXZlRm9ybSBpcyBGb3JtUG9wdXApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xvc2VGb3JtUG9wdXBzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoRG9jdW1lbnQuQWN0aXZlRWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vRm9ybVBvcHVwXHJcbiAgICAgICAgICAgICAgICAgICAgRG9jdW1lbnQuQWN0aXZlRWxlbWVudC5Gb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgRm9ybU92ZXJMYXkuT25DbGljayA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUGVyZm9ybUZvY3VzU2hha2UoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgRm9ybU92ZXJMYXkuT25Db250ZXh0TWVudSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBGb3JtT3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5WaXNpYmxlO1xyXG5cclxuICAgICAgICAgICAgV2luZG93Lk9uS2V5VXAgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKFNldHRpbmdzLk9uRjJTaG93VGhlbWVGb3JtICYmIGV2LktleUNvZGUgPT0gS2V5Q29kZXMuRjIpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBUaGVtZUZvcm0uU2hvd1RoZW1lRm9ybSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgV2luZG93Lk9uUmVzaXplID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihGb3JtQ29sbGVjdGlvbnMgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IEZvcm1Db2xsZWN0aW9ucy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKEZvcm1Db2xsZWN0aW9uc1tpXSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmMgPSBGb3JtQ29sbGVjdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZmMuRm9ybU93bmVyICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZjLkZvcm1Pd25lci5SZXNpemluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCBmYy5WaXNpYmxlRm9ybXMuQ291bnQ7IHgrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZjLlZpc2libGVGb3Jtc1t4XSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmMuVmlzaWJsZUZvcm1zW3hdLlJlc2l6aW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIENhbGN1bGF0ZU1pbm1pemVkRm9ybXNMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgV2luZG93Lk9uTW91c2VNb3ZlID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihJbkV4dGVybmFsTW91c2VFdmVudClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG1ldiA9IGV2LkFzPE1vdXNlRXZlbnQ+KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXYuU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIE1vdmluZ0Zvcm0uU3R5bGUuQm94U2hhZG93ID0gXCJub25lXCI7IC8vIGJveCAtIHNoYWRvdzogbm9uZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybS5Cb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5LkVxdWFscyhWaXNpYmlsaXR5LkNvbGxhcHNlKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKE1vdmluZ0Zvcm0uSW5EZXNpZ24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9BY3RpdmVGb3JtLkJvZHlPdmVyTGF5LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkNvbGxhcHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW92aW5nRm9ybS5Cb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5WaXNpYmxlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtLkhlYWRpbmcuRm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtb3VzZVBvcyA9IEhlbHBlci5HZXRDbGllbnRNb3VzZUxvY2F0aW9uKGV2KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgbVg7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgbVk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdYID0gKChtWCA9IG1vdXNlUG9zLlhmKSArIE1vdmluZ0Zvcm0ucHJldl9weCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1kgPSAoKG1ZID0gbW91c2VQb3MuWWYpICsgTW92aW5nRm9ybS5wcmV2X3B5KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybS53aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vdmVBY3Rpb24gPT0gTW91c2VNb3ZlQWN0aW9uLk1vdmUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtLmNoYW5nZVdpbmRvd1N0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ggPSBtb3VzZVBvcy5YZiAtIChNb3ZpbmdGb3JtLnByZXZfd2lkdGggLyAyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW92aW5nRm9ybS5wcmV2X3B4ID0gbmV3WCAtIG1vdXNlUG9zLlhmO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgeCA9IChmbG9hdClHbG9iYWwuUGFyc2VGbG9hdChNb3ZpbmdGb3JtLlN0eWxlLkxlZnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb2F0IHkgPSAoZmxvYXQpR2xvYmFsLlBhcnNlRmxvYXQoTW92aW5nRm9ybS5TdHlsZS5Ub3ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb2F0IHcgPSAoZmxvYXQpR2xvYmFsLlBhcnNlRmxvYXQoTW92aW5nRm9ybS5TdHlsZS5XaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgaCA9IChmbG9hdClHbG9iYWwuUGFyc2VGbG9hdChNb3ZpbmdGb3JtLlN0eWxlLkhlaWdodCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZsb2F0IHB4ID0geDtcclxuICAgICAgICAgICAgICAgICAgICBmbG9hdCBweSA9IHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgcHcgPSB3O1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb2F0IHBoID0gaDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYobmV3WSA8IDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1kgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKG5ld1ggPCAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdYID0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYobVggPCAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtWCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYobVkgPCAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtWSA9IDE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChNb3ZlQWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNb3VzZU1vdmVBY3Rpb24uTW92ZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSBuZXdYO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IG5ld1k7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW91c2VNb3ZlQWN0aW9uLlRvcExlZnRSZXNpemU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3IC09IG5ld1ggLSB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaCAtPSBuZXdZIC0geTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih3IDwgTW92aW5nRm9ybS5NaW5XaWR0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdYIC09IE1vdmluZ0Zvcm0uTWluV2lkdGggLSB3O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBNb3ZpbmdGb3JtLk1pbldpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaCA8IE1vdmluZ0Zvcm0uTWluSGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1kgLT0gTW92aW5nRm9ybS5NaW5IZWlnaHQgLSBoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBNb3ZpbmdGb3JtLk1pbkhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSBuZXdYO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IG5ld1k7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vdXNlTW92ZUFjdGlvbi5Ub3BSZXNpemU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoIC09IG5ld1kgLSB5O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGggPCBNb3ZpbmdGb3JtLk1pbkhlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdZIC09IE1vdmluZ0Zvcm0uTWluSGVpZ2h0IC0gaDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gTW92aW5nRm9ybS5NaW5IZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IG5ld1k7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vdXNlTW92ZUFjdGlvbi5Ub3BSaWdodFJlc2l6ZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggLT0gbmV3WSAtIHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gbVggLSB4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGggPCBNb3ZpbmdGb3JtLk1pbkhlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdZIC09IE1vdmluZ0Zvcm0uTWluSGVpZ2h0IC0gaDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gTW92aW5nRm9ybS5NaW5IZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih3IDwgTW92aW5nRm9ybS5NaW5XaWR0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gTW92aW5nRm9ybS5NaW5XaWR0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gbmV3WTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW91c2VNb3ZlQWN0aW9uLkxlZnRSZXNpemU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3IC09IG5ld1ggLSB4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHcgPCBNb3ZpbmdGb3JtLk1pbldpZHRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ggLT0gTW92aW5nRm9ybS5NaW5XaWR0aCAtIHc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdyA9IE1vdmluZ0Zvcm0uTWluV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCA9IG5ld1g7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vdXNlTW92ZUFjdGlvbi5Cb3R0b21MZWZ0UmVzaXplOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdyAtPSBuZXdYIC0geDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBtWSAtIHk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodyA8IE1vdmluZ0Zvcm0uTWluV2lkdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3WCAtPSBNb3ZpbmdGb3JtLk1pbldpZHRoIC0gdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gTW92aW5nRm9ybS5NaW5XaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihoIDwgTW92aW5nRm9ybS5NaW5IZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IE1vdmluZ0Zvcm0uTWluSGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSBuZXdYO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNb3VzZU1vdmVBY3Rpb24uQm90dG9tUmVzaXplOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IG1ZIC0geTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihoIDwgTW92aW5nRm9ybS5NaW5IZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IE1vdmluZ0Zvcm0uTWluSGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNb3VzZU1vdmVBY3Rpb24uUmlnaHRSZXNpemU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gbVggLSB4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHcgPCBNb3ZpbmdGb3JtLk1pbldpZHRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBNb3ZpbmdGb3JtLk1pbldpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNb3VzZU1vdmVBY3Rpb24uQm90dG9tUmlnaHRSZXNpemU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gbVggLSB4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBtWSAtIHk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaCA8IE1vdmluZ0Zvcm0uTWluSGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBNb3ZpbmdGb3JtLk1pbkhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHcgPCBNb3ZpbmdGb3JtLk1pbldpZHRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBNb3ZpbmdGb3JtLk1pbldpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBib29sIGNoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZihweCAhPSB4KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtLlN0eWxlLkxlZnQgPSBTY3JpcHQuV3JpdGU8c3RyaW5nPihcInggKyAncHgnXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHB5ICE9IHkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vdmluZ0Zvcm0uU3R5bGUuVG9wID0gU2NyaXB0LldyaXRlPHN0cmluZz4oXCJ5ICsgJ3B4J1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihwdyAhPSB3ICYmIChjaGFuZ2VkID0gdHJ1ZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vdmluZ0Zvcm0uU3R5bGUuV2lkdGggPSBTY3JpcHQuV3JpdGU8c3RyaW5nPihcIncgKyAncHgnXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHBoICE9IGggJiYgKGNoYW5nZWQgPSB0cnVlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW92aW5nRm9ybS5TdHlsZS5IZWlnaHQgPSBTY3JpcHQuV3JpdGU8c3RyaW5nPihcImggKyAncHgnXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihjaGFuZ2VkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtLlJlc2l6aW5nKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBXaW5kb3cuT25Nb3VzZVVwID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBJbkV4dGVybmFsTW91c2VFdmVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vdmluZ0Zvcm0uU3R5bGUuQm94U2hhZG93ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtLkJvZHlPdmVyTGF5LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkNvbGxhcHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIE1vdmluZ0Zvcm0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgTW91c2VfRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5Nb3ZlO1xyXG4gICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgV2luZG93Lk9uQmVmb3JlVW5sb2FkID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZighU2V0dGluZ3MuQWxsb3dDbG9zZVdpdGhvdXRRdWVzdGlvbilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBTY3JpcHQuV3JpdGUoXCJyZXR1cm4gJ1dvdWxkIHlvdSBsaWtlIHRvIGNsb3NlIHRoaXMgYXBwbGljYXRpb24/J1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgV2luZG93Lk9uVW5sb2FkID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihTZXR0aW5ncy5PbkFwcGxpY2F0aW9uQ2xvc2UgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBTZXR0aW5ncy5PbkFwcGxpY2F0aW9uQ2xvc2UoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgV2luZG93Lk9uRXJyb3IgKz0gbmV3IEVycm9yRXZlbnRIYW5kbGVyKChzdHJpbmcgbWVzc2FnZSwgc3RyaW5nIHVybCwgaW50IGxpbmVOdW1iZXIsIGludCBjb2x1bW5OdW1iZXIsIG9iamVjdCBlcnJvcikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoSW5FcnJvckRpYWxvZylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBJbkVycm9yRGlhbG9nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBzdHJpbmcgZXJyU3RyO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UobWVzc2FnZSkgfHwgbWVzc2FnZSA9PSBcIlNjcmlwdCBlcnJvci5cIilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciA9IFwiU2NyaXB0IEVycm9yOiBTZWUgQnJvd3NlciBDb25zb2xlIGZvciBEZXRhaWwnc1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJTdHIgPSBcIlNjcmlwdCBFcnJvcjogXCIgKyBtZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQXBwbGljYXRpb24uQXBsaWNhdGlvbkRlZml0aW9uID09IEFwcGxpY2F0aW9uRGVmaXRuaW9uLkV4cHJlc3NDcmFmdENvbnNvbGUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb25zb2xlRm9ybS5Mb2coZXJyU3RyLCBDb25zb2xlTG9nVHlwZS5FcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihTZXR0aW5ncy5TaG93RXhjZXB0aW9uRGlhbG9nKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1zZ0JveCA9IG5ldyBNZXNzYWdlQm94Rm9ybShlcnJTdHIsIE1lc3NhZ2VCb3hMYXlvdXQuRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtc2dCb3guU2hvd0RpYWxvZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZpbmFsbHlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBJbkVycm9yRGlhbG9nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIFdpbmRvd0hvbGRlci5BcHBlbmRDaGlsZChGb3JtT3ZlckxheSk7XHJcblxyXG4gICAgICAgICAgICBQYXJlbnQuQXBwZW5kQ2hpbGRyZW4oV2luZG93SG9sZGVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBTZXRDdXJzb3IoQ3Vyc29yIGN1cnNvcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIERvY3VtZW50LkJvZHkuU3R5bGUuQ3Vyc29yID0gY3Vyc29yOyAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBVbmlvbjxzdHJpbmcsIERpc3BsYXk+IHByZXZpb3VzRGlzcGxheTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2V0V2luZG93U3RhdGUoV2luZG93U3RhdGVUeXBlIFN0YXRlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoU3RhdGUgPT0gd2luZG93U3RhdGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBfcHJldndpbmRvd1N0YXRlID0gd2luZG93U3RhdGU7XHJcblxyXG4gICAgICAgICAgICBpZihfcHJldndpbmRvd1N0YXRlID09IFdpbmRvd1N0YXRlVHlwZS5NaW5pbWl6ZWQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEJvZHkuU3R5bGUuT3BhY2l0eSA9IFByZXZpb3VzT3BhY2l0eTtcclxuICAgICAgICAgICAgICAgIEFsbG93U2l6ZUNoYW5nZSA9IFByZXZpb3VzU2l6ZUNoYW5nZTtcclxuICAgICAgICAgICAgICAgIEFsbG93TW92ZUNoYW5nZSA9IFByZXZpb3VzTW92ZUNoYW5nZTtcclxuICAgICAgICAgICAgICAgIFNob3dNYXhpbWl6ZSA9IFByZXZpb3VzU2hvd01heDtcclxuICAgICAgICAgICAgICAgIFNob3dNaW5pbWl6ZSA9IFByZXZpb3VzU2hvd01pbjtcclxuICAgICAgICAgICAgICAgIEhlYWRpbmdUaXRsZS5TdHlsZS5MZWZ0ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIEhlYWRpbmdUaXRsZS5TdHlsZS5NYXJnaW5SaWdodCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBIZWFkaW5nVGl0bGUuU3R5bGUuVHJhbnNmb3JtID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihCdXR0b25NaW5pbWl6ZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIEJ1dHRvbk1pbmltaXplLklubmVySFRNTCA9IFwiLVwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgSGVhZGluZy5DbGFzc0xpc3QuUmVtb3ZlKFwiZm9ybS1oZWFkaW5nLW1pblwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBNaW5pbWl6ZWRGb3Jtcy5SZW1vdmUodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgQm9keS5TdHlsZS5EaXNwbGF5ID0gcHJldmlvdXNEaXNwbGF5O1xyXG5cclxuICAgICAgICAgICAgICAgIENhbGN1bGF0ZU1pbm1pemVkRm9ybXNMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZighQWxsb3dTaXplQ2hhbmdlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYoKHdpbmRvd1N0YXRlID0gU3RhdGUpID09IFdpbmRvd1N0YXRlVHlwZS5Ob3JtYWwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuU2V0Qm91bmRzKHByZXZfbGVmdCwgcHJldl90b3AsIHByZXZfd2lkdGgsIHByZXZfaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIFJlc2l6aW5nKCk7XHJcbiAgICAgICAgICAgICAgICBTdHlsZS5Cb3JkZXJXaWR0aCA9IFwiMXB4XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih3aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfcHJldndpbmRvd1N0YXRlID09IFdpbmRvd1N0YXRlVHlwZS5Ob3JtYWwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldl9sZWZ0ID0gTGVmdC5Ub0ludCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZfdG9wID0gVG9wLlRvSW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldl93aWR0aCA9IFdpZHRoLlRvSW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldl9oZWlnaHQgPSBIZWlnaHQuVG9JbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBTdHlsZS5Cb3JkZXJXaWR0aCA9IFwiMFwiO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuU2V0Qm91bmRzKDAsIDAsIFwiMTAwJVwiLCBcIjEwMCVcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih3aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWluaW1pemVkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBQcmV2aW91c1NpemVDaGFuZ2UgPSBBbGxvd1NpemVDaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICBQcmV2aW91c01vdmVDaGFuZ2UgPSBBbGxvd01vdmVDaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICBQcmV2aW91c09wYWNpdHkgPSBCb2R5LlN0eWxlLk9wYWNpdHk7XHJcbiAgICAgICAgICAgICAgICBQcmV2aW91c1Nob3dNYXggPSBTaG93TWF4aW1pemU7XHJcbiAgICAgICAgICAgICAgICBQcmV2aW91c1Nob3dNaW4gPSBTaG93TWluaW1pemU7XHJcblxyXG4gICAgICAgICAgICAgICAgQWxsb3dTaXplQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBCb2R5LlN0eWxlLk9wYWNpdHkgPSBcIjBcIjtcclxuICAgICAgICAgICAgICAgIFNob3dNYXhpbWl6ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgU2hvd01pbmltaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBBbGxvd01vdmVDaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihfcHJldndpbmRvd1N0YXRlID09IFdpbmRvd1N0YXRlVHlwZS5Ob3JtYWwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldl9sZWZ0ID0gTGVmdC5Ub0ludCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZfdG9wID0gVG9wLlRvSW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldl93aWR0aCA9IFdpZHRoLlRvSW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldl9oZWlnaHQgPSBIZWlnaHQuVG9JbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBTdHlsZS5Cb3JkZXJXaWR0aCA9IFwiMXB4XCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgSGVhZGluZ1RpdGxlLlN0eWxlLk1hcmdpblJpZ2h0ID0gXCIwXCI7XHJcbiAgICAgICAgICAgICAgICBIZWFkaW5nVGl0bGUuU3R5bGUuTGVmdCA9IFwiM3B4XCI7XHJcbiAgICAgICAgICAgICAgICBIZWFkaW5nVGl0bGUuU3R5bGUuVHJhbnNmb3JtID0gXCJ0cmFuc2xhdGUoMCwgLTUwJSlcIjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gKFNob3dDbG9zZSA/IDQ1LjVmIDogMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgV2lkdGggPSAoZmxvYXQpTWF0aC5NYXgoR2V0VGV4dFdpZHRoKFRleHQsIFwiMTBwdCBUYWhvbWFcIikgKyAzMiwgMTAwKSArIG9mZnNldDtcclxuICAgICAgICAgICAgICAgIEhlaWdodCA9IDMwO1xyXG5cclxuICAgICAgICAgICAgICAgIEhlYWRpbmcuQ2xhc3NMaXN0LkFkZChcImZvcm0taGVhZGluZy1taW5cIik7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoQnV0dG9uTWluaW1pemUgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBCdXR0b25NaW5pbWl6ZS5Jbm5lckhUTUwgPSBcIitcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBwcmV2aW91c0Rpc3BsYXkgPSBCb2R5LlN0eWxlLkRpc3BsYXk7XHJcbiAgICAgICAgICAgICAgICBCb2R5LlN0eWxlLkRpc3BsYXkgPSBEaXNwbGF5Lk5vbmU7XHJcblxyXG4gICAgICAgICAgICAgICAgTWluaW1pemVkRm9ybXMuQWRkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgIENhbGN1bGF0ZU1pbm1pemVkRm9ybXNMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBSZXNpemluZygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBDYWxjdWxhdGVNaW5taXplZEZvcm1zTG9jYXRpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTWluaW1pemVkRm9ybXMuUmVtb3ZlKG51bGwpO1xyXG4gICAgICAgICAgICB2YXIgUmVtb3ZlTGlzdCA9IG5ldyBMaXN0PEZvcm0+KCk7XHJcbiAgICAgICAgICAgIGludCBjb3VudCA9IDA7XHJcbiAgICAgICAgICAgIGZsb2F0IHdpZHRoVG90YWwgPSAwO1xyXG4gICAgICAgICAgICBpbnQgeSA9IDMwO1xyXG5cclxuICAgICAgICAgICAgdmFyIHZpZXdTaXplID0gUGFyZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICAgICAgZm9yZWFjaCh2YXIgaXRlbSBpbiBNaW5pbWl6ZWRGb3JtcylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoaXRlbS5Db250ZW50ID09IG51bGwgfHwgaXRlbS53aW5kb3dTdGF0ZSAhPSBXaW5kb3dTdGF0ZVR5cGUuTWluaW1pemVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbW92ZUxpc3QuQWRkKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBUb0luY3JlbWVudCA9IDMgKyBpdGVtLldpZHRoLlRvRmxvYXQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYod2lkdGhUb3RhbCArIFRvSW5jcmVtZW50ID4gdmlld1NpemUuV2lkdGgpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aFRvdGFsID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ICs9IDMzO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5Mb2NhdGlvbiA9IG5ldyBWZWN0b3IyKHdpZHRoVG90YWwsIFwiKDEwMCUgLSBcIiArICh5ICsgMikgKyBcInB4KVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGhUb3RhbCArPSBUb0luY3JlbWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3JlYWNoKHZhciBpdGVtIGluIFJlbW92ZUxpc3QpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIE1pbmltaXplZEZvcm1zLlJlbW92ZShpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy9MZWZ0ID0gMDtcclxuICAgICAgICAgICAgLy9Ub3AgPSBcImNhbGMoMTAwJSAtIDMwcHgpXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHZvaWQgY2hhbmdlV2luZG93U3RhdGUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYod2luZG93U3RhdGUgPT0gV2luZG93U3RhdGVUeXBlLk1heGltaXplZClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU2V0V2luZG93U3RhdGUoV2luZG93U3RhdGVUeXBlLk5vcm1hbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih3aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWluaW1pemVkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTZXRXaW5kb3dTdGF0ZShfcHJldndpbmRvd1N0YXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFNldFdpbmRvd1N0YXRlKFdpbmRvd1N0YXRlVHlwZS5NYXhpbWl6ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDYWxjdWxhdGVCdXR0b25Mb2NhdGlvbnMoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZmxvYXQgUmlnaHRPZmZzZXQgPSAwO1xyXG4gICAgICAgICAgICBmbG9hdCBhcHBlbmQgPSA0NS41ZjtcclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBhcHBlbmQgPSA2NS41ZjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoU2hvd0Nsb3NlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBCdXR0b25DbG9zZS5TdHlsZS5MZWZ0ID0gXCJjYWxjKDEwMCUgLSBcIiArIGFwcGVuZCArIFwicHgpXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBSaWdodE9mZnNldCArPSBhcHBlbmQ7XHJcbiAgICAgICAgICAgICAgICBpZighU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5Db250YWluczxnbG9iYWw6OkJyaWRnZS5IdG1sNS5IVE1MRWxlbWVudD4oSGVhZGluZy5DaGlsZHJlbixCdXR0b25DbG9zZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgSGVhZGluZy5BcHBlbmRDaGlsZChCdXR0b25DbG9zZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKFNob3dNYXhpbWl6ZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUmlnaHRPZmZzZXQgKz0gYXBwZW5kO1xyXG4gICAgICAgICAgICAgICAgQnV0dG9uRXhwYW5kLlN0eWxlLkxlZnQgPSBcImNhbGMoMTAwJSAtIFwiICsgUmlnaHRPZmZzZXQgKyBcInB4KVwiO1xyXG4gICAgICAgICAgICAgICAgaWYoIVN5c3RlbS5MaW5xLkVudW1lcmFibGUuQ29udGFpbnM8Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuSFRNTEVsZW1lbnQ+KEhlYWRpbmcuQ2hpbGRyZW4sQnV0dG9uRXhwYW5kKSlcclxuICAgICAgICAgICAgICAgICAgICBIZWFkaW5nLkFwcGVuZENoaWxkKEJ1dHRvbkV4cGFuZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoU2hvd01pbmltaXplKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBSaWdodE9mZnNldCArPSBhcHBlbmQ7XHJcbiAgICAgICAgICAgICAgICBCdXR0b25NaW5pbWl6ZS5TdHlsZS5MZWZ0ID0gXCJjYWxjKDEwMCUgLSBcIiArIFJpZ2h0T2Zmc2V0ICsgXCJweClcIjtcclxuICAgICAgICAgICAgICAgIGlmKCFTeXN0ZW0uTGlucS5FbnVtZXJhYmxlLkNvbnRhaW5zPGdsb2JhbDo6QnJpZGdlLkh0bWw1LkhUTUxFbGVtZW50PihIZWFkaW5nLkNoaWxkcmVuLEJ1dHRvbk1pbmltaXplKSlcclxuICAgICAgICAgICAgICAgICAgICBIZWFkaW5nLkFwcGVuZENoaWxkKEJ1dHRvbk1pbmltaXplKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoU2hvd01lbnUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEJ1dHRvbk1lbnUuU3R5bGUuTGVmdCA9IFwiMFwiO1xyXG4gICAgICAgICAgICAgICAgaWYoIVN5c3RlbS5MaW5xLkVudW1lcmFibGUuQ29udGFpbnM8Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuSFRNTEVsZW1lbnQ+KEhlYWRpbmcuQ2hpbGRyZW4sQnV0dG9uTWVudSkpXHJcbiAgICAgICAgICAgICAgICAgICAgSGVhZGluZy5BcHBlbmRDaGlsZChCdXR0b25NZW51KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBIVE1MRGl2RWxlbWVudCBDcmVhdGVGb3JtQnV0dG9uKEZvcm1CdXR0b25UeXBlIFR5cGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgYnV0dCA9IERpdihcImZvcm0taGVhZGluZy1idXR0b25cIik7XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2goVHlwZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBGb3JtQnV0dG9uVHlwZS5DbG9zZTpcclxuICAgICAgICAgICAgICAgICAgICBidXR0LkNsYXNzTGlzdC5BZGQoXCJmb3JtLWhlYWRpbmctYnV0dG9uLWNsb3NlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHQuSW5uZXJIVE1MID0gXCImdGltZXM7XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHQuT25Nb3VzZURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtICE9IG51bGwpIC8vICB8fCBXaW5kb3dIb2xkZXJTZWxlY3Rpb25Cb3ggIT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3VzZV9Eb3duID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgQWN0aXZlRm9ybSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dC5Pbk1vdXNlVXAgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtICE9IG51bGwpIC8vfHwgV2luZG93SG9sZGVyU2VsZWN0aW9uQm94ICE9IG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoSW5EZXNpZ24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBDbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBGb3JtQnV0dG9uVHlwZS5NYXhpbWl6ZTpcclxuICAgICAgICAgICAgICAgICAgICBidXR0LklubmVySFRNTCA9IFwiJiM5NjMzO1wiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidXR0Lk9uTW91c2VVcCA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKE1vdmluZ0Zvcm0gIT0gbnVsbCkgLy8gIHx8IFdpbmRvd0hvbGRlclNlbGVjdGlvbkJveCAhPSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vdXNlX0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVdpbmRvd1N0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBGb3JtQnV0dG9uVHlwZS5NaW5pbWl6ZTpcclxuICAgICAgICAgICAgICAgICAgICBidXR0LklubmVySFRNTCA9IFwiLVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidXR0Lk9uTW91c2VVcCA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKE1vdmluZ0Zvcm0gIT0gbnVsbCkgLy8gfHwgV2luZG93SG9sZGVyU2VsZWN0aW9uQm94ICE9IG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYnV0dC5Jbm5lckhUTUwgPT0gXCItXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHQuSW5uZXJIVE1MID0gXCIrXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXaW5kb3dTdGF0ZSA9IFdpbmRvd1N0YXRlVHlwZS5NaW5pbWl6ZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXaW5kb3dTdGF0ZSA9IF9wcmV2d2luZG93U3RhdGUgPT0gV2luZG93U3RhdGVUeXBlLk1pbmltaXplZCA/IFdpbmRvd1N0YXRlVHlwZS5Ob3JtYWwgOiBfcHJldndpbmRvd1N0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dC5Jbm5lckhUTUwgPSBcIi1cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgTW91c2VfRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRm9ybUJ1dHRvblR5cGUuUmVzdG9yZTpcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBGb3JtQnV0dG9uVHlwZS5IZWxwOlxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dC5Pbk1vdXNlVXAgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtICE9IG51bGwpIC8vICB8fCBXaW5kb3dIb2xkZXJTZWxlY3Rpb25Cb3ggIT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3VzZV9Eb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIEZvcm1CdXR0b25UeXBlLk1lbnU6XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dC5Jbm5lckhUTUwgPSBcIiYjOTc3NjtcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dC5Pbk1vdXNlVXAgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtICE9IG51bGwpIC8vICB8fCBXaW5kb3dIb2xkZXJTZWxlY3Rpb25Cb3ggIT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb3VzZV9Eb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBPbk1lbnVDbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBidXR0Lk9uTW91c2VFbnRlciA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybSAhPSBudWxsKSAvLyAgfHwgV2luZG93SG9sZGVyU2VsZWN0aW9uQm94ICE9IG51bGxcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLkRlZmF1bHQpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgYnV0dC5PbkRibENsaWNrID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGJ1dHQuT25Nb3VzZU1vdmUgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKE1vdmluZ0Zvcm0gIT0gbnVsbCkgLy8gIHx8IFdpbmRvd0hvbGRlclNlbGVjdGlvbkJveCAhPSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGV2LlN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmKFR5cGUgIT0gRm9ybUJ1dHRvblR5cGUuQ2xvc2UpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1dHQuT25Nb3VzZURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybSAhPSBudWxsKSAvLyB8fCBXaW5kb3dIb2xkZXJTZWxlY3Rpb25Cb3ggIT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIE1vdXNlX0Rvd24gPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBBY3RpdmVGb3JtID0gdGhpcztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBidXR0LlN0eWxlLldpZHRoID0gXCI2NXB4XCI7XHJcbiAgICAgICAgICAgICAgICBidXR0LlN0eWxlLkhlaWdodCA9IFwiNDlweFwiO1xyXG4gICAgICAgICAgICAgICAgYnV0dC5TdHlsZS5Gb250U2l6ZSA9IFwiMTZwdFwiO1xyXG4gICAgICAgICAgICAgICAgYnV0dC5TdHlsZS5MaW5lSGVpZ2h0ID0gXCI0OXB4XCI7XHJcbiAgICAgICAgICAgICAgICBidXR0LkV4Y2hhbmdlQ2xhc3MoXCJwcmltYXJ5XCIsIFwicHJpbWFyeVwiKTtcclxuICAgICAgICAgICAgICAgIGJ1dHQuU3R5bGUuRmlsdGVyID0gXCJicmlnaHRuZXNzKDExMCUpXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBidXR0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgdm9pZCBPbk1lbnVDbGljaygpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEZvcm0oKSA6IGJhc2UoXCJmb3JtLWJhc2VcIilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEhlYWRpbmcgPSBEaXYoXCJmb3JtLWhlYWRpbmdcIik7XHJcblxyXG4gICAgICAgICAgICBIZWFkaW5nLk9uQ29udGV4dE1lbnUgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIEhlYWRpbmdUaXRsZSA9IFNwYW4oXCJmb3JtLWhlYWRpbmctdGl0bGVcIik7XHJcblxyXG4gICAgICAgICAgICBCb2R5ID0gRGl2KFwiZm9ybS1ib2R5XCIpO1xyXG5cclxuICAgICAgICAgICAgQm9keS5PbkNvbnRleHRNZW51ID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihldi5UYXJnZXQgPT0gQm9keSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgQmFja0NvbG9yID0gXCIjRjBGMEYwXCI7XHJcblxyXG4gICAgICAgICAgICBCb2R5T3ZlckxheSA9IERpdihcImZvcm0tYm9keS1vdmVybGF5XCIpO1xyXG5cclxuICAgICAgICAgICAgQm9keU92ZXJMYXkuU3R5bGUuT3BhY2l0eSA9IFNob3dCb2R5T3ZlckxheSA/IFwiMC41XCIgOiBcIjBcIjtcclxuXHJcbiAgICAgICAgICAgIENoYW5nZUhlYWRpbmdCdXR0b24oRm9ybUJ1dHRvblR5cGUuQ2xvc2UpO1xyXG4gICAgICAgICAgICBpZighSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENoYW5nZUhlYWRpbmdCdXR0b24oRm9ybUJ1dHRvblR5cGUuTWF4aW1pemUpO1xyXG4gICAgICAgICAgICAgICAgQ2hhbmdlSGVhZGluZ0J1dHRvbihGb3JtQnV0dG9uVHlwZS5NaW5pbWl6ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBIZWFkaW5nLlN0eWxlLkhlaWdodCA9IFwiNTBweFwiO1xyXG4gICAgICAgICAgICAgICAgSGVhZGluZ1RpdGxlLlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgQm9keS5TdHlsZS5Ub3AgPSBcIjUwcHhcIjtcclxuICAgICAgICAgICAgICAgIEJvZHkuU3R5bGUuSGVpZ2h0ID0gXCJjYWxjKDEwMCUgLSA1MHB4KVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIEJvZHlPdmVyTGF5LlN0eWxlLlRvcCA9IFwiNTBweFwiO1xyXG4gICAgICAgICAgICAgICAgQm9keU92ZXJMYXkuU3R5bGUuSGVpZ2h0ID0gXCJjYWxjKDEwMCUgLSA1MHB4KVwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBCb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5Db2xsYXBzZTtcclxuXHJcbiAgICAgICAgICAgIFNlbGYgPSBqUXVlcnkuU2VsZWN0KENvbnRlbnQpO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZURvd24sIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEluRXh0ZXJuYWxNb3VzZUV2ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIHZhciBtZXYgPSBldi5BczxNb3VzZUV2ZW50PigpO1xyXG5cclxuICAgICAgICAgICAgICAgIG1ldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIG1ldi5TdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZighSXNBY3RpdmVGb3JtQ29sbGVjdGlvbigpKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBNb3VzZV9Eb3duID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtID0gdGhpcztcclxuICAgICAgICAgICAgICAgIEFjdGl2ZUZvcm0gPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgICAgIFNldEJvZHlPdmVyTGF5KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudFJlYyA9IHRoaXMuQ29udGVudC5HZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbW91c2VQb3MgPSBIZWxwZXIuR2V0Q2xpZW50TW91c2VMb2NhdGlvbihldik7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldl9weCA9IChmbG9hdCljbGllbnRSZWMuTGVmdCAtIG1vdXNlUG9zLlhmO1xyXG4gICAgICAgICAgICAgICAgcHJldl9weSA9IChmbG9hdCljbGllbnRSZWMuVG9wIC0gbW91c2VQb3MuWWY7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gKGZsb2F0KWNsaWVudFJlYy5XaWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSAoZmxvYXQpY2xpZW50UmVjLkhlaWdodDtcclxuXHJcbiAgICAgICAgICAgICAgICBmbG9hdCBYID0gbW91c2VQb3MuWGYgLSAoZmxvYXQpY2xpZW50UmVjLkxlZnQ7XHJcbiAgICAgICAgICAgICAgICBmbG9hdCBZID0gbW91c2VQb3MuWWYgLSAoZmxvYXQpY2xpZW50UmVjLlRvcDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih3aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuRGVmYXVsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5Nb3ZlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZih3aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWluaW1pemVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuRGVmYXVsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5Ob25lO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZVdpbmRvd1N0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoSW5EZXNpZ24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoSGVhZGluZ1RpdGxlICE9IG51bGwgJiYgZXYuVGFyZ2V0ID09IEhlYWRpbmdUaXRsZSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuRGVmYXVsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vdmVBY3Rpb24gPSBNb3VzZU1vdmVBY3Rpb24uTW92ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoQWxsb3dTaXplQ2hhbmdlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihYIDw9IFJlc2l6ZUNvcm5lcnMgJiYgWSA8PSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuTm9ydGhXZXN0U291dGhFYXN0UmVzaXplKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb3ZlQWN0aW9uID0gTW91c2VNb3ZlQWN0aW9uLlRvcExlZnRSZXNpemU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKFkgPD0gUmVzaXplQ29ybmVycyAmJiBYID49IHdpZHRoIC0gUmVzaXplQ29ybmVycylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLk5vcnRoRWFzdFNvdXRoV2VzdFJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5Ub3BSaWdodFJlc2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoWSA8PSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuTm9ydGhSZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vdmVBY3Rpb24gPSBNb3VzZU1vdmVBY3Rpb24uVG9wUmVzaXplO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihYIDw9IFJlc2l6ZUNvcm5lcnMgJiYgWSA+PSBoZWlnaHQgLSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuTm9ydGhFYXN0U291dGhXZXN0UmVzaXplKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb3ZlQWN0aW9uID0gTW91c2VNb3ZlQWN0aW9uLkJvdHRvbUxlZnRSZXNpemU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKFkgPj0gaGVpZ2h0IC0gUmVzaXplQ29ybmVycyAmJiBYID49IHdpZHRoIC0gUmVzaXplQ29ybmVycylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLk5vcnRoV2VzdFNvdXRoRWFzdFJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5Cb3R0b21SaWdodFJlc2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoWSA+PSBoZWlnaHQgLSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuU291dGhSZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vdmVBY3Rpb24gPSBNb3VzZU1vdmVBY3Rpb24uQm90dG9tUmVzaXplO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihYIDw9IFJlc2l6ZUNvcm5lcnMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5XZXN0UmVzaXplKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb3ZlQWN0aW9uID0gTW91c2VNb3ZlQWN0aW9uLkxlZnRSZXNpemU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKFggPj0gd2lkdGggLSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuRWFzdFJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW92ZUFjdGlvbiA9IE1vdXNlTW92ZUFjdGlvbi5SaWdodFJlc2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLkRlZmF1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vdmVBY3Rpb24gPSBNb3VzZU1vdmVBY3Rpb24uTW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZighQWxsb3dNb3ZlQ2hhbmdlICYmIE1vdmVBY3Rpb24gPT0gTW91c2VNb3ZlQWN0aW9uLk1vdmUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICBNb3ZlQWN0aW9uID0gTW91c2VNb3ZlQWN0aW9uLk5vbmU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgICAgIEhlYWRpbmcuQWRkRXZlbnRMaXN0ZW5lcihFdmVudFR5cGUuRGJsQ2xpY2ssIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEFsbG93U2l6ZUNoYW5nZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VXaW5kb3dTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZUxlYXZlLCAoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uPGdsb2JhbDo6QnJpZGdlLkh0bWw1LkV2ZW50PikoKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgQm9keS5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZUVudGVyLCAoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uPGdsb2JhbDo6QnJpZGdlLkh0bWw1LkV2ZW50PikoKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLkRlZmF1bHQpO1xyXG4gICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgICAgICBDb250ZW50LkFkZEV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlTW92ZSwgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbjxnbG9iYWw6OkJyaWRnZS5IdG1sNS5FdmVudD4pKChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoSW5FeHRlcm5hbE1vdXNlRXZlbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGV2LlRhcmdldCA9PSBIZWFkaW5nVGl0bGUpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1ldiA9IGV2LkFzPE1vdXNlRXZlbnQ+KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gQ29udGVudC5DbGllbnRXaWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBDb250ZW50LkNsaWVudEhlaWdodDtcclxuICAgICAgICAgICAgICAgIGludCBYID0gbWV2LlBhZ2VYIC0gQ29udGVudC5PZmZzZXRMZWZ0O1xyXG4gICAgICAgICAgICAgICAgaW50IFkgPSBtZXYuUGFnZVkgLSBDb250ZW50Lk9mZnNldFRvcDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtICE9IG51bGwgJiYgTW92ZUFjdGlvbiA9PSBNb3VzZU1vdmVBY3Rpb24uTW92ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLkRlZmF1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYod2luZG93U3RhdGUgPT0gV2luZG93U3RhdGVUeXBlLk1heGltaXplZClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLkRlZmF1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKEluRGVzaWduKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihBbGxvd1NpemVDaGFuZ2UpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoTW92ZUFjdGlvbiA9PSBNb3VzZU1vdmVBY3Rpb24uVG9wTGVmdFJlc2l6ZSB8fCBYIDw9IFJlc2l6ZUNvcm5lcnMgJiYgWSA8PSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5Ob3J0aFdlc3RTb3V0aEVhc3RSZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKE1vdmVBY3Rpb24gPT0gTW91c2VNb3ZlQWN0aW9uLlRvcFJpZ2h0UmVzaXplIHx8IFkgPD0gUmVzaXplQ29ybmVycyAmJiBYID49IHdpZHRoIC0gUmVzaXplQ29ybmVycylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuTm9ydGhFYXN0U291dGhXZXN0UmVzaXplKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihZIDw9IFJlc2l6ZUNvcm5lcnMgfHwgTW92ZUFjdGlvbiA9PSBNb3VzZU1vdmVBY3Rpb24uVG9wUmVzaXplKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5Ob3J0aFJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoTW92ZUFjdGlvbiA9PSBNb3VzZU1vdmVBY3Rpb24uQm90dG9tTGVmdFJlc2l6ZSB8fCBYIDw9IFJlc2l6ZUNvcm5lcnMgJiYgWSA+PSBoZWlnaHQgLSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5Ob3J0aEVhc3RTb3V0aFdlc3RSZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKE1vdmVBY3Rpb24gPT0gTW91c2VNb3ZlQWN0aW9uLkJvdHRvbVJpZ2h0UmVzaXplIHx8IFkgPj0gaGVpZ2h0IC0gUmVzaXplQ29ybmVycyAmJiBYID49IHdpZHRoIC0gUmVzaXplQ29ybmVycylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuTm9ydGhXZXN0U291dGhFYXN0UmVzaXplKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihNb3ZlQWN0aW9uID09IE1vdXNlTW92ZUFjdGlvbi5Cb3R0b21SZXNpemUgfHwgWSA+PSBoZWlnaHQgLSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5Tb3V0aFJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoTW92ZUFjdGlvbiA9PSBNb3VzZU1vdmVBY3Rpb24uTGVmdFJlc2l6ZSB8fCBYIDw9IFJlc2l6ZUNvcm5lcnMpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXRDdXJzb3IoQ3Vyc29yLldlc3RSZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKE1vdmVBY3Rpb24gPT0gTW91c2VNb3ZlQWN0aW9uLlJpZ2h0UmVzaXplIHx8IFggPj0gd2lkdGggLSBSZXNpemVDb3JuZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5FYXN0UmVzaXplKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgSGVhZGluZy5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZURvd24sIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFNldEJvZHlPdmVyTGF5KCk7XHJcbiAgICAgICAgICAgICAgICBpZighSXNBY3RpdmVGb3JtQ29sbGVjdGlvbigpKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih3aW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vdmluZ0Zvcm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIFNldEN1cnNvcihDdXJzb3IuRGVmYXVsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIE1vdmVBY3Rpb24gPSBNb3VzZU1vdmVBY3Rpb24uTW92ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBNb3ZpbmdGb3JtID0gdGhpcztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBBY3RpdmVGb3JtID0gdGhpcztcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgQm9keS5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZURvd24sIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEluRXh0ZXJuYWxNb3VzZUV2ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIGlmKCFJc0FjdGl2ZUZvcm1Db2xsZWN0aW9uKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIEFjdGl2ZUZvcm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgTW92aW5nRm9ybSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgQm9keS5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZU1vdmUsIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEluRXh0ZXJuYWxNb3VzZUV2ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihNb3ZpbmdGb3JtID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIUlzQWN0aXZlRm9ybUNvbGxlY3Rpb24oKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgICAgICBCb2R5T3ZlckxheS5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZURvd24sIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEluRGVzaWduKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIEJvZHlPdmVyTGF5LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkNvbGxhcHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKCFJc0FjdGl2ZUZvcm1Db2xsZWN0aW9uKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgQm9keU92ZXJMYXkuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuQ29sbGFwc2U7XHJcbiAgICAgICAgICAgICAgICBBY3RpdmVGb3JtID0gdGhpcztcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgICAgQm9keS5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5Nb3VzZUxlYXZlLCAoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uPGdsb2JhbDo6QnJpZGdlLkh0bWw1LkV2ZW50PikoKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihJbkRlc2lnbilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBCb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5Db2xsYXBzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoTW92aW5nRm9ybSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFNldEJvZHlPdmVyTGF5KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgICAgIEJvZHlPdmVyTGF5LkFkZEV2ZW50TGlzdGVuZXIoRXZlbnRUeXBlLk1vdXNlRW50ZXIsIChnbG9iYWw6OlN5c3RlbS5BY3Rpb248Z2xvYmFsOjpCcmlkZ2UuSHRtbDUuRXZlbnQ+KSgoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEluRGVzaWduKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIEJvZHlPdmVyTGF5LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkNvbGxhcHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKE1vdmluZ0Zvcm0gPT0gbnVsbCAmJiBJc0FjdGl2ZUZvcm1Db2xsZWN0aW9uKCkpIC8vIFdpbmRvd0hvbGRlclNlbGVjdGlvbkJveCA9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICBCb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5Db2xsYXBzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBCb2R5T3ZlckxheS5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5WaXNpYmxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgICAgICBqUXVlcnkuU2VsZWN0KENvbnRlbnQpXHJcbiAgICAgICAgICAgICAgICAuQ3NzKFwid2lkdGhcIiwgV2luZG93X0RlZmF1bHRXaWR0aClcclxuICAgICAgICAgICAgICAgIC5Dc3MoXCJoZWlnaHRcIiwgV2luZG93X0RlZmF1bHRIZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChIZWFkaW5nKTtcclxuICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChCb2R5KTtcclxuICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChCb2R5T3ZlckxheSk7XHJcblxyXG4gICAgICAgICAgICBIZWFkaW5nLkFwcGVuZENoaWxkKEhlYWRpbmdUaXRsZSk7XHJcblxyXG4gICAgICAgICAgICBjbG9zZUFjdGlvbiA9ICgpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENvbnRlbnQuRW1wdHkoKTtcclxuICAgICAgICAgICAgICAgIGlmKENvbnRlbnQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBDb250ZW50LkRlbGV0ZSgpOyBDb250ZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIEluaXRpYWxpc2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgVGl0bGVCYXJIZWlnaHQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEhlYWRpbmcuQ2xpZW50SGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBUaXRsZUJhcldpZHRoKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBIZWFkaW5nLkNsaWVudFdpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBDbGllbnRYKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBCb2R5LkNsaWVudExlZnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgaW50IENsaWVudFkoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEJvZHkuQ2xpZW50VG9wO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBUZXh0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gSGVhZGluZ1RpdGxlLklubmVySFRNTDsgfVxyXG4gICAgICAgICAgICBzZXQgeyBIZWFkaW5nVGl0bGUuSW5uZXJIVE1MID0gdmFsdWU7IH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgQmFja0NvbG9yXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gQm9keS5TdHlsZS5CYWNrZ3JvdW5kQ29sb3I7IH1cclxuICAgICAgICAgICAgc2V0IHsgQm9keS5TdHlsZS5CYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTsgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBGb3JlQ29sb3JcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBCb2R5LlN0eWxlLkNvbG9yOyB9XHJcbiAgICAgICAgICAgIHNldCB7IEJvZHkuU3R5bGUuQ29sb3IgPSB2YWx1ZTsgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExpc3Q8RGlhbG9nUmVzdWx0PiBEaWFsb2dSZXN1bHRzID0gbmV3IExpc3Q8RGlhbG9nUmVzdWx0PigpO1xyXG5cclxuICAgICAgICBwdWJsaWMgRm9ybUNvbGxlY3Rpb24gR2V0Rm9ybUNvbGxlY3Rpb25Gcm9tRm9ybShGb3JtIGZvcm0pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihmb3JtLl9zZXBlcmF0ZUluc3RhbmNlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZUZvcm1zID0gc3RhbmRBbG9uZUZvcm1zLlZpc2libGVGb3JtcztcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCB2aXNpYmxlRm9ybXMuQ291bnQ7IHgrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih2aXNpYmxlRm9ybXNbeF0gPT0gdGhpcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YW5kQWxvbmVGb3JtcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBGb3JtQ29sbGVjdGlvbnMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzID09IEZvcm1Db2xsZWN0aW9uc1tpXS5Gb3JtT3duZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGb3JtQ29sbGVjdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpc2libGVGb3JtcyA9IEZvcm1Db2xsZWN0aW9uc1tpXS5WaXNpYmxlRm9ybXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCB4ID0gMDsgeCA8IHZpc2libGVGb3Jtcy5Db3VudDsgeCsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYodmlzaWJsZUZvcm1zW3hdID09IHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRm9ybUNvbGxlY3Rpb25zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBJc0FjdGl2ZUZvcm1Db2xsZWN0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX3NlcGVyYXRlSW5zdGFuY2UpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBHZXRGb3JtQ29sbGVjdGlvbkZyb21Gb3JtKHRoaXMpID09IHN0YW5kQWxvbmVGb3JtcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBHZXRGb3JtQ29sbGVjdGlvbkZyb21Gb3JtKHRoaXMpID09IEdldEFjdGl2ZUZvcm1Db2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIElzVmlzaWJsZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gR2V0Rm9ybUNvbGxlY3Rpb25Gcm9tRm9ybSh0aGlzKSAhPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2hvd1N0YXJ0TmV3TGV2ZWwoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoIUhhc1NldHVwKVxyXG4gICAgICAgICAgICAgICAgU2V0dXAoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKElzVmlzaWJsZSgpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvLyBBbHJlYWR5IE9wZW4/Pz9cclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJJbnZhbGlkIHJlcXVlc3QgdG8gb3BlbiBmb3JtIGFzIGEgZGlhbG9nIHRoYXQgaXMgYWxyZWFkeSB2aXNpYmxlIVwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgRm9ybUNvbGxlY3Rpb25zLkFkZChuZXcgRm9ybUNvbGxlY3Rpb24odGhpcykpO1xyXG4gICAgICAgICAgICBXaW5kb3dIb2xkZXIuQXBwZW5kQ2hpbGQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICBDYWxjdWxhdGVaT3JkZXIoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKFN0YXJ0UG9zaXRpb24gPT0gRm9ybVN0YXJ0UG9zaXRpb24uQ2VudGVyKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDZW50cmVGb3JtKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIE9uU2hvd2VkKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBBY3RpdmVGb3JtID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIEJvZHkuRm9jdXNFbGVtZW50KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTaG93RGlhbG9nKHBhcmFtcyBEaWFsb2dSZXN1bHRbXSBkaWFsb2dSZXN1bHRzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoIUhhc1NldHVwKVxyXG4gICAgICAgICAgICAgICAgU2V0dXAoKTtcclxuXHJcbiAgICAgICAgICAgIEluRGlhbG9nUmVzdWx0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZihCdXR0b25NaW5pbWl6ZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgQnV0dG9uTWluaW1pemUuRGVsZXRlKCk7XHJcbiAgICAgICAgICAgIGlmKEJ1dHRvbkV4cGFuZCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgQnV0dG9uRXhwYW5kLkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICBpZihCdXR0b25DbG9zZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgQnV0dG9uQ2xvc2UuRGVsZXRlKCk7XHJcblxyXG4gICAgICAgICAgICBfSXNEaWFsb2cgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZihTdGFydFBvc2l0aW9uICE9IEZvcm1TdGFydFBvc2l0aW9uLk1hbnVhbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIUhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgICAgIFN0YXJ0UG9zaXRpb24gPSBGb3JtU3RhcnRQb3NpdGlvbi5DZW50ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgU2hvd1N0YXJ0TmV3TGV2ZWwoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGRpYWxvZ1Jlc3VsdHMgIT0gbnVsbCAmJiBkaWFsb2dSZXN1bHRzLkxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIERpYWxvZ1Jlc3VsdHMuQWRkUmFuZ2UoZGlhbG9nUmVzdWx0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgZmxvYXQgTWluWmVybyhmbG9hdCBpbnB1dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dCA8IDAgPyAwIDogaW5wdXQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGludCBNaW5aZXJvKGludCBpbnB1dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dCA8IDAgPyAwIDogaW5wdXQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDZW50cmVGb3JtKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFdpbmRvd0hvbGRlciA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgU2VsZlxyXG4gICAgICAgICAgICAuQ3NzKFwibGVmdFwiLCBNaW5aZXJvKChXaW5kb3dIb2xkZXIuQ2xpZW50V2lkdGggLyAyKSAtIChHbG9iYWwuUGFyc2VJbnQodGhpcy5XaWR0aC5Ub0h0bWxWYWx1ZSgpKSAvIDIpKSlcclxuICAgICAgICAgICAgLkNzcyhcInRvcFwiLCBNaW5aZXJvKChXaW5kb3dIb2xkZXIuQ2xpZW50SGVpZ2h0IC8gMikgLSAoR2xvYmFsLlBhcnNlSW50KHRoaXMuSGVpZ2h0LlRvSHRtbFZhbHVlKCkpIC8gMikpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSB2b2lkIFJlbmRlcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighSGFzUmVuZGVyZWQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJhc2UuUmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICBPblNob3dpbmcoKTsgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBTaG93bigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTaG93bigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBJbkNsb3NlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmKENoaWxkcmVuID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBDaGlsZHJlbi5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihDaGlsZHJlbltpXSAhPSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgQ2hpbGRyZW5baV0uT25Mb2FkZWQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBDaGlsZHJlbltpXS5PbkxvYWRlZChDaGlsZHJlbltpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgQ2hpbGRyZW4uUmVtb3ZlKG51bGwpOyAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIGJvb2wgX3NlcGVyYXRlSW5zdGFuY2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2hvdyhib29sIHNlcGVyYXRlSW5zdGFuY2UgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFIYXNTZXR1cClcclxuICAgICAgICAgICAgICAgIFNldHVwKCk7XHJcblxyXG4gICAgICAgICAgICBpZihfSXNEaWFsb2cpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIF9zZXBlcmF0ZUluc3RhbmNlID0gc2VwZXJhdGVJbnN0YW5jZTtcclxuICAgICAgICAgICAgaWYoIXNlcGVyYXRlSW5zdGFuY2UgJiYgKEZvcm1Db2xsZWN0aW9ucyA9PSBudWxsIHx8IEZvcm1Db2xsZWN0aW9ucy5Db3VudCA9PSAwKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU2hvd1N0YXJ0TmV3TGV2ZWwoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGFjdGl2ZUNvbGxlY3QgPSAhc2VwZXJhdGVJbnN0YW5jZSA/IEdldEFjdGl2ZUZvcm1Db2xsZWN0aW9uKCkgOiBzdGFuZEFsb25lRm9ybXM7XHJcbiAgICAgICAgICAgIHZhciB2aXNiaWxlRm9ybXMgPSBhY3RpdmVDb2xsZWN0LlZpc2libGVGb3JtcztcclxuXHJcbiAgICAgICAgICAgIGlmKCF2aXNiaWxlRm9ybXMuQ29udGFpbnModGhpcykpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZpc2JpbGVGb3Jtcy5BZGQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBXaW5kb3dIb2xkZXIuQXBwZW5kQ2hpbGQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgQ29udGVudC5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5WaXNpYmxlO1xyXG5cclxuICAgICAgICAgICAgICAgIENhbGN1bGF0ZVpPcmRlcigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKFN0YXJ0UG9zaXRpb24gIT0gRm9ybVN0YXJ0UG9zaXRpb24uTWFudWFsICYmIHdpbmRvd1N0YXRlID09IFdpbmRvd1N0YXRlVHlwZS5Ob3JtYWwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoU3RhcnRQb3NpdGlvbiA9PSBGb3JtU3RhcnRQb3NpdGlvbi5DZW50ZXIgfHwgKGFjdGl2ZUNvbGxlY3QgPT0gbnVsbCB8fCB2aXNiaWxlRm9ybXMgPT0gbnVsbCB8fCB2aXNiaWxlRm9ybXMuQ291bnQgPT0gMCB8fCB2aXNiaWxlRm9ybXNbdmlzYmlsZUZvcm1zLkNvdW50IC0gMV0ud2luZG93U3RhdGUgIT0gV2luZG93U3RhdGVUeXBlLk5vcm1hbCB8fCB2aXNiaWxlRm9ybXNbdmlzYmlsZUZvcm1zLkNvdW50IC0gMV0uQ29udGVudCA9PSBudWxsKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENlbnRyZUZvcm0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihTdGFydFBvc2l0aW9uID09IEZvcm1TdGFydFBvc2l0aW9uLldpbmRvd3NEZWZhdWx0TG9jYXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gdmlzYmlsZUZvcm1zW3Zpc2JpbGVGb3Jtcy5Db3VudCAtIDFdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IHggPSBHbG9iYWwuUGFyc2VJbnQob2JqLkxlZnQuVG9IdG1sVmFsdWUoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCB5ID0gR2xvYmFsLlBhcnNlSW50KG9iai5Ub3AuVG9IdG1sVmFsdWUoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihHbG9iYWwuSXNOYU4oeCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKEdsb2JhbC5Jc05hTih5KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWMgPSBXaW5kb3dIb2xkZXIuR2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb3VibGUgcHcyNSA9IHJlYy5XaWR0aCAqIDAuMTU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvdWJsZSBwaDI1ID0gcmVjLkhlaWdodCAqIDAuMTU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb3VibGUgcHc3NSA9IHJlYy5XaWR0aCAqIDAuNTU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvdWJsZSBwaDc1ID0gcmVjLkhlaWdodCAqIDAuNTU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZigoaW50KXggPCBwdzI1KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCA9IChpbnQpcHcyNTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGludCl5IDwgcGgyNSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAoaW50KXBoMjU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZigoaW50KXggPiBwdzc1KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCA9IChpbnQpcHcyNTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGludCl5ID4gcGg3NSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAoaW50KXBoMjU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAoaW50KXggKyAxMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IChpbnQpeSArIDEwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgU2VsZi5Dc3MoXCJsZWZ0XCIsIE1pblplcm8oKGludCl4KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5Dc3MoXCJ0b3BcIiwgTWluWmVybygoaW50KXkpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIE9uU2hvd2VkKCk7ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBBY3RpdmVGb3JtID0gdGhpcztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBHbG9iYWwuU2V0VGltZW91dCgoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uKSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5Db250ZW50LkZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5Db250ZW50LkNsaWNrKCk7ICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0pLCAwKTsgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQnJpbmdUb0Zyb250KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBhY3RpdmVDb2xsZWN0ID0gR2V0QWN0aXZlRm9ybUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgaWYoYWN0aXZlQ29sbGVjdCAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihhY3RpdmVDb2xsZWN0LkZvcm1Pd25lciA9PSB0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIHZhciB2aXNpYmxlRm9ybXMgPSBhY3RpdmVDb2xsZWN0LlZpc2libGVGb3JtcztcclxuICAgICAgICAgICAgICAgIGlmKHZpc2libGVGb3JtcyAhPSBudWxsICYmIHZpc2libGVGb3Jtcy5Db3VudCA+IDEpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZUZvcm1zLlJlbW92ZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlRm9ybXMuQWRkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIENhbGN1bGF0ZVpPcmRlcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTZXRaSW5kZXgocmVmIGludCB6SW5kZXgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuU3R5bGUuWkluZGV4ID0gKHpJbmRleCsrKS5Ub1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBDbGVhclpJbmRleCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgeCA9IEdldEFjdGl2ZUZvcm1Db2xsZWN0aW9uKCkuRm9ybU93bmVyO1xyXG4gICAgICAgICAgICBXaW5kb3dIb2xkZXIuU3R5bGUuWkluZGV4ID0gXCItXCIgKyBXaW5kb3dIb2xkZXIuQ2hpbGRFbGVtZW50Q291bnQ7XHJcbiAgICAgICAgICAgIGJvb2wgRm91bmQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBXaW5kb3dIb2xkZXIuQ2hpbGRFbGVtZW50Q291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoRm91bmQgfHwgeC5Db250ZW50ID09IFdpbmRvd0hvbGRlci5DaGlsZHJlbltpXSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBXaW5kb3dIb2xkZXIuQ2hpbGRyZW5baV0uU3R5bGUuWkluZGV4ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBGb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgV2luZG93SG9sZGVyLkNoaWxkcmVuW2ldLlN0eWxlLlpJbmRleCA9IChpIC0gV2luZG93SG9sZGVyLkNoaWxkRWxlbWVudENvdW50IC0gMSkuVG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBBcHBseVpJbmRleCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBXaW5kb3dIb2xkZXIuU3R5bGUuWkluZGV4ID0gXCJcIjtcclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IFdpbmRvd0hvbGRlci5DaGlsZEVsZW1lbnRDb3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBXaW5kb3dIb2xkZXIuQ2hpbGRyZW5baV0uU3R5bGUuWkluZGV4ID0gaS5Ub1N0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBpbnQgQ2FsY3VsYXRlWk9yZGVyKEZvcm1Db2xsZWN0aW9uIGZvcm1Db2xsZWN0aW9uLCBpbnQgekluZGV4KSAvLyAsIERvY3VtZW50RnJhZ21lbnQgZnJhZ1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgTGlzdDxGb3JtPiBUb3BNb3N0Rm9ybXMgPSBuZXcgTGlzdDxGb3JtPigpO1xyXG5cclxuICAgICAgICAgICAgdmFyIFZpc2libGVGb3JtcyA9IGZvcm1Db2xsZWN0aW9uLlZpc2libGVGb3JtcztcclxuICAgICAgICAgICAgaWYoVmlzaWJsZUZvcm1zICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBWaXNpYmxlRm9ybXMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihWaXNpYmxlRm9ybXNbaV0uQ29udGVudCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVG9DbGVhbi5BZGQoVmlzaWJsZUZvcm1zW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoVmlzaWJsZUZvcm1zW2ldLlRvcE1vc3QpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb3BNb3N0Rm9ybXMuQWRkKFZpc2libGVGb3Jtc1tpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IFRvQ2xlYW4uQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihWaXNpYmxlRm9ybXMuQ29udGFpbnMoVG9DbGVhbltpXSkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBWaXNpYmxlRm9ybXMuUmVtb3ZlKFRvQ2xlYW5baV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBUb0NsZWFuW2ldID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgVG9DbGVhbi5SZW1vdmUobnVsbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoZm9ybUNvbGxlY3Rpb24uRm9ybU93bmVyICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybUNvbGxlY3Rpb24uRm9ybU93bmVyLk1hbmFnZVBsYWNlSG9sZGVycygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1Db2xsZWN0aW9uLkZvcm1Pd25lci5TdHlsZS5aSW5kZXggPSB6SW5kZXguVG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB6SW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICAvL2ZyYWcuQXBwZW5kQ2hpbGQoZm9ybUNvbGxlY3Rpb24uRm9ybU93bmVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9pZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgICAgICAvL3tcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBpZihWaXNpYmxlRm9ybXMuQ291bnQgPT0gMClcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIGZvcm1Db2xsZWN0aW9uLkZvcm1Pd25lci5NYW5hZ2VQbGFjZUhvbGRlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgZnJhZy5BcHBlbmRDaGlsZChmb3JtQ29sbGVjdGlvbi5Gb3JtT3duZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICByZXR1cm4gekluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgICAgICAvL2Vsc2VcclxuICAgICAgICAgICAgICAgICAgICAvL3tcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBmb3JtQ29sbGVjdGlvbi5Gb3JtT3duZXIuTWFuYWdlUGxhY2VIb2xkZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgZnJhZy5BcHBlbmRDaGlsZChmb3JtQ29sbGVjdGlvbi5Gb3JtT3duZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBUb3BNb3N0Rm9ybXMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IFRvcE1vc3RGb3Jtc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBWaXNpYmxlRm9ybXMuUmVtb3ZlKGZvcm0pO1xyXG4gICAgICAgICAgICAgICAgICAgIFZpc2libGVGb3Jtcy5BZGQoZm9ybSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpbnQgbGVuZ3RoID0gVmlzaWJsZUZvcm1zLkNvdW50O1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKFZpc2libGVGb3Jtc1tpXSAhPSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFZpc2libGVGb3Jtc1tpXS5Db250ZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBWaXNpYmxlRm9ybXNbaV0uTWFuYWdlUGxhY2VIb2xkZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFZpc2libGVGb3Jtc1tpXS5TdHlsZS5aSW5kZXggPSB6SW5kZXguVG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZnJhZy5BcHBlbmRDaGlsZChWaXNpYmxlRm9ybXNbaV0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy97XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGlmKGxlbmd0aCAtIDEgPT0gaSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgVmlzaWJsZUZvcm1zW2ldLk1hbmFnZVBsYWNlSG9sZGVycygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgZnJhZy5BcHBlbmRDaGlsZChWaXNpYmxlRm9ybXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgcmV0dXJuIHpJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL31lbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8ve1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBWaXNpYmxlRm9ybXNbaV0uTWFuYWdlUGxhY2VIb2xkZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGZyYWcuQXBwZW5kQ2hpbGQoVmlzaWJsZUZvcm1zW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gekluZGV4O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIHZvaWQgTWFuYWdlUGxhY2VIb2xkZXJzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFTZXR0aW5ncy5SZW1vdmVBdHRyaWJ1dGVzT2ZmRWxlbWVudHNXaGVuTG9zZUZvY3VzKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgYm9vbCBzaG91bGRIaWRlUGxhY2Vob2xkZXJzID0gQWN0aXZlRm9ybSAhPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgaWYoc2hvdWxkSGlkZVBsYWNlaG9sZGVycyAhPSBIYXNSZW1vdmVkUGxhY2VIb2xkZXIpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEhhc1JlbW92ZWRQbGFjZUhvbGRlciA9IHNob3VsZEhpZGVQbGFjZWhvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlID0gbmV3IFF1ZXVlPEhUTUxFbGVtZW50PigpO1xyXG4gICAgICAgICAgICAgICAgcXVlLkVucXVldWUoQm9keSk7XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUocXVlLkNvdW50ID4gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHF1ZS5EZXF1ZXVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2hvdWxkSGlkZVBsYWNlaG9sZGVycylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gZWxlbWVudC5HZXRBdHRyaWJ1dGUoXCJwbGFjZWhvbGRlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoYSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuUmVtb3ZlQXR0cmlidXRlKFwicGxhY2Vob2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LlNldEF0dHJpYnV0ZShcImRhdGEtcGxhY2Vob2xkZXJcIiwgYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBlbGVtZW50LkdldEF0dHJpYnV0ZShcImRhdGEtcGxhY2Vob2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGEpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LlJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcGxhY2Vob2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LlNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGludCBsZW5ndGggPSBlbGVtZW50LkNoaWxkRWxlbWVudENvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZS5FbnF1ZXVlKGVsZW1lbnQuQ2hpbGRyZW5baV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgQ2FsY3VsYXRlWk9yZGVyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEdldEFjdGl2ZUZvcm1Db2xsZWN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICBpZihGb3JtQ29sbGVjdGlvbnMgPT0gbnVsbCAmJiBzdGFuZEFsb25lRm9ybXMuVmlzaWJsZUZvcm1zLkNvdW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIEZvcm1Db2xsZWN0aW9ucy5SZW1vdmUobnVsbCk7XHJcbiAgICAgICAgICAgIHZhciBjb3VudCA9IEZvcm1Db2xsZWN0aW9ucy5Db3VudDtcclxuICAgICAgICAgICAgaW50IHpJbmRleCA9IDE7XHJcblxyXG4gICAgICAgICAgICAvL3ZhciBmcmFnID0gRG9jdW1lbnQuQ3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICAgICAgICAgICAgRm9ybU92ZXJMYXkuU3R5bGUuT3BhY2l0eSA9IGNvdW50ID09IDAgPyBcIlwiIDogY291bnQgPT0gMSA/IFwiMFwiIDogXCIwLjRcIjtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCBjb3VudDsgeCsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvL2lmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgLy97XHJcbiAgICAgICAgICAgICAgICAvLyAgICBpZih4ID09IGNvdW50IC0gMSlcclxuICAgICAgICAgICAgICAgIC8vICAgIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICBmcmFnLkFwcGVuZENoaWxkKEZvcm1PdmVyTGF5KTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICB6SW5kZXggPSBDYWxjdWxhdGVaT3JkZXIoRm9ybUNvbGxlY3Rpb25zW3hdLCB6SW5kZXgsIGZyYWcpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgfVxyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICAvL2Vsc2VcclxuICAgICAgICAgICAgICAgIC8ve1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICBpZih4ID09IGNvdW50IC0gMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2ZyYWcuQXBwZW5kQ2hpbGQoRm9ybU92ZXJMYXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIEZvcm1PdmVyTGF5LlN0eWxlLlpJbmRleCA9IHpJbmRleC5Ub1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHpJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgekluZGV4ID0gQ2FsY3VsYXRlWk9yZGVyKEZvcm1Db2xsZWN0aW9uc1t4XSwgekluZGV4KTsgLy8gZnJhZ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHpJbmRleCA9IENhbGN1bGF0ZVpPcmRlcihzdGFuZEFsb25lRm9ybXMsIHpJbmRleCk7IC8vIGZyYWdcclxuXHJcbiAgICAgICAgICAgIC8vV2luZG93SG9sZGVyLkVtcHR5KCk7XHJcbiAgICAgICAgICAgIC8vV2luZG93SG9sZGVyLkFwcGVuZENoaWxkKGZyYWcpO1xyXG5cclxuICAgICAgICAgICAgaWYoQWN0aXZlRm9ybSAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBBY3RpdmVGb3JtLkJvZHkuRm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBMaXN0PEZvcm0+IFRvQ2xlYW4gPSBuZXcgTGlzdDxGb3JtPigpO1xyXG4gICAgICAgIHByaXZhdGUgQWN0aW9uIGNsb3NlQWN0aW9uO1xyXG4gICAgICAgIHByb3RlY3RlZCBib29sIEluQ2xvc2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2xvc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoX0lzRGlhbG9nICYmIEluRGlhbG9nUmVzdWx0KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgSW5DbG9zZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBPbkNsb3NpbmcoKTtcclxuXHJcbiAgICAgICAgICAgIFRvQ2xlYW4uQWRkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG93bmVyRm9ybUNvbGxlY3Rpb24gPSBHZXRGb3JtQ29sbGVjdGlvbkZyb21Gb3JtKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgaWYob3duZXJGb3JtQ29sbGVjdGlvbiAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihvd25lckZvcm1Db2xsZWN0aW9uLkZvcm1Pd25lciA9PSB0aGlzKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG93bmVyRm9ybUNvbGxlY3Rpb24uRm9ybU93bmVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgb3duZXJGb3JtQ29sbGVjdGlvbi5WaXNpYmxlRm9ybXMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG93bmVyRm9ybUNvbGxlY3Rpb24uVmlzaWJsZUZvcm1zW2ldID09IHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3duZXJGb3JtQ29sbGVjdGlvbi5WaXNpYmxlRm9ybXNbaV0uQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoRm9ybUNvbGxlY3Rpb25zLkNvdW50ID09IDEpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBGb3JtQ29sbGVjdGlvbnMgPSBuZXcgTGlzdDxGb3JtQ29sbGVjdGlvbj4oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3duZXJGb3JtQ29sbGVjdGlvbi5WaXNpYmxlRm9ybXMuUmVtb3ZlKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihDb250ZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCFGb3JSZXVzZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihTZXR0aW5ncy5Gb3JtRmFkZUR1cmF0aW9uID4gMClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNlbGYuRmFkZU91dChTZXR0aW5ncy5Gb3JtRmFkZUR1cmF0aW9uLCAoZ2xvYmFsOjpTeXN0ZW0uQWN0aW9uKWNsb3NlQWN0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ29udGVudC5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5Db2xsYXBzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgQ2FsY3VsYXRlWk9yZGVyKCk7XHJcblxyXG4gICAgICAgICAgICBBY3RpdmVGb3JtID0gX1ByZXZBY3RpdmVGb3JtO1xyXG4gICAgICAgICAgICBpZihfSXNEaWFsb2cpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEluRGlhbG9nUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmKERpYWxvZ1Jlc3VsdCAhPSBEaWFsb2dSZXN1bHRFbnVtLk5vbmUgJiZcclxuICAgICAgICAgICAgICAgIERpYWxvZ1Jlc3VsdHMgIT0gbnVsbCAmJiBEaWFsb2dSZXN1bHRzLkNvdW50ID4gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgRGlhbG9nUmVzdWx0cy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgRGlhbG9nUmVzdWx0c1tpXS5JbnZva2VJZlJlc3VsdChEaWFsb2dSZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoT25Gb3JtQ2xvc2VkICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBPbkZvcm1DbG9zZWQoKTtcclxuICAgICAgICAgICAgT25DbG9zZWQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKFdpbmRvd1N0YXRlID09IFdpbmRvd1N0YXRlVHlwZS5NaW5pbWl6ZWQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIE1pbmltaXplZEZvcm1zLlJlbW92ZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIENhbGN1bGF0ZU1pbm1pemVkRm9ybXNMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBJbkNsb3NlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgSW5EaWFsb2dSZXN1bHQgPSBmYWxzZTtcclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxudXNpbmcgU3lzdGVtLkxpbnE7XHJcbnVzaW5nIFN5c3RlbS5UZXh0O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgQ2FsY3VsYXRvckNvbnRyb2wgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIE1lbW9JbnB1dCBEaXNwbGF5SW5wdXQ7XHJcblxyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuQ2xvc2U7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5CYWNrO1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuQ0U7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5DO1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuUFRBWDtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bk1UQVg7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5UQVg7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5EYmw7XHJcblxyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuNztcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bjg7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG45O1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuRGl2O1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuU3FydDtcclxuXHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG40O1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuNTtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bjY7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5NdWw7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5QZXI7XHJcblxyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuMTtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bjI7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG4zO1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuTWludXM7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG4xT3Zlclg7XHJcblxyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuMDtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bnBsdXNPck5lZztcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bkRvdDtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0blBsdXM7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5FcTtcclxuXHJcbiAgICAgICAgcHVibGljIGRlY2ltYWwgVmFsdWU7XHJcblxyXG4gICAgICAgIHByaXZhdGUgTGlzdDxzdHJpbmc+IF9jb21tYW5kcyA9IG5ldyBMaXN0PHN0cmluZz4oKTtcclxuICAgICAgICBwcml2YXRlIHN0cmluZyBjdXJyZW50X2NvbW1hbmQgPSBcIlwiO1xyXG5cclxuICAgICAgICBwcml2YXRlIHZvaWQgQWRkVGV4dFRvQ29tbWFuZChTaW1wbGVCdXR0b24gYnV0dG9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoYnV0dG9uLlRleHQgPT0gXCIuXCIgJiYgY3VycmVudF9jb21tYW5kLkNvbnRhaW5zKFwiLlwiKSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmKGN1cnJlbnRfY29tbWFuZCA9PSBcIjBcIilcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRfY29tbWFuZCA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICBjdXJyZW50X2NvbW1hbmQgKz0gYnV0dG9uLlRleHQ7XHJcblxyXG4gICAgICAgICAgICBSZWZyZXNoVmFsdWUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBBY3Rpb248ZGVjaW1hbD4gT25FcXVhbCA9IG51bGw7XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENhbGN1bGF0ZUFuZENsb3NlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciB4ID0gQ2FsY3VsYXRlKCk7XHJcblxyXG4gICAgICAgICAgICBpZihPbkVxdWFsICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBPbkVxdWFsKHgpO1xyXG4gICAgICAgICAgICBpZighRG9udFJlZnJlc2gpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKE9uQ2xvc2UgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBPbkNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBBY3Rpb24gT25DbG9zZTtcclxuXHJcbiAgICAgICAgcHVibGljIGRlY2ltYWwgQ2FsY3VsYXRlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGRlY2ltYWwgcHJldmlvdXNWYWx1ZSA9IDA7XHJcblxyXG4gICAgICAgICAgICBzdHJpbmcgcHJldmlvdXNPcCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBfY29tbWFuZHMuQ291bnQ7XHJcblxyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBjb21tYW5kID0gX2NvbW1hbmRzW2ldO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGNvbW1hbmQuRW5kc1dpdGgoXCIlXCIpKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSBjb21tYW5kLlN1YnN0cmluZygwLCBjb21tYW5kLkxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGRlY2ltYWwgdHJ5RGVjO1xyXG4gICAgICAgICAgICAgICAgaWYoZGVjaW1hbC5UcnlQYXJzZShjb21tYW5kLCBvdXQgdHJ5RGVjKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihwcmV2aW91c09wICE9IFwiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihfY29tbWFuZHNbaV0uRW5kc1dpdGgoXCIlXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlEZWMgPSBwcmV2aW91c1ZhbHVlICogKHRyeURlYyAvIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5RGVjID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocHJldmlvdXNPcCA9PSBcIitcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZSA9IHByZXZpb3VzVmFsdWUgKyB0cnlEZWM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwcmV2aW91c09wID09IFwiLVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gcHJldmlvdXNWYWx1ZSAtIHRyeURlYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHByZXZpb3VzT3AgPT0gXCIvXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSBwcmV2aW91c1ZhbHVlIC8gdHJ5RGVjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocHJldmlvdXNPcCA9PSBcIipcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZSA9IHByZXZpb3VzVmFsdWUgKiB0cnlEZWM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwcmV2aW91c09wID09IFwiKlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gcHJldmlvdXNWYWx1ZSAqIHRyeURlYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNPcCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSB0cnlEZWM7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzT3AgPSBjb21tYW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHByZXZpb3VzT3AgPT0gXCIrVEFYXCIpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gSGVscGVyLkFkZFRheChwcmV2aW91c1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNPcCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocHJldmlvdXNPcCA9PSBcIi1UQVhcIilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSBIZWxwZXIuRGVkdWN0VGF4KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c09wID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwcmV2aW91c09wID09IFwiVEFYXCIpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gSGVscGVyLkdldFBvcnRpb25UYXgocHJldmlvdXNWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzT3AgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHByZXZpb3VzT3AgPT0gXCJEYmxcIilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSBwcmV2aW91c1ZhbHVlICogMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNPcCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocHJldmlvdXNPcCA9PSBcInNxcnRcIilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gKGRlY2ltYWwpTWF0aC5TcXJ0KChkb3VibGUpcHJldmlvdXNWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c09wID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwcmV2aW91c09wID09IFwiMS94XCIpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZSA9IDEuMG0gLyBwcmV2aW91c1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKEV4Y2VwdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzT3AgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHByZXZpb3VzT3AgPT0gXCIrLy1cIilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSAtcHJldmlvdXNWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNPcCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcHJldmlvdXNWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFJlZnJlc2hWYWx1ZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihEb250UmVmcmVzaClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdmFyIGJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IF9jb21tYW5kcy5Db3VudDtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoX2NvbW1hbmRzW2ldICsgXCIgXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJ1aWxkZXIuQXBwZW5kKGN1cnJlbnRfY29tbWFuZCk7XHJcbiAgICAgICAgICAgIERpc3BsYXlJbnB1dC5UZXh0ID0gXCJcIjtcclxuICAgICAgICAgICAgRGlzcGxheUlucHV0LlRleHQgPSBidWlsZGVyLlRvU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBJc0FsbE51bWJlcnMoc3RyaW5nIHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZGVjaW1hbCB4O1xyXG4gICAgICAgICAgICByZXR1cm4gZGVjaW1hbC5UcnlQYXJzZSh2YWx1ZSwgb3V0IHgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSB2b2lkIEJhY2soU2ltcGxlQnV0dG9uIGJ1dHRvbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGN1cnJlbnRfY29tbWFuZCAhPSBcIlwiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50X2NvbW1hbmQgPSBjdXJyZW50X2NvbW1hbmQuU3Vic3RyaW5nKDAsIGN1cnJlbnRfY29tbWFuZC5MZW5ndGggLSAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9jb21tYW5kcy5Db3VudCA+IDApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBTeXN0ZW0uTGlucS5FbnVtZXJhYmxlLkxhc3Q8c3RyaW5nPihfY29tbWFuZHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKElzQWxsTnVtYmVycyh4KSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfY29tbWFuZCA9IHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfY29tbWFuZCA9IGN1cnJlbnRfY29tbWFuZC5TdWJzdHJpbmcoMCwgY3VycmVudF9jb21tYW5kLkxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2NvbW1hbmQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBfY29tbWFuZHMuUmVtb3ZlQXQoX2NvbW1hbmRzLkNvdW50IC0gMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgUmVmcmVzaFZhbHVlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBJc1NpbmdsZU9wZXJhdG9yKHN0cmluZyB4KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuICh4LkNvbnRhaW5zKFwiVEFYXCIpIHx8IHggPT0gXCJEYmxcIiB8fCB4ID09IFwiMS94XCIgfHwgeCA9PSBcIisvLVwiIHx8IHggPT0gXCJzcXJ0XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgRG9udFJlZnJlc2ggPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQWRkT3BlcmF0b3IoU2ltcGxlQnV0dG9uIGJ1dHRvbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKElzU2luZ2xlT3BlcmF0b3IoYnV0dG9uLlRleHQpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfY29tbWFuZHMuQ291bnQgPiAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5MYXN0PHN0cmluZz4oX2NvbW1hbmRzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZighSXNTaW5nbGVPcGVyYXRvcih4KSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRfY29tbWFuZCA9PSBcIlwiICYmICFJc0FsbE51bWJlcnMoeCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihjdXJyZW50X2NvbW1hbmQgIT0gXCJcIilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfY29tbWFuZHMuQWRkKGN1cnJlbnRfY29tbWFuZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudF9jb21tYW5kID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBfY29tbWFuZHMuQWRkKGJ1dHRvbi5UZXh0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBSZWZyZXNoVmFsdWUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRfY29tbWFuZCA9PSBcIlwiKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGJ1dHRvbi5UZXh0ID09IFwiPVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2FsY3VsYXRlQW5kQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihfY29tbWFuZHMuQ291bnQgPiAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IFN5c3RlbS5MaW5xLkVudW1lcmFibGUuTGFzdDxzdHJpbmc+KF9jb21tYW5kcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighSXNTaW5nbGVPcGVyYXRvcih4KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoYnV0dG9uLlRleHQgPT0gXCIlXCIpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoX2NvbW1hbmRzLkNvdW50ID4gMClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5MYXN0PHN0cmluZz4oX2NvbW1hbmRzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFJc1NpbmdsZU9wZXJhdG9yKHgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2NvbW1hbmQgKz0gXCIlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29tbWFuZHMuQWRkKGN1cnJlbnRfY29tbWFuZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2NvbW1hbmQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9jb21tYW5kcy5BZGQoY3VycmVudF9jb21tYW5kKTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2NvbW1hbmQgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihidXR0b24uVGV4dCA9PSBcIj1cIilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhbGN1bGF0ZUFuZENsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jb21tYW5kcy5BZGQoYnV0dG9uLlRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFJlZnJlc2hWYWx1ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgQ2FsY3VsYXRvckNvbnRyb2woZGVjaW1hbCBzdGFydGluZ1ZhbHVlLCBib29sIENsb3NlQnV0dG9uVmlzaWJsZSA9IGZhbHNlKSA6IGJhc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgVmFsdWUgPSBzdGFydGluZ1ZhbHVlO1xyXG5cclxuICAgICAgICAgICAgY3VycmVudF9jb21tYW5kID0gVmFsdWUuVG9TdHJpbmcoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBEb2N1bWVudC5DcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gICAgICAgICAgICBpbnQgQWRkSGVpZ2h0ID0gKEhlbHBlci5Ob3REZXNrdG9wID8gNDUgOiAyMik7XHJcblxyXG4gICAgICAgICAgICAvLzI3Ljc3Nzc4XHJcblxyXG4gICAgICAgICAgICBkb2MuQXBwZW5kQ2hpbGQoXHJcbiAgICAgICAgICAgICAgICAoRGlzcGxheUlucHV0ID0gbmV3IE1lbW9JbnB1dCgpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgUmVhZG9ubHkgPSB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIEJvdW5kcyA9IG5ldyBWZWN0b3I0KDQsIDQsIFwiKDEwMCUgLSA4cHgpXCIsIEFkZEhlaWdodClcclxuICAgICAgICAgICAgICAgIH0pLkNvbnRlbnRcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgRGlzcGxheUlucHV0LlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcbiAgICAgICAgICAgICAgICBEaXNwbGF5SW5wdXQuSGVpZ2h0ID0gNDU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIExpc3Q8U2ltcGxlQnV0dG9uPiBidXR0b25zID0gbmV3IExpc3Q8U2ltcGxlQnV0dG9uPigpO1xyXG5cclxuICAgICAgICAgICAgYnV0dG9ucy5BZGRSYW5nZShcclxuICAgICAgICAgICAgICAgIG5ldyBTaW1wbGVCdXR0b25bXSB7XHJcbiAgICAgICAgICAgICAgICBidG5QVEFYID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiK1RBWFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZE9wZXJhdG9yXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuNyA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcIjdcIixcclxuICAgICAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSBBZGRUZXh0VG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuOCA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcIjhcIixcclxuICAgICAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSBBZGRUZXh0VG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuOSA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcIjlcIixcclxuICAgICAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSBBZGRUZXh0VG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuRGl2ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiL1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZE9wZXJhdG9yXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuU3FydCA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcInNxcnRcIixcclxuICAgICAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSBBZGRPcGVyYXRvclxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bk1UQVggPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCItVEFYXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkT3BlcmF0b3JcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG40ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiNFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZFRleHRUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG41ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiNVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZFRleHRUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG42ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiNlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZFRleHRUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG5NdWwgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCIqXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkT3BlcmF0b3JcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG5QZXIgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCIlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkT3BlcmF0b3JcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG5UQVggPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCJUQVhcIixcclxuICAgICAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSBBZGRPcGVyYXRvclxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bjEgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCIxXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkVGV4dFRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bjIgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCIyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkVGV4dFRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bjMgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCIzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkVGV4dFRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bk1pbnVzID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiLVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZE9wZXJhdG9yXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuMU92ZXJYID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiMS94XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkT3BlcmF0b3JcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG5EYmwgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCJEYmxcIixcclxuICAgICAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSBBZGRPcGVyYXRvclxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bjAgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCIwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkVGV4dFRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bnBsdXNPck5lZyA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcIisvLVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZE9wZXJhdG9yXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuRG90ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiLlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZFRleHRUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBidG5QbHVzID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiK1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEFkZE9wZXJhdG9yXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuRXEgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCI9XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gQWRkT3BlcmF0b3JcclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpbnQgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICBpbnQgeSA9IDA7XHJcbiAgICAgICAgICAgIGludCB5T2Zmc2V0ID0gMjggKyBBZGRIZWlnaHQ7XHJcbiAgICAgICAgICAgIGJ0bkNsb3NlID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFRleHQgPSBcIiZ0aW1lcztcIixcclxuICAgICAgICAgICAgICAgIFNpemUgPSBuZXcgVmVjdG9yMihcIigoMTAwJSAtIDI4cHgpICogMC4xNjY2NjY2NjY2NjY2NjY3KVwiLCBcIigoMTAwJSAtIFwiICsgeU9mZnNldCArIFwicHgpICogMC4yKVwiKSxcclxuICAgICAgICAgICAgICAgIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoKCgxMDAlIC0gMjhweCkgKiBcIiArICg1ICogMC4xNjY2NjY2NjY2NjY2NjY3bSkgKyBcIikgKyBcIiArICgoNSAqIDQpICsgNCkgKyBcInB4KVwiLCBcIigoKDEwMCUgLSBcIiArIHlPZmZzZXQgKyBcInB4KSAqIFwiICsgKHkgKiAwLjJtKSArIFwiKSArIFwiICsgKCgoeSAqIDQpICsgOCkgKyBBZGRIZWlnaHQpICsgXCJweClcIiksXHJcbiAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihPbkNsb3NlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPbkNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnRuQ2xvc2UuU3R5bGUuRm9udFNpemUgPSBcIjI2cHhcIjtcclxuICAgICAgICAgICAgICAgIGJ0bkNsb3NlLlN0eWxlLkZvbnRXZWlnaHQgPSBcImJvbGRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBidG5CYWNrID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFRleHQgPSBcIkJhY2tcIixcclxuICAgICAgICAgICAgICAgIFNpemUgPSBuZXcgVmVjdG9yMihcIigoKDEwMCUgLSAyNHB4KSAtICgoMTAwJSAtIDI4cHgpICogMC4xNjY2NjY2NjY2NjY2NjY3KSkgKiAwLjMzMylcIiwgXCIoKDEwMCUgLSBcIiArIHlPZmZzZXQgKyBcInB4KSAqIDAuMilcIiksXHJcbiAgICAgICAgICAgICAgICBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKCgoKCgxMDAlIC0gMjRweCkgLSAoKDEwMCUgLSAyOHB4KSAqIDAuMTY2NjY2NjY2NjY2NjY2NykpICogMC4zMzMpICogMCkgKyA0cHgpXCIsIFwiKCgoMTAwJSAtIFwiICsgeU9mZnNldCArIFwicHgpICogXCIgKyAoeSAqIDAuMm0pICsgXCIpICsgXCIgKyAoKCh5ICogNCkgKyA4KSArIEFkZEhlaWdodCkgKyBcInB4KVwiKSxcclxuICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IEJhY2tcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICBidG5CYWNrLlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcbiAgICAgICAgICAgIGJ0bkNFID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFRleHQgPSBcIkNFXCIsXHJcbiAgICAgICAgICAgICAgICBTaXplID0gbmV3IFZlY3RvcjIoXCIoKCgxMDAlIC0gMjRweCkgLSAoKDEwMCUgLSAyOHB4KSAqIDAuMTY2NjY2NjY2NjY2NjY2NykpICogMC4zMzMpXCIsIFwiKCgxMDAlIC0gXCIgKyB5T2Zmc2V0ICsgXCJweCkgKiAwLjIpXCIpLFxyXG4gICAgICAgICAgICAgICAgTG9jYXRpb24gPSBuZXcgVmVjdG9yMihcIigoKCgoMTAwJSAtIDI0cHgpIC0gKCgxMDAlIC0gMjhweCkgKiAwLjE2NjY2NjY2NjY2NjY2NjcpKSAqIDAuMzMzKSAqIDEpICsgOHB4KVwiLCBcIigoKDEwMCUgLSBcIiArIHlPZmZzZXQgKyBcInB4KSAqIFwiICsgKHkgKiAwLjJtKSArIFwiKSArIFwiICsgKCgoeSAqIDQpICsgOCkgKyBBZGRIZWlnaHQpICsgXCJweClcIiksXHJcbiAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudF9jb21tYW5kID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBSZWZyZXNoVmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICBidG5DRS5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICBidG5DID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFRleHQgPSBcIkNcIixcclxuICAgICAgICAgICAgICAgIFNpemUgPSBuZXcgVmVjdG9yMihcIigoKCgxMDAlIC0gMjRweCkgLSAoKDEwMCUgLSAyOHB4KSAqIDAuMTY2NjY2NjY2NjY2NjY2NykpICogMC4zMzMpICsgNHB4KVwiLCBcIigoMTAwJSAtIFwiICsgeU9mZnNldCArIFwicHgpICogMC4yKVwiKSxcclxuICAgICAgICAgICAgICAgIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoKCgoKDEwMCUgLSAyNHB4KSAtICgoMTAwJSAtIDI4cHgpICogMC4xNjY2NjY2NjY2NjY2NjY3KSkgKiAwLjMzMykgKiAyKSArIDEycHgpXCIsIFwiKCgoMTAwJSAtIFwiICsgeU9mZnNldCArIFwicHgpICogXCIgKyAoeSAqIDAuMm0pICsgXCIpICsgXCIgKyAoKCh5ICogNCkgKyA4KSArIEFkZEhlaWdodCkgKyBcInB4KVwiKSxcclxuICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IChldikgPT5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfY29tbWFuZHMgPSBuZXcgTGlzdDxzdHJpbmc+KCk7IGN1cnJlbnRfY29tbWFuZCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgUmVmcmVzaFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgYnRuQy5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG5cclxuICAgICAgICAgICAgZG9jLkFwcGVuZENoaWxkcmVuKGJ0bkNsb3NlLkNvbnRlbnQsIGJ0bkJhY2suQ29udGVudCwgYnRuQ0UuQ29udGVudCwgYnRuQy5Db250ZW50KTtcclxuXHJcbiAgICAgICAgICAgIHkrKztcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBidXR0b25zLkNvdW50OyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnNbaV0uU2l6ZSA9IG5ldyBWZWN0b3IyKFwiKCgxMDAlIC0gMjhweCkgKiAwLjE2NjY2NjY2NjY2NjY2NjcpXCIsIFwiKCgxMDAlIC0gXCIgKyB5T2Zmc2V0ICsgXCJweCkgKiAwLjIpXCIpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uc1tpXS5Mb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKCgoMTAwJSAtIDI4cHgpICogXCIgKyAoaW5kZXggKiAwLjE2NjY2NjY2NjY2NjY2NjdtKSArIFwiKSArIFwiICsgKChpbmRleCAqIDQpICsgNCkgKyBcInB4KVwiLCBcIigoKDEwMCUgLSBcIiArIHlPZmZzZXQgKyBcInB4KSAqIFwiICsgKHkgKiAwLjJtKSArIFwiKSArIFwiICsgKCgoeSAqIDQpICsgOCkgKyBBZGRIZWlnaHQpICsgXCJweClcIik7XHJcbiAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgICAgICBidXR0b25zW2ldLlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgZG9jLkFwcGVuZENoaWxkKGJ1dHRvbnNbaV0uQ29udGVudCk7XHJcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gNilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgeSsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBidG5EYmwuU3R5bGUuRm9udFNpemUgPSBcIjYuNXB0XCI7XHJcbiAgICAgICAgICAgIGJ0blRBWC5TdHlsZS5Gb250U2l6ZSA9IFwiNi41cHRcIjtcclxuICAgICAgICAgICAgYnRuUFRBWC5TdHlsZS5Gb250U2l6ZSA9IFwiNi41cHRcIjtcclxuICAgICAgICAgICAgYnRuTVRBWC5TdHlsZS5Gb250U2l6ZSA9IFwiNi41cHRcIjtcclxuXHJcbiAgICAgICAgICAgIGJ0bkNsb3NlLlN0eWxlLkNvbG9yID0gXCJyZWRcIjtcclxuICAgICAgICAgICAgYnRuQ2xvc2UuU3R5bGUuRm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG5cclxuICAgICAgICAgICAgaWYoIUNsb3NlQnV0dG9uVmlzaWJsZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnRuQ2xvc2UuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuSGlkZGVuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBSZWZyZXNoVmFsdWUoKTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoZG9jKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBDaGVja0VkaXQgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIFRleHRJbnB1dCBFZGl0O1xyXG4gICAgICAgIHB1YmxpYyBIVE1MU3BhbkVsZW1lbnQgc3BhbjtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgQ2hlY2tlZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIEVkaXQuVGV4dC5Jc1RydWUoKSA9PSAxOyB9XHJcbiAgICAgICAgICAgIHNldCB7IEVkaXQuVGV4dCA9IHZhbHVlLlRvU3RyaW5nKCk7IH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBDaGVja0VkaXQoc3RyaW5nIGxhYmVsID0gXCJcIikgOiBiYXNlKG5ldyBIVE1MTGFiZWxFbGVtZW50KCkgeyBDbGFzc05hbWUgPSBCYXNlQ2xhc3MoZmFsc2UsIHRydWUpIH0pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBFZGl0ID0gbmV3IFRleHRJbnB1dChJbnB1dFR5cGUuQ2hlY2tib3gpO1xyXG4gICAgICAgICAgICBFZGl0LkNvbnRyb2xsZXIgPSB0aGlzO1xyXG4gICAgICAgICAgICBzcGFuID0gbmV3IEhUTUxTcGFuRWxlbWVudCgpO1xyXG5cclxuICAgICAgICAgICAgVGV4dCA9IGxhYmVsO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5Db250ZW50LkFwcGVuZENoaWxkcmVuKEVkaXQsIHNwYW4pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBpbXBsaWNpdCBvcGVyYXRvciBUZXh0SW5wdXQoQ2hlY2tFZGl0IGNoZWNrRWRpdClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGVja0VkaXQuRWRpdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgVGV4dFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIHNwYW4uSW5uZXJIVE1MOyB9XHJcbiAgICAgICAgICAgIHNldCB7IHNwYW4uSW5uZXJIVE1MID0gdmFsdWU7IH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIFN5c3RlbTtcclxudXNpbmcgU3lzdGVtLlRleHQ7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBUZXh0SW5wdXQgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgcHJldlRleHQgPSBcIlwiO1xyXG5cclxuICAgICAgICBwdWJsaWMgQWN0aW9uPFRleHRJbnB1dD4gT25UZXh0Q2hhbmdlZCA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxUZXh0SW5wdXQsIEtleWJvYXJkRXZlbnQ+IE9uS2V5RG93biA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxUZXh0SW5wdXQsIEtleWJvYXJkRXZlbnQ+IE9uS2V5VXAgPSBudWxsO1xyXG4gICAgICAgIHB1YmxpYyBBY3Rpb248VGV4dElucHV0LCBLZXlib2FyZEV2ZW50PiBPbktleVByZXNzID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgQWN0aW9uPFRleHRJbnB1dD4gT25Hb3RGb2N1cyA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxUZXh0SW5wdXQ+IE9uTG9zdEZvY3VzID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgQWN0aW9uPFRleHRJbnB1dD4gT25WYWxpZGF0ZURhdGEgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIFZhbGlkYXRlRGF0YSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0aGlzIGlzIFRleHRJbnB1dERyb3BEb3duKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuQXM8VGV4dElucHV0RHJvcERvd24+KCk7XHJcbiAgICAgICAgICAgICAgICBpZihjLlVzZWRFZGl0ICE9IG51bGwgJiYgYy5PblZhbGlkYXRlRGF0YSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIGMuT25WYWxpZGF0ZURhdGEoYy5Vc2VkRWRpdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoT25WYWxpZGF0ZURhdGEgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIE9uVmFsaWRhdGVEYXRhKHRoaXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSXNTdWJtaXQgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHB1YmxpYyBib29sIEdvTmV4dCB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIE9uRm9jdXNEb250U2VsZWN0QWxsIHsgZ2V0OyBzZXQ7IH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIHN0cmluZyBfZGlzcGxheUZvcm1hdCA9IFwiXCI7XHJcblxyXG4gICAgICAgIHB1YmxpYyB2aXJ0dWFsIHZvaWQgU2V0RGlzcGxheUZvcm1hdChzdHJpbmcgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBfZGlzcGxheUZvcm1hdCA9IHZhbHVlO1xyXG4gICAgICAgICAgICBmb3JtYXRUZXh0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCBzdHJpbmcgR2V0RGlzcGxheUZvcm1hdCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gX2Rpc3BsYXlGb3JtYXQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIERpc3BsYXlGb3JtYXRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBfZGlzcGxheUZvcm1hdDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU2V0RGlzcGxheUZvcm1hdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250cm9sIENvbnRyb2xsZXIgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgSW5wdXRUeXBlIFR5cGU7XHJcbiAgICAgICAgcHVibGljIGJvb2wgRGlzYWJsZUZvY3VzUG9wdXA7XHJcbiAgICAgICAgcHJpdmF0ZSBib29sIElzT3ZlcnJpZGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgc3RyaW5nIEdldFZhbHVlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb250ZW50LklubmVySFRNTDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2aXJ0dWFsIHZvaWQgU2V0VmFsdWUoc3RyaW5nIHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ29udGVudC5Jbm5lckhUTUwgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNldERhdGVUaW1lKERhdGVUaW1lIGRhdGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBTZXREYXRlKHN0cmluZy5Gb3JtYXQoXCJ7MDpcIiArIEdldERpc3BsYXlGb3JtYXQoKSArIFwifVwiLCBkYXRlKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVGV4dElucHV0KEhUTUxFbGVtZW50IG92ZXJyaWRlRWxlbWVudCwgYm9vbCBhZGRJbnB1dENvbnRyb2wgPSB0cnVlLCBib29sIGFkZEV2ZW50c09uQ29udHJvbCA9IHRydWUpIDogYmFzZShvdmVycmlkZUVsZW1lbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBvdmVycmlkZUVsZW1lbnQuQ2xhc3NOYW1lID0gKGFkZElucHV0Q29udHJvbCA/IFwiaW5wdXRjb250cm9sXCIgOiBcIlwiKSArIEJhc2VDbGFzcyhhZGRJbnB1dENvbnRyb2wpO1xyXG4gICAgICAgICAgICBJc092ZXJyaWRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYoYWRkRXZlbnRzT25Db250cm9sKVxyXG4gICAgICAgICAgICAgICAgYWRkRXZlbnRzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIE9uRm9jdXMoKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2aXJ0dWFsIEhUTUxJbnB1dEVsZW1lbnQgR2V0SW5wdXQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoQ29udGVudC5JczxIVE1MSW5wdXRFbGVtZW50PigpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29udGVudC5BczxIVE1MSW5wdXRFbGVtZW50PigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvbnRlbnQuQXM8SFRNTElucHV0RWxlbWVudD4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGRlY2ltYWwgR2V0TnVtYmVyVmFsdWUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZGVjaW1hbCB2YWx1ZSA9IFRleHQuU3RyaXBOb25OdW1iZXJTdHJpbmcoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG9iamVjdCBHZXRFZGl0VmFsdWUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYodGhpcyBpcyBTZWFyY2hJbnB1dClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gKChTZWFyY2hJbnB1dCl0aGlzKS5FZGl0VmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZih2YWx1ZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOyAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoVHlwZSA9PSBJbnB1dFR5cGUuTnVtYmVyKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlY2ltYWwgdmFsdWUgPSBUZXh0LlN0cmlwTm9uTnVtYmVyU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZihUeXBlID09IElucHV0VHlwZS5EYXRlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGVUaW1lIGRhdGUgPSBHZXREYXRlVGltZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBUZXh0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTY3JvbGwoaW50IHZhbHVlLCBIVE1MRWxlbWVudCBwYXJlbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihwYXJlbnQgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgcGFyZW50LlNjcm9sbFRvcCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAvL0dsb2JhbC5TZXRUaW1lb3V0KCgpID0+XHJcbiAgICAgICAgICAgIC8ve1xyXG4gICAgICAgICAgICAvLyAgICBpZih0aGlzLkNvbnRlbnQuUGFyZW50RWxlbWVudCA9PSBudWxsIHx8IHRoaXMuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQgPT0gbnVsbClcclxuICAgICAgICAgICAgLy8gICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5Db250ZW50LlBhcmVudEVsZW1lbnQuUGFyZW50RWxlbWVudC5TY3JvbGxUb3AgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy99LCAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgR2V0RGlzcGxheVZhbHVlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoRGlzcGxheUZvcm1hdCkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBUZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoVHlwZSA9PSBJbnB1dFR5cGUuTnVtYmVyKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlY2ltYWwgdmFsdWUgPSBUZXh0LlN0cmlwTm9uTnVtYmVyU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoRGlzcGxheUZvcm1hdC5Ub0xvd2VyKCkuU3RhcnRzV2l0aChcImNcIikpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBib29sIHdhc05lZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZSA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhc05lZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IC12YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh3YXNOZWcgPyBcIi1cIiA6IFwiXCIpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZy5Gb3JtYXQoXCIkezA6XCIgKyBEaXNwbGF5Rm9ybWF0LlJlcGxhY2UoXCJjXCIsIFwiblwiKS5SZXBsYWNlKFwiQ1wiLCBcIk5cIikgKyBcIn1cIiwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKERpc3BsYXlGb3JtYXQuVG9Mb3dlcigpLlN0YXJ0c1dpdGgoXCJwXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Gb3JtYXQoXCJ7MDpcIiArIERpc3BsYXlGb3JtYXQgKyBcIn1cIiwgdmFsdWUgPT0gMCA/IDAgOiB2YWx1ZSAvIDEwMC4wbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KFwiezA6XCIgKyBEaXNwbGF5Rm9ybWF0ICsgXCJ9XCIsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKFR5cGUgPT0gSW5wdXRUeXBlLkRhdGUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgRGF0ZVRpbWUgdmFsdWUgPSBUZXh0LlN0cmlwTm9uRGF0ZVN0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZhbHVlID09IERhdGVUaW1lLk1pblZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KFwiezA6XCIgKyBEaXNwbGF5Rm9ybWF0ICsgXCJ9XCIsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5Gb3JtYXQoXCJ7MDpcIiArIERpc3BsYXlGb3JtYXQgKyBcIn1cIiwgVGV4dCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBmb3JtYXRUZXh0KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IEdldElucHV0KCk7XHJcbiAgICAgICAgICAgIGlmKGlucHV0ICE9IG51bGwgJiYgaW5wdXQgIT0gRG9jdW1lbnQuQWN0aXZlRWxlbWVudCkgLy8gSXMgQWN0aXZlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKERpc3BsYXlGb3JtYXQpKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0LlR5cGUgPSBJbnB1dFR5cGUuVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICBzdHJpbmcgbmV3VGV4dCA9IEdldERpc3BsYXlWYWx1ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihuZXdUZXh0ICE9IFRleHQpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBUZXh0ID0gbmV3VGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIFByZVpJbmRleDtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSB2b2lkIGFkZEV2ZW50cygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighSXNPdmVycmlkZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gR2V0SW5wdXQoKTtcclxuICAgICAgICAgICAgICAgIGlmKGlucHV0ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoRGlzcGxheUZvcm1hdCkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihUeXBlID09IElucHV0VHlwZS5QYXNzd29yZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuVHlwZSA9IElucHV0VHlwZS5UZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5Db250ZW50Lk9uQmx1ciA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ29udGVudC5TdHlsZS5aSW5kZXggPSBQcmVaSW5kZXg7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9ybWF0VGV4dCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKE9uTG9zdEZvY3VzICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25Mb3N0Rm9jdXModGhpcyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5PbkZvY3VzID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBQcmVaSW5kZXggPSBDb250ZW50LlN0eWxlLlpJbmRleDtcclxuICAgICAgICAgICAgICAgIENvbnRlbnQuU3R5bGUuWkluZGV4ID0gXCIxMDAwMFwiO1xyXG5cclxuICAgICAgICAgICAgICAgIE9uRm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IEdldElucHV0KCk7XHJcbiAgICAgICAgICAgICAgICBpZihpbnB1dCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKERpc3BsYXlGb3JtYXQpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoVHlwZSA9PSBJbnB1dFR5cGUuTnVtYmVyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0ID0gVGV4dC5TdHJpcE5vbk51bWJlclN0cmluZygpLlRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiMC4wMFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighSGVscGVyLklzRmlyZUZveCgpICYmICFSZWFkb25seSAmJiBUeXBlICE9IElucHV0VHlwZS5EYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5UeXBlID0gVHlwZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihUeXBlICE9IElucHV0VHlwZS5DaGVja2JveCAmJlxyXG4gICAgICAgICAgICAgICAgICAgIFNldHRpbmdzLk9uRm9jdXNTZWxlY3RBbGwgJiYgIU9uRm9jdXNEb250U2VsZWN0QWxsKSAvLyAmJiBIZWxwZXIuSXNGaXJlRm94KCkgJiYgQnJvd3Nlci5Jc0lFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LlNlbGVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKE9uR290Rm9jdXMgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBPbkdvdEZvY3VzKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCFEaXNhYmxlRm9jdXNQb3B1cCAmJiAhUmVhZG9ubHkgJiYgRW5hYmxlZCAmJiBIZWxwZXIuTm90RGVza3RvcCAmJiAhKHRoaXMgaXMgVGV4dElucHV0RHJvcERvd24pICYmIENvbnRyb2xsZXIgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZighU2V0dGluZ3MuRGlzYWJsZVRleHRQb3B1cEVkaXRvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFRleHRGb3JtKHRoaXMpLlNob3dQb3B1cChuZXcgVmVjdG9yMigwLCAwKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5PbkNoYW5nZSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2hlY2tUZXh0Q2hhbmdlZCgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuT25Db250ZXh0TWVudSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5PbktleVByZXNzID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDaGVja1RleHRDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgICAgICBpZihPbktleVByZXNzICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25LZXlQcmVzcyh0aGlzLCBldik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5PbktleURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENoZWNrVGV4dENoYW5nZWQoKTtcclxuICAgICAgICAgICAgICAgIGlmKE9uS2V5RG93biAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIE9uS2V5RG93bih0aGlzLCBldik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5PbktleVVwID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDaGVja1RleHRDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgICAgICBpZihPbktleVVwICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25LZXlVcCh0aGlzLCBldik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5QYXN0ZSwgKGdsb2JhbDo6U3lzdGVtLkFjdGlvbikoKCkgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2hlY2tUZXh0Q2hhbmdlZCgpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHRoaXMuQ29udGVudC5BZGRFdmVudExpc3RlbmVyKEV2ZW50VHlwZS5DdXQsIChnbG9iYWw6OlN5c3RlbS5BY3Rpb24pKCgpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENoZWNrVGV4dENoYW5nZWQoKTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBJbnB1dFR5cGUgRml4SW5wdXQoSW5wdXRUeXBlIHR5cGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0eXBlID09IElucHV0VHlwZS5EYXRlIHx8IChIZWxwZXIuSXNGaXJlRm94KCkgJiYgdHlwZSAhPSBJbnB1dFR5cGUuUGFzc3dvcmQgJiYgdHlwZSAhPSBJbnB1dFR5cGUuQ2hlY2tib3gpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gSW5wdXRUeXBlLlRleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFRleHRJbnB1dChJbnB1dFR5cGUgdHlwZSA9IElucHV0VHlwZS5UZXh0LCBib29sIGFjID0gdHJ1ZSkgOiBiYXNlKFwiaW5wdXRjb250cm9sXCIsIEZpeElucHV0KHR5cGUpLCBhYylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFR5cGUgPSB0eXBlO1xyXG5cclxuICAgICAgICAgICAgaWYoVHlwZSA9PSBJbnB1dFR5cGUuTnVtYmVyKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDb250ZW50LlN0eWxlLlRleHRBbGlnbiA9IFRleHRBbGlnbi5SaWdodDtcclxuICAgICAgICAgICAgICAgIENvbnRlbnQuU3R5bGUuVGV4dEluZGVudCA9IFwiM3B4XCI7XHJcbiAgICAgICAgICAgICAgICBDb250ZW50LlN0eWxlLlBhZGRpbmdSaWdodCA9IFwiM3B4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgRGlzcGxheUZvcm1hdCA9IFwibjJcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKFR5cGUgPT0gSW5wdXRUeXBlLkRhdGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSBuZXcgc3RyaW5nWzNdO1xyXG4gICAgICAgICAgICAgICAgc3RyWyhpbnQpU2V0dGluZ3MuRGF5UG9zaXRpb25dID0gXCJkZFwiO1xyXG4gICAgICAgICAgICAgICAgc3RyWyhpbnQpU2V0dGluZ3MuTW9udGhQb3NpdGlvbl0gPSBcIk1NXCI7XHJcbiAgICAgICAgICAgICAgICBzdHJbKGludClTZXR0aW5ncy5ZZWFyUG9zaXRpb25dID0gXCJ5eXl5XCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgYnVpbGRlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IDM7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBidWlsZGVyLkFwcGVuZChzdHJbaV0gKyBTZXR0aW5ncy5EYXRlU2VwZXJhdG9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJ1aWxkZXIuTGVuZ3RoLS07XHJcbiAgICAgICAgICAgICAgICBEaXNwbGF5Rm9ybWF0ID0gYnVpbGRlci5Ub1N0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGRFdmVudHMoKTtcclxuXHJcbiAgICAgICAgICAgIGZvcm1hdFRleHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBDaGVja1RleHRDaGFuZ2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFRleHQgIT0gcHJldlRleHQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKE9uVGV4dENoYW5nZWQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBPblRleHRDaGFuZ2VkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgcHJldlRleHQgPSBUZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBSZW5kZXIoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5SZW5kZXIoKTtcclxuICAgICAgICAgICAgcHJldlRleHQgPSBUZXh0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBUZXh0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoSXNPdmVycmlkZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gR2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihUeXBlID09IElucHV0VHlwZS5DaGVja2JveClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkNvbnRlbnQuQXM8SFRNTElucHV0RWxlbWVudD4oKS5DaGVja2VkLlRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkNvbnRlbnQuQXM8SFRNTElucHV0RWxlbWVudD4oKS5WYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKElzT3ZlcnJpZGUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU2V0VmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKFR5cGUgPT0gSW5wdXRUeXBlLkNoZWNrYm94KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5Ub0xvd2VyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5BczxIVE1MSW5wdXRFbGVtZW50PigpLkNoZWNrZWQgPSB2YWx1ZS5Jc1RydWUoKSA9PSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuQXM8SFRNTElucHV0RWxlbWVudD4oKS5WYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXRUZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIENoZWNrVGV4dENoYW5nZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2V0RGF0ZShzdHJpbmcgZGF0ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGRhdGUpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGQgPSBkYXRlLlN0cmlwTm9uRGF0ZVN0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgaWYoZGQgPT0gRGF0ZVRpbWUuTWluVmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IHN0cmluZy5Gb3JtYXQoXCJ7MDpcIiArIERpc3BsYXlGb3JtYXQgKyBcIn1cIiwgZGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgVGV4dCA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgR2V0RGF0ZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShUZXh0KSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRkID0gVGV4dC5TdHJpcE5vbkRhdGVTdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgIGlmKGRkID09IERhdGVUaW1lLk1pblZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuRm9ybWF0KFwiezA6XCIgKyBEaXNwbGF5Rm9ybWF0ICsgXCJ9XCIsIGRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgRGF0ZVRpbWUgR2V0RGF0ZVRpbWUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIFRleHQuU3RyaXBOb25EYXRlU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBJc051bWVyaWNUeXBlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBUeXBlID09IElucHV0VHlwZS5OdW1iZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBJc0RhdGVUeXBlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBUeXBlID09IElucHV0VHlwZS5EYXRlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBib29sIGVuYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBFbmFibGVkXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gZW5hYmxlZDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgaWYoZW5hYmxlZClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuUmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5Db250ZW50LlNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgX3JlYWRvbmx5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFJlYWRvbmx5XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX3JlYWRvbmx5OyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBfcmVhZG9ubHkgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmKF9yZWFkb25seSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuU2V0QXR0cmlidXRlKFwicmVhZG9ubHlcIiwgKF9yZWFkb25seSkuVG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5Db250ZW50LlJlbW92ZUF0dHJpYnV0ZShcInJlYWRvbmx5XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBEYXRlQ29udHJvbCA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0blRvcDtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0blNlbGVjdGVkUmFuZ2U7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5Ub2RheTtcclxuXHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5MZWZ0O1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gYnRuUmlnaHQ7XHJcblxyXG4gICAgICAgIHB1YmxpYyBDb250cm9sIENvbnRlbnRSYW5nZTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgU2VsZWN0ZWRZZWFyO1xyXG4gICAgICAgIHByaXZhdGUgaW50IFNlbGVjdGVkTW9udGg7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgU2VsZWN0ZWREYXk7XHJcblxyXG4gICAgICAgIHByaXZhdGUgRGlzcGxheU1vZGUgX2FjdGl2ZURpc3BsYXlNb2RlID0gRGlzcGxheU1vZGUuRGF5O1xyXG5cclxuICAgICAgICBwdWJsaWMgRGlzcGxheU1vZGUgQWN0aXZlRGlzcGxheU1vZGVcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBfYWN0aXZlRGlzcGxheU1vZGU7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9hY3RpdmVEaXNwbGF5TW9kZSAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfYWN0aXZlRGlzcGxheU1vZGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBSZWZyZXNoVmlldygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgRGF0ZVRpbWUgR2V0Vmlld0RhdGVUaW1lKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZVRpbWUoU2VsZWN0ZWRZZWFyLCBTZWxlY3RlZE1vbnRoLCBTZWxlY3RlZERheSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTZXRWaWV3RGF0ZVRpbWUoRGF0ZVRpbWUgZGF0ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBuZXdTZWxlY3RlZFllYXIgPSBkYXRlLlllYXI7XHJcbiAgICAgICAgICAgIHZhciBuZXdTZWxlY3RlZE1vbnRoID0gZGF0ZS5Nb250aDtcclxuICAgICAgICAgICAgdmFyIG5ld1NlbGVjdGVkRGF5ID0gZGF0ZS5EYXk7XHJcblxyXG4gICAgICAgICAgICBpZihuZXdTZWxlY3RlZFllYXIgIT0gU2VsZWN0ZWRZZWFyIHx8XHJcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3RlZE1vbnRoICE9IFNlbGVjdGVkTW9udGggfHxcclxuICAgICAgICAgICAgICAgIG5ld1NlbGVjdGVkRGF5ICE9IFNlbGVjdGVkRGF5IHx8IGRhdGUgPT0gRGF0ZVRpbWUuVG9kYXkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFNlbGVjdGVkWWVhciA9IG5ld1NlbGVjdGVkWWVhcjtcclxuICAgICAgICAgICAgICAgIFNlbGVjdGVkTW9udGggPSBuZXdTZWxlY3RlZE1vbnRoO1xyXG4gICAgICAgICAgICAgICAgU2VsZWN0ZWREYXkgPSBuZXdTZWxlY3RlZERheTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihPbkRhdGVDaGFuZ2VkICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25EYXRlQ2hhbmdlZChkYXRlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBSZWZyZXNoVmlldygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgQWN0aW9uPERhdGVUaW1lPiBPbkRhdGVDaGFuZ2VkO1xyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBzdHJpbmdbXSBEYXlzID0gbmV3IHN0cmluZ1tdIHtcclxuICAgICAgICAgICAgXCJNT1wiLFxyXG4gICAgICAgICAgICBcIlRVXCIsXHJcbiAgICAgICAgICAgIFwiV0VcIixcclxuICAgICAgICAgICAgXCJUSFwiLFxyXG4gICAgICAgICAgICBcIkZSXCIsXHJcbiAgICAgICAgICAgIFwiU0FcIixcclxuICAgICAgICAgICAgXCJTVVwiXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUmVmcmVzaFZpZXcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBHZXRWaWV3RGF0ZVRpbWUoKTtcclxuICAgICAgICAgICAgYnRuVG9wLlRleHQgPSBkYXRlLlRvU3RyaW5nKFwiZGRkLCBkZCBNTU0geXl5eVwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBEb2N1bWVudC5DcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2goX2FjdGl2ZURpc3BsYXlNb2RlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIERpc3BsYXlNb2RlLkRheTpcclxuICAgICAgICAgICAgICAgICAgICBidG5TZWxlY3RlZFJhbmdlLlRleHQgPSBkYXRlLlRvU3RyaW5nKFwiTU1NIHl5eXlcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIERhdGVUaW1lIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlVGltZShkYXRlLlllYXIsIGRhdGUuTW9udGgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGVUaW1lIGVuZERhdGUgPSBzdGFydERhdGUuQWRkTW9udGhzKDEpLkFkZERheXMoLTEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpbnQgVG90YWxEYXlzID0gKGVuZERhdGUgLSBzdGFydERhdGUpLkRheXM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydERheUluZGV4ID0gKHN0YXJ0RGF0ZS5EYXlPZldlZWsgPT0gRGF5T2ZXZWVrLlN1bmRheSA/IDcgOiAoaW50KXN0YXJ0RGF0ZS5EYXlPZldlZWspIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICBpbnQgb2Zmc2V0U3RhcnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGludCByb3cgPSAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBEYXRlVGltZSBzdGFydE91dHNpZGUgPSBzdGFydERheUluZGV4ID09IDAgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydERhdGUgOiBzdGFydERhdGUuQWRkRGF5cygtc3RhcnREYXlJbmRleCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmREYXlJbmRleCA9IChlbmREYXRlLkRheU9mV2VlayA9PSBEYXlPZldlZWsuU3VuZGF5ID8gNyA6IChpbnQpZW5kRGF0ZS5EYXlPZldlZWspIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IDQyOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBEYXRlVGltZSBjdXJEYXRlID0gc3RhcnRPdXRzaWRlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ0biA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0ID0gY3VyRGF0ZS5EYXkuVG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJvdW5kcyA9IG5ldyBWZWN0b3I0KFwiKDEwMCUgKiBcIiArIChvZmZzZXRTdGFydCAqIDAuMTQyOCkgKyBcIilcIiwgXCIoKCgxMDAlIC0gXCIgKyAoSGVscGVyLk5vdERlc2t0b3AgPyAyOSA6IDE2KSArIFwicHgpICogXCIgKyAoKHJvdyAtIDEpICogMC4xNjY2KSArIFwiKSArIFwiICsgKEhlbHBlci5Ob3REZXNrdG9wID8gMjkgOiAxNikgKyBcInB4KVwiLCBcIigxMDAlICogMC4xNDI4KVwiLCBcIigoMTAwJSAtIFwiICsgKEhlbHBlci5Ob3REZXNrdG9wID8gMjkgOiAxNikgKyBcInB4KSAqIFwiICsgMC4xNjY2ICsgXCIpXCIpLCAvLyAgb2Zmc2V0U3RhcnQgKiAzMCwgICgyMiAqIHJvdykgLSA2LCAzMCwgMjJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihHZXRWaWV3RGF0ZVRpbWUoKSA9PSBjdXJEYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoT25SZXF1ZXN0VG9DbG9zZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT25SZXF1ZXN0VG9DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXRWaWV3RGF0ZVRpbWUoY3VyRGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG4uU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5TdHlsZS5Gb250V2VpZ2h0ID0gXCJib2xkXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VyRGF0ZSA9PSBkYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG4uQ2xhc3NMaXN0LkFkZChcInNpbXBsZWJ1dHRvbi1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuLlN0eWxlLkJvcmRlckNvbG9yID0gXCJ0cmFuc3BhcmVudFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VyRGF0ZSA8IHN0YXJ0RGF0ZSB8fCBjdXJEYXRlID4gZW5kRGF0ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9idG4uU3R5bGUuQ29sb3IgPSBcInJnYigyMTEsIDIxMSwgMjExKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoY3VyRGF0ZS5EYXlPZldlZWsgPT0gRGF5T2ZXZWVrLlNhdHVyZGF5IHx8IGN1ckRhdGUuRGF5T2ZXZWVrID09IERheU9mV2Vlay5TdW5kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5TdHlsZS5Db2xvciA9IFwicmdiKDE5MSwgMTEsIDExKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLlN0eWxlLkZpbHRlciA9IFwiYnJpZ2h0bmVzcygxMTAlKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLlN0eWxlLkZpbHRlciA9IFwiYnJpZ2h0bmVzcygxMTAlKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5Db250ZW50Lk9uS2V5RG93biA9IEJsb2NrVGFiRXZlbnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MuQXBwZW5kQ2hpbGQoYnRuKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldFN0YXJ0Kys7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihvZmZzZXRTdGFydCA+IDYpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0U3RhcnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydE91dHNpZGUgPSBzdGFydE91dHNpZGUuRGF0ZS5BZGREYXlzKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihzdGFydE91dHNpZGUuSG91ciA9PSAyMylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRPdXRzaWRlID0gc3RhcnRPdXRzaWRlLkFkZEhvdXJzKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IoaW50IHggPSAwOyB4IDwgNzsgeCsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gTGFiZWwoRGF5c1t4XSwgMCwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsLlNldExvY2F0aW9uKFwiKDEwMCUgKiBcIiArICh4ICogMC4xNDI4KSArIFwiICsgKCgxMDAlICogMC4xNDI4KSAqIDAuNDUpIC0gNnB4KVwiLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9Cb3VuZHMgPSBuZXcgVmVjdG9yNChcIigxMDAlICogXCIgKyAob2Zmc2V0U3RhcnQgKiAwLjE0MjgpICsgXCIpXCIsIFwiKCgxMDAlICogXCIgKyAocm93ICogMC4xNjY2KSArIFwiKSArICgxMDAlICogMC4xNjY2KSlcIiwgXCIoMTAwJSAqIDAuMTQyOClcIiwgXCIoKDEwMCUgKiBcIiArIDAuMTY2NiArIFwiKSArICgxMDAlICogMC4xNjY2KSlcIiksIC8vICBvZmZzZXRTdGFydCAqIDMwLCAgKDIyICogcm93KSAtIDYsIDMwLCAyMlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jLkFwcGVuZENoaWxkKGxhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgRGlzcGxheU1vZGUuTW9udGg6XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEaXNwbGF5TW9kZS5ZZWFyOlxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIENvbnRlbnRSYW5nZS5Db250ZW50LkVtcHR5KCk7IC8vIGVtcHR5IGFuZCByZS1jcmVhdGVcclxuICAgICAgICAgICAgQ29udGVudFJhbmdlLkNvbnRlbnQuQXBwZW5kQ2hpbGQoZG9jKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBBY3Rpb24gT25SZXF1ZXN0VG9DbG9zZTtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQmxvY2tUYWJFdmVudChLZXlib2FyZEV2ZW50IGV2KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoZXYuS2V5Q29kZSA9PSA5KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihPblJlcXVlc3RUb0Nsb3NlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25SZXF1ZXN0VG9DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGVDb250cm9sKERhdGVUaW1lIHN0YXJ0RGF0ZSkgOiBiYXNlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFNpemUgPSBuZXcgVmVjdG9yMigyMzAsIDI0NSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZG9jID0gRG9jdW1lbnQuQ3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5PbktleURvd24gPSBCbG9ja1RhYkV2ZW50O1xyXG5cclxuICAgICAgICAgICAgYnRuVG9wID0gbmV3IFNpbXBsZUJ1dHRvbigpO1xyXG4gICAgICAgICAgICBidG5Ub3AuU3R5bGUuVHJhbnNmb3JtID0gXCJ0cmFuc2xhdGUoLTUwJSwgMClcIjtcclxuICAgICAgICAgICAgYnRuVG9wLlN0eWxlLkxlZnQgPSBcIjUwJVwiO1xyXG4gICAgICAgICAgICBidG5Ub3AuU3R5bGUuTWFyZ2luUmlnaHQgPSBcIjUwJVwiO1xyXG4gICAgICAgICAgICBidG5Ub3AuVG9wID0gNjtcclxuICAgICAgICAgICAgYnRuVG9wLldpZHRoID0gXCJhdXRvXCI7XHJcbiAgICAgICAgICAgIGJ0blRvcC5TdHlsZS5Cb3JkZXJDb2xvciA9IFwidHJhbnNwYXJlbnRcIjtcclxuICAgICAgICAgICAgYnRuVG9wLkNvbnRlbnQuT25LZXlEb3duID0gQmxvY2tUYWJFdmVudDtcclxuXHJcbiAgICAgICAgICAgIGJ0blNlbGVjdGVkUmFuZ2UgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vdmVVcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgYnRuU2VsZWN0ZWRSYW5nZS5TdHlsZS5UcmFuc2Zvcm0gPSBcInRyYW5zbGF0ZSgtNTAlLCAwKVwiO1xyXG4gICAgICAgICAgICBidG5TZWxlY3RlZFJhbmdlLlN0eWxlLkxlZnQgPSBcIjUwJVwiO1xyXG4gICAgICAgICAgICBidG5TZWxlY3RlZFJhbmdlLlN0eWxlLk1hcmdpblJpZ2h0ID0gXCI1MCVcIjtcclxuICAgICAgICAgICAgYnRuU2VsZWN0ZWRSYW5nZS5Ub3AgPSAzMDtcclxuICAgICAgICAgICAgYnRuU2VsZWN0ZWRSYW5nZS5XaWR0aCA9IFwiYXV0b1wiO1xyXG4gICAgICAgICAgICBidG5TZWxlY3RlZFJhbmdlLlN0eWxlLkJvcmRlckNvbG9yID0gXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgICAgICAgICBidG5TZWxlY3RlZFJhbmdlLkNvbnRlbnQuT25LZXlEb3duID0gQmxvY2tUYWJFdmVudDtcclxuXHJcbiAgICAgICAgICAgIGJ0bkxlZnQgPSBuZXcgU2ltcGxlQnV0dG9uKCkgeyBUZXh0ID0gXCI8XCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoMTQsIDM2KSwgU2l6ZSA9IG5ldyBWZWN0b3IyKDEzLCAxMyksIEl0ZW1DbGljayA9IChldikgPT4geyBNb3ZlTGVmdCgpOyB9IH07XHJcbiAgICAgICAgICAgIGJ0bkxlZnQuQ29udGVudC5PbktleURvd24gPSBCbG9ja1RhYkV2ZW50O1xyXG5cclxuICAgICAgICAgICAgYnRuUmlnaHQgPSBuZXcgU2ltcGxlQnV0dG9uKCkgeyBUZXh0ID0gXCI+XCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDI2cHgpXCIsIDM2KSwgU2l6ZSA9IG5ldyBWZWN0b3IyKDEzLCAxMyksIEl0ZW1DbGljayA9IChldikgPT4geyBNb3ZlUmlnaHQoKTsgfSB9O1xyXG4gICAgICAgICAgICBidG5SaWdodC5Db250ZW50Lk9uS2V5RG93biA9IEJsb2NrVGFiRXZlbnQ7XHJcblxyXG4gICAgICAgICAgICBidG5MZWZ0LlN0eWxlLkJvcmRlclJhZGl1cyA9IFwiNTAlXCI7XHJcbiAgICAgICAgICAgIGJ0blJpZ2h0LlN0eWxlLkJvcmRlclJhZGl1cyA9IFwiNTAlXCI7XHJcblxyXG4gICAgICAgICAgICBidG5MZWZ0LlN0eWxlLkxpbmVIZWlnaHQgPSBcIjBcIjtcclxuICAgICAgICAgICAgYnRuUmlnaHQuU3R5bGUuTGluZUhlaWdodCA9IFwiMFwiO1xyXG5cclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ0blNlbGVjdGVkUmFuZ2UuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgIGJ0blNlbGVjdGVkUmFuZ2UuSGVpZ2h0ID0gMzY7XHJcbiAgICAgICAgICAgICAgICBidG5TZWxlY3RlZFJhbmdlLlRvcCA9IDQyO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blRvcC5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuVG9wLkhlaWdodCA9IDM2O1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0bkxlZnQuU2l6ZSA9IG5ldyBWZWN0b3IyKDM2LCAzNik7XHJcbiAgICAgICAgICAgICAgICBidG5MZWZ0LlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcbiAgICAgICAgICAgICAgICBidG5MZWZ0LlRvcCA9IDIwO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blJpZ2h0LlNpemUgPSBuZXcgVmVjdG9yMigzNiwgMzYpO1xyXG4gICAgICAgICAgICAgICAgYnRuUmlnaHQuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgIGJ0blJpZ2h0LlRvcCA9IDIwO1xyXG4gICAgICAgICAgICAgICAgYnRuUmlnaHQuTGVmdCA9IFwiKDEwMCUgLSA1MHB4KVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIENvbnRlbnRSYW5nZSA9IG5ldyBDb250cm9sKCkgeyBTaXplID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDIwcHgpXCIsIFwiKDEwMCUgLSAxNDdweClcIiksIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoMTEsIDkwKSB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ29udGVudFJhbmdlID0gbmV3IENvbnRyb2woKSB7IFNpemUgPSBuZXcgVmVjdG9yMihcIigxMDAlIC0gMjBweClcIiwgXCIoMTAwJSAtIDkycHgpXCIpLCBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKDExLCA2MCkgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgQ29udGVudFJhbmdlLkNvbnRlbnQuT25LZXlEb3duID0gQmxvY2tUYWJFdmVudDtcclxuXHJcbiAgICAgICAgICAgIGJ0blRvZGF5ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFRleHQgPSBcIlRvZGF5XCIsXHJcbiAgICAgICAgICAgICAgICBXaWR0aCA9IDUwLFxyXG4gICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIEFjdGl2ZURpc3BsYXlNb2RlID0gRGlzcGxheU1vZGUuRGF5O1xyXG4gICAgICAgICAgICAgICAgICAgIFNldFZpZXdEYXRlVGltZShEYXRlVGltZS5Ub2RheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKE9uRGF0ZUNoYW5nZWQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgT25EYXRlQ2hhbmdlZChEYXRlVGltZS5Ub2RheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKEdldFZpZXdEYXRlVGltZSgpID09IERhdGVUaW1lLlRvZGF5KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoT25SZXF1ZXN0VG9DbG9zZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgT25SZXF1ZXN0VG9DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGJ0blRvZGF5LlN0eWxlLlRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKC01MCUsIDApXCI7XHJcbiAgICAgICAgICAgIGJ0blRvZGF5LlN0eWxlLkxlZnQgPSBcIjUwJVwiO1xyXG4gICAgICAgICAgICBidG5Ub2RheS5TdHlsZS5NYXJnaW5SaWdodCA9IFwiNTAlXCI7XHJcblxyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnRuVG9kYXkuVG9wID0gXCIoMTAwJSAtIDUxcHgpXCI7XHJcbiAgICAgICAgICAgICAgICBidG5Ub2RheS5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuVG9kYXkuSGVpZ2h0ID0gNDU7XHJcbiAgICAgICAgICAgICAgICBidG5Ub2RheS5TdHlsZS5NaW5XaWR0aCA9IFwiNjBweFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuVG9kYXkuV2lkdGggPSBcIigxMDAlICogMC4xNDI4KVwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnRuVG9kYXkuVG9wID0gXCIoMTAwJSAtIDI2cHgpXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJ0blRvZGF5LkNvbnRlbnQuT25LZXlEb3duID0gQmxvY2tUYWJFdmVudDtcclxuXHJcbiAgICAgICAgICAgIGRvYy5BcHBlbmRDaGlsZHJlbihidG5Ub3AsIGJ0bkxlZnQsIGJ0blNlbGVjdGVkUmFuZ2UsIGJ0blJpZ2h0LCBDb250ZW50UmFuZ2UsIGJ0blRvZGF5KTtcclxuICAgICAgICAgICAgaWYoc3RhcnREYXRlID09IERhdGVUaW1lLk1pblZhbHVlKVxyXG4gICAgICAgICAgICAgICAgc3RhcnREYXRlID0gRGF0ZVRpbWUuVG9kYXk7XHJcblxyXG4gICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKGRvYyk7XHJcblxyXG4gICAgICAgICAgICBTZXRWaWV3RGF0ZVRpbWUoc3RhcnREYXRlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIE1vdmVMZWZ0KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIE1vdmVMZWZ0T3JSaWdodCgtMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBNb3ZlVXAoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZihfYWN0aXZlRGlzcGxheU1vZGUgIT0gRGlzcGxheU1vZGUuWWVhcilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgX2FjdGl2ZURpc3BsYXlNb2RlKys7XHJcbiAgICAgICAgICAgICAgICBSZWZyZXNoVmlldygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBNb3ZlTGVmdE9yUmlnaHQoaW50IHRpbWVzVmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgZGF0ZSA9IEdldFZpZXdEYXRlVGltZSgpO1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoKF9hY3RpdmVEaXNwbGF5TW9kZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNhc2UgRGlzcGxheU1vZGUuRGF5OlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlLkFkZE1vbnRocygoMSAqIHRpbWVzVmFsdWUpKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIERpc3BsYXlNb2RlLk1vbnRoOlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlLkFkZE1vbnRocygoMTIgKiB0aW1lc1ZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBEaXNwbGF5TW9kZS5ZZWFyOlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlLkFkZFllYXJzKCgxMjAgKiB0aW1lc1ZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFNldFZpZXdEYXRlVGltZShkYXRlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIE1vdmVSaWdodCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBNb3ZlTGVmdE9yUmlnaHQoMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZW51bSBEaXNwbGF5TW9kZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgRGF5LFxyXG4gICAgICAgICAgICBNb250aCxcclxuICAgICAgICAgICAgWWVhclxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIEdyaWRMb29rdXBFZGl0IDogQ29udHJvbFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlldyBncmlkVmlldztcclxuICAgICAgICBwdWJsaWMgc3RyaW5nIEZpZWxkTmFtZTtcclxuICAgICAgICBwdWJsaWMgc3RyaW5nIERpc3BsYXlOYW1lO1xyXG4gICAgICAgIHByaXZhdGUgYm9vbCBWaXNpYmxlO1xyXG5cclxuICAgICAgICBwdWJsaWMgR3JpZExvb2t1cEVkaXQoKSA6IGJhc2UoXCJpbnB1dGNvbnRyb2xcIiwgQ29tYm9Cb3hUeXBlcy5EZWZhdWx0KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ3JpZFZpZXcgPSBuZXcgR3JpZFZpZXcodHJ1ZSwgdHJ1ZSkgeyBTaXplID0gbmV3IFZlY3RvcjIoMjUwLCA0MDApIH07XHJcbiAgICAgICAgICAgIGdyaWRWaWV3LkNvbnRleHRNZW51ID0gbnVsbDtcclxuICAgICAgICAgICAgZ3JpZFZpZXcuT25Gb2N1c2VkUm93Q2hhbmdlZCA9IChyb3dIYW5kbGUsIFByZXZSb3doYW5kbGUpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5FbXB0eSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHJvd0hhbmRsZSA+IC0xKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5BcHBlbmRDaGlsZChuZXcgSFRNTE9wdGlvbkVsZW1lbnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgSW5uZXJIVE1MID0gKGdyaWRWaWV3LkdldFJvd0NlbGxWYWx1ZShyb3dIYW5kbGUsIERpc3BsYXlOYW1lKSBhcyBzdHJpbmcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSA9IChncmlkVmlldy5HZXRSb3dDZWxsVmFsdWUocm93SGFuZGxlLCBGaWVsZE5hbWUpIGFzIHN0cmluZylcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKFZpc2libGUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xvc2VQb3B1cCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZ3JpZFZpZXcuQ29udGVudC5Pbk1vdXNlTGVhdmUgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENsb3NlUG9wdXAoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5Db250ZW50Lk9uTW91c2VEb3duID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBpZihWaXNpYmxlKVxyXG4gICAgICAgICAgICAgICAgICAgIENsb3NlUG9wdXAoKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBTaG93UG9wdXAoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNob3dQb3B1cCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihWaXNpYmxlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgeCA9IHRoaXMuQ29udGVudC5HZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAgICAgZ3JpZFZpZXcuTG9jYXRpb24gPSBuZXcgVmVjdG9yMigoaW50KXguTGVmdCwgKGludCkoeC5Ub3AgKyB4LkhlaWdodCkpO1xyXG5cclxuICAgICAgICAgICAgQ29udGV4dE1lbnUuVG90YWxDb250ZXh0SGFuZGxlcysrO1xyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuUGFyZW50RWxlbWVudC5BcHBlbmRDaGlsZChncmlkVmlldyk7XHJcblxyXG4gICAgICAgICAgICBncmlkVmlldy5SZW5kZXJHcmlkKCk7XHJcblxyXG4gICAgICAgICAgICBncmlkVmlldy5Db250ZW50LlN0eWxlLlpJbmRleCA9IChDb250ZXh0TWVudS5Ub3RhbENvbnRleHRIYW5kbGVzICsgU2V0dGluZ3MuQ29udGV4dE1lbnVTdGFydGluZ1pJbmRleCkuVG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbG9zZVBvcHVwKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFZpc2libGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGdyaWRWaWV3LkNvbnRlbnQuUGFyZW50RWxlbWVudC5SZW1vdmVDaGlsZChncmlkVmlldyk7XHJcbiAgICAgICAgICAgICAgICBDb250ZXh0TWVudS5Ub3RhbENvbnRleHRIYW5kbGVzLS07XHJcbiAgICAgICAgICAgICAgICBWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2U7XHJcbnVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxudXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzO1xyXG51c2luZyBTeXN0ZW0uTGlucTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIEdyaWRWaWV3IDogQ29udHJvbFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBIVE1MRGl2RWxlbWVudCBHcmlkSGVhZGVyO1xyXG4gICAgICAgIHB1YmxpYyBIVE1MRGl2RWxlbWVudCBHcmlkSGVhZGVyQ29udGFpbmVyO1xyXG4gICAgICAgIHB1YmxpYyBIVE1MRGl2RWxlbWVudCBHcmlkQm9keUNvbnRhaW5lcjtcclxuICAgICAgICBwdWJsaWMgSFRNTERpdkVsZW1lbnQgR3JpZEJvZHk7XHJcblxyXG4gICAgICAgIHByaXZhdGUgSFRNTERpdkVsZW1lbnQgQm90dG9uT2ZUYWJsZTtcclxuICAgICAgICBwcml2YXRlIEhUTUxEaXZFbGVtZW50IFJpZ2h0T2ZUYWJsZTtcclxuICAgICAgICBwcml2YXRlIEhUTUxEaXZFbGVtZW50IFJpZ2h0T2ZUYWJsZUhlYWRlcjtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBEYXRhVGFibGUgX2RhdGFTb3VyY2UgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgQWN0aW9uPGludCwgaW50PiBPbkZvY3VzZWRSb3dDaGFuZ2VkID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgQWN0aW9uPGludD4gT25Sb3dEb3VibGVDbGljayA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxIVE1MRWxlbWVudCwgaW50PiBPbkN1c3RvbVJvd1N0eWxlID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIEFjdGlvbjxNb3VzZUV2ZW50PEhUTUxEaXZFbGVtZW50Pj4gT25Sb3dDbGljaztcclxuICAgICAgICBwcm90ZWN0ZWQgQWN0aW9uPE1vdXNlRXZlbnQ8SFRNTERpdkVsZW1lbnQ+PiBPbkRvdWJsZUNsaWNrO1xyXG4gICAgICAgIHByb3RlY3RlZCBBY3Rpb248TW91c2VFdmVudD4gT25DZWxsUm93TW91c2VEb3duO1xyXG5cclxuICAgICAgICBwdWJsaWMgSGFyZFNvZnRMaXN0PGJvb2w+IFNlbGVjdGVkUm93cyA9IG5ldyBIYXJkU29mdExpc3Q8Ym9vbD4oZmFsc2UpO1xyXG4gICAgICAgIHB1YmxpYyBMaXN0PGludD4gVmlzaWJsZVJvd0hhbmRsZXMgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTZXRWaXNpYmxlUm93SGFuZGxlczxUPihMaXN0PFQ+IENlbGxzLCBib29sIGFzYylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGFzYylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNvcnRlZCA9IFN5c3RlbS5MaW5xLkVudW1lcmFibGUuU2VsZWN0PFQsZ2xvYmFsOjpTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXI8aW50LCBUPj4oQ2VsbHNcclxuLChnbG9iYWw6OlN5c3RlbS5GdW5jPFQsIGludCwgZ2xvYmFsOjpTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXI8aW50LCBUPj4pKCh4LCBpKSA9PiBuZXcgS2V5VmFsdWVQYWlyPGludCwgVD4oaSwgeCkpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5PcmRlckJ5PFQ+KChnbG9iYWw6OlN5c3RlbS5GdW5jPGdsb2JhbDo6U3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyPGludCwgVD4sIFQ+KSh4ID0+IHguVmFsdWUpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5Ub0xpc3QoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBWaXNpYmxlUm93SGFuZGxlcyA9IFN5c3RlbS5MaW5xLkVudW1lcmFibGUuU2VsZWN0PGdsb2JhbDo6U3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyPGludCwgVD4saW50Pihzb3J0ZWQsKGdsb2JhbDo6U3lzdGVtLkZ1bmM8Z2xvYmFsOjpTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXI8aW50LCBUPiwgaW50PikoeCA9PiB4LktleSkpLlRvTGlzdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNvcnRlZCA9IFN5c3RlbS5MaW5xLkVudW1lcmFibGUuU2VsZWN0PFQsZ2xvYmFsOjpTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXI8aW50LCBUPj4oQ2VsbHNcclxuLChnbG9iYWw6OlN5c3RlbS5GdW5jPFQsIGludCwgZ2xvYmFsOjpTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXI8aW50LCBUPj4pKCh4LCBpKSA9PiBuZXcgS2V5VmFsdWVQYWlyPGludCwgVD4oaSwgeCkpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5PcmRlckJ5RGVzY2VuZGluZzxUPigoZ2xvYmFsOjpTeXN0ZW0uRnVuYzxnbG9iYWw6OlN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcjxpbnQsIFQ+LCBUPikoeCA9PiB4LlZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICAuVG9MaXN0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgVmlzaWJsZVJvd0hhbmRsZXMgPSBTeXN0ZW0uTGlucS5FbnVtZXJhYmxlLlNlbGVjdDxnbG9iYWw6OlN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcjxpbnQsIFQ+LGludD4oc29ydGVkLChnbG9iYWw6OlN5c3RlbS5GdW5jPGdsb2JhbDo6U3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyPGludCwgVD4sIGludD4pKHggPT4geC5LZXkpKS5Ub0xpc3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgX2FsbG93Um93RHJhZyA9IGZhbHNlO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBBbGxvd1Jvd0RyYWdcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBfYWxsb3dSb3dEcmFnOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfYWxsb3dSb3dEcmFnICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hbGxvd1Jvd0RyYWcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIEF1dG9HZW5lcmF0ZUNvbHVtbnNGcm9tU291cmNlID0gdHJ1ZTtcclxuICAgICAgICBwdWJsaWMgYm9vbCBBbGxvd011bHRpU2VsZWN0aW9uID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBib29sIHNob3dBdXRvRmlsdGVyUm93ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFNob3dBdXRvRmlsdGVyUm93XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gc2hvd0F1dG9GaWx0ZXJSb3c7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHNob3dBdXRvRmlsdGVyUm93ICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3dBdXRvRmlsdGVyUm93ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXNob3dBdXRvRmlsdGVyUm93KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIEZpbHRlci5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbHVtbkNvdW50KCk7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9GaWx0ZXJFZGl0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbHVtbnNbaV0uRmlsdGVyRWRpdCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb2x1bW5zW2ldLkZpbHRlclZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBDYWxjdWxhdGVWaXNpYmxlUm93cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENhbGN1bGF0ZVZpc2libGVSb3dzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIExpc3Q8aW50PiBjYWxjVmlzaWJsZVJvd3MgPSBuZXcgTGlzdDxpbnQ+KCk7XHJcblxyXG4gICAgICAgICAgICBmb3IoaW50IHkgPSAwOyB5IDwgUm93Q291bnQoKTsgeSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBib29sIEFkZEluZGV4ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IHggPSAwOyB4IDwgQ29sdW1uQ291bnQoKTsgeCsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFDb2x1bW5zW3hdLlZhbHVlTWF0Y2hGaWx0ZXIoeSkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBBZGRJbmRleCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihBZGRJbmRleClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxjVmlzaWJsZVJvd3MuQWRkKHkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBWaXNpYmxlUm93SGFuZGxlcyA9IGNhbGNWaXNpYmxlUm93cztcclxuICAgICAgICAgICAgUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGZsb2F0IFVuaXRIZWlnaHQgPSAyOC4wZjtcclxuICAgICAgICBwcml2YXRlIGJvb2wgX2NvbHVtbkF1dG9XaWR0aCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBwcml2YXRlIGludCBfZm9jdXNlZGNvbHVtbiA9IC0xO1xyXG5cclxuICAgICAgICBwdWJsaWMgaW50IEZvY3VzZWRDb2x1bW5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2ZvY3VzZWRjb2x1bW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlICE9IEZvY3VzZWRDb2x1bW4pXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZXYgPSBfZm9jdXNlZGNvbHVtbjtcclxuICAgICAgICAgICAgICAgICAgICBfZm9jdXNlZGNvbHVtbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGludCBfZm9jdXNlZERhdGFIYW5kbGUgPSAtMTtcclxuXHJcbiAgICAgICAgcHVibGljIGludCBGb2N1c2VkRGF0YUhhbmRsZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfZm9jdXNlZERhdGFIYW5kbGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlICE9IF9mb2N1c2VkRGF0YUhhbmRsZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJldiA9IF9mb2N1c2VkRGF0YUhhbmRsZTtcclxuICAgICAgICAgICAgICAgICAgICBfZm9jdXNlZERhdGFIYW5kbGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoT25Gb2N1c2VkUm93Q2hhbmdlZCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBPbkZvY3VzZWRSb3dDaGFuZ2VkKF9mb2N1c2VkRGF0YUhhbmRsZSwgcHJldik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNldERlZmF1bHRTaXplcygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihfY29sdW1uSGVhZGVyc1Zpc2libGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEdyaWRIZWFkZXJDb250YWluZXIuU2V0Qm91bmRzKDAsIDAsIFwiMTAwJVwiLCBVbml0SGVpZ2h0ICsgMSk7XHJcbiAgICAgICAgICAgICAgICBHcmlkQm9keUNvbnRhaW5lci5TZXRCb3VuZHMoMCwgVW5pdEhlaWdodCArIDMsIFwiMTAwJVwiLCBcIigxMDAlIC0gXCIgKyAoVW5pdEhlaWdodCArIDMpICsgXCJweClcIik7XHJcbiAgICAgICAgICAgICAgICBHcmlkSGVhZGVyLlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkluaGVyaXQ7XHJcbiAgICAgICAgICAgICAgICBHcmlkSGVhZGVyQ29udGFpbmVyLlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkluaGVyaXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBHcmlkSGVhZGVyLlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkhpZGRlbjtcclxuICAgICAgICAgICAgICAgIEdyaWRIZWFkZXJDb250YWluZXIuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuSGlkZGVuO1xyXG5cclxuICAgICAgICAgICAgICAgIEdyaWRCb2R5Q29udGFpbmVyLlNldEJvdW5kcygwLCAxLCBcIjEwMCVcIiwgXCIoMTAwJSAtIDFweClcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgYm9vbCBfY29sdW1uSGVhZGVyc1Zpc2libGUgPSB0cnVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBDb2x1bW5IZWFkZXJzVmlzaWJsZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfY29sdW1uSGVhZGVyc1Zpc2libGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlICE9IF9jb2x1bW5IZWFkZXJzVmlzaWJsZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfY29sdW1uSGVhZGVyc1Zpc2libGUgPSB2YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgU2V0RGVmYXVsdFNpemVzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgQ29sdW1uQXV0b1dpZHRoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb2x1bW5BdXRvV2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgIEdyaWRCb2R5Q29udGFpbmVyLlN0eWxlLk92ZXJmbG93WCA9IE92ZXJmbG93LkhpZGRlbjtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBHcmlkQm9keUNvbnRhaW5lci5TdHlsZS5PdmVyZmxvd1ggPSBPdmVyZmxvdy5BdXRvO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKF9jb2x1bW5BdXRvV2lkdGggIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2NvbHVtbkF1dG9XaWR0aCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBib29sIF91c2VFZGl0Rm9ybSA9IHRydWU7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFVzZUVkaXRGb3JtXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF91c2VFZGl0Rm9ybTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUgIT0gX3VzZUVkaXRGb3JtKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF91c2VFZGl0Rm9ybSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBTb3J0U2V0dGluZyBTb3J0U2V0dGluZ3M7XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNvcnRDb2x1bW4oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoU29ydFNldHRpbmdzICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFNvcnRDb2x1bW4oU29ydFNldHRpbmdzLkNvbHVtbiwgU29ydFNldHRpbmdzLlNvcnRNb2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2xlYXJTb3J0Q29sdW1uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKFNvcnRTZXR0aW5ncyAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTb3J0Q29sdW1uKFNvcnRTZXR0aW5ncy5Db2x1bW4sIEdyaWRWaWV3U29ydE1vZGUuTm9uZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNvcnRDb2x1bW4oR3JpZFZpZXdDb2x1bW4gY29sdW1uLCBHcmlkVmlld1NvcnRNb2RlIHNvcnQgPSBHcmlkVmlld1NvcnRNb2RlLkFzYylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbHVtbi5Tb3J0ZWRNb2RlID0gc29ydDtcclxuXHJcbiAgICAgICAgICAgIGlmKFNvcnRTZXR0aW5ncyAhPSBudWxsICYmIFNvcnRTZXR0aW5ncy5Db2x1bW4gIT0gY29sdW1uKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTb3J0U2V0dGluZ3MuQ29sdW1uLlNvcnRlZE1vZGUgPSBHcmlkVmlld1NvcnRNb2RlLk5vbmU7XHJcbiAgICAgICAgICAgICAgICBWaXNpYmxlUm93SGFuZGxlcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKHNvcnQgPT0gR3JpZFZpZXdTb3J0TW9kZS5Ob25lKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBWaXNpYmxlUm93SGFuZGxlcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBib29sIHNvcnQxID0gc29ydCA9PSBHcmlkVmlld1NvcnRNb2RlLkFzYztcclxuXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2goY29sdW1uLkNvbHVtbi5EYXRhVHlwZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuT2JqZWN0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXRWaXNpYmxlUm93SGFuZGxlczxvYmplY3Q+KChjb2x1bW4uQ29sdW1uIGFzIERhdGFDb2x1bW5PYmplY3QpLkNlbGxzLCBzb3J0MSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkJvb2w6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldFZpc2libGVSb3dIYW5kbGVzPGJvb2w/PigoY29sdW1uLkNvbHVtbiBhcyBEYXRhQ29sdW1uQm9vbCkuQ2VsbHMsIHNvcnQxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGF0ZVRpbWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldFZpc2libGVSb3dIYW5kbGVzPGdsb2JhbDo6U3lzdGVtLkRhdGVUaW1lPz4oKGNvbHVtbi5Db2x1bW4gYXMgRGF0YUNvbHVtbkRhdGVUaW1lKS5DZWxscywgc29ydDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TdHJpbmc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldFZpc2libGVSb3dIYW5kbGVzPHN0cmluZz4oKGNvbHVtbi5Db2x1bW4gYXMgRGF0YUNvbHVtblN0cmluZykuQ2VsbHMsIHNvcnQxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQnl0ZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0VmlzaWJsZVJvd0hhbmRsZXM8Ynl0ZT8+KChjb2x1bW4uQ29sdW1uIGFzIERhdGFDb2x1bW5CeXRlKS5DZWxscywgc29ydDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TaG9ydDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2V0VmlzaWJsZVJvd0hhbmRsZXM8c2hvcnQ/PigoY29sdW1uLkNvbHVtbiBhcyBEYXRhQ29sdW1uU2hvcnQpLkNlbGxzLCBzb3J0MSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkludGVnZXI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldFZpc2libGVSb3dIYW5kbGVzPGludD8+KChjb2x1bW4uQ29sdW1uIGFzIERhdGFDb2x1bW5JbnRlZ2VyKS5DZWxscywgc29ydDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Mb25nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXRWaXNpYmxlUm93SGFuZGxlczxsb25nPz4oKGNvbHVtbi5Db2x1bW4gYXMgRGF0YUNvbHVtbkxvbmcpLkNlbGxzLCBzb3J0MSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkZsb2F0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXRWaXNpYmxlUm93SGFuZGxlczxmbG9hdD8+KChjb2x1bW4uQ29sdW1uIGFzIERhdGFDb2x1bW5GbG9hdCkuQ2VsbHMsIHNvcnQxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRG91YmxlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXRWaXNpYmxlUm93SGFuZGxlczxkb3VibGU/PigoY29sdW1uLkNvbHVtbiBhcyBEYXRhQ29sdW1uRG91YmxlKS5DZWxscywgc29ydDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5EZWNpbWFsOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZXRWaXNpYmxlUm93SGFuZGxlczxkZWNpbWFsPz4oKGNvbHVtbi5Db2x1bW4gYXMgRGF0YUNvbHVtbkRlY2ltYWwpLkNlbGxzLCBzb3J0MSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgIFNvcnRTZXR0aW5ncyA9IG5ldyBTb3J0U2V0dGluZygpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIENvbHVtbiA9IGNvbHVtbixcclxuICAgICAgICAgICAgICAgIFNvcnRNb2RlID0gc29ydFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBDb2x1bW5Db3VudCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gQ29sdW1ucy5Db3VudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgUm93Q291bnQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoX2RhdGFTb3VyY2UgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICByZXR1cm4gX2RhdGFTb3VyY2UuUm93Q291bnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTY3JvbGxUb0JvdHRvbSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBHcmlkQm9keUNvbnRhaW5lci5TY3JvbGxUb3AgPSBHcmlkQm9keS5DbGllbnRIZWlnaHQgLSBHcmlkQm9keUNvbnRhaW5lci5DbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBTY3JvbGxUb1RvcCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBHcmlkQm9keUNvbnRhaW5lci5TY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGFUYWJsZSBEYXRhU291cmNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9kYXRhU291cmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBGb2N1c2VkRGF0YUhhbmRsZSA9IC0xO1xyXG4gICAgICAgICAgICAgICAgU2VsZWN0ZWRSb3dzID0gbmV3IEhhcmRTb2Z0TGlzdDxib29sPihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBWaXNpYmxlUm93SGFuZGxlcyA9IG5ldyBMaXN0PGludD4oKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihfZGF0YVNvdXJjZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhU291cmNlLk9uRGF0YVNvdXJjZUNoYW5nZWQgLT0gRGF0YVNvdXJjZV9PbkRhdGFTb3VyY2VDaGFuZ2VkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIF9kYXRhU291cmNlID0gdmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoX2RhdGFTb3VyY2UgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YVNvdXJjZS5PbkRhdGFTb3VyY2VDaGFuZ2VkICs9IERhdGFTb3VyY2VfT25EYXRhU291cmNlQ2hhbmdlZDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoQ29sdW1ucy5Db3VudCA9PSAwICYmIEF1dG9HZW5lcmF0ZUNvbHVtbnNGcm9tU291cmNlKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN3ID0gU3RvcHdhdGNoLlN0YXJ0TmV3KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgX2RhdGFTb3VyY2UuQ29sdW1uQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN3MSA9IFN0b3B3YXRjaC5TdGFydE5ldygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBndmMgPSBuZXcgR3JpZFZpZXdDb2x1bW4odGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBndmMuQ2FwdGlvbiA9IF9kYXRhU291cmNlLkNvbHVtbnNbaV0uRmllbGROYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3ZjLkNvbHVtbiA9IF9kYXRhU291cmNlLkNvbHVtbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBndmMuVmlzaWJsZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKF9kYXRhU291cmNlLkNvbHVtbnNbaV0uRGF0YVR5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5CeXRlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuU2hvcnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5JbnRlZ2VyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuTG9uZzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkZsb2F0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRG91YmxlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRGVjaW1hbDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3ZjLkJvZHlBcHBhcmVuY2UuQWxpZ25tZW50ID0gVGV4dEFsaWduLlJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5EYXRlVGltZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoU2V0dGluZ3MuR3JpZFZpZXdBdXRvQ29sdW1uRm9ybWF0RGF0ZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKFNldHRpbmdzLkdyaWRWaWV3QXV0b0NvbHVtbkdlbmVyYXRlRm9ybWF0QXNEYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGd2Yy5Gb3JtYXRTdHJpbmcgPSBcInswOmR9XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3ZjLkZvcm1hdFN0cmluZyA9IFwiezA6eXl5eS1NTS1kZH1cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQm9vbDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3ZjLkNlbGxEaXNwbGF5ID0gbmV3IEdyaWRWaWV3Q2VsbERpc3BsYXlDaGVja0JveCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb2x1bW5zLkFkZChndmMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3LlN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKFwiRGF0YVNvdXJjZSBBZGRDb2x1bW4gQXV0bzogXCIgKyBzdzEuRWxhcHNlZE1pbGxpc2Vjb25kcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3LlN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoXCJEYXRhU291cmNlIEF1dG9Db2x1bW5zOiBcIiArIHN3LkVsYXBzZWRNaWxsaXNlY29uZHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBMaXN0PEdyaWRWaWV3Q29sdW1uPiBDb2x1bW5zID0gbmV3IExpc3Q8R3JpZFZpZXdDb2x1bW4+KCk7XHJcblxyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlld0NvbHVtbiBHZXRDb2x1bW4oaW50IGkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gQ29sdW1uc1tpXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgR2V0Rm9jdXNlZFJvd0NlbGxWYWx1ZShpbnQgY29sdW1uSW5kZXgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gR2V0Rm9jdXNlZFJvd0NlbGxWYWx1ZShDb2x1bW5zW2NvbHVtbkluZGV4XSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgR3JpZFZpZXdDb2x1bW4gR2V0R3JpZFZpZXdDb2x1bW5CeUZpZWxkTmFtZShzdHJpbmcgRmllbGROYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbHVtbkNvdW50KCk7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoQ29sdW1uc1tpXS5Db2x1bW4uRmllbGROYW1lID09IEZpZWxkTmFtZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29sdW1uc1tpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgR2V0Rm9jdXNlZFJvd0NlbGxWYWx1ZShzdHJpbmcgRmllbGROYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdldEZvY3VzZWRSb3dDZWxsVmFsdWUoR2V0Q29sdW1uQnlGaWVsZE5hbWUoRmllbGROYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldEZvY3VzZWRSb3dDZWxsVmFsdWUoR3JpZFZpZXdDb2x1bW4gY29sdW1uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdldFJvd0NlbGxWYWx1ZShGb2N1c2VkRGF0YUhhbmRsZSwgY29sdW1uKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgR2V0Rm9jdXNlZFJvd0NlbGxWYWx1ZShEYXRhQ29sdW1uIGNvbHVtbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBHZXRSb3dDZWxsVmFsdWUoRm9jdXNlZERhdGFIYW5kbGUsIGNvbHVtbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldFJvd0NlbGxWYWx1ZShpbnQgRGF0YWhhbmRsZSwgR3JpZFZpZXdDb2x1bW4gY29sdW1uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdldFJvd0NlbGxWYWx1ZShEYXRhaGFuZGxlLCBjb2x1bW4uQ29sdW1uKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvYmplY3QgR2V0Um93Q2VsbFZhbHVlKGludCBEYXRhaGFuZGxlLCBEYXRhQ29sdW1uIGNvbHVtbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKERhdGFoYW5kbGUgPT0gLTEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbi5HZXRDZWxsVmFsdWUoRGF0YWhhbmRsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldFJvd0NlbGxWYWx1ZShpbnQgRGF0YWhhbmRsZSwgc3RyaW5nIEZpZWxkTmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBHZXRSb3dDZWxsVmFsdWUoRGF0YWhhbmRsZSwgR2V0Q29sdW1uQnlGaWVsZE5hbWUoRmllbGROYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb2JqZWN0IEdldFJvd0NlbGxWYWx1ZShpbnQgRGF0YWhhbmRsZSwgaW50IGNvbHVtbkluZGV4KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdldFJvd0NlbGxWYWx1ZShEYXRhaGFuZGxlLCBDb2x1bW5zW2NvbHVtbkluZGV4XSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgR3JpZFZpZXdDb2x1bW4gR2V0R3JpZFZpZXdDb2x1bW5CeUZpZWxkTmFtZShzdHJpbmcgZmllbGROYW1lLCBib29sIElnbm9yZUNhc2UgPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBDb2x1bW5Db3VudCgpOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKENvbHVtbnNbaV0gIT0gbnVsbCAmJiBDb2x1bW5zW2ldLkNvbHVtbiAhPSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nLkNvbXBhcmUoQ29sdW1uc1tpXS5Db2x1bW4uRmllbGROYW1lLCBmaWVsZE5hbWUsIElnbm9yZUNhc2UpID09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENvbHVtbnNbaV07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGFDb2x1bW4gR2V0Q29sdW1uQnlGaWVsZE5hbWUoc3RyaW5nIGZpZWxkTmFtZSwgYm9vbCBJZ25vcmVDYXNlID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihEYXRhU291cmNlID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBEYXRhU291cmNlLkNvbHVtbkNvdW50OyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKERhdGFTb3VyY2UuQ29sdW1uc1tpXSAhPSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nLkNvbXBhcmUoRGF0YVNvdXJjZS5Db2x1bW5zW2ldLkZpZWxkTmFtZSwgZmllbGROYW1lLCBJZ25vcmVDYXNlKSA9PSAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBEYXRhU291cmNlLkNvbHVtbnNbaV07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQWRkQ29sdW1uKHN0cmluZyBjYXB0aW9uLCBzdHJpbmcgZmllbGRuYW1lLCBpbnQgd2lkdGggPSAxMDAsIHN0cmluZyBmb3JtYXRzdHJpbmcgPSBcIlwiLCBUZXh0QWxpZ24gYWxpZ25tZW50ID0gVGV4dEFsaWduLkxlZnQsIHN0cmluZyBmb3JlY29sb3IgPSBudWxsLCBib29sIGlzQm9sZCA9IGZhbHNlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGNvbCA9IEdldENvbHVtbkJ5RmllbGROYW1lKGZpZWxkbmFtZSk7XHJcbiAgICAgICAgICAgIGlmKGNvbCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBBZGRDb2x1bW4oY2FwdGlvbiwgY29sLCB3aWR0aCwgZm9ybWF0c3RyaW5nLCBhbGlnbm1lbnQsIGZvcmVjb2xvciwgaXNCb2xkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEFkZENvbHVtbihzdHJpbmcgY2FwdGlvbiwgRGF0YUNvbHVtbiBjb2x1bW4sIGludCB3aWR0aCA9IDEwMCwgc3RyaW5nIGZvcm1hdHN0cmluZyA9IFwiXCIsIFRleHRBbGlnbiBhbGlnbm1lbnQgPSBUZXh0QWxpZ24uTGVmdCwgc3RyaW5nIGZvcmVjb2xvciA9IG51bGwsIGJvb2wgaXNCb2xkID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBBZGRDb2x1bW4obmV3IEdyaWRWaWV3Q29sdW1uKHRoaXMsIHdpZHRoKSB7IENhcHRpb24gPSBjYXB0aW9uLCBCb2R5QXBwYXJlbmNlID0gbmV3IEdyaWRWaWV3Q2VsbEFwcGFyZW5jZShpc0JvbGQsIGFsaWdubWVudCwgZm9yZWNvbG9yKSwgRm9ybWF0U3RyaW5nID0gZm9ybWF0c3RyaW5nLCBDb2x1bW4gPSBjb2x1bW4gfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBBZGRDb2x1bW4oR3JpZFZpZXdDb2x1bW4gY29sdW1uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoY29sdW1uID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBDb2x1bW5zLkFkZChjb2x1bW4pO1xyXG5cclxuICAgICAgICAgICAgUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQWRkQ29sdW1ucyhwYXJhbXMgR3JpZFZpZXdDb2x1bW5bXSBjb2x1bW5zKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoY29sdW1ucyA9PSBudWxsIHx8IGNvbHVtbnMuTGVuZ3RoID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBDb2x1bW5zLkFkZFJhbmdlKGNvbHVtbnMpO1xyXG5cclxuICAgICAgICAgICAgUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUmVtb3ZlQ29sdW1uKEdyaWRWaWV3Q29sdW1uIGNvbHVtbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENvbHVtbnMuUmVtb3ZlKGNvbHVtbik7XHJcblxyXG4gICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgaW50IEdldERhdGFTb3VyY2VSb3coaW50IGkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihWaXNpYmxlUm93SGFuZGxlcyA9PSBudWxsIHx8IFZpc2libGVSb3dIYW5kbGVzLkNvdW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgcmV0dXJuIFZpc2libGVSb3dIYW5kbGVzW2ldO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGZsb2F0IEdldENvbHVtbldpZHRocygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihfY29sdW1uQXV0b1dpZHRoKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gR3JpZEJvZHlDb250YWluZXIuQ2xpZW50V2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmbG9hdCB3aWR0aCA9IDAuMGY7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgQ29sdW1ucy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKENvbHVtbnNbaV0uVmlzaWJsZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggKz0gQ29sdW1uc1tpXS5XaWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB3aWR0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2xlYXJTZWxlY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU2VsZWN0ZWRSb3dzID0gbmV3IEhhcmRTb2Z0TGlzdDxib29sPihmYWxzZSk7XHJcbiAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNlbGVjdEFsbFJvd3MoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaW50IGxlbmd0aCA9IFJvd0NvdW50KCk7XHJcbiAgICAgICAgICAgIGlmKGxlbmd0aCA9PSAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTZWxlY3RlZFJvd3MuQ2xlYXJBbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGludFtdIGluZGV4ID0gbmV3IGludFtsZW5ndGhdO1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4W2ldID0gR2V0RGF0YVNvdXJjZVJvdyhpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFNlbGVjdGVkUm93cy5DbGVhckFsbFNldEhhcmRSYW5nZSh0cnVlLCBpbmRleCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgUHJldlJlbmRlckdyaWRTY3JvbGxJZCA9IC0xO1xyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBEZWxheWVkUmVuZGVyR3JpZChib29sIHJlbmRlck5vTGFnID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihyZW5kZXJOb0xhZylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUmVuZGVyR3JpZChmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihTZXR0aW5ncy5HcmlkVmlld1Njcm9sbERlbGF5ZWQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoUHJldlJlbmRlckdyaWRTY3JvbGxJZCAhPSAtMSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEdsb2JhbC5DbGVhclRpbWVvdXQoUHJldlJlbmRlckdyaWRTY3JvbGxJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFByZXZSZW5kZXJHcmlkU2Nyb2xsSWQgPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgUHJldlJlbmRlckdyaWRTY3JvbGxJZCA9IEdsb2JhbC5TZXRUaW1lb3V0KChnbG9iYWw6OlN5c3RlbS5BY3Rpb24pKCgpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSksIE1hdGguTWF4KDEsIFNldHRpbmdzLkdyaWRWaWV3U2Nyb2xsRGVsYXlNUykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgU3RvcHdhdGNoIGNsaWNrVGltZURpZmYgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgRGF0YVJvdyBHZXRGb2N1c2VkUm93KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKEZvY3VzZWREYXRhSGFuZGxlID4gLTEpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBEYXRhU291cmNlW0dldERhdGFTb3VyY2VSb3coRm9jdXNlZERhdGFIYW5kbGUpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgaW50IEdldFZpc2libGVDb3VudCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihDb2x1bW5zID09IG51bGwgfHwgQ29sdW1ucy5Db3VudCA9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIGludCBsZW5ndGggPSBDb2x1bW5zLkNvdW50O1xyXG4gICAgICAgICAgICBpbnQgbGVuZ3RoMSA9IENvbHVtbnMuQ291bnQ7XHJcblxyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCFDb2x1bW5zW2ldLlZpc2libGUpXHJcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoMS0tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBsZW5ndGgxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBHZXRCZXN0Rml0Rm9yQ29sdW1uKEdyaWRWaWV3Q29sdW1uIGNvbHVtbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFjb2x1bW4uVmlzaWJsZSlcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG5cclxuICAgICAgICAgICAgaW50IG1heExlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIGludCBtYXhJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICBzdHJpbmcgbWF4U3RyID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgIGludCBsZW5ndGggPSBSb3dDb3VudCgpO1xyXG4gICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0cmluZyB2YWx1ZSA9IGNvbHVtbi5HZXREaXNwbGF5VmFsdWVCeURhdGFSb3dIYW5kbGUoaSk7XHJcbiAgICAgICAgICAgICAgICBpZighc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZSh2YWx1ZSkpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW50IHYgPSB2YWx1ZS5MZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodiA+IG1heExlbmd0aClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heExlbmd0aCA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4U3RyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihtYXhJbmRleCA+IC0xKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGludClHZXRUZXh0V2lkdGgobWF4U3RyLCBTZXR0aW5ncy5EZWZhdWx0Rm9udCkgKyAyMDtcclxuICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEJlc3RGaXRBbGxDb2x1bW5zKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9kaXNhYmxlUmVuZGVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbHVtbnMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoQ29sdW1uc1tpXS5WaXNpYmxlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIENvbHVtbnNbaV0uV2lkdGggPSBHZXRCZXN0Rml0Rm9yQ29sdW1uKENvbHVtbnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF9kaXNhYmxlUmVuZGVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJlbmRlckdyaWRJbnRlcm5hbCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgaGVhZGluZ0NsYXNzO1xyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIGNlbGxDbGFzcztcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBEaWN0aW9uYXJ5PGludCwgSFRNTERpdkVsZW1lbnQ+IENhY2hlUm93ID0gbmV3IERpY3Rpb25hcnk8aW50LCBIVE1MRGl2RWxlbWVudD4oKTtcclxuICAgICAgICBpbnQgQ291bnRPZkRlbGV0aW9uID0gMDtcclxuICAgICAgICBwdWJsaWMgR3JpZFZpZXcoYm9vbCBhdXRvR2VuZXJhdGVDb2x1bW5zID0gdHJ1ZSwgYm9vbCBjb2x1bW5BdXRvV2lkdGggPSBmYWxzZSkgOiBiYXNlKFwiZ3JpZFwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFVuaXRIZWlnaHQgPSA1MztcclxuICAgICAgICAgICAgICAgIGhlYWRpbmdDbGFzcyA9IFwiaGVhZGluZyBoZWFkaW5nLXJlc3BvbnNpdmVcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBjZWxsQ2xhc3MgPSBcImNlbGwgY2VsbC1yZXNwb25zaXZlXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBVbml0SGVpZ2h0ID0gMjA7XHJcbiAgICAgICAgICAgICAgICBoZWFkaW5nQ2xhc3MgPSBcImhlYWRpbmdcIjtcclxuICAgICAgICAgICAgICAgIGNlbGxDbGFzcyA9IFwiY2VsbFwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLkNvbnRlbnQuU3R5bGUuT3ZlcmZsb3cgPSBPdmVyZmxvdy5IaWRkZW47XHJcblxyXG4gICAgICAgICAgICByZW5kZXJHcmlkSW50ZXJuYWwgPSAoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfZGlzYWJsZVJlbmRlcilcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgaW50IFN0YXJ0ZWRXaXRoID0gUmVuZGVyVGltZTtcclxuXHJcbiAgICAgICAgICAgICAgICBHcmlkSGVhZGVyQ29udGFpbmVyLlNjcm9sbExlZnQgPSBHcmlkQm9keUNvbnRhaW5lci5TY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAgICAgaWYoU2V0dGluZ3MuR3JpZFZpZXdCbHVyT25TY3JvbGwpXHJcbiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzc0JsdXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBWYWxpZGF0ZUdyaWRTaXplKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoQ29sdW1uQ291bnQoKSA9PSAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIENsZWFyR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpbnQgUmF3TGVmdENlbGxJbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICBmbG9hdCBSYXdMZWZ0Q2VsbFNjcm9sbFBhZGRpbmcgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIGludCBSYXdMZWZ0Q2VsbENvdW50ID0gQ29sdW1ucy5Db3VudDtcclxuXHJcbiAgICAgICAgICAgICAgICBmbG9hdCBMZWZ0TG9jYXRpb24gPSAwO1xyXG4gICAgICAgICAgICAgICAgYm9vbCBmb3VuZExlZnRMb2NhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgYm9vbCBmb3VuZFJpZ2h0TG9jYXRpb24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpbnQgQ2xpZW50V2lkdGggPSBHcmlkQm9keUNvbnRhaW5lci5DbGllbnRXaWR0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAjcmVnaW9uIFwiQ29sdW1uc1wiXHJcblxyXG4gICAgICAgICAgICAgICAgZmxvYXQgVmlld1dpZHRoID0gR3JpZEJvZHlDb250YWluZXIuU2Nyb2xsTGVmdCArIENsaWVudFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgZmxvYXQgX2NvbHVtbkF1dG9XaWR0aFNpbmdsZSA9IDAuMGY7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoX2NvbHVtbkF1dG9XaWR0aClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfY29sdW1uQXV0b1dpZHRoU2luZ2xlID0gQ2xpZW50V2lkdGggPT0gMCA/IDAuMGYgOiBDbGllbnRXaWR0aCAvIEdldFZpc2libGVDb3VudCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZsb2F0IE1heFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgZmxvYXQgTGFzdFdpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcihpbnQgeCA9IDA7IHggPCBDb2x1bW5zLkNvdW50OyB4KyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIUNvbHVtbnNbeF0uVmlzaWJsZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIENvbHVtbnNbeF0uQ2FjaGVkWCA9IExlZnRMb2NhdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBMYXN0V2lkdGggPSBfY29sdW1uQXV0b1dpZHRoID8gX2NvbHVtbkF1dG9XaWR0aFNpbmdsZSA6IENvbHVtbnNbeF0uV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgTGVmdExvY2F0aW9uICs9IExhc3RXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBpZighZm91bmRMZWZ0TG9jYXRpb24gJiYgTGVmdExvY2F0aW9uID49IEdyaWRCb2R5Q29udGFpbmVyLlNjcm9sbExlZnQpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZExlZnRMb2NhdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJhd0xlZnRDZWxsSW5kZXggPSB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSYXdMZWZ0Q2VsbFNjcm9sbFBhZGRpbmcgPSBMZWZ0TG9jYXRpb24gLSBHcmlkQm9keUNvbnRhaW5lci5TY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihmb3VuZExlZnRMb2NhdGlvbiAmJiAhZm91bmRSaWdodExvY2F0aW9uICYmIExlZnRMb2NhdGlvbiA+PSBWaWV3V2lkdGgpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFJpZ2h0TG9jYXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSYXdMZWZ0Q2VsbENvdW50ID0geCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihTdGFydGVkV2l0aCAhPSBSZW5kZXJUaW1lKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBNYXhXaWR0aCA9IExlZnRMb2NhdGlvbjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY29sRnJhZ21lbnQgPSBEb2N1bWVudC5DcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaW50IHVib3VuZFJvd0NvdW50ID0gUmF3TGVmdENlbGxDb3VudCAtIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoX2NvbHVtbkhlYWRlcnNWaXNpYmxlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcihpbnQgeCA9IFJhd0xlZnRDZWxsSW5kZXg7IHggPCBSYXdMZWZ0Q2VsbENvdW50OyB4KyspXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih4ID49IENvbHVtbnMuQ291bnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIUNvbHVtbnNbeF0uVmlzaWJsZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdjb2wgPSBDb2x1bW5zW3hdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sSW5kZXggPSB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBwYXJlbmNlID0gZ2NvbC5IZWFkaW5nQXBwYXJlbmNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IExhYmVsKGdjb2wuQ2FwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfY29sdW1uQXV0b1dpZHRoID8gZ2NvbC5DYWNoZWRYIDogZ2NvbC5DYWNoZWRYKSwgMCwgKF9jb2x1bW5BdXRvV2lkdGggPyBfY29sdW1uQXV0b1dpZHRoU2luZ2xlIDogZ2NvbC5XaWR0aCkgLSAoeCA9PSB1Ym91bmRSb3dDb3VudCA/IDAgOiAxKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGFyZW5jZS5Jc0JvbGQsIGZhbHNlLCBoZWFkaW5nQ2xhc3MsIGFwcGFyZW5jZS5BbGlnbm1lbnQsIGFwcGFyZW5jZS5Gb3JlY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihnY29sLlNvcnRlZE1vZGUgIT0gR3JpZFZpZXdTb3J0TW9kZS5Ob25lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc29ydEltYWdlID0gRGl2KGdjb2wuU29ydGVkTW9kZSA9PSBHcmlkVmlld1NvcnRNb2RlLkFzYyA/IFwiZ3JpZC1zb3J0LXVwXCIgOiBcImdyaWQtc29ydC1kb3duXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydEltYWdlLlNldEJvdW5kcyhcIigxMDAlIC0gMTNweClcIiwgMTEsIDksIDUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLkFwcGVuZENoaWxkKHNvcnRJbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldHVwQ29sdW1uKGNvbCwgeCwgZ2NvbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xGcmFnbWVudC5BcHBlbmRDaGlsZChjb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoU3RhcnRlZFdpdGggIT0gUmVuZGVyVGltZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICNlbmRyZWdpb24gXCJDb2x1bW5zXCJcclxuXHJcbiAgICAgICAgICAgICAgICBpZihfZGF0YVNvdXJjZSA9PSBudWxsIHx8IF9kYXRhU291cmNlLlJvd0NvdW50ID09IDAgfHwgX2RhdGFTb3VyY2UuQ29sdW1uQ291bnQgPT0gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBDbGVhckdyaWQoKTtcclxuICAgICAgICAgICAgICAgICAgICBHcmlkSGVhZGVyLkFwcGVuZENoaWxkKGNvbEZyYWdtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBwciA9IFBpeGVsc1BlclJvdyhfZGF0YVNvdXJjZS5Sb3dDb3VudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgZmxvYXQgUmF3VG9wUm93SW5kZXggPSBHZXRSYXdUb3BSb3dJbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgZmxvYXQgUmF3VG9wUm93U2Nyb2xsUGFkZGluZyA9IFJhd1RvcFJvd0luZGV4ICUgMS4wZjtcclxuICAgICAgICAgICAgICAgIGZsb2F0IFJhd1Zpc2libGVSb3dDb3VudCA9IEdldFJhd1Zpc2libGVSb3dDb3VudCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGludCBMZW5ndGggPSAoaW50KShSYXdWaXNpYmxlUm93Q291bnQgKyBSYXdUb3BSb3dJbmRleCkgKyAxO1xyXG4gICAgICAgICAgICAgICAgaW50IHN0YXJ0ID0gKGludClSYXdUb3BSb3dJbmRleDtcclxuXHJcbiAgICAgICAgICAgICAgICAjcmVnaW9uIFwiU2VsZWN0aW9uXCJcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IHggPSBTZWxlY3RlZFJvd3MuU0wuQ291bnQgLSAxOyB4ID49IDA7IHgtLSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBib29sIEZvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gc3RhcnQ7IGkgPCBMZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkgPCBEYXRhU291cmNlLlJvd0NvdW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgRGF0YVJvd2hhbmRsZSA9IEdldERhdGFTb3VyY2VSb3coaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihTZWxlY3RlZFJvd3MuR2V0SW5kZXhWYWx1ZUJ5SGFyZExpc3RJbmRleChTZWxlY3RlZFJvd3MuU0xbeF0pLkluZGV4ID09IERhdGFSb3doYW5kbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFN0YXJ0ZWRXaXRoICE9IFJlbmRlclRpbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihTdGFydGVkV2l0aCAhPSBSZW5kZXJUaW1lKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZighRm91bmQpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZFJvd3MuU0wuUmVtb3ZlQXQoeCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICNlbmRyZWdpb24gXCJTZWxlY3Rpb25cIlxyXG5cclxuICAgICAgICAgICAgICAgIHZhciByb3dGcmFnbWVudCA9IERvY3VtZW50LkNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihTZXR0aW5ncy5HcmlkVmlld1Jvd1Njcm9sbFBhZGRpbmcgPiAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0IC09IFNldHRpbmdzLkdyaWRWaWV3Um93U2Nyb2xsUGFkZGluZztcclxuICAgICAgICAgICAgICAgICAgICBMZW5ndGggKz0gU2V0dGluZ3MuR3JpZFZpZXdSb3dTY3JvbGxQYWRkaW5nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZsb2F0IFkgPSAoc3RhcnQgKiAocHByKSkgLSBSYXdUb3BSb3dTY3JvbGxQYWRkaW5nO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKFNob3dBdXRvRmlsdGVyUm93KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIExlbmd0aCAtPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIFkgKz0gVW5pdEhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyAjVE9ETyAtIENMRUFOLi4uXHJcbiAgICAgICAgICAgICAgICBpZihzdGFydCA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgaWYoTGVuZ3RoID4gRGF0YVNvdXJjZS5Sb3dDb3VudClcclxuICAgICAgICAgICAgICAgICAgICBMZW5ndGggPSBEYXRhU291cmNlLlJvd0NvdW50O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKENhY2hlUm93LkNvdW50ID4gMTApXHJcbiAgICAgICAgICAgICAgICB7ICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmKENvdW50T2ZEZWxldGlvbiA+IDgpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDYWNoZVJvdyA9IG5ldyBEaWN0aW9uYXJ5PGludCwgSFRNTERpdkVsZW1lbnQ+KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvdW50T2ZEZWxldGlvbiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGludCBNYXhEZWxldGUgPSBDYWNoZVJvdy5Db3VudCAtIDEwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnQgX19sZW5ndGggPSBDYWNoZVJvdy5Db3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxpbnQ+IEtleXNUb0RlbGV0ZSA9IG5ldyBMaXN0PGludD4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IF9fbGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmaWVsZEluZGV4ID0gU3lzdGVtLkxpbnEuRW51bWVyYWJsZS5FbGVtZW50QXQ8Z2xvYmFsOjpTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXI8aW50LCBnbG9iYWw6OkJyaWRnZS5IdG1sNS5IVE1MRGl2RWxlbWVudD4+KENhY2hlUm93LGkpLktleTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZpZWxkSW5kZXggPCBzdGFydCB8fCBmaWVsZEluZGV4ID49IExlbmd0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBLZXlzVG9EZWxldGUuQWRkKFN5c3RlbS5MaW5xLkVudW1lcmFibGUuRWxlbWVudEF0PGdsb2JhbDo6U3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyPGludCwgZ2xvYmFsOjpCcmlkZ2UuSHRtbDUuSFRNTERpdkVsZW1lbnQ+PihDYWNoZVJvdyxpKS5LZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEtleXNUb0RlbGV0ZS5Db3VudCA+IE1heERlbGV0ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfX2xlbmd0aCA9IEtleXNUb0RlbGV0ZS5Db3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoX19sZW5ndGggPiAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRPZkRlbGV0aW9uKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBfX2xlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IENhY2hlUm93W0tleXNUb0RlbGV0ZVtpXV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4Lk9uQ2xpY2sgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeC5PbkRibENsaWNrID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHguRW1wdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHguT25EcmFnU3RhcnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeC5EZWxldGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYWNoZVJvdy5SZW1vdmUoS2V5c1RvRGVsZXRlW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpbnQgcHJldlJvd0NhY2hlID0gQ2FjaGVSb3cuQ291bnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IHN0YXJ0OyBpIDwgTGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIUNhY2hlUm93LkNvbnRhaW5zS2V5KGkpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIERhdGFSb3doYW5kbGUgPSBHZXREYXRhU291cmNlUm93KGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHIgPSBEaXYoKGkgJSAyID09IDAgPyBcImNlbGxyb3cgZXZlblwiIDogXCJjZWxscm93XCIpICsgKFNlbGVjdGVkUm93cy5HZXRWYWx1ZShEYXRhUm93aGFuZGxlLCB0cnVlKSA/IFwiIGNlbGxyb3ctc2VsZWN0ZWRcIiA6IFwiXCIpICsgKERhdGFSb3doYW5kbGUgPT0gRm9jdXNlZERhdGFIYW5kbGUgPyBcIiBmb2N1c2Vkcm93XCIgOiBcIlwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkci5TZXRCb3VuZHMoMCwgWSwgX2NvbHVtbkF1dG9XaWR0aCA/IENsaWVudFdpZHRoIDogTWF4V2lkdGgsIFVuaXRIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkci5TZXRBdHRyaWJ1dGUoXCJpXCIsIENvbnZlcnQuVG9TdHJpbmcoRGF0YVJvd2hhbmRsZSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZHIuT25DbGljayA9IE9uUm93Q2xpY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFNldHRpbmdzLklzQ2hyb21lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkci5PbkRibENsaWNrID0gT25Eb3VibGVDbGljaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGludCB4ID0gUmF3TGVmdENlbGxJbmRleDsgeCA8IFJhd0xlZnRDZWxsQ291bnQ7IHgrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IENvbHVtbnNbeF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighY29sLlZpc2libGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFwcGFyZW5jZSA9IGNvbC5Cb2R5QXBwYXJlbmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1c2VEZWZhdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIVE1MRWxlbWVudCBjZWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29sLkNlbGxEaXNwbGF5ID09IG51bGwgfHwgKHVzZURlZmF1bHQgPSBjb2wuQ2VsbERpc3BsYXkuVXNlRGVmYXVsdEVsZW1lbnQpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwgPSBMYWJlbChjb2wuR2V0RGlzcGxheVZhbHVlQnlEYXRhUm93SGFuZGxlKERhdGFSb3doYW5kbGUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5DYWNoZWRYLCAwLCBfY29sdW1uQXV0b1dpZHRoID8gX2NvbHVtbkF1dG9XaWR0aFNpbmdsZSA6IGNvbC5XaWR0aCwgYXBwYXJlbmNlLklzQm9sZCwgZmFsc2UsIGNlbGxDbGFzcywgYXBwYXJlbmNlLkFsaWdubWVudCwgYXBwYXJlbmNlLkZvcmVjb2xvcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyLkFwcGVuZENoaWxkKHVzZURlZmF1bHQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuQ2VsbERpc3BsYXkuT25DcmVhdGVEZWZhdWx0KGNlbGwsIHRoaXMsIERhdGFSb3doYW5kbGUsIHgpIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IGNvbC5DZWxsRGlzcGxheS5PbkNyZWF0ZSh0aGlzLCBEYXRhUm93aGFuZGxlLCB4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLlNldExvY2F0aW9uKGNvbC5DYWNoZWRYLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLlN0eWxlLldpZHRoID0gKF9jb2x1bW5BdXRvV2lkdGggPyBfY29sdW1uQXV0b1dpZHRoU2luZ2xlIDogY29sLldpZHRoKS5Ub1B4KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyLkFwcGVuZENoaWxkKGNlbGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbC5TZXRBdHRyaWJ1dGUoXCJpXCIsIHguVG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLk9uTW91c2VEb3duID0gT25DZWxsUm93TW91c2VEb3duO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihBbGxvd1Jvd0RyYWcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyLlNldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiLCBcInRydWVcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHIuT25EcmFnU3RhcnQgPSBPblJvd0RyYWdTdGFydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93RnJhZ21lbnQuQXBwZW5kQ2hpbGQoZHIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2FjaGVSb3dbaV0gPSBkcjsgICBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKFN0YXJ0ZWRXaXRoICE9IFJlbmRlclRpbWUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwcmV2Um93Q2FjaGUgPT0gMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsZWFyR3JpZCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgR3JpZEJvZHkuQXBwZW5kQ2hpbGQocm93RnJhZ21lbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgWSArPSBVbml0SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYocHJldlJvd0NhY2hlID09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJHcmlkKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoT25DdXN0b21Sb3dTdHlsZSAhPSBudWxsICYmIHJvd0ZyYWdtZW50LkNoaWxkTm9kZXMgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSByb3dGcmFnbWVudC5DaGlsZE5vZGVzLkxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgY291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFN0YXJ0ZWRXaXRoICE9IFJlbmRlclRpbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyaWRCb2R5LkFwcGVuZENoaWxkKHJvd0ZyYWdtZW50KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSAoSFRNTEVsZW1lbnQpcm93RnJhZ21lbnQuQ2hpbGROb2Rlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9uQ3VzdG9tUm93U3R5bGUoY2hpbGQsIEdsb2JhbC5QYXJzZUludChjaGlsZC5HZXRBdHRyaWJ1dGUoXCJpXCIpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goRXhjZXB0aW9uIGV4KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihBcHBsaWNhdGlvbi5BcGxpY2F0aW9uRGVmaXRpb24gPT0gQXBwbGljYXRpb25EZWZpdG5pb24uRXhwcmVzc0NyYWZ0Q29uc29sZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb25zb2xlRm9ybS5Mb2coZXguVG9TdHJpbmcoKSwgQ29uc29sZUxvZ1R5cGUuRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIEdyaWRIZWFkZXIuQXBwZW5kQ2hpbGQoY29sRnJhZ21lbnQpO1xyXG4gICAgICAgICAgICAgICAgR3JpZEJvZHkuQXBwZW5kQ2hpbGQocm93RnJhZ21lbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKFN0YXJ0ZWRXaXRoICE9IFJlbmRlclRpbWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIFJlbmRlclRpbWUgPSAtMTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIEdyaWRIZWFkZXJDb250YWluZXIgPSBEaXYoXCJoZWFkaW5nLWNvbnRhaW5lclwiKTtcclxuXHJcbiAgICAgICAgICAgIEdyaWRIZWFkZXIgPSBEaXYoKTtcclxuICAgICAgICAgICAgR3JpZEhlYWRlci5TZXRCb3VuZHMoXCIwXCIsIFwiMFwiLCBcIjBcIiwgXCIyOXB4XCIpO1xyXG4gICAgICAgICAgICBHcmlkQm9keUNvbnRhaW5lciA9IERpdigpO1xyXG5cclxuICAgICAgICAgICAgR3JpZEJvZHlDb250YWluZXIuU3R5bGUuT3ZlcmZsb3dYID0gT3ZlcmZsb3cuQXV0bztcclxuICAgICAgICAgICAgR3JpZEJvZHlDb250YWluZXIuU3R5bGUuT3ZlcmZsb3dZID0gT3ZlcmZsb3cuQXV0bztcclxuXHJcbiAgICAgICAgICAgIEdyaWRIZWFkZXJDb250YWluZXIuU3R5bGUuT3ZlcmZsb3cgPSBPdmVyZmxvdy5IaWRkZW47XHJcblxyXG4gICAgICAgICAgICBHcmlkQm9keSA9IERpdigpO1xyXG4gICAgICAgICAgICBHcmlkQm9keS5TZXRCb3VuZHMoXCIwXCIsIFwiMFwiLCBcIjBcIiwgXCIwXCIpO1xyXG5cclxuICAgICAgICAgICAgR3JpZEJvZHlDb250YWluZXIuQXBwZW5kQ2hpbGQoR3JpZEJvZHkpO1xyXG4gICAgICAgICAgICBHcmlkSGVhZGVyQ29udGFpbmVyLkFwcGVuZENoaWxkKEdyaWRIZWFkZXIpO1xyXG5cclxuICAgICAgICAgICAgU2V0RGVmYXVsdFNpemVzKCk7XHJcblxyXG4gICAgICAgICAgICBDb250ZW50Lk9uTW91c2VVcCA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoUmVzaXplSW5kZXggPT0gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgaW50IHggPSBTY3JpcHQuV3JpdGU8aW50PihcImV2LnBhZ2VYXCIpO1xyXG4gICAgICAgICAgICAgICAgeCA9IENvbHVtbnNbUmVzaXplSW5kZXhdLldpZHRoICsgKHggLSBSZXNpemVQYWdlWCk7XHJcbiAgICAgICAgICAgICAgICBpZih4IDwgMjQpXHJcbiAgICAgICAgICAgICAgICAgICAgeCA9IDI0O1xyXG4gICAgICAgICAgICAgICAgQ29sdW1uc1tSZXNpemVJbmRleF0uV2lkdGggPSB4O1xyXG5cclxuICAgICAgICAgICAgICAgIEZvcm0uU2V0Q3Vyc29yKEN1cnNvci5EZWZhdWx0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICBSZXNpemVJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgUmVzaXplU3BhbiA9IG51bGw7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBPblJlc2l6ZSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQ2FjaGVSb3cgPSBuZXcgRGljdGlvbmFyeTxpbnQsIEhUTUxEaXZFbGVtZW50PigpO1xyXG4gICAgICAgICAgICAgICAgRGVsYXllZFJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaW50IHByZXZsZWZ0ID0gMDtcclxuICAgICAgICAgICAgR3JpZEJvZHlDb250YWluZXIuT25TY3JvbGwgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHByZXZsZWZ0ICE9IEdyaWRCb2R5Q29udGFpbmVyLlNjcm9sbExlZnQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FjaGVSb3cgPSBuZXcgRGljdGlvbmFyeTxpbnQsIEhUTUxEaXZFbGVtZW50PigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZsZWZ0ID0gR3JpZEJvZHlDb250YWluZXIuU2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgICAgICAgICBEZWxheWVkUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBEZWxheWVkUmVuZGVyR3JpZCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIE9uTG9hZGVkID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIE9uQ2VsbFJvd01vdXNlRG93biA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgRm9jdXNlZENvbHVtbiA9IEdsb2JhbC5QYXJzZUludChldi5DdXJyZW50VGFyZ2V0LkFzPEhUTUxFbGVtZW50PigpLkdldEF0dHJpYnV0ZShcImlcIikpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBPblJvd0NsaWNrID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZighU2V0dGluZ3MuSXNDaHJvbWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoY2xpY2tUaW1lRGlmZiA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tUaW1lRGlmZiA9IFN0b3B3YXRjaC5TdGFydE5ldygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja1RpbWVEaWZmLlN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVtcyA9IGNsaWNrVGltZURpZmYuRWxhcHNlZE1pbGxpc2Vjb25kcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tUaW1lRGlmZiA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihlbXMgPCAyMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9uRG91YmxlQ2xpY2soZXYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBEYXRhUm93SGFuZGxlID0gR2xvYmFsLlBhcnNlSW50KGV2LkN1cnJlbnRUYXJnZXQuR2V0QXR0cmlidXRlKFwiaVwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG1ldiA9IGV2LkFzPE1vdXNlRXZlbnQ+KCk7XHJcbiAgICAgICAgICAgICAgICBpZihBbGxvd011bHRpU2VsZWN0aW9uKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKG1ldi5DdHJsS2V5KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2VsZWN0ZWRSb3dzLkFkZE9yU2V0KHRydWUsIERhdGFSb3dIYW5kbGUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihtZXYuU2hpZnRLZXkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgU2VsZWN0ZWRSb3dzLkNsZWFyQW5kQWRkT3JTZXQodHJ1ZSwgRGF0YVJvd0hhbmRsZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZihEYXRhUm93SGFuZGxlICE9IF9mb2N1c2VkRGF0YUhhbmRsZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c2VkRGF0YUhhbmRsZSA9IERhdGFSb3dIYW5kbGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBDb250ZW50LlRhYkluZGV4ID0gMDtcclxuICAgICAgICAgICAgT25Eb3VibGVDbGljayA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW50IGRyaCA9IEdsb2JhbC5QYXJzZUludChldi5DdXJyZW50VGFyZ2V0LkdldEF0dHJpYnV0ZShcImlcIikpO1xyXG4gICAgICAgICAgICAgICAgaWYoT25Sb3dEb3VibGVDbGljayAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIE9uUm93RG91YmxlQ2xpY2soZHJoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihfdXNlRWRpdEZvcm0pXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkciA9IERhdGFTb3VyY2VbZHJoXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZkcmUgPSBuZXcgRGF0YVJvd0VkaXRGb3JtKGlkciwgdGhpcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmRyZS5TaG93RGlhbG9nKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBDb250ZW50Lk9uS2V5RG93biA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGtldiA9IGV2LkFzPEtleWJvYXJkRXZlbnQ+KCk7XHJcbiAgICAgICAgICAgICAgICAvL0dsb2JhbC5BbGVydChcIkNPTlRST0wgKyBBXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYoQWxsb3dNdWx0aVNlbGVjdGlvbiAmJiBrZXYuQ3RybEtleSAmJiAoa2V2LktleUNvZGUgPT0gNjUgfHwga2V2LktleUNvZGUgPT0gOTcpKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGtleUNvZGUgPT0gNjUgfHwga2V5Q29kZSA9PSA5N1xyXG4gICAgICAgICAgICAgICAgICAgIC8vR2xvYmFsLkFsZXJ0KFwiQWxsb3dNdWx0aVNlbGVjdGlvbiA9IFRSVUVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgU2VsZWN0QWxsUm93cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vR2xvYmFsLkFsZXJ0KFwiQWxsb3dNdWx0aVNlbGVjdGlvbiA9IEZBTFNFXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgQ29udGV4dE1lbnUgPSBuZXcgQ29udGV4dE1lbnUoKTtcclxuXHJcbiAgICAgICAgICAgIENvbnRleHRNZW51LkNvbnRleHRJdGVtcy5BZGRSYW5nZShuZXcgQ29udGV4dEl0ZW1bXSB7XHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJTb3J0IEFzY2VuZGluZ1wiLCAoY20pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZihGb2N1c2VkQ29sdW1uID4gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTb3J0Q29sdW1uKENvbHVtbnNbRm9jdXNlZENvbHVtbl0sIEdyaWRWaWV3U29ydE1vZGUuQXNjKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIG5ldyBDb250ZXh0SXRlbShcIlNvcnQgRGVzY2VuZGluZ1wiLCAoY20pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZihGb2N1c2VkQ29sdW1uID4gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTb3J0Q29sdW1uKENvbHVtbnNbRm9jdXNlZENvbHVtbl0sIEdyaWRWaWV3U29ydE1vZGUuRGVzYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJDbGVhciBBbGwgU29ydGluZ1wiLCAoY20pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBDbGVhclNvcnRDb2x1bW4oKTtcclxuICAgICAgICAgICAgICAgIH0sICB0cnVlKSxcclxuICAgICAgICAgICAgICAgIG5ldyBDb250ZXh0SXRlbShcIkdyb3VwIEJ5IFRoaXMgQ29sdW1uXCIpLFxyXG4gICAgICAgICAgICAgICAgbmV3IENvbnRleHRJdGVtKFwiSGlkZSBHcm91cCBCeSBCb3hcIiwgdHJ1ZSksXHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJIaWRlIFRoaXMgQ29sdW1uXCIpLFxyXG4gICAgICAgICAgICAgICAgbmV3IENvbnRleHRJdGVtKFwiVmlldyBDb2x1bW5zXCIpLFxyXG4gICAgICAgICAgICAgICAgbmV3IENvbnRleHRJdGVtKFwiU2F2ZSBDb2x1bW4gTGF5b3V0XCIpLFxyXG4gICAgICAgICAgICAgICAgbmV3IENvbnRleHRJdGVtKFwiQmVzdCBGaXRcIiksXHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJCZXN0IEZpdCAoYWxsIGNvbHVtbnMpXCIsIChjaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIEJlc3RGaXRBbGxDb2x1bW5zKCk7XHJcbiAgICAgICAgICAgICAgICB9LCB0cnVlKSxcclxuICAgICAgICAgICAgICAgIG5ldyBDb250ZXh0SXRlbShcIkZpbHRlciBFZGl0b3IuLi5cIiksXHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJTaG93IEZpbmQgUGFuZWxcIiksXHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJTaG93IEF1dG8gRmlsdGVyIFJvd1wiKSxcclxuICAgICAgICAgICAgICAgIG5ldyBDb250ZXh0SXRlbShcIlNlbGVjdCBBbGxcIiwgKGNtKSA9PiB7IFNlbGVjdEFsbFJvd3MoKTsgfSksXHJcbiAgICAgICAgICAgICAgICBuZXcgQ29udGV4dEl0ZW0oXCJVbnNlbGVjdCBBbGxcIiwgKGNtKSA9PiB7IENsZWFyU2VsZWN0aW9uKCk7IH0pXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5PbkNvbnRleHRNZW51ID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBPbkRvdWJsZUNsaWNrKGV2LkFzPE1vdXNlRXZlbnQ8SFRNTERpdkVsZW1lbnQ+PigpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihDb250ZXh0TWVudSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29udGV4dE1lbnUuU2hvdyhIZWxwZXIuR2V0Q2xpZW50TW91c2VMb2NhdGlvbihldikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBPbkNvbHVtbk9uQ2xpY2sgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKFJlc2l6ZUluZGV4ID49IDApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBnY29sID0gQ29sdW1uc1tHbG9iYWwuUGFyc2VJbnQoZXYuQ3VycmVudFRhcmdldC5HZXRBdHRyaWJ1dGUoXCJpXCIpKV07XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IENvbHVtbkNvdW50KCk7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihDb2x1bW5zW2ldICE9IGdjb2wpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb2x1bW5zW2ldLlNvcnRlZE1vZGUgPSBHcmlkVmlld1NvcnRNb2RlLk5vbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3dpdGNoKGdjb2wuU29ydGVkTW9kZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgR3JpZFZpZXdTb3J0TW9kZS5Ob25lOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTb3J0Q29sdW1uKGdjb2wsIEdyaWRWaWV3U29ydE1vZGUuQXNjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgR3JpZFZpZXdTb3J0TW9kZS5Bc2M6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNvcnRDb2x1bW4oZ2NvbCwgR3JpZFZpZXdTb3J0TW9kZS5EZXNjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgR3JpZFZpZXdTb3J0TW9kZS5EZXNjOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTb3J0Q29sdW1uKGdjb2wsIEdyaWRWaWV3U29ydE1vZGUuTm9uZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBPbkNvbHVtbkRyYWdTdGFydCA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU2NyaXB0LkNhbGwoXCJldi5kYXRhVHJhbnNmZXIuc2V0RGF0YVwiLCBcImdyaWR2aWV3Q29sdW1uRHJhZ1wiLCBldi5DdXJyZW50VGFyZ2V0LkdldEF0dHJpYnV0ZShcImlcIikpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBPbkNvbHVtbkRyYWdPdmVyID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBPbkNvbHVtbkRyb3AgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGV2LlRhcmdldCA9PSBudWxsIHx8ICEoZXYuVGFyZ2V0IGlzIEhUTUxTcGFuRWxlbWVudCkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBldi5UYXJnZXQuQXM8SFRNTFNwYW5FbGVtZW50PigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHRhcmdldC5QYXJlbnRFbGVtZW50ICE9IEdyaWRIZWFkZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBIb3ZlckluZGV4ID0gR2xvYmFsLlBhcnNlSW50KHRhcmdldC5HZXRBdHRyaWJ1dGUoXCJpXCIpKTtcclxuICAgICAgICAgICAgICAgIHZhciBTZWxlY3RlZEluZGV4ID0gU2NyaXB0LldyaXRlPGludD4oXCJwYXJzZUludChldi5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcXFwiZ3JpZHZpZXdDb2x1bW5EcmFnXFxcIikpO1wiKTtcclxuICAgICAgICAgICAgICAgIGlmKFNlbGVjdGVkSW5kZXggPT0gSG92ZXJJbmRleClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoSG92ZXJJbmRleCA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGludCB4ID0gU2NyaXB0LldyaXRlPGludD4oXCJldi5sYXllclhcIik7XHJcbiAgICAgICAgICAgICAgICB4IC09IHRhcmdldC5DbGllbnRMZWZ0O1xyXG4gICAgICAgICAgICAgICAgaW50IHcgPSB0YXJnZXQuQ2xpZW50V2lkdGggLyAyO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKEhvdmVySW5kZXggPT0gU2VsZWN0ZWRJbmRleCAtIDEgJiYgeCA+IHcpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgaWYoSG92ZXJJbmRleCA9PSBTZWxlY3RlZEluZGV4ICsgMSAmJiB4IDwgdylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoeCA8IHcpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgRHJhZ0luZGV4ID0gSG92ZXJJbmRleDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBEcmFnSW5kZXggPSBIb3ZlckluZGV4ICsgMTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihEcmFnSW5kZXggPCAwIHx8IFNlbGVjdGVkSW5kZXggPCAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBDb2x1bW5zW1NlbGVjdGVkSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgaWYoRHJhZ0luZGV4ID09IENvbHVtbnMuQ291bnQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ29sdW1ucy5SZW1vdmUoY29sKTtcclxuICAgICAgICAgICAgICAgICAgICBDb2x1bW5zLkFkZChjb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2wxID0gQ29sdW1uc1tEcmFnSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgIENvbHVtbnMuUmVtb3ZlKGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgQ29sdW1ucy5JbnNlcnQoQ29sdW1ucy5JbmRleE9mKGNvbDEpLCBjb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgT25Db2x1bW5Nb3VzZURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGludCB4ID0gU2NyaXB0LldyaXRlPGludD4oXCJldi5sYXllclhcIik7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZXYuVGFyZ2V0LkFzPEhUTUxTcGFuRWxlbWVudD4oKTtcclxuICAgICAgICAgICAgICAgIHggLT0gdGFyZ2V0LkNsaWVudExlZnQ7XHJcbiAgICAgICAgICAgICAgICBSZXNpemVQYWdlWCA9IFNjcmlwdC5Xcml0ZTxpbnQ+KFwiZXYucGFnZVhcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgRm9jdXNlZENvbHVtbiA9IEdsb2JhbC5QYXJzZUludChldi5DdXJyZW50VGFyZ2V0LkdldEF0dHJpYnV0ZShcImlcIikpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHggPj0gdGFyZ2V0LkNsaWVudFdpZHRoIC0gMilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBSZXNpemVJbmRleCA9IEdsb2JhbC5QYXJzZUludCh0YXJnZXQuR2V0QXR0cmlidXRlKFwiaVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgUmVzaXplU3BhbiA9IHRhcmdldDtcclxuICAgICAgICAgICAgICAgICAgICBGb3JtLlNldEN1cnNvcihDdXJzb3IuRWFzdFdlc3RSZXNpemUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFJlc2l6ZVNwYW4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlc2l6ZUluZGV4ID0gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIE9uQ29sdW1uTW91c2VNb3ZlID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihSZXNpemVJbmRleCA9PSAtMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnQgeCA9IFNjcmlwdC5Xcml0ZTxpbnQ+KFwiZXYubGF5ZXJYXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBldi5UYXJnZXQuQXM8SFRNTFNwYW5FbGVtZW50PigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHggLT0gdGFyZ2V0LkNsaWVudExlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHggPj0gdGFyZ2V0LkNsaWVudFdpZHRoIC0gMilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEZvcm0uU2V0Q3Vyc29yKEN1cnNvci5FYXN0V2VzdFJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgRm9ybS5TZXRDdXJzb3IoQ3Vyc29yLkRlZmF1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgT25Db2x1bW5Nb3VzZUxlYXZlID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihSZXNpemVJbmRleCA9PSAtMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBGb3JtLlNldEN1cnNvcihDdXJzb3IuRGVmYXVsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBPblJvd0RyYWdTdGFydCA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU2NyaXB0LkNhbGwoXCJldi5kYXRhVHJhbnNmZXIuc2V0RGF0YVwiLCBcImdyaWR2aWV3Um93RHJhZ1wiLCBKU09OLlN0cmluZ2lmeShEYXRhU291cmNlW0dsb2JhbC5QYXJzZUludChldi5DdXJyZW50VGFyZ2V0LkdldEF0dHJpYnV0ZShcImlcIikpXS5HZXRPZmZsaW5lRGF0YVJvdygpKSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkcmVuKEdyaWRIZWFkZXJDb250YWluZXIsIEdyaWRCb2R5Q29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgIEZpbHRlclJvd09uQ2hhbmdlID0gKHRlKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDb2x1bW5zW0dsb2JhbC5QYXJzZUludCh0ZS5Db250ZW50LkdldEF0dHJpYnV0ZShcImlcIikpXS5GaWx0ZXJWYWx1ZSA9IHRlLlRleHQ7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBBdXRvR2VuZXJhdGVDb2x1bW5zRnJvbVNvdXJjZSA9IGF1dG9HZW5lcmF0ZUNvbHVtbnM7XHJcbiAgICAgICAgICAgIENvbHVtbkF1dG9XaWR0aCA9IGNvbHVtbkF1dG9XaWR0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBEYXRhU291cmNlX09uRGF0YVNvdXJjZUNoYW5nZWQob2JqZWN0IHNlbmRlciwgRXZlbnRBcmdzIGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBTb3J0Q29sdW1uKCk7XHJcbiAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSB2b2lkIFJlbmRlcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLlJlbmRlcigpO1xyXG4gICAgICAgICAgICBIYXNSZW5kZXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIFJlbmRlckdyaWQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKENvbnRlbnQuUGFyZW50RWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBmbG9hdCBHZXRSYXdWaXNpYmxlUm93Q291bnQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdyaWRCb2R5Q29udGFpbmVyLkNsaWVudEhlaWdodCA9PSAwID8gMC4wZiA6IEdyaWRCb2R5Q29udGFpbmVyLkNsaWVudEhlaWdodCAvIFVuaXRIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZmxvYXQgR2V0UmF3VG9wUm93SW5kZXgoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIEdyaWRCb2R5Q29udGFpbmVyLlNjcm9sbFRvcCA9PSAwID8gMC4wZiA6IEdyaWRCb2R5Q29udGFpbmVyLlNjcm9sbFRvcCAvIFBpeGVsc1BlclJvdyhSb3dDb3VudCgpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFZhbGlkYXRlR3JpZFdpZHRoKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IEdldENvbHVtbldpZHRocygpO1xyXG4gICAgICAgICAgICBHcmlkQm9keS5TdHlsZS5XaWR0aCA9ICh3aWR0aCkuVG9QeCgpO1xyXG4gICAgICAgICAgICBHcmlkSGVhZGVyLlN0eWxlLldpZHRoID0gKCh3aWR0aCkgKyAyNCkuVG9QeCgpOyAvLyAod2lkdGgpLlRvUHgoKTtcclxuICAgICAgICAgICAgaWYoUmlnaHRPZlRhYmxlID09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFJpZ2h0T2ZUYWJsZSA9IERpdigpO1xyXG4gICAgICAgICAgICAgICAgR3JpZEJvZHkuQXBwZW5kQ2hpbGQoUmlnaHRPZlRhYmxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihSaWdodE9mVGFibGVIZWFkZXIgPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUmlnaHRPZlRhYmxlSGVhZGVyID0gRGl2KCk7XHJcbiAgICAgICAgICAgICAgICBHcmlkSGVhZGVyLkFwcGVuZENoaWxkKFJpZ2h0T2ZUYWJsZUhlYWRlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgUmlnaHRPZlRhYmxlLlNldEJvdW5kcyh3aWR0aCAtIDEsIDAsIDEsIDEpO1xyXG4gICAgICAgICAgICBSaWdodE9mVGFibGVIZWFkZXIuU2V0Qm91bmRzKHdpZHRoIC0gMSwgMCwgMSwgMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZmxvYXQgUGl4ZWxzUGVyUm93KGludCByb3dDb3VudClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHJvd0NvdW50ID4gU2V0dGluZ3MuTWF4aW11bVBpeGVsU2Nyb2xsaW5nUm93cylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDMuMGY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVW5pdEhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgVmFsaWRhdGVHcmlkSGVpZ2h0KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpID0gUm93Q291bnQoKTtcclxuICAgICAgICAgICAgdmFyIHBwciA9IFBpeGVsc1BlclJvdyhpKTtcclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHBwciAqIGk7XHJcblxyXG4gICAgICAgICAgICBpZihpID4gU2V0dGluZ3MuTWF4aW11bVBpeGVsU2Nyb2xsaW5nUm93cyAmJiBHcmlkQm9keUNvbnRhaW5lci5DbGllbnRIZWlnaHQgPiAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgKz0gKChHcmlkQm9keUNvbnRhaW5lci5DbGllbnRIZWlnaHQgLyBVbml0SGVpZ2h0KSAqIHBwcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIEdyaWRCb2R5LlN0eWxlLkhlaWdodCA9IGhlaWdodC5Ub1B4KCk7XHJcbiAgICAgICAgICAgIGlmKEJvdHRvbk9mVGFibGUgPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQm90dG9uT2ZUYWJsZSA9IERpdigpO1xyXG4gICAgICAgICAgICAgICAgR3JpZEJvZHkuQXBwZW5kQ2hpbGQoQm90dG9uT2ZUYWJsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgQm90dG9uT2ZUYWJsZS5TZXRCb3VuZHMoMCwgaGVpZ2h0LCAxLCAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFZhbGlkYXRlR3JpZFNpemUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgVmFsaWRhdGVHcmlkSGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIFZhbGlkYXRlR3JpZFdpZHRoKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbGVhckhlYWRlcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBHcmlkSGVhZGVyLkVtcHR5KCk7XHJcbiAgICAgICAgICAgIEdyaWRIZWFkZXIuQXBwZW5kQ2hpbGQoUmlnaHRPZlRhYmxlSGVhZGVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsZWFyQ29sdW1ucygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb2x1bW5zID0gbmV3IExpc3Q8R3JpZFZpZXdDb2x1bW4+KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBDbGVhclZpZXcoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ29sdW1ucyA9IG5ldyBMaXN0PEdyaWRWaWV3Q29sdW1uPigpO1xyXG4gICAgICAgICAgICBWaXNpYmxlUm93SGFuZGxlcyA9IG5ldyBMaXN0PGludD4oKTtcclxuICAgICAgICAgICAgU2VsZWN0ZWRSb3dzID0gbmV3IEhhcmRTb2Z0TGlzdDxib29sPihmYWxzZSk7XHJcbiAgICAgICAgICAgIF9kYXRhU291cmNlID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIENsZWFyQm9keSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBHcmlkQm9keS5FbXB0eSgpO1xyXG4gICAgICAgICAgICBHcmlkQm9keS5BcHBlbmRDaGlsZHJlbihSaWdodE9mVGFibGUsIEJvdHRvbk9mVGFibGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQ2xlYXJHcmlkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENsZWFySGVhZGVyKCk7XHJcbiAgICAgICAgICAgIENsZWFyQm9keSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgRHJhZ0luZGV4ID0gLTE7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgUmVzaXplSW5kZXggPSAtMTtcclxuICAgICAgICBwcml2YXRlIGludCBSZXNpemVQYWdlWCA9IDA7XHJcbiAgICAgICAgcHJpdmF0ZSBIVE1MU3BhbkVsZW1lbnQgUmVzaXplU3BhbiA9IG51bGw7XHJcblxyXG4gICAgICAgIHByaXZhdGUgQWN0aW9uPE1vdXNlRXZlbnQ8SFRNTFNwYW5FbGVtZW50Pj4gT25Db2x1bW5PbkNsaWNrO1xyXG4gICAgICAgIHByaXZhdGUgQWN0aW9uPEV2ZW50PEhUTUxTcGFuRWxlbWVudD4+IE9uQ29sdW1uRHJhZ1N0YXJ0O1xyXG4gICAgICAgIHByaXZhdGUgQWN0aW9uPEV2ZW50PEhUTUxTcGFuRWxlbWVudD4+IE9uQ29sdW1uRHJhZ092ZXI7XHJcbiAgICAgICAgcHJpdmF0ZSBBY3Rpb248RXZlbnQ8SFRNTFNwYW5FbGVtZW50Pj4gT25Db2x1bW5Ecm9wO1xyXG4gICAgICAgIHByaXZhdGUgQWN0aW9uPE1vdXNlRXZlbnQ8SFRNTFNwYW5FbGVtZW50Pj4gT25Db2x1bW5Nb3VzZURvd247XHJcbiAgICAgICAgcHJpdmF0ZSBBY3Rpb248TW91c2VFdmVudDxIVE1MU3BhbkVsZW1lbnQ+PiBPbkNvbHVtbk1vdXNlTW92ZTtcclxuICAgICAgICBwcml2YXRlIEFjdGlvbjxNb3VzZUV2ZW50PEhUTUxTcGFuRWxlbWVudD4+IE9uQ29sdW1uTW91c2VMZWF2ZTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBBY3Rpb248RXZlbnQ8SFRNTERpdkVsZW1lbnQ+PiBPblJvd0RyYWdTdGFydDtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSB2b2lkIFNldHVwQ29sdW1uKEhUTUxTcGFuRWxlbWVudCBzZSwgaW50IGluZGV4LCBHcmlkVmlld0NvbHVtbiBnY29sKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2UuU2V0QXR0cmlidXRlKFwiaVwiLCBDb252ZXJ0LlRvU3RyaW5nKGluZGV4KSk7XHJcbiAgICAgICAgICAgIHNlLlNldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiLCBcInRydWVcIik7XHJcbiAgICAgICAgICAgIHNlLk9uQ2xpY2sgPSBPbkNvbHVtbk9uQ2xpY2s7XHJcbiAgICAgICAgICAgIHNlLk9uRHJhZ1N0YXJ0ID0gT25Db2x1bW5EcmFnU3RhcnQ7XHJcbiAgICAgICAgICAgIHNlLk9uRHJhZ092ZXIgPSBPbkNvbHVtbkRyYWdPdmVyO1xyXG4gICAgICAgICAgICBzZS5PbkRyb3AgPSBPbkNvbHVtbkRyb3A7XHJcbiAgICAgICAgICAgIHNlLk9uTW91c2VEb3duID0gT25Db2x1bW5Nb3VzZURvd247XHJcbiAgICAgICAgICAgIHNlLk9uTW91c2VNb3ZlID0gT25Db2x1bW5Nb3VzZU1vdmU7XHJcbiAgICAgICAgICAgIHNlLk9uTW91c2VMZWF2ZSA9IE9uQ29sdW1uTW91c2VMZWF2ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW50IGxhc3RJZCA9IC0xO1xyXG5cclxuICAgICAgICBwcml2YXRlIGludCBQcmV2U2Nyb2xsID0gLTE7XHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBQcm9jZXNzQmx1cigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihQcmV2U2Nyb2xsICE9IEdyaWRCb2R5Q29udGFpbmVyLlNjcm9sbFRvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgR3JpZEJvZHkuQ2xhc3NMaXN0LkFkZChcImJsdXJcIik7XHJcbiAgICAgICAgICAgICAgICBpZihsYXN0SWQgIT0gLTEpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgR2xvYmFsLkNsZWFyVGltZW91dChsYXN0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RJZCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxhc3RJZCA9IEdsb2JhbC5TZXRUaW1lb3V0KChnbG9iYWw6OlN5c3RlbS5BY3Rpb24pKCgpID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgR3JpZEJvZHkuQ2xhc3NMaXN0LlJlbW92ZShcImJsdXJcIik7XHJcbiAgICAgICAgICAgICAgICB9KSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBQcmV2U2Nyb2xsID0gR3JpZEJvZHlDb250YWluZXIuU2Nyb2xsVG9wO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBBY3Rpb248VGV4dElucHV0PiBGaWx0ZXJSb3dPbkNoYW5nZTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgUmVuZGVyVGltZSA9IC0xO1xyXG4gICAgICAgIHByaXZhdGUgQWN0aW9uIHJlbmRlckdyaWRJbnRlcm5hbDtcclxuICAgICAgICBwcml2YXRlIGJvb2wgX2Rpc2FibGVSZW5kZXIgPSBmYWxzZTtcclxuICAgICAgICBwdWJsaWMgdm9pZCBSZW5kZXJHcmlkKGJvb2wgY2xlYXIgPSB0cnVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoY2xlYXIpXHJcbiAgICAgICAgICAgICAgICBDYWNoZVJvdyA9IG5ldyBEaWN0aW9uYXJ5PGludCwgSFRNTERpdkVsZW1lbnQ+KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZihSZW5kZXJUaW1lID4gLTEpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIEdsb2JhbC5DbGVhclRpbWVvdXQoUmVuZGVyVGltZSk7XHJcbiAgICAgICAgICAgICAgICBSZW5kZXJUaW1lID0gR2xvYmFsLlNldFRpbWVvdXQoKGdsb2JhbDo6U3lzdGVtLkFjdGlvbilyZW5kZXJHcmlkSW50ZXJuYWwsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyR3JpZEludGVybmFsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIFNvcnRTZXR0aW5nXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIEdyaWRWaWV3Q29sdW1uIENvbHVtbjtcclxuICAgICAgICBwdWJsaWMgR3JpZFZpZXdTb3J0TW9kZSBTb3J0TW9kZTtcclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIEdyaWRWaWV3Q2VsbERpc3BsYXlDaGVja0JveCA6IEdyaWRWaWV3Q2VsbERpc3BsYXlcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgc3RhdGljIHN0cmluZyByZXNvdXJjZV9jaGVja2VkID0gXCJjaGVja2VkXCI7XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSBIVE1MRWxlbWVudCBPbkNyZWF0ZShHcmlkVmlldyBncmlkVmlldywgaW50IGRhdGFSb3dJbmRleCwgaW50IGNvbHVtbkluZGV4KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gZ3JpZFZpZXcuR2V0Um93Q2VsbFZhbHVlKGRhdGFSb3dJbmRleCwgY29sdW1uSW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNlbGwgPSBDb250cm9sLkRpdihcImNlbGxcIik7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IENvbnRyb2wuSW5wdXQoXCJcIiwgSW5wdXRUeXBlLkNoZWNrYm94KTtcclxuICAgICAgICAgICAgaW5wdXQuU2V0Qm91bmRzRnVsbCgpO1xyXG4gICAgICAgICAgICBpbnB1dC5TZXRDaGVja2VkKHZhbHVlKTtcclxuICAgICAgICAgICAgaW5wdXQuU3R5bGUuTWFyZ2luID0gXCIwXCI7XHJcbiAgICAgICAgICAgIGNlbGwuQXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNlbGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgR3JpZFZpZXdDZWxsRGlzcGxheUltYWdlIDogR3JpZFZpZXdDZWxsRGlzcGxheVxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBib29sIFVzZUJhc2U2NFJlc291cmNlO1xyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgSFRNTEVsZW1lbnQgT25DcmVhdGUoR3JpZFZpZXcgZ3JpZFZpZXcsIGludCBkYXRhUm93SW5kZXgsIGludCBjb2x1bW5JbmRleClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBzcmMgPSAoZ3JpZFZpZXcuR2V0Um93Q2VsbFZhbHVlKGRhdGFSb3dJbmRleCwgY29sdW1uSW5kZXgpICsgXCJcIikuSHRtbFVybEVzY2FwZSgpO1xyXG4gICAgICAgICAgICB2YXIgaW1nRGl2ID0gQ29udHJvbC5EaXYoXCJjZWxsXCIpO1xyXG5cclxuICAgICAgICAgICAgaW1nRGl2LlNldEltYWdlKHNyYywgIVVzZUJhc2U2NFJlc291cmNlKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBpbWdEaXY7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgSW1hZ2VFZGl0IDogQ29udHJvbFxyXG4gICAge1xyXG4gICAgICAgIHByaXZhdGUgQ29udHJvbCBfbm9JbWFnZURhdGFUZXh0O1xyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgX2lzVVJMO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBpc1VybFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF9pc1VSTDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX2lzVVJMICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pc1VSTCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlZnJlc2hJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgSW1hZ2VFZGl0KCkgOiBiYXNlKFwiaW5wdXRjb250cm9sXCIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBfbm9JbWFnZURhdGFUZXh0ID0gbmV3IENvbnRyb2woXCJmb3JtLWhlYWRpbmctdGl0bGVcIik7XHJcbiAgICAgICAgICAgIF9ub0ltYWdlRGF0YVRleHQuQ29udGVudC5Jbm5lckhUTUwgPSBcIk5vIGltYWdlIGRhdGFcIjtcclxuICAgICAgICAgICAgX25vSW1hZ2VEYXRhVGV4dC5Db250ZW50LlN0eWxlLkNvbG9yID0gXCJibGFja1wiO1xyXG4gICAgICAgICAgICBfbm9JbWFnZURhdGFUZXh0LkNvbnRlbnQuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuSW5oZXJpdDtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoX25vSW1hZ2VEYXRhVGV4dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0cmluZyBfaW1hZ2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFJlZnJlc2hJbWFnZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShfaW1hZ2UpKVxyXG4gICAgICAgICAgICB7ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgX25vSW1hZ2VEYXRhVGV4dC5Db250ZW50LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkhpZGRlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIF9pbWFnZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBfbm9JbWFnZURhdGFUZXh0LkNvbnRlbnQuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuSW5oZXJpdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLlNldEltYWdlKF9pbWFnZSwgX2lzVVJMKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgSW1hZ2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBfaW1hZ2U7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9pbWFnZSA9PSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBfaW1hZ2UgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIFJlZnJlc2hJbWFnZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlO1xyXG51c2luZyBCcmlkZ2UuSHRtbDU7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBQcm9ncmVzc0NvbnRyb2wgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgcG9zaXRpb247XHJcblxyXG4gICAgICAgIHB1YmxpYyBIVE1MRGl2RWxlbWVudCBpbnRlcm5hbFByb2dyZXNzQ29udHJvbDtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgbWF4aW11bTtcclxuXHJcbiAgICAgICAgcHVibGljIGludCBTdGVwID0gMTtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgRGlzYWJsZVVwZGF0ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBOZXh0U3RlcCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBQb3NpdGlvbiArPSBTdGVwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGludCBNYXhpbXVtXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gbWF4aW11bTsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUgPCAxKVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMTtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlIDwgcG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIG1heGltdW0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmKCFEaXNhYmxlVXBkYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgIFVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgaW50IFBvc2l0aW9uXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gcG9zaXRpb247IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlIDwgMClcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDA7XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHZhbHVlID4gbWF4aW11bSlcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG1heGltdW07XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgaWYoIURpc2FibGVVcGRhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBQcm9ncmVzc0NvbnRyb2woKSA6IGJhc2UoXCJwcm9ncmVzc2JhclwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaW50ZXJuYWxQcm9ncmVzc0NvbnRyb2wgPSBEaXYoXCJwcm9ncmVzc2JhcmJvZHlcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBSZW5kZXIoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5SZW5kZXIoKTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoaW50ZXJuYWxQcm9ncmVzc0NvbnRyb2wpO1xyXG5cclxuICAgICAgICAgICAgVXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBVcGRhdGUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoRGlzYWJsZVVwZGF0ZSB8fCBpbnRlcm5hbFByb2dyZXNzQ29udHJvbCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZihtYXhpbXVtID09IDAgfHwgcG9zaXRpb24gPT0gMClcclxuICAgICAgICAgICAgICAgIGludGVybmFsUHJvZ3Jlc3NDb250cm9sLlN0eWxlLldpZHRoID0gXCIwJVwiO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0cmluZyBzb3VyY2UgPSBTY3JpcHQuV3JpdGU8c3RyaW5nPihcIigodGhpcy5wb3NpdGlvbiAvIHRoaXMubWF4aW11bSkgKiAxMDAuMDApICsgJyUnXCIpO1xyXG4gICAgICAgICAgICAgICAgaW50ZXJuYWxQcm9ncmVzc0NvbnRyb2wuU3R5bGUuV2lkdGggPSBcImNhbGMoXCIgKyBzb3VyY2UgKyBcIiAtIDJweClcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxudXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIFtOYW1lc3BhY2UodHJ1ZSldXHJcbiAgICBwdWJsaWMgY2xhc3MgUmliYm9uQnV0dG9uIDogQ29udHJvbFxyXG4gICAge1xyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIF9pY29uID0gXCJcIjtcclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBJY29uXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9pY29uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfaWNvbiAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaWNvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFByb2Nlc3NJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0cmluZyBfaWNvblVSTCA9IFwiXCI7XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgSWNvblVSTFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfaWNvblVSTDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX2ljb25VUkwgIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2ljb25VUkwgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBQcm9jZXNzSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdHJpbmcgX2NhcHRpb24gPSBcIlwiO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIENhcHRpb25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NhcHRpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9jYXB0aW9uICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9jYXB0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzc0NhcHRpb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgQmVnaW5Hcm91cCA9IGZhbHNlO1xyXG4gICAgICAgIHB1YmxpYyBib29sIElzU21hbGxDYXB0aW9uID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBBY3Rpb248UmliYm9uQnV0dG9uPiBPbkl0ZW1DbGljaztcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBib29sIGVuYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICBwdWJsaWMgSFRNTERpdkVsZW1lbnQgY2FwdGlvbkRpdiA9IG51bGw7XHJcbiAgICAgICAgcHVibGljIEhUTUxEaXZFbGVtZW50IGltYWdlRGl2ID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgc2V0RW5hYmxlZChib29sIHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ2hhbmdlU3RhdGUodmFsdWUpO1xyXG4gICAgICAgICAgICBpZih2YWx1ZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoaW1hZ2VEaXYgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZURpdi5DbGFzc0xpc3QuUmVtb3ZlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihjYXB0aW9uRGl2ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkRpdi5DbGFzc0xpc3QuUmVtb3ZlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihpbWFnZURpdiAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGl2LkNsYXNzTGlzdC5BZGQoXCJkaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGNhcHRpb25EaXYgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXB0aW9uRGl2LkNsYXNzTGlzdC5BZGQoXCJkaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgRW5hYmxlZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbmFibGVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBzZXRFbmFibGVkKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFJpYmJvbkJ1dHRvbihzdHJpbmcgY2FwdGlvbiA9IFwiXCIsIGJvb2wgX2lzU21hbGxDYXB0aW9uID0gZmFsc2UpIDogYmFzZShfaXNTbWFsbENhcHRpb24gPyBcInJpYmJvbmJ1dHRvbnNtYWxsXCIgOiBcInJpYmJvbmJ1dHRvblwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ2FwdGlvbiA9IGNhcHRpb247XHJcbiAgICAgICAgICAgIElzU21hbGxDYXB0aW9uID0gX2lzU21hbGxDYXB0aW9uO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxSaWJib25CdXR0b24+IEFmdGVySXRlbUNsaWNrO1xyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBSZW5kZXIoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgSGFzUmVuZGVyZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5PbkNsaWNrID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBib29sIHdhc0VuYWJsZWQgPSBlbmFibGVkO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGVuYWJsZWQgJiYgT25JdGVtQ2xpY2sgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBPbkl0ZW1DbGljayh0aGlzKTtcclxuICAgICAgICAgICAgICAgIGlmKHdhc0VuYWJsZWQgJiYgQWZ0ZXJJdGVtQ2xpY2sgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBBZnRlckl0ZW1DbGljayh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIFByb2Nlc3NDYXB0aW9uKCk7XHJcbiAgICAgICAgICAgIFByb2Nlc3NJbWFnZSgpO1xyXG5cclxuICAgICAgICAgICAgc2V0RW5hYmxlZChlbmFibGVkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFByb2Nlc3NDYXB0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGNhcHRpb25EaXYgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2FwdGlvbkRpdi5SZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIGNhcHRpb25EaXYgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKENhcHRpb24pKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjYXB0aW9uRGl2ID0gRGl2KElzU21hbGxDYXB0aW9uID8gXCJyaWJib25idXR0b25zbWFsbGNhcHRpb25cIiA6IFwicmliYm9uYnV0dG9uY2FwdGlvblwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXB0aW9uRGl2LklubmVySFRNTCA9IENhcHRpb247XHJcblxyXG4gICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChjYXB0aW9uRGl2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUHJvY2Vzc0ltYWdlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGltYWdlRGl2ID09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKEljb24pKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGl2ID0gRGl2KElzU21hbGxDYXB0aW9uID8gXCJyaWJib25idXR0b25zbWFsbGljb25cIiA6IFwicmliYm9uYnV0dG9uaWNvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZURpdi5TdHlsZS5CYWNrZ3JvdW5kID0gR2V0SW1hZ2VTdHJpbmcoSWNvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKEljb25VUkwpKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGl2ID0gRGl2KElzU21hbGxDYXB0aW9uID8gXCJyaWJib25idXR0b25zbWFsbGljb25cIiA6IFwicmliYm9uYnV0dG9uaWNvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZURpdi5TdHlsZS5CYWNrZ3JvdW5kID0gR2V0SW1hZ2VTdHJpbmdVUkkoSWNvblVSTCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihpbWFnZURpdiAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoaW1hZ2VEaXYpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoSWNvbikpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEaXYuU3R5bGUuQmFja2dyb3VuZCA9IEdldEltYWdlU3RyaW5nKEljb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZighc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShJY29uVVJMKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZURpdi5TdHlsZS5CYWNrZ3JvdW5kID0gR2V0SW1hZ2VTdHJpbmdVUkkoSWNvblVSTCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKGltYWdlRGl2ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGltYWdlRGl2LlN0eWxlLkJhY2tncm91bmRTaXplID0gXCIxMDAlIDEwMCVcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihjYXB0aW9uRGl2ICE9IG51bGwgJiYgSXNTbWFsbENhcHRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkRpdi5TdHlsZS5MZWZ0ID0gXCIyOHB4XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihjYXB0aW9uRGl2ICE9IG51bGwgJiYgSXNTbWFsbENhcHRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkRpdi5TdHlsZS5MZWZ0ID0gXCI2cHhcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxudXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcbnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBbTmFtZXNwYWNlKHRydWUpXVxyXG4gICAgcHVibGljIGNsYXNzIFJpYmJvbkNvbnRyb2wgOiBDb250cm9sLCBJUGFnZXNcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgTGlzdDxSaWJib25QYWdlPiBSaWJib25QYWdlcyB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBJY29uVVJMID0gXCJmYXYuaWNvXCI7XHJcbiAgICAgICAgcHVibGljIHJlYWRvbmx5IFJpYmJvblR5cGUgVHlwZTtcclxuICAgICAgICBwdWJsaWMgSFRNTERpdkVsZW1lbnQgQXBwbGljYXRpb25JY29uID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgQWN0aW9uPGludCwgUmliYm9uUGFnZT4gT25TZWxlY3RlZFBhZ2VDaGFuZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgZW51bSBSaWJib25UeXBlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBGdWxsLFxyXG4gICAgICAgICAgICBDb21wYWN0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgUmliYm9uQ29udHJvbChSaWJib25UeXBlIHR5cGUgPSBSaWJib25UeXBlLkZ1bGwpIDogYmFzZShcInJpYmJvbmNvbnRyb2xcIiArICh0eXBlID09IFJpYmJvblR5cGUuRnVsbCA/IFwiXCIgOiBcIiByaWJib25jb250cm9sLWNvbXBhY3RcIikpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBUeXBlID0gdHlwZTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuT25Db250ZXh0TWVudSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBldi5QcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgQWRkUmliYm9uUGFnZXMocGFyYW1zIFJpYmJvblBhZ2VbXSBwYWdlcylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHBhZ2VzICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBSaWJib25QYWdlcy5BZGRSYW5nZShwYWdlcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGludCBzZWxlY3RlZGluZGV4ID0gLTE7XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgU2VsZWN0ZWRJbmRleFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZGluZGV4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZih2YWx1ZSA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRpbmRleCA+PSBSaWJib25QYWdlcy5Db3VudClcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZGluZGV4ID0gUmliYm9uUGFnZXMuQ291bnQgLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHNlbGVjdGVkaW5kZXggIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRpbmRleCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKE9uU2VsZWN0ZWRQYWdlQ2hhbmdlICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9uU2VsZWN0ZWRQYWdlQ2hhbmdlKHNlbGVjdGVkaW5kZXgsIFJpYmJvblBhZ2VzW3NlbGVjdGVkaW5kZXhdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFNldFNlbGVjdGVkSW5kZXgodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBNZW51Q2xpY2soKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgU2V0U2VsZWN0ZWRJbmRleChpbnQgaW5kZXgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihSaWJib25QYWdlcyAhPSBudWxsICYmIFJpYmJvblBhZ2VzLkNvdW50ID4gMClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IFJpYmJvblBhZ2VzLkNvdW50OyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoUmliYm9uUGFnZXNbaV0uUmliYm9uSGVhZGVyICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSaWJib25QYWdlc1tpXS5SaWJib25IZWFkZXIuQ2xhc3NMaXN0LlJlbW92ZShcInJpYmJvbnBhZ2VoZWFkZXItaGlkZGVuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSaWJib25QYWdlc1tpXS5SaWJib25IZWFkZXIuQ2xhc3NMaXN0LlJlbW92ZShcInJpYmJvbnBhZ2VoZWFkZXItYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSBpbmRleClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmliYm9uUGFnZXNbaV0uUmliYm9uSGVhZGVyLkNsYXNzTGlzdC5BZGQoXCJyaWJib25wYWdlaGVhZGVyLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLkNvbnRlbnQuU3R5bGUuVmlzaWJpbGl0eSA9IFZpc2liaWxpdHkuSW5oZXJpdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlci5DbGFzc0xpc3QuQWRkKFwicmliYm9ucGFnZWhlYWRlci1oaWRkZW5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSaWJib25QYWdlc1tpXS5Db250ZW50LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkhpZGRlbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgUmVuZGVyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEhhc1JlbmRlcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYoVHlwZSA9PSBSaWJib25UeXBlLkZ1bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKEFwcGxpY2F0aW9uSWNvbiAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uSWNvbi5EZWxldGUoKTtcclxuICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uSWNvbiA9IERpdihcImFwcGxpY2F0aW9uLWljb25cIik7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXBwSWNvbkltYWdlID0gRGl2KFwiZmF2LWljb25cIik7XHJcbiAgICAgICAgICAgICAgICBhcHBJY29uSW1hZ2UuU3R5bGUuQmFja2dyb3VuZCA9IFJpYmJvbkJ1dHRvbi5HZXRJbWFnZVN0cmluZ1VSSShJY29uVVJMKTtcclxuICAgICAgICAgICAgICAgIGFwcEljb25JbWFnZS5TdHlsZS5CYWNrZ3JvdW5kU2l6ZSA9IFwiMTAwJSAxMDAlXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgQXBwbGljYXRpb25JY29uLkFwcGVuZENoaWxkKGFwcEljb25JbWFnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChBcHBsaWNhdGlvbkljb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihSaWJib25QYWdlcyAhPSBudWxsICYmIFJpYmJvblBhZ2VzLkNvdW50ID4gMClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW50IHdpZHRoID0gNTg7XHJcbiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgUmliYm9uUGFnZXMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihDb250ZW50LkNvbnRhaW5zKFJpYmJvblBhZ2VzW2ldKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLkNvbnRlbnQuRGVsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlci5EZWxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgUmliYm9uUGFnZXNbaV0uUmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKFR5cGUgPT0gUmliYm9uVHlwZS5Db21wYWN0KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIVJpYmJvblBhZ2VzW2ldLkNvbnRlbnQuQ2xhc3NOYW1lLkNvbnRhaW5zKFwicmliYm9ucGFnZS1jb21wYWN0XCIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmliYm9uUGFnZXNbaV0uQ29udGVudC5DbGFzc0xpc3QuQWRkKFwicmliYm9ucGFnZS1jb21wYWN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihSaWJib25QYWdlc1tpXS5Db250ZW50LkNsYXNzTmFtZS5Db250YWlucyhcInJpYmJvbnBhZ2UtY29tcGFjdFwiKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLkNvbnRlbnQuQ2xhc3NMaXN0LlJlbW92ZShcInJpYmJvbnBhZ2UtY29tcGFjdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGludCBpbmRleCA9IGk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGkgPT0gc2VsZWN0ZWRpbmRleClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlciA9IERpdihcInJpYmJvbnBhZ2VoZWFkZXIgcmliYm9ucGFnZWhlYWRlci1hY3RpdmVcIiArIChUeXBlID09IFJpYmJvblR5cGUuRnVsbCA/IFwiXCIgOiBcIiByaWJib25wYWdlaGVhZGVyLWNvbXBhY3RcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSaWJib25QYWdlc1tpXS5Db250ZW50LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LlZpc2libGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlciA9IERpdihcInJpYmJvbnBhZ2VoZWFkZXIgcmliYm9ucGFnZWhlYWRlci1oaWRkZW5cIiArIChUeXBlID09IFJpYmJvblR5cGUuRnVsbCA/IFwiXCIgOiBcIiByaWJib25wYWdlaGVhZGVyLWNvbXBhY3RcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSaWJib25QYWdlc1tpXS5Db250ZW50LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkhpZGRlbjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlci5Pbk1vdXNlRG93biA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNlbGVjdGVkSW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlci5PblRvdWNoU3RhcnQgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZEluZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUmliYm9uUGFnZXNbaV0uUmliYm9uSGVhZGVyLklubmVySFRNTCA9IFJpYmJvblBhZ2VzW2ldLkNhcHRpb247XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGludCBpbndpZHRoID0gMjQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JFbXB0eShSaWJib25QYWdlc1tpXS5DYXB0aW9uKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlud2lkdGggKz0gKGludClHZXRUZXh0V2lkdGgoUmliYm9uUGFnZXNbaV0uQ2FwdGlvbiwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUmliYm9uUGFnZXNbaV0uUmliYm9uSGVhZGVyLlN0eWxlLkxlZnQgPSB3aWR0aCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICBSaWJib25QYWdlc1tpXS5SaWJib25IZWFkZXIuU3R5bGUuV2lkdGggPSBpbndpZHRoICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKFJpYmJvblBhZ2VzW2ldLlJpYmJvbkhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChSaWJib25QYWdlc1tpXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICs9IGlud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgU2VsZWN0ZWRJbmRleCA9IHNlbGVjdGVkaW5kZXg7XHJcbiAgICAgICAgfVxyXG5cbiAgICBcbnByaXZhdGUgTGlzdDxSaWJib25QYWdlPiBfX1Byb3BlcnR5X19Jbml0aWFsaXplcl9fUmliYm9uUGFnZXM9bmV3IExpc3Q8UmliYm9uUGFnZT4oKTt9XHJcbn0iLCJ1c2luZyBCcmlkZ2U7XHJcbnVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxudXNpbmcgU3lzdGVtLlRleHQ7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIFtOYW1lc3BhY2UodHJ1ZSldXHJcbiAgICBwdWJsaWMgY2xhc3MgUmliYm9uR3JvdXAgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBDYXB0aW9uIHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwdWJsaWMgTGlzdDxSaWJib25CdXR0b24+IEJ1dHRvbnMgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHByaXZhdGUgYm9vbCBlbmFibGVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBIVE1MRGl2RWxlbWVudCBjYXB0aW9uRGl2ID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgRW5hYmxlZFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbmFibGVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBzZXRFbmFibGVkKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgc2V0RW5hYmxlZChib29sIHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoQnV0dG9ucy5Db3VudCA+IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBCdXR0b25zLkNvdW50OyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25zW2ldLnNldEVuYWJsZWQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbnNbaV0uc2V0RW5hYmxlZChCdXR0b25zW2ldLkVuYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBDaGFuZ2VTdGF0ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIGlmKHZhbHVlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihjYXB0aW9uRGl2ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkRpdi5DbGFzc0xpc3QuUmVtb3ZlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihjYXB0aW9uRGl2ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkRpdi5DbGFzc0xpc3QuQWRkKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBSaWJib25Hcm91cChzdHJpbmcgX2NhcHRpb24gPSBcIlwiKSA6IGJhc2UoXCJyaWJib25ncm91cFwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ2FwdGlvbiA9IF9jYXB0aW9uO1xyXG4gICAgICAgICAgICBCdXR0b25zID0gbmV3IExpc3Q8UmliYm9uQnV0dG9uPigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFJpYmJvbkdyb3VwKHN0cmluZyBfY2FwdGlvbiwgcGFyYW1zIFJpYmJvbkJ1dHRvbltdIGJ1dHRvbnMpIDogYmFzZShcInJpYmJvbmdyb3VwXCIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDYXB0aW9uID0gX2NhcHRpb247XHJcbiAgICAgICAgICAgIEJ1dHRvbnMgPSBuZXcgTGlzdDxSaWJib25CdXR0b24+KCk7XHJcbiAgICAgICAgICAgIGlmKGJ1dHRvbnMgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIEJ1dHRvbnMuQWRkUmFuZ2UoYnV0dG9ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIEhUTUxEaXZFbGVtZW50IENyZWF0ZVZlcnRpY2FsTGluZShpbnQgaGVpZ2h0KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGh0bWxEaXYgPSBEaXYoXCJyaWJib25zZXBlcmF0b3JcIik7XHJcbiAgICAgICAgICAgIGlmKGhlaWdodCAhPSA1OClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaHRtbERpdi5TdHlsZS5IZWlnaHQgPSBoZWlnaHQgKyBcInB4XCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBodG1sRGl2O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNsYXNzIFJlbmRlckluZm9cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHB1YmxpYyBpbnQgTGVmdDtcclxuICAgICAgICAgICAgcHVibGljIGludCBXaWR0aDtcclxuXHJcbiAgICAgICAgICAgIHB1YmxpYyBib29sIElzU21hbGwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHB1YmxpYyBSaWJib25CdXR0b24gRmlyc3RCdXR0b247XHJcbiAgICAgICAgICAgIHB1YmxpYyBSaWJib25CdXR0b24gU2Vjb25kQnV0dG9uO1xyXG4gICAgICAgICAgICBwdWJsaWMgUmliYm9uQnV0dG9uIFRoaXJkQnV0dG9uO1xyXG5cclxuICAgICAgICAgICAgcHVibGljIGJvb2wgQmVnaW5Hcm91cCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIExpc3Q8UmVuZGVySW5mbz4gcmlMaXN0ID0gbnVsbDtcclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgR2VuZXJhdGVSTGlzdCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBSZW5kZXJJbmZvIHJpID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmKHJpTGlzdCA9PSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByaUxpc3QgPSBuZXcgTGlzdDxSZW5kZXJJbmZvPigpO1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IEJ1dHRvbnMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihyaSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkgPSBuZXcgUmVuZGVySW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByaS5GaXJzdEJ1dHRvbiA9IEJ1dHRvbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpLklzU21hbGwgPSByaS5GaXJzdEJ1dHRvbi5Jc1NtYWxsQ2FwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocmkuSXNTbWFsbCAhPSBCdXR0b25zW2ldLklzU21hbGxDYXB0aW9uIHx8IEJ1dHRvbnNbaV0uQmVnaW5Hcm91cCB8fCAhQnV0dG9uc1tpXS5Jc1NtYWxsQ2FwdGlvbiB8fCAocmkuRmlyc3RCdXR0b24gIT0gbnVsbCAmJiByaS5TZWNvbmRCdXR0b24gIT0gbnVsbCAmJiByaS5UaGlyZEJ1dHRvbiAhPSBudWxsKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlMaXN0LkFkZChyaSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkgPSBuZXcgUmVuZGVySW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24gPSBCdXR0b25zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuSXNTbWFsbCA9IEJ1dHRvbnNbaV0uSXNTbWFsbENhcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaS5CZWdpbkdyb3VwID0gQnV0dG9uc1tpXS5CZWdpbkdyb3VwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmkuU2Vjb25kQnV0dG9uID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuU2Vjb25kQnV0dG9uID0gQnV0dG9uc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaS5UaGlyZEJ1dHRvbiA9IEJ1dHRvbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYocmkgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByaUxpc3QuQWRkKHJpKTtcclxuICAgICAgICAgICAgICAgICAgICByaSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSB2b2lkIFJlbmRlcigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBIYXNSZW5kZXJlZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBHZW5lcmF0ZVJMaXN0KCk7XHJcblxyXG4gICAgICAgICAgICBDb250ZW50LkVtcHR5KCk7XHJcblxyXG4gICAgICAgICAgICBpbnQgd2lkdGggPSAwO1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IHJpTGlzdC5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmkgPSByaUxpc3RbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYocmkuQmVnaW5Hcm91cClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCArPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2bGJnID0gQ3JlYXRlVmVydGljYWxMaW5lKDU4KTtcclxuICAgICAgICAgICAgICAgICAgICB2bGJnLlN0eWxlLkxlZnQgPSB3aWR0aCArIFwicHhcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZCh2bGJnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB3aWR0aCArPSAzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHJpLklzU21hbGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW50IE1heFdpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihyaS5UaGlyZEJ1dHRvbiA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocmkuU2Vjb25kQnV0dG9uID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1heFdpZHRoID0gTWF0aC5NYXgoKGludClHZXRUZXh0V2lkdGgocmkuRmlyc3RCdXR0b24uQ2FwdGlvbiwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpICsgMjggKyA2LCA2NCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uUmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5MZWZ0ID0gd2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaS5GaXJzdEJ1dHRvbi5Db250ZW50LlN0eWxlLldpZHRoID0gTWF4V2lkdGggKyBcInB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5Ub3AgPSBcIjI2cHhcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKHJpLkZpcnN0QnV0dG9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1heFdpZHRoID0gTWF0aC5NYXgoTWF0aC5NYXgoKGludClHZXRUZXh0V2lkdGgocmkuRmlyc3RCdXR0b24uQ2FwdGlvbiwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpbnQpR2V0VGV4dFdpZHRoKHJpLlNlY29uZEJ1dHRvbi5DYXB0aW9uLCBTZXR0aW5ncy5EZWZhdWx0Rm9udCkpICsgMjggKyA2LCA2NCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uUmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaS5TZWNvbmRCdXR0b24uUmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5MZWZ0ID0gd2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaS5TZWNvbmRCdXR0b24uQ29udGVudC5TdHlsZS5MZWZ0ID0gd2lkdGggKyBcInB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5Ub3AgPSAoKCgxMDAgLSAzKSAvIDMpIC0gMTEpICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpLkZpcnN0QnV0dG9uLkNvbnRlbnQuU3R5bGUuV2lkdGggPSBNYXhXaWR0aCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpLlNlY29uZEJ1dHRvbi5Db250ZW50LlN0eWxlLldpZHRoID0gTWF4V2lkdGggKyBcInB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5Ub3AgPSBcIjExcHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpLlNlY29uZEJ1dHRvbi5Db250ZW50LlN0eWxlLlRvcCA9IFwiNDFweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQocmkuRmlyc3RCdXR0b24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChyaS5TZWNvbmRCdXR0b24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1heFdpZHRoID0gTWF0aC5NYXgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLk1heChNYXRoLk1heCgoaW50KUdldFRleHRXaWR0aChyaS5GaXJzdEJ1dHRvbi5DYXB0aW9uLCBTZXR0aW5ncy5EZWZhdWx0Rm9udCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGludClHZXRUZXh0V2lkdGgocmkuU2Vjb25kQnV0dG9uLkNhcHRpb24sIFNldHRpbmdzLkRlZmF1bHRGb250KSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGludClHZXRUZXh0V2lkdGgocmkuVGhpcmRCdXR0b24uQ2FwdGlvbiwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpKSArIDI4ICsgNiwgNjQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uUmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpLlNlY29uZEJ1dHRvbi5SZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuVGhpcmRCdXR0b24uUmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByaS5GaXJzdEJ1dHRvbi5Db250ZW50LlN0eWxlLkxlZnQgPSB3aWR0aCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuU2Vjb25kQnV0dG9uLkNvbnRlbnQuU3R5bGUuTGVmdCA9IHdpZHRoICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByaS5UaGlyZEJ1dHRvbi5Db250ZW50LlN0eWxlLkxlZnQgPSB3aWR0aCArIFwicHhcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpLkZpcnN0QnV0dG9uLkNvbnRlbnQuU3R5bGUuV2lkdGggPSBNYXhXaWR0aCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuU2Vjb25kQnV0dG9uLkNvbnRlbnQuU3R5bGUuV2lkdGggPSBNYXhXaWR0aCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuVGhpcmRCdXR0b24uQ29udGVudC5TdHlsZS5XaWR0aCA9IE1heFdpZHRoICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5Ub3AgPSBcIjNweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByaS5TZWNvbmRCdXR0b24uQ29udGVudC5TdHlsZS5Ub3AgPSBcIjI2cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmkuVGhpcmRCdXR0b24uQ29udGVudC5TdHlsZS5Ub3AgPSBcIjQ5cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gM1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChyaS5GaXJzdEJ1dHRvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQocmkuU2Vjb25kQnV0dG9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZChyaS5UaGlyZEJ1dHRvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCArPSBNYXhXaWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByaS5GaXJzdEJ1dHRvbi5SZW5kZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmkuRmlyc3RCdXR0b24uQ29udGVudC5TdHlsZS5MZWZ0ID0gd2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgaW50IGlud2lkdGggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJpLkZpcnN0QnV0dG9uLkNhcHRpb24uQ29udGFpbnMoXCIgXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmluZ3MgPSByaS5GaXJzdEJ1dHRvbi5DYXB0aW9uLlNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGludCBsZW5ndGggPSByaS5GaXJzdEJ1dHRvbi5DYXB0aW9uLkxlbmd0aCAvIDI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGogPSAwOyBqIDwgc3RyaW5ncy5MZW5ndGg7IGorKylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYnVpbGRlci5MZW5ndGggPiBsZW5ndGgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW53aWR0aCA9IChpbnQpR2V0VGV4dFdpZHRoKGJ1aWxkZXIuVG9TdHJpbmcoKSwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpICsgMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihidWlsZGVyLkxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5BcHBlbmQoXCIgXCIgKyBzdHJpbmdzW2pdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLkFwcGVuZChzdHJpbmdzW2pdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpbndpZHRoID09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlud2lkdGggPSAoaW50KUdldFRleHRXaWR0aChidWlsZGVyLlRvU3RyaW5nKCksIFNldHRpbmdzLkRlZmF1bHRGb250KSArIDIwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlud2lkdGggPSAoaW50KUdldFRleHRXaWR0aChyaS5GaXJzdEJ1dHRvbi5DYXB0aW9uLCBTZXR0aW5ncy5EZWZhdWx0Rm9udCkgKyAyMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGlud2lkdGggPCA0NClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlud2lkdGggPSA0NDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJpLkZpcnN0QnV0dG9uLkNvbnRlbnQuU3R5bGUuV2lkdGggPSBpbndpZHRoICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCArPSBpbndpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKHJpLkZpcnN0QnV0dG9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW50IG1pbldpZHRoID0gKGludClHZXRUZXh0V2lkdGgoQ2FwdGlvbiwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpICsgMjA7XHJcblxyXG4gICAgICAgICAgICBpZih3aWR0aCA8IG1pbldpZHRoKVxyXG4gICAgICAgICAgICAgICAgd2lkdGggPSBtaW5XaWR0aDtcclxuXHJcbiAgICAgICAgICAgIHdpZHRoICs9IDM7XHJcblxyXG4gICAgICAgICAgICB2YXIgdmwgPSBDcmVhdGVWZXJ0aWNhbExpbmUoODApO1xyXG4gICAgICAgICAgICB2bC5TdHlsZS5MZWZ0ID0gd2lkdGggLSAxICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgQ29udGVudC5BcHBlbmRDaGlsZCh2bCk7XHJcblxyXG4gICAgICAgICAgICBDb250ZW50LlN0eWxlLldpZHRoID0gd2lkdGggKyBcInB4XCI7XHJcblxyXG4gICAgICAgICAgICBpZighc3RyaW5nLklzTnVsbE9yV2hpdGVTcGFjZShDYXB0aW9uKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2FwdGlvbkRpdiA9IERpdihcInJpYmJvbmdyb3VwY2FwdGlvblwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXB0aW9uRGl2LklubmVySFRNTCA9IENhcHRpb247XHJcbiAgICAgICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKGNhcHRpb25EaXYpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRFbmFibGVkKGVuYWJsZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZTtcclxudXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgW05hbWVzcGFjZSh0cnVlKV1cclxuICAgIHB1YmxpYyBjbGFzcyBSaWJib25QYWdlIDogQ29udHJvbFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgQ2FwdGlvbiB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHVibGljIExpc3Q8UmliYm9uR3JvdXA+IFJpYmJvbkdyb3VwcyB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHVibGljIEhUTUxEaXZFbGVtZW50IFJpYmJvbkhlYWRlciA9IG51bGw7XHJcblxyXG4gICAgICAgIHB1YmxpYyBSaWJib25QYWdlKHN0cmluZyBfY2FwdGlvbiA9IFwiXCIpIDogYmFzZShcInJpYmJvbnBhZ2VcIilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENhcHRpb24gPSBfY2FwdGlvbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEFkZFJpYmJvbkdyb3VwcyhwYXJhbXMgUmliYm9uR3JvdXBbXSBwYWdlcylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHBhZ2VzICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBSaWJib25Hcm91cHMuQWRkUmFuZ2UocGFnZXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgUmVuZGVyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEhhc1JlbmRlcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYoUmliYm9uR3JvdXBzID09IG51bGwgfHwgUmliYm9uR3JvdXBzLkNvdW50ID09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGludCB3aWR0aCA9IDA7XHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBSaWJib25Hcm91cHMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUmliYm9uR3JvdXBzW2ldLlJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgUmliYm9uR3JvdXBzW2ldLkNvbnRlbnQuU3R5bGUuTGVmdCA9IHdpZHRoICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgd2lkdGggKz0gR2xvYmFsLlBhcnNlSW50KFJpYmJvbkdyb3Vwc1tpXS5Db250ZW50LlN0eWxlLldpZHRoKTtcclxuICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoUmliYm9uR3JvdXBzW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXG4gICAgXG5wcml2YXRlIExpc3Q8UmliYm9uR3JvdXA+IF9fUHJvcGVydHlfX0luaXRpYWxpemVyX19SaWJib25Hcm91cHM9bmV3IExpc3Q8UmliYm9uR3JvdXA+KCk7fVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBTaW1wbGVCdXR0b24gOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxTaW1wbGVCdXR0b24+IEl0ZW1DbGljaztcclxuICAgICAgICBwdWJsaWMgRm9ybSBQYXJlbnRGb3JtID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgRGlhbG9nUmVzdWx0RW51bSBEaWFsb2dSZXN1bHQgPSBEaWFsb2dSZXN1bHRFbnVtLk5vbmU7XHJcbiAgICAgICAgcHJpdmF0ZSBIVE1MSW1hZ2VFbGVtZW50IF9pbWFnZUVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIHByaXZhdGUgc3RyaW5nIF9pbWFnZTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgSW1hZ2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBfaW1hZ2U7IH1cclxuICAgICAgICAgICAgc2V0IHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gKHZhbHVlICsgXCJcIikuVHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUgIT0gX2ltYWdlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pbWFnZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIF9Qcm9jZXNzQnV0dG9uSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgYm9vbCBfdXNlQmFzZTY0SW1hZ2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFVzZUJhc2U2NEltYWdlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX3VzZUJhc2U2NEltYWdlOyB9XHJcbiAgICAgICAgICAgIHNldCB7XHJcbiAgICAgICAgICAgICAgICBpZihfdXNlQmFzZTY0SW1hZ2UgIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3VzZUJhc2U2NEltYWdlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgX1Byb2Nlc3NCdXR0b25JbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgX2ltYWdlUmlnaHRBbGlnbjtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgSW1hZ2VSaWdodEFsaWduXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX2ltYWdlUmlnaHRBbGlnbjsgfVxyXG4gICAgICAgICAgICBzZXQge1xyXG4gICAgICAgICAgICAgICAgaWYoX2ltYWdlUmlnaHRBbGlnbiAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VSaWdodEFsaWduID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgX1Byb2Nlc3NCdXR0b25JbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW50IF9idXR0b25JbWFnZVNpemU7XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgQnV0dG9uSW1hZ2VTaXplXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gX2J1dHRvbkltYWdlU2l6ZTsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX2J1dHRvbkltYWdlU2l6ZSAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfYnV0dG9uSW1hZ2VTaXplID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgX1Byb2Nlc3NCdXR0b25JbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgICAgXHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBfUHJvY2Vzc0J1dHRvbkltYWdlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UoX2ltYWdlKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX2ltYWdlRWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pbWFnZUVsZW1lbnQuRGVsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgX2ltYWdlRWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1lbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKF9pbWFnZUVsZW1lbnQgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50ID0gbmV3IEhUTUxJbWFnZUVsZW1lbnQoKTsgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfWVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgX2ltYWdlRWxlbWVudC5TZXRJbWFnZShfaW1hZ2UsICFfdXNlQmFzZTY0SW1hZ2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHN0cmluZyBwYWRkaW5nID0gX2J1dHRvbkltYWdlU2l6ZSA9PSAwID8gXCIxNnB4XCIgOiBfYnV0dG9uSW1hZ2VTaXplLlRvUHgoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLkhlaWdodCA9IHBhZGRpbmc7XHJcbiAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLlBvc2l0aW9uID0gUG9zaXRpb24uQWJzb2x1dGU7XHJcbiAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLlRvcCA9IFwiMXB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIV9pbWFnZVJpZ2h0QWxpZ24pXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2ltYWdlRWxlbWVudC5TdHlsZS5CYWNrZ3JvdW5kUG9zaXRpb24gPSBcImxlZnRcIjtcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLlBhZGRpbmdMZWZ0ID0gcGFkZGluZztcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLlBhZGRpbmdSaWdodCA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF9pbWFnZUVsZW1lbnQuU3R5bGUuTGVmdCA9IFwiMXB4XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKENvbnRlbnQuTGFzdENoaWxkID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKF9pbWFnZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50Lkluc2VydEJlZm9yZShfaW1hZ2VFbGVtZW50LCBDb250ZW50Lkxhc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2ltYWdlRWxlbWVudC5TdHlsZS5SaWdodCA9IFwiMXB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgX2ltYWdlRWxlbWVudC5TdHlsZS5MZWZ0ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLkJhY2tncm91bmRQb3NpdGlvbiA9IFwicmlnaHRcIjtcclxuICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LlN0eWxlLlBhZGRpbmdSaWdodCA9IHBhZGRpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgX2ltYWdlRWxlbWVudC5TdHlsZS5QYWRkaW5nTGVmdCA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQoX2ltYWdlRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9ICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24oQnV0dG9uVHlwZSBidXR0b24gPSBCdXR0b25UeXBlLkJ1dHRvbiwgYm9vbCBhYyA9IHRydWUpIDogYmFzZShcInNpbXBsZWJ1dHRvblwiLCBidXR0b24sIGFjKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ29udGVudC5PbkNvbnRleHRNZW51ID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZihhYylcclxuICAgICAgICAgICAgICAgIFN0eWxlLkZvbnQgPSBTZXR0aW5ncy5Gb250O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5TZXRTaXplKFwiNjlweFwiLCBcIjIwcHhcIik7XHJcblxyXG4gICAgICAgICAgICBDb250ZW50Lk9uQ2xpY2sgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGVuYWJsZWQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5Db250ZW50LkJsdXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoRGlhbG9nUmVzdWx0ICE9IERpYWxvZ1Jlc3VsdEVudW0uTm9uZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJlbnRGb3JtICE9IG51bGwgJiYgUGFyZW50Rm9ybS5Jc0RpYWxvZygpKSAvLyBKdXN0IGluY2FzZSB3ZSBzZXQgZGlzYWJsZWQgYW5kIGlzIGRpYWxvZ1xyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyZW50Rm9ybS5EaWFsb2dSZXN1bHQgPSBEaWFsb2dSZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihJdGVtQ2xpY2sgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihEaWFsb2dSZXN1bHQgIT0gRGlhbG9nUmVzdWx0RW51bS5Ob25lICYmIFBhcmVudEZvcm0uRGlhbG9nUmVzdWx0ICE9IERpYWxvZ1Jlc3VsdEVudW0uTm9uZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJlbnRGb3JtICE9IG51bGwgJiYgUGFyZW50Rm9ybS5Jc0RpYWxvZygpKSAvLyBKdXN0IGluY2FzZSB3ZSBzZXQgZGlzYWJsZWQgYW5kIGlzIGRpYWxvZ1xyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyZW50Rm9ybS5DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBDb250ZW50Lk9uRGJsQ2xpY2sgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIENvbnRlbnQuT25Nb3VzZURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIENvbnRlbnQuT25Nb3VzZVVwID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBldi5TdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBUZXh0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gdGhpcy5Db250ZW50LkFzPEhUTUxCdXR0b25FbGVtZW50PigpLlRleHRDb250ZW50OyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihUZXh0ICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5BczxIVE1MQnV0dG9uRWxlbWVudD4oKS5UZXh0Q29udGVudCA9IHZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihfaW1hZ2VFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50LkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaW1hZ2VFbGVtZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBfUHJvY2Vzc0J1dHRvbkltYWdlKCk7XHJcbiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgZW5hYmxlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIEVuYWJsZWRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBlbmFibGVkOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZihlbmFibGVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGVudC5SZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRlbnQuU2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgKCFlbmFibGVkKS5Ub1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIFNwbGl0Q29udHJvbENvbnRhaW5lciA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgQ29udHJvbCBQYW5lbDE7XHJcbiAgICAgICAgcHVibGljIENvbnRyb2wgUGFuZWwyO1xyXG4gICAgICAgIHB1YmxpYyBDb250cm9sIFNwbGl0dGVyO1xyXG5cclxuICAgICAgICBwcml2YXRlIENsaWVudFJlY3QgX3ByZXZDbGllbnRSZWN0ID0gbnVsbDtcclxuICAgICAgICBwcml2YXRlIGJvb2wgSXNNb3VzZURvd24gPSBmYWxzZTtcclxuICAgICAgICBwcml2YXRlIFZlY3RvcjIgX21vdXNlRG93blZlY3RvcjtcclxuICAgICAgICBwcml2YXRlIFZlY3RvcjIgX2N1cnJlbnRNb3VzZURvd25WZWN0b3I7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgX3N0YXJ0aW5nU3BsaXR0ZXJQb3M7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgX3NwbGl0dGVyUG9zaXRpb24gPSAtMTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBGaXhlZFNwbGl0dGVyUG9zaXRpb24gZml4ZWRTcGxpdHRlclBvc3Rpb24gPSBGaXhlZFNwbGl0dGVyUG9zaXRpb24uUGFuZWwxO1xyXG5cclxuICAgICAgICBwdWJsaWMgRml4ZWRTcGxpdHRlclBvc2l0aW9uIEZpeGVkU3BsaXR0ZXJQb3N0aW9uXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gZml4ZWRTcGxpdHRlclBvc3Rpb247IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZpeGVkU3BsaXR0ZXJQb3N0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBSZW5kZXJDb250cm9scygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBTcGxpdHRlclJlc2l6YWJsZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgU3BsaXR0ZXJQb3NpdGlvblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF9zcGxpdHRlclBvc2l0aW9uOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZih2YWx1ZSA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgX3NwbGl0dGVyUG9zaXRpb24gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIFJlbmRlckNvbnRyb2xzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgYm9vbCBob3Jpem9udGFsO1xyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBIb3Jpem9udGFsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQgeyByZXR1cm4gaG9yaXpvbnRhbDsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUgIT0gaG9yaXpvbnRhbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBSZW5kZXJDb250cm9scygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhvcml6b250YWwgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgUmVuZGVyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuUmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICBSZW5kZXJDb250cm9scygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSB2b2lkIFJlc2l6ZUNoaWxkcmVuKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuTGlua2VkRm9ybSAhPSBudWxsICYmIHRoaXMuQ29udGVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkxpbmtlZEZvcm0uUmVzaXplQ2hpbGRyZW4odGhpcy5Db250ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFNwbGl0Q29udHJvbENvbnRhaW5lcigpIDogYmFzZShcInNwbGl0Y29udHJvbFwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgUGFuZWwxID0gbmV3IENvbnRyb2woKSB7IExvY2F0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCkgfTtcclxuICAgICAgICAgICAgUGFuZWwyID0gbmV3IENvbnRyb2woKTtcclxuICAgICAgICAgICAgUGFuZWwxLlN0eWxlLk92ZXJmbG93ID0gT3ZlcmZsb3cuQXV0bztcclxuICAgICAgICAgICAgUGFuZWwyLlN0eWxlLk92ZXJmbG93ID0gT3ZlcmZsb3cuQXV0bztcclxuXHJcbiAgICAgICAgICAgIFNwbGl0dGVyID0gbmV3IENvbnRyb2woKTtcclxuXHJcbiAgICAgICAgICAgIFNwbGl0dGVyLkNvbnRlbnQuT25Nb3VzZURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCFTcGxpdHRlclJlc2l6YWJsZSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBJc01vdXNlRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBfbW91c2VEb3duVmVjdG9yID0gSGVscGVyLkdldENsaWVudE1vdXNlTG9jYXRpb24oZXYpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1heFNpemUgPSBHZXRNYXhTcGxpdHRlclNpemUoKTtcclxuICAgICAgICAgICAgICAgIF9zdGFydGluZ1NwbGl0dGVyUG9zID0gX3NwbGl0dGVyUG9zaXRpb24gPiBtYXhTaXplID8gbWF4U2l6ZSA6IF9zcGxpdHRlclBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBPblJlc2l6ZSA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5MaW5rZWRGb3JtICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMuTGlua2VkRm9ybS5Jc1Zpc2libGUoKSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgY2xpZW50UmVjID0gdGhpcy5Db250ZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKF9wcmV2Q2xpZW50UmVjdCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9wcmV2Q2xpZW50UmVjdCA9IGNsaWVudFJlYztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihmaXhlZFNwbGl0dGVyUG9zdGlvbiA9PSBGaXhlZFNwbGl0dGVyUG9zaXRpb24uTm9uZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkb3VibGUgVjEgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBWMiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9vbCBkaXJ0eSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihIb3Jpem9udGFsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2xpZW50UmVjLkhlaWdodCAhPSBfcHJldkNsaWVudFJlY3QuSGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWMSA9IGNsaWVudFJlYy5IZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWMiA9IF9wcmV2Q2xpZW50UmVjdC5IZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2xpZW50UmVjLldpZHRoICE9IF9wcmV2Q2xpZW50UmVjdC5XaWR0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVjEgPSBjbGllbnRSZWMuV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWMiA9IF9wcmV2Q2xpZW50UmVjdC5XaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcnR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZihkaXJ0eSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNwbGl0dGVyUG9zaXRpb24gPSBWMSA9PSAwIHx8IFYyID09IDAgPyAwIDogKGludCkoU3BsaXR0ZXJQb3NpdGlvbiAqIChWMSAvIFYyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIF9wcmV2Q2xpZW50UmVjdCA9IGNsaWVudFJlYztcclxuXHJcbiAgICAgICAgICAgICAgICBSZW5kZXJDb250cm9scygpO1xyXG5cclxuICAgICAgICAgICAgICAgIFJlc2l6ZUNoaWxkcmVuKCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBDb250ZW50Lk9uTW91c2VNb3ZlID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihJc01vdXNlRG93bilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfY3VycmVudE1vdXNlRG93blZlY3RvciA9IEhlbHBlci5HZXRDbGllbnRNb3VzZUxvY2F0aW9uKGV2KTtcclxuICAgICAgICAgICAgICAgICAgICBpbnQgeDtcclxuICAgICAgICAgICAgICAgICAgICBpbnQgbSA9IGhvcml6b250YWwgPyAoX21vdXNlRG93blZlY3Rvci5ZaSAtIF9jdXJyZW50TW91c2VEb3duVmVjdG9yLllpKSA6IChfbW91c2VEb3duVmVjdG9yLlhpIC0gX2N1cnJlbnRNb3VzZURvd25WZWN0b3IuWGkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IEdldE1heFNwbGl0dGVyU2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCh4ID0gZml4ZWRTcGxpdHRlclBvc3Rpb24gPT0gRml4ZWRTcGxpdHRlclBvc2l0aW9uLlBhbmVsMiA/IF9zdGFydGluZ1NwbGl0dGVyUG9zICsgbSA6IF9zdGFydGluZ1NwbGl0dGVyUG9zIC0gbSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgPiB5KVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IHk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFNwbGl0dGVyUG9zaXRpb24gPSB4O1xyXG4gICAgICAgICAgICAgICAgICAgIF9jdXJyZW50TW91c2VEb3duVmVjdG9yID0gX21vdXNlRG93blZlY3RvcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUmVzaXplQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuT25Nb3VzZVVwID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBJc01vdXNlRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgUmVuZGVyQ29udHJvbHMoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuQXBwZW5kQ2hpbGRyZW4oUGFuZWwxLCBTcGxpdHRlciwgUGFuZWwyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW50IEdldE1heFNwbGl0dGVyU2l6ZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgbWF4U2l6ZSA9IChpbnQpKEhvcml6b250YWwgPyB0aGlzLkNvbnRlbnQuR2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuSGVpZ2h0IDogdGhpcy5Db250ZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLldpZHRoKSAtIDEyO1xyXG4gICAgICAgICAgICBpZihtYXhTaXplIDwgMClcclxuICAgICAgICAgICAgICAgIG1heFNpemUgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gbWF4U2l6ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBSZW5kZXJDb250cm9scygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgc3AgPSBTcGxpdHRlclBvc2l0aW9uO1xyXG4gICAgICAgICAgICB2YXIgbWF4U2l6ZSA9IEdldE1heFNwbGl0dGVyU2l6ZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYoX3ByZXZDbGllbnRSZWN0ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHNwID4gbWF4U2l6ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzcCA9IG1heFNpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKEhvcml6b250YWwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFBhbmVsMS5FeGNoYW5nZUNsYXNzKFwic3BsaXR2ZXJ0aWNhbFwiLCBcInNwbGl0aG9yaXpvbnRhbFwiKTtcclxuICAgICAgICAgICAgICAgIFBhbmVsMi5FeGNoYW5nZUNsYXNzKFwic3BsaXR2ZXJ0aWNhbFwiLCBcInNwbGl0aG9yaXpvbnRhbFwiKTtcclxuICAgICAgICAgICAgICAgIFNwbGl0dGVyLkV4Y2hhbmdlQ2xhc3MoXCJzcGxpdHRlcnZlcnRpY2FsXCIsIFwic3BsaXR0ZXJob3Jpem9udGFsXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIFBhbmVsMS5XaWR0aCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBTcGxpdHRlci5XaWR0aCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBQYW5lbDIuV2lkdGggPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGZpeGVkU3BsaXR0ZXJQb3N0aW9uICE9IEZpeGVkU3BsaXR0ZXJQb3NpdGlvbi5QYW5lbDIpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU3BsaXR0ZXIuTG9jYXRpb24gPSBuZXcgVmVjdG9yMigwLCBzcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFBhbmVsMS5IZWlnaHQgPSBzcDtcclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuTG9jYXRpb24gPSBuZXcgVmVjdG9yMigwLCBzcCArIDEyKTtcclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuSGVpZ2h0ID0gXCIoMTAwJSAtIFwiICsgKHNwICsgMTIpICsgXCJweClcIjsgO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFNwbGl0dGVyLkxvY2F0aW9uID0gbmV3IFZlY3RvcjIoMCwgXCIoMTAwJSAtIFwiICsgKHNwKSArIFwicHgpXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDEuSGVpZ2h0ID0gXCIoMTAwJSAtIFwiICsgc3AgKyBcInB4KVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuSGVpZ2h0ID0gc3AgLSAxMjtcclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuTG9jYXRpb24gPSBuZXcgVmVjdG9yMigwLCBcIigxMDAlIC0gXCIgKyAoc3AgLSAxMikgKyBcInB4KVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFBhbmVsMS5FeGNoYW5nZUNsYXNzKFwic3BsaXRob3Jpem9udGFsXCIsIFwic3BsaXR2ZXJ0aWNhbFwiKTtcclxuICAgICAgICAgICAgICAgIFBhbmVsMi5FeGNoYW5nZUNsYXNzKFwic3BsaXRob3Jpem9udGFsXCIsIFwic3BsaXR2ZXJ0aWNhbFwiKTtcclxuICAgICAgICAgICAgICAgIFNwbGl0dGVyLkV4Y2hhbmdlQ2xhc3MoXCJzcGxpdHRlcmhvcml6b250YWxcIiwgXCJzcGxpdHRlcnZlcnRpY2FsXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIFBhbmVsMS5IZWlnaHQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgU3BsaXR0ZXIuSGVpZ2h0ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIFBhbmVsMi5IZWlnaHQgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGZpeGVkU3BsaXR0ZXJQb3N0aW9uICE9IEZpeGVkU3BsaXR0ZXJQb3NpdGlvbi5QYW5lbDIpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU3BsaXR0ZXIuTG9jYXRpb24gPSBuZXcgVmVjdG9yMihzcCwgMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFBhbmVsMS5XaWR0aCA9IHNwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuV2lkdGggPSBcIigxMDAlIC0gXCIgKyAoc3AgKyAxMikgKyBcInB4KVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIFBhbmVsMi5Mb2NhdGlvbiA9IG5ldyBWZWN0b3IyKHNwICsgMTIsIDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFNwbGl0dGVyLkxvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIFwiICsgc3AgKyBcInB4KVwiLCAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUGFuZWwxLldpZHRoID0gXCIoMTAwJSAtIFwiICsgc3AgKyBcInB4KVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuV2lkdGggPSBzcDtcclxuICAgICAgICAgICAgICAgICAgICBQYW5lbDIuTG9jYXRpb24gPSBuZXcgVmVjdG9yMihcIigxMDAlIC0gXCIgKyAoc3AgKyAxMikgKyBcInB4KVwiLCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIFNwbGl0SGlkZUNvbnRyb2xDb250YWluZXIgOiBDb250cm9sXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIENvbnRyb2wgQm9keTtcclxuICAgICAgICBwdWJsaWMgQ29udHJvbCBTbGlkZXI7XHJcbiAgICAgICAgcHVibGljIENvbnRyb2wgUGFuZWw7XHJcbiAgICAgICAgcHJpdmF0ZSBIVE1MU3BhbkVsZW1lbnQgc3BhbjtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgX3NsaWRlV2lkdGg7XHJcblxyXG4gICAgICAgIHB1YmxpYyBpbnQgU2xpZGVXaWR0aFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF9zbGlkZVdpZHRoOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfc2xpZGVXaWR0aCAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfc2xpZGVXaWR0aCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckNvbnRyb2woKTtcclxuICAgICAgICAgICAgICAgICAgICBSZXNpemVDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIFNsaWRlckxvY2F0aW9uIF9zbGlkZXJMb2NhdGlvbiA9IFNsaWRlckxvY2F0aW9uLkxlZnQ7XHJcblxyXG4gICAgICAgIHB1YmxpYyBTbGlkZXJMb2NhdGlvbiBTbGlkZXJMb2NhdGlvblxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF9zbGlkZXJMb2NhdGlvbjsgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoX3NsaWRlckxvY2F0aW9uICE9IHZhbHVlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9zbGlkZXJMb2NhdGlvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckNvbnRyb2woKTtcclxuICAgICAgICAgICAgICAgICAgICBSZXNpemVDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGJvb2wgX3NsaWRlclZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgU2xpZGVyVmlzaWJsZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF9zbGlkZXJWaXNpYmxlOyB9XHJcbiAgICAgICAgICAgIHNldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihfc2xpZGVyVmlzaWJsZSAhPSB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBfc2xpZGVyVmlzaWJsZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFJlbmRlckNvbnRyb2woKTtcclxuICAgICAgICAgICAgICAgICAgICBSZXNpemVDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGludCByZWZyZXNoSWQgPSAtMTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSB2b2lkIFJlc2l6ZUNoaWxkcmVuKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuTGlua2VkRm9ybSAhPSBudWxsICYmIHRoaXMuQ29udGVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihyZWZyZXNoSWQgIT0gLTEpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgR2xvYmFsLkNsZWFyVGltZW91dChyZWZyZXNoSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVmcmVzaElkID0gR2xvYmFsLlNldFRpbWVvdXQoKGdsb2JhbDo6U3lzdGVtLkFjdGlvbikoKCkgPT5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkxpbmtlZEZvcm0uUmVzaXplQ2hpbGRyZW4odGhpcy5Db250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoSWQgPSAtMTtcclxuICAgICAgICAgICAgICAgIH0pLCAxMDAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFNwbGl0SGlkZUNvbnRyb2xDb250YWluZXIoKSA6IGJhc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQm9keSA9IG5ldyBDb250cm9sKCk7XHJcbiAgICAgICAgICAgIFNsaWRlciA9IG5ldyBDb250cm9sKFwicHJpbWFyeVwiKTtcclxuICAgICAgICAgICAgUGFuZWwgPSBuZXcgQ29udHJvbCgpO1xyXG4gICAgICAgICAgICBzcGFuID0gU3BhbihcImZvcm0taGVhZGluZy10aXRsZVwiKTtcclxuICAgICAgICAgICAgc3Bhbi5UZXh0Q29udGVudCA9IFwiPlwiO1xyXG5cclxuICAgICAgICAgICAgc3Bhbi5TdHlsZS5Gb250V2VpZ2h0ID0gXCJib2xkXCI7XHJcbiAgICAgICAgICAgIHNwYW4uU3R5bGUuQ29sb3IgPSBcIndoaXRlXCI7XHJcblxyXG4gICAgICAgICAgICBTbGlkZXIuQ29udGVudC5BcHBlbmRDaGlsZChzcGFuKTtcclxuXHJcbiAgICAgICAgICAgIFNsaWRlci5Db250ZW50Lk9uTW91c2VFbnRlciA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU2xpZGVyLlN0eWxlLkZpbHRlciA9IFwiYnJpZ2h0bmVzcygxMTAlKVwiO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgU2xpZGVyLkNvbnRlbnQuT25Nb3VzZUxlYXZlID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTbGlkZXIuU3R5bGUuRmlsdGVyID0gXCJicmlnaHRuZXNzKDkwJSlcIjtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIFNsaWRlci5TdHlsZS5UcmFuc2l0aW9uID0gXCJ3aWR0aCAxcywgbGVmdCAxc1wiO1xyXG4gICAgICAgICAgICBCb2R5LlN0eWxlLlRyYW5zaXRpb24gPSBcImxlZnQgMXMsIHdpZHRoIDFzXCI7XHJcbiAgICAgICAgICAgIFBhbmVsLlN0eWxlLlRyYW5zaXRpb24gPSBcIndpZHRoIDFzXCI7XHJcblxyXG4gICAgICAgICAgICBTbGlkZXIuU3R5bGUuRmlsdGVyID0gXCJicmlnaHRuZXNzKDkwJSlcIjtcclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzcGFuLlN0eWxlLkZvbnRTdHlsZSA9IFwiMzZweFwiO1xyXG4gICAgICAgICAgICAgICAgU2xpZGVyLldpZHRoID0gNjU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzcGFuLlN0eWxlLkZvbnRTdHlsZSA9IFwiMjZweFwiO1xyXG4gICAgICAgICAgICAgICAgU2xpZGVyLldpZHRoID0gMzA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFNsaWRlci5IZWlnaHQgPSBcIjEwMCVcIjtcclxuXHJcbiAgICAgICAgICAgIFNsaWRlci5Db250ZW50Lk9uQ2xpY2sgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFNsaWRlclZpc2libGUgPSAhU2xpZGVyVmlzaWJsZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgX3NsaWRlV2lkdGggPSAyNTA7XHJcbiAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGRyZW4oUGFuZWwsIFNsaWRlciwgQm9keSk7XHJcblxyXG4gICAgICAgICAgICBSZW5kZXJDb250cm9sKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBSZW5kZXJDb250cm9sKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludCB3aWR0aDtcclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHdpZHRoID0gNjU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IDMwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihTbGlkZXJMb2NhdGlvbiA9PSBTbGlkZXJMb2NhdGlvbi5MZWZ0KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihTbGlkZXJWaXNpYmxlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwYW4uVGV4dENvbnRlbnQgPSBcIjxcIjtcclxuICAgICAgICAgICAgICAgICAgICBQYW5lbC5XaWR0aCA9IFNsaWRlV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgU2xpZGVyLkxlZnQgPSBTbGlkZVdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIEJvZHkuTG9jYXRpb24gPSBuZXcgVmVjdG9yMih3aWR0aCArIFNsaWRlV2lkdGgsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgIEJvZHkuU2l6ZSA9IG5ldyBWZWN0b3IyKFwiKDEwMCUgLSBcIiArICh3aWR0aCArIFNsaWRlV2lkdGgpICsgXCJweClcIiwgXCIxMDAlXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwYW4uVGV4dENvbnRlbnQgPSBcIj5cIjtcclxuICAgICAgICAgICAgICAgICAgICBTbGlkZXIuTGVmdCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgUGFuZWwuV2lkdGggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIEJvZHkuTG9jYXRpb24gPSBuZXcgVmVjdG9yMih3aWR0aCwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgQm9keS5TaXplID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIFwiICsgKHdpZHRoKSArIFwicHgpXCIsIFwiMTAwJVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBQYW5lbC5Mb2NhdGlvbiA9IG5ldyBWZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICAgICAgUGFuZWwuSGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudW0gU2xpZGVyTG9jYXRpb25cclxuICAgIHtcclxuICAgICAgICBMZWZ0LFxyXG4gICAgICAgIFJpZ2h0XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIFN5c3RlbTtcclxudXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWM7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBUYWJDb250cm9sIDogQ29udHJvbFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBMaXN0PFRhYkNvbnRyb2xQYWdlPiBUYWJQYWdlcyB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHJpdmF0ZSBDb250cm9sIHRhYkhlYWRlcnM7XHJcbiAgICAgICAgcHJpdmF0ZSBDb250cm9sIHRhYkhlYWRlckNvbnRhaW5lcjtcclxuXHJcbiAgICAgICAgcHVibGljIFRhYkNvbnRyb2woKSA6IGJhc2UoXCJ0YWJjb250cm9sXCIpXHJcbiAgICAgICAgeyAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBDb250ZW50Lk9uQ29udGV4dE1lbnUgPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGV2LlN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZXYuUHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEFkZFBhZ2VzKHBhcmFtcyBUYWJDb250cm9sUGFnZVtdIFBhZ2VzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgVGFiUGFnZXMuQWRkUmFuZ2UoUGFnZXMpO1xyXG4gICAgICAgICAgICBpZih0aGlzLkhhc1JlbmRlcmVkKVxyXG4gICAgICAgICAgICAgICAgUmVzaXplVGFiSGVhZGVycygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBib29sIHNob3dDbG9zZWRCdXR0b247XHJcblxyXG4gICAgICAgIHB1YmxpYyBib29sIFNob3dDbG9zZWRCdXR0b25cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0Nsb3NlZEJ1dHRvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUgIT0gc2hvd0Nsb3NlZEJ1dHRvbilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93Q2xvc2VkQnV0dG9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgUmVzaXplVGFiSGVhZGVycygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgQWN0aW9uPGludD4gT25TZWxlY3RlZFRhYkluZGV4Q2hhbmdlZCA9IG51bGw7XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW50IHNlbGVjdGVkaW5kZXggPSAwO1xyXG5cclxuICAgICAgICBwdWJsaWMgaW50IFNlbGVjdGVkSW5kZXhcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRpbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUgPCAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcclxuICAgICAgICAgICAgICAgIGlmKHNlbGVjdGVkaW5kZXggIT0gdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRpbmRleCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIE9uU2VsZWN0ZWRUYWJJbmRleENoYW5nZWQhPW51bGw/Z2xvYmFsOjpCcmlkZ2UuU2NyaXB0LkZyb21MYW1iZGEoKCk9Pk9uU2VsZWN0ZWRUYWJJbmRleENoYW5nZWQuSW52b2tlKHZhbHVlKSk6bnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihUYWJQYWdlcyAhPSBudWxsICYmIFRhYlBhZ2VzLkNvdW50ID4gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgVGFiUGFnZXMuQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYWdlID0gVGFiUGFnZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFRhYkNvbnRyb2xBY3RpdmVTdHlsZUNoYW5nZShpLCByZWYgcGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFRhYlBhZ2VzW2ldID0gcGFnZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgdm9pZCBUYWJDb250cm9sQWN0aXZlU3R5bGVDaGFuZ2UoaW50IGksIHJlZiBUYWJDb250cm9sUGFnZSBwYWdlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYm9vbCBJc3NlbGVjdGVkID0gaSA9PSBzZWxlY3RlZGluZGV4O1xyXG5cclxuICAgICAgICAgICAgc3RyaW5nIHN0YXRlID0gSXNzZWxlY3RlZCA/IFwiYWN0aXZlXCIgOiBcImhpZGRlblwiO1xyXG4gICAgICAgICAgICBpZihwYWdlLlRhYlBhZ2VIZWFkZXIgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyLkNsYXNzTGlzdC5SZW1vdmUoXCJ0YWJjb250cm9scGFnZWhlYWRlci1oaWRkZW5cIik7XHJcbiAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuQ2xhc3NMaXN0LlJlbW92ZShcInRhYmNvbnRyb2xwYWdlaGVhZGVyLWFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuQ2xhc3NMaXN0LkFkZChcInRhYmNvbnRyb2xwYWdlaGVhZGVyLVwiICsgc3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyID0gRGl2KFwidGFiY29udHJvbHBhZ2VoZWFkZXIgdGFiY29udHJvbHBhZ2VoZWFkZXItXCIgKyBzdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKElzc2VsZWN0ZWQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyLlN0eWxlLkxpbmVIZWlnaHQgPSBcIjQ0cHhcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuU3R5bGUuTGluZUhlaWdodCA9IFwiNDZweFwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyLlN0eWxlLkhlaWdodCA9IFwiNDVweFwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuU2V0QXR0cmlidXRlKFwiaVwiLCBpLlRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICBpZihzaG93Q2xvc2VkQnV0dG9uKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihwYWdlLlRhYlBhZ2VIZWFkZXJDbG9zZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2UuVGFiUGFnZUhlYWRlckNsb3NlID0gRGl2KFwidGFiY29udHJvbHBhZ2VoZWFkZXItY2xvc2VidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyQ2xvc2UuT25DbGljayA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IEdsb2JhbC5QYXJzZUludChldi5DdXJyZW50VGFyZ2V0LlBhcmVudEVsZW1lbnQuR2V0QXR0cmlidXRlKFwiaVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjcGFnZSA9IFRhYlBhZ2VzW2luZGV4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3BhZ2UuQ29udGVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcGFnZS5Db250ZW50LkVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcGFnZS5Db250ZW50LkRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNwYWdlLlRhYlBhZ2VIZWFkZXIgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3BhZ2UuVGFiUGFnZUhlYWRlci5FbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3BhZ2UuVGFiUGFnZUhlYWRlci5EZWxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBUYWJQYWdlcy5SZW1vdmUoY3BhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRleCA+IFRhYlBhZ2VzLkNvdW50IC0gMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gVGFiUGFnZXMuQ291bnQgLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZEluZGV4ID0gaW5kZXg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBSZXNpemVUYWJIZWFkZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuQXBwZW5kQ2hpbGQocGFnZS5UYWJQYWdlSGVhZGVyQ2xvc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYocGFnZS5UYWJQYWdlSGVhZGVyQ2xvc2UgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuUmVtb3ZlQ2hpbGQocGFnZS5UYWJQYWdlSGVhZGVyQ2xvc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwYWdlLkNvbnRlbnQuU3R5bGUuVmlzaWJpbGl0eSA9IElzc2VsZWN0ZWQgPyBWaXNpYmlsaXR5LkluaGVyaXQgOiBWaXNpYmlsaXR5LkNvbGxhcHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZvaWQgUmVzaXplVGFiSGVhZGVycygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0YWJIZWFkZXJzID09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRhYkhlYWRlcnMgPSBuZXcgQ29udHJvbChcInRhYmhlYWRlci1jb250YWluZXJcIikgeyBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKDAsIDApIH07XHJcbiAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0YWJIZWFkZXJzLkhlaWdodCA9IDQ3O1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYkhlYWRlckNvbnRhaW5lciA9IG5ldyBDb250cm9sKCkgeyBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKDAsIDApIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdGFiSGVhZGVyQ29udGFpbmVyLldpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFiSGVhZGVyQ29udGFpbmVyLkhlaWdodCA9IDUwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYkhlYWRlckNvbnRhaW5lci5BcHBlbmRDaGlsZCh0YWJIZWFkZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICB0YWJIZWFkZXJDb250YWluZXIuU3R5bGUuQmFja2dyb3VuZENvbG9yID0gXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYkhlYWRlckNvbnRhaW5lci5TdHlsZS5PdmVyZmxvd1ggPSBPdmVyZmxvdy5BdXRvO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0YWJIZWFkZXJzLlN0eWxlLk1pbldpZHRoID0gXCIxMDAlXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQodGFiSGVhZGVyQ29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0YWJIZWFkZXJzLkhlaWdodCA9IDIzO1xyXG4gICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQodGFiSGVhZGVycyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFiSGVhZGVycy5XaWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKFRhYlBhZ2VzICE9IG51bGwgJiYgVGFiUGFnZXMuQ291bnQgPiAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpbnQgd2lkdGggPSAyO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBUYWJQYWdlcy5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYWdlID0gVGFiUGFnZXNbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2UuUmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHBhZ2UuVGFiUGFnZUhlYWRlciA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVGFiQ29udHJvbEFjdGl2ZVN0eWxlQ2hhbmdlKGksIHJlZiBwYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyLk9uTW91c2VEb3duID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZEluZGV4ID0gR2xvYmFsLlBhcnNlSW50KGV2LkN1cnJlbnRUYXJnZXQuQXM8SFRNTERpdkVsZW1lbnQ+KCkuR2V0QXR0cmlidXRlKFwiaVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2UuVGFiUGFnZUhlYWRlci5PblRvdWNoU3RhcnQgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNlbGVjdGVkSW5kZXggPSBHbG9iYWwuUGFyc2VJbnQoZXYuQ3VycmVudFRhcmdldC5BczxIVE1MRGl2RWxlbWVudD4oKS5HZXRBdHRyaWJ1dGUoXCJpXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSGVhZGVycy5Db250ZW50LkFwcGVuZENoaWxkKHBhZ2UuVGFiUGFnZUhlYWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGQocGFnZS5Db250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZS5UYWJQYWdlSGVhZGVyLlNldEF0dHJpYnV0ZShcImlcIiwgaS5Ub1N0cmluZygpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaW50IGlud2lkdGggPSAyNDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPckVtcHR5KHBhZ2UuQ2FwdGlvbikpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW53aWR0aCArPSAoaW50KUdldFRleHRXaWR0aChwYWdlLkNhcHRpb24sIFwiMTRweCBUYWhvbWFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbndpZHRoICs9IChpbnQpR2V0VGV4dFdpZHRoKHBhZ2UuQ2FwdGlvbiwgU2V0dGluZ3MuRGVmYXVsdEZvbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihzaG93Q2xvc2VkQnV0dG9uKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW53aWR0aCArPSAxOTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgSFRNTFNwYW5FbGVtZW50IHNwYW4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcmVhY2godmFyIGl0ZW0gaW4gcGFnZS5UYWJQYWdlSGVhZGVyLkNoaWxkcmVuKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbSBpcyBIVE1MU3BhbkVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzcGFuID0gaXRlbS5BczxIVE1MU3BhbkVsZW1lbnQ+KCkpLklubmVySFRNTCA9IHBhZ2UuQ2FwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHNwYW4gPT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4gPSBuZXcgSFRNTFNwYW5FbGVtZW50KCkgeyBJbm5lckhUTUwgPSBwYWdlLkNhcHRpb24gfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2UuVGFiUGFnZUhlYWRlci5BcHBlbmRDaGlsZChzcGFuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFuLlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuU3R5bGUuTGVmdCA9IHdpZHRoLlRvUHgoKTtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlLlRhYlBhZ2VIZWFkZXIuU3R5bGUuV2lkdGggPSBpbndpZHRoLlRvUHgoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSAyNnB4KTtcclxuICAgICAgICAgICAgICAgICAgICAvL3RvcDogMjRweDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlLkhlaWdodCA9IFwiKDEwMCUgLSA0OXB4KVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlLlRvcCA9IDQ5O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggKz0gaW53aWR0aCArIDI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFRhYlBhZ2VzW2ldID0gcGFnZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYkhlYWRlcnMuV2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgUmVuZGVyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEhhc1JlbmRlcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgUmVzaXplVGFiSGVhZGVycygpO1xyXG4gICAgICAgIH1cclxuXG4gICAgXG5wcml2YXRlIExpc3Q8VGFiQ29udHJvbFBhZ2U+IF9fUHJvcGVydHlfX0luaXRpYWxpemVyX19UYWJQYWdlcz1uZXcgTGlzdDxUYWJDb250cm9sUGFnZT4oKTt9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBUYWJDb250cm9sUGFnZSA6IENvbnRyb2xcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgaW50IGluZGV4O1xyXG5cclxuICAgICAgICBwdWJsaWMgVGFiQ29udHJvbFBhZ2UoKSA6IGJhc2UoXCJ0YWJjb250cm9scGFnZVwiKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBIVE1MRGl2RWxlbWVudCBUYWJQYWdlSGVhZGVyID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgSFRNTERpdkVsZW1lbnQgVGFiUGFnZUhlYWRlckNsb3NlID0gbnVsbDtcclxuICAgICAgICBwdWJsaWMgc3RyaW5nIENhcHRpb24geyBnZXQ7IHNldDsgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlO1xyXG51c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgVGlsZUNvbnRyb2wgOiBDb250cm9sLCBJUGFnZXNcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgTGlzdDxSaWJib25QYWdlPiBSaWJib25QYWdlcyB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHJpdmF0ZSBUaWxlVmlld1N0YXRlIF92aWV3U3RhdGUgPSBUaWxlVmlld1N0YXRlLkhpZGRlbjtcclxuICAgICAgICBwcml2YXRlIFVuaW9uPHN0cmluZywgT3ZlcmZsb3c+IHByZXZPdmVyRmxvdyA9IG51bGw7XHJcbiAgICAgICAgcHJpdmF0ZSBpbnQgQ2xlYXJUaW1lT3V0ID0gLTE7XHJcblxyXG4gICAgICAgIHB1YmxpYyBUaWxlVmlld1N0YXRlIFZpZXdTdGF0ZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIF92aWV3U3RhdGU7IH1cclxuICAgICAgICAgICAgc2V0XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKENsZWFyVGltZU91dCAhPSAtMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBHbG9iYWwuQ2xlYXJUaW1lb3V0KENsZWFyVGltZU91dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xlYXJUaW1lT3V0ID0gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih2YWx1ZSAhPSBfdmlld1N0YXRlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF92aWV3U3RhdGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZihfdmlld1N0YXRlID09IFRpbGVWaWV3U3RhdGUuSGlkZGVuKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2xlYXJUaW1lT3V0ID0gR2xvYmFsLlNldFRpbWVvdXQoKGdsb2JhbDo6U3lzdGVtLkFjdGlvbikoKCkgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudC5TdHlsZS5WaXNpYmlsaXR5ID0gVmlzaWJpbGl0eS5IaWRkZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCAxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTG9jYXRpb24gPSBuZXcgVmVjdG9yMihcIigxMDAlICogLTEpXCIsIDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoQ29udGVudC5QYXJlbnRFbGVtZW50ICE9IG51bGwgJiYgcHJldk92ZXJGbG93ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQuUGFyZW50RWxlbWVudC5TdHlsZS5PdmVyZmxvdyA9IHByZXZPdmVyRmxvdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkluaGVyaXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJlbmRlclRpbGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKENvbnRlbnQuUGFyZW50RWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2T3ZlckZsb3cgPSBDb250ZW50LlBhcmVudEVsZW1lbnQuU3R5bGUuT3ZlcmZsb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50LlBhcmVudEVsZW1lbnQuU3R5bGUuT3ZlcmZsb3cgPSBPdmVyZmxvdy5IaWRkZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFJlbmRlclRpbGVzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludCB4ID0gMDtcclxuICAgICAgICAgICAgaW50IHkgPSA2O1xyXG5cclxuICAgICAgICAgICAgdmFyIGRvYyA9IERvY3VtZW50LkNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuICAgICAgICAgICAgdmFyIGRpdiA9IG5ldyBDb250cm9sKCk7XHJcbiAgICAgICAgICAgIGRpdi5XaWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgICAgICBkaXYuU2V0TG9jYXRpb24oMCwgMCk7XHJcbiAgICAgICAgICAgIGRpdi5TdHlsZS5aSW5kZXggPSBcIjEwXCI7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGl2MiA9IG5ldyBDb250cm9sKFwicHJpbWFyeVwiKTtcclxuICAgICAgICAgICAgZGl2Mi5XaWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgICAgICBkaXYyLlN0eWxlLk1pbkhlaWdodCA9IFwiMTAwJVwiO1xyXG4gICAgICAgICAgICBkaXYyLlNldExvY2F0aW9uKDAsIDApO1xyXG4gICAgICAgICAgICBkaXYyLlN0eWxlLkZpbHRlciA9IFwiYnJpZ2h0bmVzcyg1MCUpXCI7XHJcblxyXG4gICAgICAgICAgICBkaXYyLlN0eWxlLk9wYWNpdHkgPSBcIjAuOVwiO1xyXG4gICAgICAgICAgICBkaXYyLlN0eWxlLlpJbmRleCA9IFwiOVwiO1xyXG5cclxuICAgICAgICAgICAgZm9yZWFjaCh2YXIgcGFnZSBpbiBSaWJib25QYWdlcylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIXN0cmluZy5Jc051bGxPcldoaXRlU3BhY2UocGFnZS5DYXB0aW9uKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGxiID0gQ29udHJvbC5MYWJlbChwYWdlLkNhcHRpb24sIDYsIHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxsYi5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGxsYi5TdHlsZS5Db2xvciA9IFwid2hpdGVcIjtcclxuICAgICAgICAgICAgICAgICAgICBkb2MuQXBwZW5kQ2hpbGQobGxiKTtcclxuICAgICAgICAgICAgICAgICAgICB5ICs9IDI2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZvcmVhY2godmFyIGdyb3VwIGluIHBhZ2UuUmliYm9uR3JvdXBzKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcmVhY2godmFyIGJ1dHRvbiBpbiBncm91cC5CdXR0b25zKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLkV4Y2hhbmdlQ2xhc3MoXCJyaWJib25idXR0b25zbWFsbFwiLCBcInJpYmJvbmJ1dHRvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLlN0eWxlLkJvcmRlclJhZGl1cyA9IFwiNHB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5BZnRlckl0ZW1DbGljayA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld1N0YXRlID0gVGlsZVZpZXdTdGF0ZS5IaWRkZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJ1dHRvbi5FbmFibGVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uRXhjaGFuZ2VDbGFzcyhcInByaW1hcnlcIiwgXCJwcmltYXJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLlN0eWxlLkJvcmRlciA9IFwiMFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLlN0eWxlLkZpbHRlciA9IFwiYnJpZ2h0bmVzcygxMTAlKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLkV4Y2hhbmdlQ2xhc3MoXCJwcmltYXJ5XCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLlN0eWxlLkJvcmRlciA9IFwiMXB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uU3R5bGUuRmlsdGVyID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uU3R5bGUuT3BhY2l0eSA9IFwiMVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uU3R5bGUuQm94U2hhZG93ID0gXCIwcHggMHB4IDEwcHggLTJweCByZ2JhKDAsMCwwLDAuMjUpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5Jc1NtYWxsQ2FwdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uUHJvY2Vzc0NhcHRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLlByb2Nlc3NJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uU2l6ZSA9IG5ldyBWZWN0b3IyKFwiKCgxMDAlIC0gMjRweCkgKiAwLjMzKVwiLCAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uTG9jYXRpb24gPSBuZXcgVmVjdG9yMihcIigoKDEwMCUgLSAyNHB4KSAqIChcIiArICh4ICogMC4zM20pICsgXCIpKSArIChcIiArICg2ICogKHgpKSArIFwicHgpICsgNnB4KVwiLCB5KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJ1dHRvbi5jYXB0aW9uRGl2ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJ1dHRvbi5FbmFibGVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5jYXB0aW9uRGl2LlN0eWxlLkNvbG9yID0gXCJ3aGl0ZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5jYXB0aW9uRGl2LlN0eWxlLkNvbG9yID0gXCJncmV5XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmNhcHRpb25EaXYuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5jYXB0aW9uRGl2LlN0eWxlLlRvcCA9IFwiNjVweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihidXR0b24uaW1hZ2VEaXYgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmltYWdlRGl2LkV4Y2hhbmdlQ2xhc3MoXCJyaWJib25idXR0b25zbWFsbGljb25cIiwgXCJyaWJib25idXR0b25pY29uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLkljb25VUkwgPSAoYnV0dG9uLkljb25VUkwgKyBcIlwiKS5SZXBsYWNlKFwieDE2eDE2XCIsIFwieDMyeDMyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmltYWdlRGl2LlN0eWxlLlRvcCA9IFwiMjdweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYnV0dG9uLkVuYWJsZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gIGJ1dHRvbi5pbWFnZURpdi5TdHlsZS5GaWx0ZXIgPSBcImJyaWdodG5lc3MoOTAlKSBncmF5c2NhbGUoMTAwJSkgY29udHJhc3QoNjAlKSBicmlnaHRuZXNzKDE4MCUpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gIGJ1dHRvbi5pbWFnZURpdi5TdHlsZS5GaWx0ZXIgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih4ID09IDIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSArPSAxMDY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLlN0eWxlLk9wYWNpdHkgPSBcIjFcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jLkFwcGVuZENoaWxkKGJ1dHRvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKHggIT0gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB5ICs9IDEwNjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGl2LkhlaWdodCA9IHk7XHJcbiAgICAgICAgICAgIGRpdjIuSGVpZ2h0ID0geTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuRW1wdHkoKTtcclxuICAgICAgICAgICAgZGl2LkNvbnRlbnQuQXBwZW5kQ2hpbGQoZG9jKTtcclxuXHJcbiAgICAgICAgICAgIGRpdjIuQ29udGVudC5Pbk1vdXNlRG93biA9IChldikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZXYuU3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKGRpdjIpO1xyXG4gICAgICAgICAgICBDb250ZW50LkFwcGVuZENoaWxkKGRpdik7XHJcblxyXG4gICAgICAgICAgICBkaXYuQ29udGVudC5DbGljaygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgUmVuZGVyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuUmVuZGVyKCk7XHJcbiAgICAgICAgICAgIFJlbmRlclRpbGVzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgVGlsZUNvbnRyb2woKSA6IGJhc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU3R5bGUuT3ZlcmZsb3dZID0gT3ZlcmZsb3cuQXV0bztcclxuICAgICAgICAgICAgTG9jYXRpb24gPSBuZXcgVmVjdG9yMihcIigxMDAlICogLTEpXCIsIDApO1xyXG4gICAgICAgICAgICBTaXplID0gbmV3IFZlY3RvcjIoXCIxMDAlXCIsIFwiMTAwJVwiKTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuU3R5bGUuQmFja2dyb3VuZENvbG9yID0gXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgICAgICAgICBDb250ZW50LlN0eWxlLlZpc2liaWxpdHkgPSBWaXNpYmlsaXR5LkhpZGRlbjtcclxuICAgICAgICAgICAgQ29udGVudC5TdHlsZS5UcmFuc2l0aW9uID0gXCJsZWZ0IDFzIGVhc2VcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEFkZFJpYmJvblBhZ2VzKHBhcmFtcyBSaWJib25QYWdlW10gcGFnZXMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihwYWdlcyAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgUmliYm9uUGFnZXMuQWRkUmFuZ2UocGFnZXMpO1xyXG4gICAgICAgIH1cclxuXG4gICAgXG5wcml2YXRlIExpc3Q8UmliYm9uUGFnZT4gX19Qcm9wZXJ0eV9fSW5pdGlhbGl6ZXJfX1JpYmJvblBhZ2VzPW5ldyBMaXN0PFJpYmJvblBhZ2U+KCk7fVxyXG5cclxuICAgIHB1YmxpYyBlbnVtIFRpbGVWaWV3U3RhdGVcclxuICAgIHtcclxuICAgICAgICBIaWRkZW4sXHJcbiAgICAgICAgVmlzaWJsZVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBGb3JtUG9wdXAgOiBGb3JtXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIGludCBQcmV2aW91c1Njcm9sbFRvcDtcclxuICAgICAgICBwdWJsaWMgSFRNTEVsZW1lbnQgUGFyZW50Q29udGFpbmVyO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIFZlY3RvcjIgR2V0UG9wdXBEZWZhdWx0TG9jYXRpb24oQ29udHJvbCBjb250cm9sLCBib29sIGlzQ29udHJvbENoaWxkID0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVmVjdG9yMigwLCAwKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGlzQ29udHJvbENoaWxkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVjID0gY29udHJvbC5Db250ZW50LlBhcmVudEVsZW1lbnQuR2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIoKGZsb2F0KXJlYy5MZWZ0LCAoZmxvYXQpKHJlYy5Ub3AgKyByZWMuSGVpZ2h0KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVjID0gY29udHJvbC5Db250ZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyKChmbG9hdClyZWMuTGVmdCwgKGZsb2F0KShyZWMuVG9wICsgcmVjLkhlaWdodCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgRm9ybVBvcHVwKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIEhlYWRpbmcuU3R5bGUuRGlzcGxheSA9IERpc3BsYXkuTm9uZTtcclxuICAgICAgICAgICAgQm9keS5TZXRMb2NhdGlvbigwLCAwKTtcclxuICAgICAgICAgICAgQm9keS5TZXRTaXplKFwiMTAwJVwiLCBcIjEwMCVcIik7XHJcbiAgICAgICAgICAgIENvbnRlbnQuQ2xhc3NMaXN0LkFkZChcImlucHV0Y29udHJvbFwiKTtcclxuICAgICAgICAgICAgQ29udGVudC5DbGFzc0xpc3QuUmVtb3ZlKFwiZm9ybS1iYXNlXCIpO1xyXG4gICAgICAgICAgICBDb250ZW50LlN0eWxlLkJveFNoYWRvdyA9IFwiMCAwIDYzcHggLTE3cHggcmdiYSgwLDAsMCwwLjc1KVwiO1xyXG5cclxuICAgICAgICAgICAgU3RhcnRQb3NpdGlvbiA9IEZvcm1TdGFydFBvc2l0aW9uLk1hbnVhbDtcclxuXHJcbiAgICAgICAgICAgIFNob3dDbG9zZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBTaG93TWF4aW1pemUgPSBmYWxzZTtcclxuICAgICAgICAgICAgU2hvd01pbmltaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgIEFsbG93TW92ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBBbGxvd1NpemVDaGFuZ2UgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIFNob3dQb3B1cChWZWN0b3IyIGxvY2F0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5Mb2NhdGlvbiA9IGxvY2F0aW9uO1xyXG4gICAgICAgICAgICBTaG93RGlhbG9nKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHZvaWQgTW92ZUZvcm1VcCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLkxvY2F0aW9uID0gbmV3IFZlY3RvcjIodGhpcy5MZWZ0LCB0aGlzLlRvcC5Ub0Zsb2F0KCkgLSB0aGlzLkhlaWdodC5Ub0Zsb2F0KCkgLSAyMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPblNob3dlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uU2hvd2VkKCk7XHJcblxyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgQWxsb3dTaXplQ2hhbmdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIFdpbmRvd1N0YXRlID0gV2luZG93U3RhdGVUeXBlLk1heGltaXplZDtcclxuICAgICAgICAgICAgICAgIEFsbG93U2l6ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBDb250ZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlY3QuQm90dG9tID4gV2luZG93LklubmVySGVpZ2h0IHx8IHJlY3QuQm90dG9tID4gRG9jdW1lbnQuRG9jdW1lbnRFbGVtZW50LkNsaWVudEhlaWdodClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vdmVGb3JtVXAoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaChFeGNlcHRpb24pXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uQ2xvc2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25DbG9zZWQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJuYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBDb2xvcklucHV0IDogVGV4dElucHV0XHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIENvbG9ySW5wdXQoKSA6IGJhc2UoQnJpZGdlLkh0bWw1LklucHV0VHlwZS5Db2xvcilcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgQ29uc29sZUZvcm0gOiBGb3JtXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIHN0YXRpYyBib29sIENvbnNvbGVWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgQ29uc29sZUZvcm0gX2NvbnNvbGVGb3JtID0gbnVsbDtcclxuICAgICAgICBwcml2YXRlIEhUTUxEaXZFbGVtZW50IGxvZ0NvbnRlbnQgPSBudWxsO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIFdpbmRvd1N0YXRlVHlwZSBwcmV2V2luZG93U3RhdGUgPSBXaW5kb3dTdGF0ZVR5cGUuTm9ybWFsO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGJvb2wgZmlyc3RMb2FkID0gdHJ1ZTtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBWZWN0b3IyIHByZXZMb2NhdGlvbjtcclxuICAgICAgICBwcml2YXRlIHN0YXRpYyBWZWN0b3IyIHByZXZTaXplID0gU2V0dGluZ3MuQ29uc29sZURlZmF1bHRTaXplO1xyXG5cclxuICAgICAgICBwdWJsaWMgdm9pZCBJbnRlcm5hbENsZWFyKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxvZ0NvbnRlbnQuRW1wdHkoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2b2lkIEludGVybmFsTG9nKHN0cmluZyBzb3VyY2UsIENvbnNvbGVMb2dUeXBlIGxvZ1R5cGUgPSBDb25zb2xlTG9nVHlwZS5Mb2cpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgcGFyYSA9IG5ldyBIVE1MUGFyYWdyYXBoRWxlbWVudCgpIHsgQ2xhc3NOYW1lID0gXCJjb25zb2xlLXBhcmFcIiB9O1xyXG4gICAgICAgICAgICBzd2l0Y2gobG9nVHlwZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDb25zb2xlTG9nVHlwZS5EZWJ1ZzpcclxuICAgICAgICAgICAgICAgICAgICBwYXJhLlN0eWxlLkNvbG9yID0gQ29sb3IuRm9yZXN0R3JlZW47XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBDb25zb2xlTG9nVHlwZS5FcnJvcjpcclxuICAgICAgICAgICAgICAgICAgICBwYXJhLlN0eWxlLkNvbG9yID0gQ29sb3IuUmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwYXJhLklubmVySFRNTCA9IHNvdXJjZTtcclxuICAgICAgICAgICAgbG9nQ29udGVudC5BcHBlbmRDaGlsZChwYXJhKTtcclxuICAgICAgICAgICAgaWYobG9nQ29udGVudC5DaGlsZHJlbi5MZW5ndGggPiAxMDAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBsb2dDb250ZW50LlJlbW92ZUNoaWxkKGxvZ0NvbnRlbnQuQ2hpbGRyZW5bMF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmEuU2Nyb2xsSW50b1ZpZXcoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25Hb3RGb2N1cygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihDb250ZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFN0eWxlLk9wYWNpdHkgPSBcIjFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiYXNlLk9uR290Rm9jdXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uTG9zdEZvY3VzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKENvbnRlbnQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU3R5bGUuT3BhY2l0eSA9IFwiMC41XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYmFzZS5Pbkxvc3RGb2N1cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIENvbnNvbGVGb3JtKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxvZ0NvbnRlbnQgPSBEaXYoXCJjb25zb2xlLWJvZHlcIik7XHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5BcHBlbmRDaGlsZChsb2dDb250ZW50KTtcclxuICAgICAgICAgICAgdGhpcy5Cb2R5LlN0eWxlLkJhY2tncm91bmQgPSBDb2xvci5CbGFjaztcclxuICAgICAgICAgICAgdGhpcy5Cb2R5LlN0eWxlLk92ZXJmbG93WSA9IE92ZXJmbG93LlNjcm9sbDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuVGV4dCA9IERvY3VtZW50LlRpdGxlICsgXCIgLSBDb25zb2xlXCI7XHJcbiAgICAgICAgICAgIGlmKGZpcnN0TG9hZClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5TdGFydFBvc2l0aW9uID0gRm9ybVN0YXJ0UG9zaXRpb24uQ2VudGVyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5TaXplID0gcHJldlNpemU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLlN0YXJ0UG9zaXRpb24gPSBGb3JtU3RhcnRQb3NpdGlvbi5NYW51YWw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkxvY2F0aW9uID0gcHJldkxvY2F0aW9uO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHByZXZXaW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZTaXplID0gU2V0dGluZ3MuQ29uc29sZURlZmF1bHRTaXplO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuU2l6ZSA9IHByZXZTaXplO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHByZXZXaW5kb3dTdGF0ZSA9PSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFNldFdpbmRvd1N0YXRlKHByZXZXaW5kb3dTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uU2hvd2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25TaG93ZWQoKTtcclxuICAgICAgICAgICAgQ29uc29sZVZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICBmaXJzdExvYWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uQ2xvc2luZygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uQ2xvc2luZygpO1xyXG5cclxuICAgICAgICAgICAgcHJldlNpemUgPSBTaXplO1xyXG4gICAgICAgICAgICBwcmV2TG9jYXRpb24gPSBMb2NhdGlvbjtcclxuICAgICAgICAgICAgcHJldldpbmRvd1N0YXRlID0gV2luZG93U3RhdGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPbkNsb3NlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uQ2xvc2VkKCk7XHJcbiAgICAgICAgICAgIENvbnNvbGVWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHN0YXRpYyB2b2lkIENoZWNrQ29uc29sZVN0YXRlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKCFDb25zb2xlVmlzaWJsZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgX2NvbnNvbGVGb3JtID0gbmV3IENvbnNvbGVGb3JtKCk7XHJcbiAgICAgICAgICAgICAgICBfY29uc29sZUZvcm0uU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIExvZyhzdHJpbmcgc291cmNlLCBDb25zb2xlTG9nVHlwZSBsb2dUeXBlID0gQ29uc29sZUxvZ1R5cGUuTG9nKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ2hlY2tDb25zb2xlU3RhdGUoKTtcclxuICAgICAgICAgICAgX2NvbnNvbGVGb3JtLkludGVybmFsTG9nKHNvdXJjZSwgbG9nVHlwZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgQ2xlYXIoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQ2hlY2tDb25zb2xlU3RhdGUoKTtcclxuICAgICAgICAgICAgX2NvbnNvbGVGb3JtLkludGVybmFsQ2xlYXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudW0gQ29uc29sZUxvZ1R5cGVcclxuICAgIHtcclxuICAgICAgICBMb2csXHJcbiAgICAgICAgRGVidWcsXHJcbiAgICAgICAgRXJyb3JcclxuICAgIH1cclxufSIsInVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgRGlhbG9nRm9ybSA6IEZvcm1cclxuICAgIHtcclxuICAgICAgICBwcm90ZWN0ZWQgTGlzdDxTaW1wbGVEaWFsb2dCdXR0b24+IF9idXR0b25Db2xsZWN0aW9uO1xyXG5cclxuICAgICAgICBwdWJsaWMgQ29udHJvbCBCdXR0b25TZWN0aW9uO1xyXG5cclxuICAgICAgICBwdWJsaWMgRGlhbG9nRm9ybShzdHJpbmcgdGV4dCA9IFwiXCIpIDogYmFzZSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLlRleHQgPSB0ZXh0O1xyXG4gICAgICAgICAgICBiYXNlLkJvZHkuU3R5bGUuQmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xyXG5cclxuICAgICAgICAgICAgLy8gICAgICAgICAgIHRvcDpjYWxjKDEwMCUgLSA3MHB4KTtcclxuICAgICAgICAgICAgLy93aWR0aDoxMDAlO1xyXG4gICAgICAgICAgICAvL2hlaWdodDo3MHB4O1xyXG5cclxuICAgICAgICAgICAgQnV0dG9uU2VjdGlvbiA9IG5ldyBDb250cm9sKFwiZGlhbG9nYnV0dG9uc2VjdGlvblwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBCdXR0b25TZWN0aW9uLlRvcCA9IFwiKDEwMCUgLSA3MHB4KVwiO1xyXG4gICAgICAgICAgICAgICAgQnV0dG9uU2VjdGlvbi5TaXplID0gbmV3IFZlY3RvcjIoXCIxMDAlXCIsIDcwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25TaG93aW5nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5BcHBlbmRDaGlsZChCdXR0b25TZWN0aW9uKTtcclxuICAgICAgICAgICAgYmFzZS5PblNob3dpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBUZXh0SW5wdXREcm9wRG93biA6IFRleHRJbnB1dFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVCdXR0b24gRHJvcERvd25CdXR0b247XHJcbiAgICAgICAgcHVibGljIFRleHRJbnB1dCBVc2VkRWRpdDtcclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHN0cmluZyBHZXREaXNwbGF5Rm9ybWF0KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBVc2VkRWRpdC5HZXREaXNwbGF5Rm9ybWF0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCBmbG9hdCBHZXREcm9wZG93bldpZHRoKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZmxvYXQpdGhpcy5Db250ZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLldpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgU2V0RGlzcGxheUZvcm1hdChzdHJpbmcgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBVc2VkRWRpdC5TZXREaXNwbGF5Rm9ybWF0KHZhbHVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSB2b2lkIE9uRm9jdXMoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgVXNlZEVkaXQuRm9jdXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSBIVE1MSW5wdXRFbGVtZW50IEdldElucHV0KClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBVc2VkRWRpdC5HZXRJbnB1dCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFRleHRJbnB1dERyb3BEb3duKElucHV0VHlwZSBpbnB1dFR5cGUgPSBJbnB1dFR5cGUuVGV4dCkgOiBiYXNlKG5ldyBIVE1MRGl2RWxlbWVudCgpLCB0cnVlLCBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludCBkcm9wRG93bldpZHRoID0gMTc7XHJcblxyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZHJvcERvd25XaWR0aCA9IDQ1O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBUeXBlID0gaW5wdXRUeXBlO1xyXG5cclxuICAgICAgICAgICAgVXNlZEVkaXQgPSBuZXcgVGV4dElucHV0KGlucHV0VHlwZSkgeyBEaXNhYmxlRm9jdXNQb3B1cCA9IHRydWUsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoMCwgMCksIFNpemUgPSBuZXcgVmVjdG9yMihcIigxMDAlIC0gXCIgKyAoZHJvcERvd25XaWR0aCAtIDEpICsgXCJweClcIiwgXCIxMDAlXCIpIH07XHJcbiAgICAgICAgICAgIFVzZWRFZGl0Lk9uVGV4dENoYW5nZWQgPSAoc2VuZGVyKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihPblRleHRDaGFuZ2VkICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgT25UZXh0Q2hhbmdlZChzZW5kZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgX2Rpc3BsYXlGb3JtYXQgPSBVc2VkRWRpdC5EaXNwbGF5Rm9ybWF0O1xyXG5cclxuICAgICAgICAgICAgRHJvcERvd25CdXR0b24gPSBuZXcgU2ltcGxlQnV0dG9uKCkgeyBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKDEwMCUgLSBcIiArIGRyb3BEb3duV2lkdGggKyBcInB4KVwiLCAwKSwgU2l6ZSA9IG5ldyBWZWN0b3IyKGRyb3BEb3duV2lkdGgsIFwiMTAwJVwiKSB9O1xyXG4gICAgICAgICAgICBEcm9wRG93bkJ1dHRvbi5Db250ZW50Lk9uTW91c2VEb3duID0gKGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZighUmVhZG9ubHkgJiYgRW5hYmxlZClcclxuICAgICAgICAgICAgICAgICAgICBPbkRyb3BEb3duQ2xpY2tlZChldik7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBTdHlsZS5Cb3JkZXIgPSBcIjBcIjtcclxuXHJcbiAgICAgICAgICAgIERyb3BEb3duQnV0dG9uLkNsYXNzTGlzdC5BZGQoXCJkcm9wZG93blwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBEcm9wRG93bkJ1dHRvbi5TdHlsZS5CYWNrZ3JvdW5kUG9zaXRpb24gPSBcInJpZ2h0IDE2cHggY2VudGVyXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuQXBwZW5kQ2hpbGRyZW4oVXNlZEVkaXQsIERyb3BEb3duQnV0dG9uKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSBzdHJpbmcgR2V0VmFsdWUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIFVzZWRFZGl0LlRleHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBTZXRWYWx1ZShzdHJpbmcgdmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBVc2VkRWRpdC5UZXh0ID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIE9uRHJvcERvd25DbGlja2VkKE1vdXNlRXZlbnQgbW91c2VFdmVudClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBNZW1vSW5wdXQgOiBUZXh0SW5wdXRcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgaW50IFJvd3NcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBDb250ZW50LkFzPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KCkuUm93czsgfVxyXG4gICAgICAgICAgICBzZXQgeyBDb250ZW50LkFzPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KCkuUm93cyA9IHZhbHVlOyB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgaW50IENvbHNcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldCB7IHJldHVybiBDb250ZW50LkFzPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KCkuQ29sczsgfVxyXG4gICAgICAgICAgICBzZXQgeyBDb250ZW50LkFzPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KCkuQ29scyA9IHZhbHVlOyB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIFZlY3RvcjIgUHJlU2l6ZTtcclxuICAgICAgICBwcml2YXRlIFZlY3RvcjIgUHJlUHJlU2l6ZTtcclxuICAgICAgICBwcml2YXRlIHN0cmluZyBQcmVaSW5kZXg7XHJcbiAgICAgICAgcHJpdmF0ZSBib29sIF9oYXNHb3RGb2N1cztcclxuXHJcbiAgICAgICAgcHVibGljIGJvb2wgRGlzYWJsZVJlc2l6ZSB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSBzdHJpbmcgR2V0VmFsdWUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIENvbnRlbnQuQXM8SFRNTFRleHRBcmVhRWxlbWVudD4oKS5WYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBvdmVycmlkZSB2b2lkIFNldFZhbHVlKHN0cmluZyB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENvbnRlbnQuQXM8SFRNTFRleHRBcmVhRWxlbWVudD4oKS5WYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIE1lbW9JbnB1dCgpIDogYmFzZShuZXcgSFRNTFRleHRBcmVhRWxlbWVudCgpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU3R5bGUuUmVzaXplID0gUmVzaXplLk5vbmU7XHJcblxyXG4gICAgICAgICAgICBPbkdvdEZvY3VzID0gKG1lbW8pID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKERpc2FibGVSZXNpemUpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIFN0eWxlLlJlc2l6ZSA9IFJlc2l6ZS5Cb3RoO1xyXG4gICAgICAgICAgICAgICAgUHJlUHJlU2l6ZSA9IFNpemU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoX2hhc0dvdEZvY3VzKVxyXG4gICAgICAgICAgICAgICAgICAgIFNpemUgPSBQcmVTaXplO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIF9oYXNHb3RGb2N1cyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgUHJlU2l6ZSA9IFNpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIE9uTG9zdEZvY3VzID0gKG1lbW8pID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFN0eWxlLlJlc2l6ZSA9IFJlc2l6ZS5Ob25lO1xyXG4gICAgICAgICAgICAgICAgUHJlU2l6ZSA9IFNpemU7XHJcbiAgICAgICAgICAgICAgICBTaXplID0gUHJlUHJlU2l6ZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2U7XHJcbnVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIFBERlByZXZpZXdGb3JtIDogRm9ybVxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgU291cmNlO1xyXG4gICAgICAgIHB1YmxpYyBQZGZTb3VyY2VUeXBlIFBERlNvdXJjZVR5cGU7XHJcbiAgICAgICAgcHVibGljIEhUTUxFbGVtZW50IFBkZlZpZXdlcjtcclxuXHJcbiAgICAgICAgcHVibGljIFBERlByZXZpZXdGb3JtKHN0cmluZyBzb3VyY2UsIFBkZlNvdXJjZVR5cGUgcGRmU291cmNlVHlwZSA9IFBkZlNvdXJjZVR5cGUuVXJsKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgU291cmNlID0gc291cmNlO1xyXG4gICAgICAgICAgICBQREZTb3VyY2VUeXBlID0gcGRmU291cmNlVHlwZTtcclxuXHJcbiAgICAgICAgICAgIFBkZlZpZXdlciA9IERvY3VtZW50LkNyZWF0ZUVsZW1lbnQoQnJvd3Nlci5Jc0lFID8gXCJpZnJhbWVcIiA6IHBkZlNvdXJjZVR5cGUgPT0gUGRmU291cmNlVHlwZS5VcmwgPyBcImVtYmVkXCIgOiBcIm9iamVjdFwiKTtcclxuICAgICAgICAgICAgUGRmVmlld2VyLkNsYXNzTmFtZSA9IFwiY29udHJvbFwiO1xyXG5cclxuICAgICAgICAgICAgUGRmVmlld2VyLlNldEJvdW5kcygwLCAwLCBcIjEwMCVcIiwgXCIxMDAlXCIpO1xyXG4gICAgICAgICAgICBQZGZWaWV3ZXIuU2V0QXR0cmlidXRlKFwiYWx0XCIsIFwicGRmXCIpO1xyXG4gICAgICAgICAgICBQZGZWaWV3ZXIuU2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImFwcGxpY2F0aW9uL3BkZlwiKTtcclxuICAgICAgICAgICAgLy9vYmplY3RcclxuXHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5BcHBlbmRDaGlsZChQZGZWaWV3ZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25TaG93aW5nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25TaG93aW5nKCk7XHJcbiAgICAgICAgICAgIC8vZGF0YVxyXG4gICAgICAgICAgICBpZihQREZTb3VyY2VUeXBlID09IFBkZlNvdXJjZVR5cGUuVXJsKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBQZGZWaWV3ZXIuU2V0QXR0cmlidXRlKFwiU3JjXCIsIFNvdXJjZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBQZGZWaWV3ZXIuU2V0QXR0cmlidXRlKFwiZGF0YVwiLCBHZXRQZGZTdHJpbmcoU291cmNlKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudW0gUGRmU291cmNlVHlwZVxyXG4gICAge1xyXG4gICAgICAgIFVybCxcclxuICAgICAgICBCYXNlNjRcclxuICAgIH1cclxufSIsIm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIFNpbXBsZURpYWxvZ0J1dHRvbiA6IFNpbXBsZUJ1dHRvblxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBTaW1wbGVEaWFsb2dCdXR0b24oRm9ybSBwYXJlbnRGb3JtLCBEaWFsb2dSZXN1bHRFbnVtIGRpYWxvZ1Jlc3VsdCA9IERpYWxvZ1Jlc3VsdEVudW0uTm9uZSkgOiBiYXNlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuUGFyZW50Rm9ybSA9IHBhcmVudEZvcm07XHJcbiAgICAgICAgICAgIHRoaXMuRGlhbG9nUmVzdWx0ID0gZGlhbG9nUmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5TZXRTaXplKDc1LCAyMyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwibmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgQ2FsY0Zvcm0gOiBGb3JtUG9wdXBcclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgVGV4dElucHV0IElucHV0Q29udHJvbDtcclxuXHJcbiAgICAgICAgcHVibGljIENhbGN1bGF0b3JDb250cm9sIENhbENvbnRyb2w7XHJcbiAgICAgICAgcHVibGljIGJvb2wgQ2xpY2tlZENsb3NlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHB1YmxpYyBDYWxjRm9ybShUZXh0SW5wdXQgaW5wdXRDb250cm9sKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoaW5wdXRDb250cm9sLkNvbnRlbnQuUGFyZW50RWxlbWVudCAhPSBudWxsICYmIGlucHV0Q29udHJvbC5Db250ZW50LlBhcmVudEVsZW1lbnQuUGFyZW50RWxlbWVudCAhPSBudWxsICYmIGlucHV0Q29udHJvbC5Db250ZW50LlBhcmVudEVsZW1lbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFByZXZpb3VzU2Nyb2xsVG9wID0gaW5wdXRDb250cm9sLkNvbnRlbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQuU2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAgICAgUGFyZW50Q29udGFpbmVyID0gaW5wdXRDb250cm9sLkNvbnRlbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIElucHV0Q29udHJvbCA9IGlucHV0Q29udHJvbDtcclxuICAgICAgICAgICAgQ2FsQ29udHJvbCA9IG5ldyBDYWxjdWxhdG9yQ29udHJvbChJbnB1dENvbnRyb2wuR2V0TnVtYmVyVmFsdWUoKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIENhbENvbnRyb2wuU2V0Qm91bmRzRnVsbCgpO1xyXG4gICAgICAgICAgICBDYWxDb250cm9sLk9uQ2xvc2UgPSAoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDbGlja2VkQ2xvc2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5DbG9zZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgQ2FsQ29udHJvbC5PbkVxdWFsID0gKHZhbHVlKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBJbnB1dENvbnRyb2wuVGV4dCA9IHZhbHVlLlRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBBcHBlbmRDaGlsZChDYWxDb250cm9sKTtcclxuXHJcbiAgICAgICAgICAgIFNpemUgPSBuZXcgVmVjdG9yMigxODIsIDE1Nyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPbkNsb3NlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uQ2xvc2VkKCk7XHJcbiAgICAgICAgICAgIElucHV0Q29udHJvbC5WYWxpZGF0ZURhdGEoKTtcclxuICAgICAgICAgICAgaWYoIUhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICAgICAgSW5wdXRDb250cm9sLkZvY3VzKCk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgSW5wdXRDb250cm9sLlNjcm9sbChQcmV2aW91c1Njcm9sbFRvcCwgUGFyZW50Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25DbG9zaW5nKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25DbG9zaW5nKCk7XHJcblxyXG4gICAgICAgICAgICBpZighQ2xpY2tlZENsb3NlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBDYWxDb250cm9sLkRvbnRSZWZyZXNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIENhbENvbnRyb2wuQWRkT3BlcmF0b3IoQ2FsQ29udHJvbC5idG5FcSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uU2hvd2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25TaG93ZWQoKTtcclxuICAgICAgICAgICAgaWYoSW5wdXRDb250cm9sID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICB0aGlzLkNsb3NlKCk7XHJcblxyXG4gICAgICAgICAgICBDYWxDb250cm9sLmJ0bkVxLkZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcbnVzaW5nIFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgRGF0YVJvd0VkaXRGb3JtIDogRGlhbG9nRm9ybVxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBib29sIExpdmVEYXRhO1xyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlldyBHcmlkVmlldztcclxuICAgICAgICBwdWJsaWMgRGF0YVJvdyBEYXRhUm93O1xyXG5cclxuICAgICAgICBwcml2YXRlIEhUTUxEaXZFbGVtZW50IFBhbmVsO1xyXG5cclxuICAgICAgICBwcml2YXRlIG9iamVjdFtdIHByZXZEYXRhO1xyXG5cclxuICAgICAgICBwdWJsaWMgRGF0YVJvd0VkaXRGb3JtKERhdGFSb3cgX2RhdGFSb3csIEdyaWRWaWV3IF9ncmlkVmlldywgYm9vbCBfbGl2ZURhdGEgPSB0cnVlKSA6IGJhc2UoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcHJldkRhdGEgPSBuZXcgb2JqZWN0W19kYXRhUm93LlBhcmVudFRhYmxlLkNvbHVtbkNvdW50XTtcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBfZGF0YVJvdy5QYXJlbnRUYWJsZS5Db2x1bW5Db3VudDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBwcmV2RGF0YVtpXSA9IF9kYXRhUm93W2ldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBEYXRhUm93ID0gX2RhdGFSb3c7XHJcbiAgICAgICAgICAgIEdyaWRWaWV3ID0gX2dyaWRWaWV3O1xyXG4gICAgICAgICAgICBMaXZlRGF0YSA9IF9saXZlRGF0YTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuVGV4dCA9IFwiUm93IEVkaXQgRm9ybVwiO1xyXG4gICAgICAgICAgICB0aGlzLldpZHRoID0gXCI0MDBweFwiOyAvLyAyNXB4IC0gMjVweCAzNTBweCB3aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5IZWlnaHQgPSBcIjYwMHB4XCI7XHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5TdHlsZS5PdmVyZmxvd1kgPSBCcmlkZ2UuSHRtbDUuT3ZlcmZsb3cuQXV0bztcclxuXHJcbiAgICAgICAgICAgIFBhbmVsID0gRGl2KCk7XHJcbiAgICAgICAgICAgIFBhbmVsLlN0eWxlLk92ZXJmbG93WSA9IE92ZXJmbG93LkF1dG87XHJcbiAgICAgICAgICAgIFBhbmVsLlNldEJvdW5kcyhcIjBcIiwgXCIwXCIsIFwiMTAwJVwiLCBcIigxMDAlIC0gNjBweClcIik7XHJcbiAgICAgICAgICAgIEJvZHkuU3R5bGUuQmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xyXG5cclxuICAgICAgICAgICAgX2J1dHRvbkNvbGxlY3Rpb24gPSBnbG9iYWw6OkJyaWRnZS5TY3JpcHQuQ2FsbEZvcihuZXcgTGlzdDxTaW1wbGVEaWFsb2dCdXR0b24+KCksKF9vMyk9PntfbzMuQWRkKG5ldyBTaW1wbGVEaWFsb2dCdXR0b24odGhpcywgRGlhbG9nUmVzdWx0RW51bS5DYW5jZWwpIHsgVGV4dCA9IFwiQ2FuY2VsXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDg1cHgpXCIsIFwiKDEwMCUgLSAzNXB4KVwiKSwgSXRlbUNsaWNrID0gKGV2KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IERhdGFSb3cuUGFyZW50VGFibGUuQ29sdW1uQ291bnQ7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGF0YVJvd1tpXSA9IHByZXZEYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyaWRWaWV3LlJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfX0pO19vMy5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLk9LKSB7IFRleHQgPSBcIk9LXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDE3MHB4KVwiLCBcIigxMDAlIC0gMzVweClcIikgIH0pO3JldHVybiBfbzM7fSk7XHJcblxyXG4gICAgICAgICAgICBCdXR0b25TZWN0aW9uLkFwcGVuZENoaWxkcmVuVGFiSW5kZXgoX2J1dHRvbkNvbGxlY3Rpb24uVG9BcnJheSgpKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5BcHBlbmRDaGlsZChQYW5lbCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkFsbG93U2l6ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRGF0YSBub3cgYXV0byBjaGFuZ2VzLi4uXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25DbG9zZWQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgR3JpZFZpZXcuRGF0YVNvdXJjZS5FbmREYXRhVXBkYXRlKCk7XHJcblxyXG4gICAgICAgICAgICBiYXNlLk9uQ2xvc2VkKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPblNob3dlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uU2hvd2VkKCk7XHJcblxyXG4gICAgICAgICAgICBpZihEYXRhUm93ID09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlhbG9nUmVzdWx0ID0gRGlhbG9nUmVzdWx0RW51bS5DYW5jZWw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBHcmlkVmlldy5EYXRhU291cmNlLkJlZ2luRGF0YVVwZGF0ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIEdlbmVyYXRlRm9ybSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHZvaWQgR2VuZXJhdGVGb3JtKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuUGFuZWwuRW1wdHkoKTtcclxuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IEdyaWRWaWV3LkNvbHVtbkNvdW50KCk7XHJcblxyXG4gICAgICAgICAgICBpbnQgY29sID0gMDtcclxuICAgICAgICAgICAgaW50IGhlaWdodCA9IDI1O1xyXG5cclxuICAgICAgICAgICAgaW50IGRlZmF1bHRIZWlnaHQgPSAyNCArIDMgKyAyNCArIDM7XHJcbiAgICAgICAgICAgIGludCBkZWZhdWx0SGVpZ2h0MlggPSBkZWZhdWx0SGVpZ2h0ICogMztcclxuICAgICAgICAgICAgaW50IGluY3JlbWVudEhlaWdodCA9IGRlZmF1bHRIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBpbnQgZWFjaFdpZHRoID0gKDM1MCAvIDMpIC0gMztcclxuXHJcbiAgICAgICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW5jcmVtZW50SGVpZ2h0ID0gZGVmYXVsdEhlaWdodDtcclxuICAgICAgICAgICAgICAgIHZhciBnckNvbCA9IEdyaWRWaWV3LkdldENvbHVtbihpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZighZ3JDb2wuQWxsb3dFZGl0KVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBkdENvbCA9IGdyQ29sLkNvbHVtbjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZHRJbmRleCA9IGdyQ29sLkdldERhdGFDb2x1bW5JbmRleCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGdyQ29sLkNvbHVtbi5GaWVsZE5hbWUuVG9Mb3dlcigpID09IFwiY250clwiKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyQ29sLlJlYWRPbmx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2goZHRDb2wuRGF0YVR5cGUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5EYXRlVGltZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxibGRhdGUgPSBMYWJlbChnckNvbC5DYXB0aW9uLCAyNSArIChjb2wgKiBlYWNoV2lkdGggKyAoY29sICogMykpLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXREYXRlID0gbmV3IFRleHRJbnB1dChCcmlkZ2UuSHRtbDUuSW5wdXRUeXBlLkRhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dERhdGUuU2V0Qm91bmRzKDI1ICsgKGNvbCAqIGVhY2hXaWR0aCArIChjb2wgKiAzKSksIGhlaWdodCArIDE2ICsgMywgZWFjaFdpZHRoLCAyNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0RGF0ZS5TZXREYXRlKENvbnZlcnQuVG9TdHJpbmcoRGF0YVJvd1tkdEluZGV4XSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dERhdGUuUmVhZG9ubHkgPSBnckNvbC5SZWFkT25seTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWdyQ29sLlJlYWRPbmx5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dERhdGUuT25UZXh0Q2hhbmdlZCA9IChldikgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhUm93W2R0SW5kZXhdID0gaW5wdXREYXRlLkdldERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihMaXZlRGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JpZFZpZXcuUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFuZWwuQXBwZW5kQ2hpbGRyZW4obGJsZGF0ZSwgaW5wdXREYXRlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkludGVnZXI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Mb25nOlxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuRmxvYXQ6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5Eb3VibGU6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5EZWNpbWFsOlxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YVR5cGUuQm9vbDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLkJ5dGU6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhVHlwZS5TaG9ydDpcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYmxubWIgPSBMYWJlbChnckNvbC5DYXB0aW9uLCAyNSArIChjb2wgKiBlYWNoV2lkdGggKyAoY29sICogMykpLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBUZXh0SW5wdXQgaW5wdXROdW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdyQ29sLkNlbGxEaXNwbGF5IGlzIEdyaWRWaWV3Q2VsbERpc3BsYXlDaGVja0JveClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXROdW0gPSBuZXcgVGV4dElucHV0KEJyaWRnZS5IdG1sNS5JbnB1dFR5cGUuQ2hlY2tib3gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXROdW0uU2V0Q2hlY2tlZChEYXRhUm93W2R0SW5kZXhdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TnVtID0gbmV3IFRleHRJbnB1dChJbnB1dFR5cGUuTnVtYmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TnVtLlRleHQgPSBDb252ZXJ0LlRvU3RyaW5nKERhdGFSb3dbZHRJbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dE51bS5TZXRCb3VuZHMoMjUgKyAoY29sICogZWFjaFdpZHRoICsgKGNvbCAqIDMpKSwgaGVpZ2h0ICsgMTYgKyAzLCBlYWNoV2lkdGgsIDI0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TnVtLlJlYWRvbmx5ID0gZ3JDb2wuUmVhZE9ubHk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighZ3JDb2wuUmVhZE9ubHkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TnVtLk9uVGV4dENoYW5nZWQgPSAoZXYpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5wdXROdW0uVHlwZSA9PSBJbnB1dFR5cGUuQ2hlY2tib3gpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhUm93W2R0SW5kZXhdID0gaW5wdXROdW0uVGV4dC5Jc1RydWUoKSA9PSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhUm93W2R0SW5kZXhdID0gaW5wdXROdW0uVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoTGl2ZURhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyaWRWaWV3LlJlbmRlckdyaWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhbmVsLkFwcGVuZENoaWxkcmVuKGxibG5tYiwgaW5wdXROdW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLk9iamVjdDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGFUeXBlLlN0cmluZzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxibHN0ciA9IExhYmVsKGdyQ29sLkNhcHRpb24sIDI1ICsgKGNvbCAqIGVhY2hXaWR0aCArIChjb2wgKiAzKSksIGhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dHN0ciA9IG5ldyBUZXh0SW5wdXQoQnJpZGdlLkh0bWw1LklucHV0VHlwZS5UZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzdHIuU2V0Qm91bmRzKDI1ICsgKGNvbCAqIGVhY2hXaWR0aCArIChjb2wgKiAzKSksIGhlaWdodCArIDE2ICsgMywgZWFjaFdpZHRoLCAyNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c3RyLlRleHQgPSBDb252ZXJ0LlRvU3RyaW5nKERhdGFSb3dbZHRJbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHN0ci5SZWFkb25seSA9IGdyQ29sLlJlYWRPbmx5O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWdyQ29sLlJlYWRPbmx5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHN0ci5PblRleHRDaGFuZ2VkID0gKGV2KSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGFSb3dbZHRJbmRleF0gPSBpbnB1dHN0ci5UZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihMaXZlRGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JpZFZpZXcuUmVuZGVyR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFuZWwuQXBwZW5kQ2hpbGRyZW4obGJsc3RyLCBpbnB1dHN0cik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmKG9iai5MZW5ndGggPiAxMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8ve1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1x0aW5jcmVtZW50SGVpZ2h0ID0gZGVmYXVsdEhlaWdodDJYO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9cdGNvbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Vsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy97XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihjb2wgPT0gMilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgKz0gaW5jcmVtZW50SGVpZ2h0ICsgMztcclxuICAgICAgICAgICAgICAgICAgICBjb2wgPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEFkZCBBY2NlcHQgQ2hhbmdlc1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIFN5c3RlbTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIERhdGVGb3JtIDogRm9ybVBvcHVwXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIFRleHRJbnB1dCBJbnB1dENvbnRyb2w7XHJcblxyXG4gICAgICAgIHB1YmxpYyBEYXRlQ29udHJvbCBEYXRlQ29udHJvbDtcclxuICAgICAgICBwdWJsaWMgYm9vbCBDbGlja2VkQ2xvc2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcHVibGljIERhdGVGb3JtKFRleHRJbnB1dCBpbnB1dENvbnRyb2wpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihpbnB1dENvbnRyb2wuQ29udGVudC5QYXJlbnRFbGVtZW50ICE9IG51bGwgJiYgaW5wdXRDb250cm9sLkNvbnRlbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50ICE9IG51bGwgJiYgaW5wdXRDb250cm9sLkNvbnRlbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUHJldmlvdXNTY3JvbGxUb3AgPSBpbnB1dENvbnRyb2wuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQuUGFyZW50RWxlbWVudC5TY3JvbGxUb3A7XHJcbiAgICAgICAgICAgICAgICBQYXJlbnRDb250YWluZXIgPSBpbnB1dENvbnRyb2wuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQuUGFyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgU2l6ZSA9IG5ldyBWZWN0b3IyKDIzMiwgMjQ3KTtcclxuXHJcbiAgICAgICAgICAgIElucHV0Q29udHJvbCA9IGlucHV0Q29udHJvbDtcclxuICAgICAgICAgICAgRGF0ZUNvbnRyb2wgPSBuZXcgRGF0ZUNvbnRyb2woaW5wdXRDb250cm9sLkdldERhdGVUaW1lKCkpO1xyXG4gICAgICAgICAgICBEYXRlQ29udHJvbC5TZXRCb3VuZHNGdWxsKCk7XHJcblxyXG4gICAgICAgICAgICBEYXRlQ29udHJvbC5PbkRhdGVDaGFuZ2VkID0gKGRhdGUpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGUgPT0gRGF0ZVRpbWUuTWluVmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRDb250cm9sLlNldERhdGUoXCJcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRDb250cm9sLlNldERhdGUoc3RyaW5nLkZvcm1hdChcInswOlwiICsgaW5wdXRDb250cm9sLkRpc3BsYXlGb3JtYXQgKyBcIn1cIiwgZGF0ZSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgRGF0ZUNvbnRyb2wuT25SZXF1ZXN0VG9DbG9zZSA9ICgpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuQ2xvc2UoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIENvbnRlbnQuT25LZXlEb3duID0gRGF0ZUNvbnRyb2wuQmxvY2tUYWJFdmVudDtcclxuXHJcbiAgICAgICAgICAgIEFwcGVuZENoaWxkKERhdGVDb250cm9sKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uQ2xvc2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25DbG9zZWQoKTtcclxuICAgICAgICAgICAgSW5wdXRDb250cm9sLlZhbGlkYXRlRGF0YSgpO1xyXG4gICAgICAgICAgICBpZighSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgICAgICBJbnB1dENvbnRyb2wuRm9jdXMoKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBJbnB1dENvbnRyb2wuU2Nyb2xsKFByZXZpb3VzU2Nyb2xsVG9wLCBQYXJlbnRDb250YWluZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPblNob3dlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uU2hvd2VkKCk7XHJcbiAgICAgICAgICAgIGlmKElucHV0Q29udHJvbCA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5DbG9zZSgpO1xyXG5cclxuICAgICAgICAgICAgRGF0ZUNvbnRyb2wuYnRuVG9kYXkuRm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBEYXRlSW5wdXQgOiBUZXh0SW5wdXREcm9wRG93blxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBEYXRlSW5wdXQoKSA6IGJhc2UoSW5wdXRUeXBlLkRhdGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG92ZXJyaWRlIHZvaWQgT25Ecm9wRG93bkNsaWNrZWQoTW91c2VFdmVudCBtb3VzZUV2ZW50KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYoIVJlYWRvbmx5ICYmIEVuYWJsZWQpXHJcbiAgICAgICAgICAgICAgICAobmV3IERhdGVGb3JtKHRoaXMuVXNlZEVkaXQpKS5cclxuICAgICAgICAgICAgICAgIFNob3dQb3B1cChGb3JtUG9wdXAuXHJcbiAgICAgICAgICAgICAgICAgICAgR2V0UG9wdXBEZWZhdWx0TG9jYXRpb24oRHJvcERvd25CdXR0b24sIHRydWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIFN5c3RlbTtcclxudXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWM7XHJcbnVzaW5nIFN5c3RlbS5HbG9iYWxpemF0aW9uO1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgSW5wdXREaWFsb2dDaGVja2JveCA6IElucHV0RGlhbG9nQmFzZVxyXG4gICAge1xyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gICAgIENyZWF0ZXMgYSBRdWVzdGlvbiBEaWFsb2cgd2l0aCBhIGNoZWNrYm94XHJcbiAgICAgICAgLy8vICAgICBUaGUgUmVzdWx0IFByb3BlcnR5IGNvbnRhaW5zIGEgYm9vbGVhbiB2YWx1ZSBvZiB0aGUgY2hlY2tib3ggc3RhdGVcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBpbiB0aGUgdGl0bGUgYmFyIG9mIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInF1ZXN0aW9uXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBhYm91dCB0aGUgaW5wdXQgYm94IG9uIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIHB1YmxpYyBJbnB1dERpYWxvZ0NoZWNrYm94KHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uKSA6IHRoaXModGl0bGUsIHF1ZXN0aW9uLCAzNjApXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgY2hlY2tib3hcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgYSBib29sZWFuIHZhbHVlIG9mIHRoZSBjaGVja2JveCBzdGF0ZVxyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidGl0bGVcIj5UaGUgbWVzc2FnZSB0aGF0IHdpbGwgYXBwZWFyIGluIHRoZSB0aXRsZSBiYXIgb2YgdGhlIGRpYWxvZzwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwicXVlc3Rpb25cIj5UaGUgbWVzc2FnZSB0aGF0IHdpbGwgYXBwZWFyIGFib3V0IHRoZSBpbnB1dCBib3ggb24gdGhlIGRpYWxvZzwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic2l6ZVwiPlRoZSB3aWR0aCBvZiB0aGlzIGRpYWxvZy4gVGhlIGRlZmF1bHQgc2l6ZSBpcyAzNjA8L3BhcmFtPlxyXG4gICAgICAgIHB1YmxpYyBJbnB1dERpYWxvZ0NoZWNrYm94KHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uLCBpbnQgc2l6ZSkgOiBiYXNlKHRpdGxlLCBzaXplLCBxdWVzdGlvbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IElucHV0KFwiaW5wdXRjb250cm9sXCIsIElucHV0VHlwZS5DaGVja2JveCk7XHJcbiAgICAgICAgICAgIGlucHV0LklkID0gXCJEaWFsb2dBbnN3ZXJCb3hcIjtcclxuICAgICAgICAgICAgaW5wdXQuU2V0Qm91bmRzKFwiMTBweFwiLCBcIjBweFwiLCBcIjkwJVwiLCBcIjQwcHhcIik7XHJcbiAgICAgICAgICAgIGlucHV0Lk9uQ2hhbmdlID0gZXYgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUmVzdWx0ID0gaW5wdXQuQ2hlY2tlZDtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgQW5zd2VyRGl2LkFwcGVuZENoaWxkKGlucHV0KTtcclxuICAgICAgICAgICAgQ3JlYXRlKFF1ZXN0aW9uU2l6ZSArIDQwICsgMjUgKyA3OCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYm9vbCBSZXN1bHQgeyBnZXQ7IHByaXZhdGUgc2V0OyB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIElucHV0RGlhbG9nQ29sb3VyIDogSW5wdXREaWFsb2dCYXNlXHJcbiAgICB7XHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgY29sb3VyIHNlbGVjdG9yXHJcbiAgICAgICAgLy8vICAgICBUaGUgUmVzdWx0IFByb3BlcnR5IGNvbnRhaW5zIHRoZSBIZXhDb2RlIGZvciB0aGUgc2VsZWN0ZWQgY29sb3VyXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dDb2xvdXIoc3RyaW5nIHRpdGxlLCBzdHJpbmcgcXVlc3Rpb24pIDogdGhpcyh0aXRsZSwgcXVlc3Rpb24sIDM2MClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYSBjb2xvdXIgc2VsZWN0b3JcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIEhleENvZGUgZm9yIHRoZSBzZWxlY3RlZCBjb2xvdXJcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBpbiB0aGUgdGl0bGUgYmFyIG9mIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInF1ZXN0aW9uXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBhYm91dCB0aGUgaW5wdXQgYm94IG9uIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInNpemVcIj5UaGUgd2lkdGggb2YgdGhpcyBkaWFsb2cuIFRoZSBkZWZhdWx0IHNpemUgaXMgMzYwPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dDb2xvdXIoc3RyaW5nIHRpdGxlLCBzdHJpbmcgcXVlc3Rpb24sIGludCBzaXplKSA6IGJhc2UodGl0bGUsIHNpemUsIHF1ZXN0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGlucHV0ID0gSW5wdXQoXCJpbnB1dGNvbnRyb2xcIiwgSW5wdXRUeXBlLkNvbG9yKTtcclxuICAgICAgICAgICAgaW5wdXQuSWQgPSBcIkRpYWxvZ0Fuc3dlckJveFwiO1xyXG4gICAgICAgICAgICBpbnB1dC5TZXRCb3VuZHMoXCIxMHB4XCIsIFwiMHB4XCIsIFwiOTAlXCIsIFwiNDBweFwiKTtcclxuICAgICAgICAgICAgaW5wdXQuT25DaGFuZ2UgPSBldiA9PiB7IFJlc3VsdCA9IGlucHV0LlZhbHVlOyB9O1xyXG4gICAgICAgICAgICBBbnN3ZXJEaXYuQXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgICAgICAgICBDcmVhdGUoUXVlc3Rpb25TaXplICsgNDAgKyAyNSArIDc4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgUmVzdWx0IHsgZ2V0OyBwcml2YXRlIHNldDsgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBJbnB1dERpYWxvZ0RhdGUgOiBJbnB1dERpYWxvZ0Jhc2VcclxuICAgIHtcclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYSBEYXRlIFNlbGVjdG9yXHJcbiAgICAgICAgLy8vICAgICBUaGUgUmVzdWx0IFByb3BlcnR5IGNvbnRhaW5zIHRoZSBzZWxlY3RlZCBEYXRlXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dEYXRlKHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uKSA6IHRoaXModGl0bGUsIHF1ZXN0aW9uLCAzNjApXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgRGF0ZSBTZWxlY3RvclxyXG4gICAgICAgIC8vLyAgICAgVGhlIFJlc3VsdCBQcm9wZXJ0eSBjb250YWlucyB0aGUgc2VsZWN0ZWQgRGF0ZVxyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidGl0bGVcIj5UaGUgbWVzc2FnZSB0aGF0IHdpbGwgYXBwZWFyIGluIHRoZSB0aXRsZSBiYXIgb2YgdGhlIGRpYWxvZzwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwicXVlc3Rpb25cIj5UaGUgbWVzc2FnZSB0aGF0IHdpbGwgYXBwZWFyIGFib3V0IHRoZSBpbnB1dCBib3ggb24gdGhlIGRpYWxvZzwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic2l6ZVwiPlRoZSB3aWR0aCBvZiB0aGlzIGRpYWxvZy4gVGhlIGRlZmF1bHQgc2l6ZSBpcyAzNjA8L3BhcmFtPlxyXG4gICAgICAgIHB1YmxpYyBJbnB1dERpYWxvZ0RhdGUoc3RyaW5nIHRpdGxlLCBzdHJpbmcgcXVlc3Rpb24sIGludCBzaXplKSA6IGJhc2UodGl0bGUsIHNpemUsIHF1ZXN0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGlucHV0ID0gSW5wdXQoXCJpbnB1dGNvbnRyb2xcIiwgSW5wdXRUeXBlLkRhdGUpO1xyXG4gICAgICAgICAgICBpbnB1dC5JZCA9IFwiRGlhbG9nQW5zd2VyQm94XCI7XHJcbiAgICAgICAgICAgIGlucHV0LlNldEJvdW5kcyhcIjEwcHhcIiwgXCIwcHhcIiwgXCI5MCVcIiwgXCJhdXRvXCIpO1xyXG4gICAgICAgICAgICBpbnB1dC5PbkNoYW5nZSA9IGV2ID0+IHsgUmVzdWx0ID0gaW5wdXQuVmFsdWU7IH07XHJcbiAgICAgICAgICAgIEFuc3dlckRpdi5BcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICAgICAgICAgIENyZWF0ZShRdWVzdGlvblNpemUgKyAyNSArIDI1ICsgNzgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBSZXN1bHQgeyBnZXQ7IHByaXZhdGUgc2V0OyB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIElucHV0RGlhbG9nRGF0ZVRpbWVMb2NhbCA6IElucHV0RGlhbG9nQmFzZVxyXG4gICAge1xyXG4gICAgICAgIC8vLyA8c3VtbWFyeT5cclxuICAgICAgICAvLy8gICAgIENyZWF0ZXMgYSBRdWVzdGlvbiBEaWFsb2cgd2l0aCBhIERhdGUgU2VsZWN0b3JcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIHNlbGVjdGVkIERhdGVcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBpbiB0aGUgdGl0bGUgYmFyIG9mIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInF1ZXN0aW9uXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBhYm91dCB0aGUgaW5wdXQgYm94IG9uIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIHB1YmxpYyBJbnB1dERpYWxvZ0RhdGVUaW1lTG9jYWwoc3RyaW5nIHRpdGxlLCBzdHJpbmcgcXVlc3Rpb24pIDogdGhpcyh0aXRsZSwgcXVlc3Rpb24sIDM2MClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYSBEYXRlIFNlbGVjdG9yXHJcbiAgICAgICAgLy8vICAgICBUaGUgUmVzdWx0IFByb3BlcnR5IGNvbnRhaW5zIHRoZSBzZWxlY3RlZCBEYXRlXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJzaXplXCI+VGhlIHdpZHRoIG9mIHRoaXMgZGlhbG9nLiBUaGUgZGVmYXVsdCBzaXplIGlzIDM2MDwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIElucHV0RGlhbG9nRGF0ZVRpbWVMb2NhbChzdHJpbmcgdGl0bGUsIHN0cmluZyBxdWVzdGlvbiwgaW50IHNpemUpIDogYmFzZSh0aXRsZSwgc2l6ZSwgcXVlc3Rpb24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBSZXN1bHQgPSBEYXRlVGltZS5Ob3c7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IElucHV0KFwiaW5wdXRjb250cm9sXCIsIElucHV0VHlwZS5EYXRlVGltZUxvY2FsKTtcclxuICAgICAgICAgICAgaW5wdXQuSWQgPSBcIkRpYWxvZ0Fuc3dlckJveFwiO1xyXG4gICAgICAgICAgICBpbnB1dC5TZXRCb3VuZHMoXCIxMHB4XCIsIFwiMHB4XCIsIFwiOTAlXCIsIFwiYXV0b1wiKTtcclxuICAgICAgICAgICAgaW5wdXQuT25DaGFuZ2UgPSBldiA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBSZXN1bHQgPSBEYXRlVGltZS5QYXJzZUV4YWN0KGlucHV0LlZhbHVlLCBcInl5eXktTU0tZGRUSEg6bW1cIiwgQ3VsdHVyZUluZm8uSW52YXJpYW50Q3VsdHVyZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIEFuc3dlckRpdi5BcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICAgICAgICAgIENyZWF0ZShRdWVzdGlvblNpemUgKyAyNSArIDI1ICsgNzgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIERhdGVUaW1lIFJlc3VsdFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZ2V0OyBwcml2YXRlIHNldDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsYXNzIElucHV0RGlhbG9nRW1haWwgOiBJbnB1dERpYWxvZ0Jhc2VcclxuICAgIHtcclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYW4gZW1haWwgaW5wdXRcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIEVudGVyZWQgZW1haWwgYWRkcmVzc1xyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidGl0bGVcIj5UaGUgbWVzc2FnZSB0aGF0IHdpbGwgYXBwZWFyIGluIHRoZSB0aXRsZSBiYXIgb2YgdGhlIGRpYWxvZzwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwicXVlc3Rpb25cIj5UaGUgbWVzc2FnZSB0aGF0IHdpbGwgYXBwZWFyIGFib3V0IHRoZSBpbnB1dCBib3ggb24gdGhlIGRpYWxvZzwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIElucHV0RGlhbG9nRW1haWwoc3RyaW5nIHRpdGxlLCBzdHJpbmcgcXVlc3Rpb24pIDogdGhpcyh0aXRsZSwgcXVlc3Rpb24sIDM2MClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYW4gZW1haWwgaW5wdXRcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIEVudGVyZWQgZW1haWxcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBpbiB0aGUgdGl0bGUgYmFyIG9mIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInF1ZXN0aW9uXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBhYm91dCB0aGUgaW5wdXQgYm94IG9uIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInNpemVcIj5UaGUgd2lkdGggb2YgdGhpcyBkaWFsb2cuIFRoZSBkZWZhdWx0IHNpemUgaXMgMzYwPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dFbWFpbChzdHJpbmcgdGl0bGUsIHN0cmluZyBxdWVzdGlvbiwgaW50IHNpemUpIDogYmFzZSh0aXRsZSwgc2l6ZSwgcXVlc3Rpb24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSBJbnB1dChcImlucHV0Y29udHJvbFwiLCBJbnB1dFR5cGUuRW1haWwpO1xyXG4gICAgICAgICAgICBpbnB1dC5JZCA9IFwiRGlhbG9nQW5zd2VyQm94XCI7XHJcbiAgICAgICAgICAgIGlucHV0LlNldEJvdW5kcyhcIjEwcHhcIiwgXCIwcHhcIiwgXCI5MCVcIiwgXCJhdXRvXCIpO1xyXG4gICAgICAgICAgICBpbnB1dC5PbkNoYW5nZSA9IGV2ID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vdG9kbyBjc3MgZm9yIGVtYWlsIGlucHV0IG5vdCBzaG93aW5nIHVwXHJcbiAgICAgICAgICAgICAgICAvL3RvZG8gY291bGQgYWx3YXlzIHZhbGlkYXRlIGVtYWlsIGhlcmVcclxuICAgICAgICAgICAgICAgIFJlc3VsdCA9IGlucHV0LlZhbHVlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBBbnN3ZXJEaXYuQXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgICAgICAgICBDcmVhdGUoUXVlc3Rpb25TaXplICsgMjUgKyAyNSArIDc4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgUmVzdWx0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQ7IHByaXZhdGUgc2V0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgSW5wdXREaWFsb2dXZWVrIDogSW5wdXREaWFsb2dCYXNlXHJcbiAgICB7XHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgV2VlayBpbnB1dFxyXG4gICAgICAgIC8vLyAgICAgVGhlIFJlc3VsdCBQcm9wZXJ0eSBjb250YWlucyB0aGUgRW50ZXJlZCB3ZWVrXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dXZWVrKHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uKSA6IHRoaXModGl0bGUsIHF1ZXN0aW9uLCAzNjApXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgV2VlayBpbnB1dFxyXG4gICAgICAgIC8vLyAgICAgVGhlIFJlc3VsdCBQcm9wZXJ0eSBjb250YWlucyB0aGUgRW50ZXJlZCBXZWVrXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJzaXplXCI+VGhlIHdpZHRoIG9mIHRoaXMgZGlhbG9nLiBUaGUgZGVmYXVsdCBzaXplIGlzIDM2MDwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIElucHV0RGlhbG9nV2VlayhzdHJpbmcgdGl0bGUsIHN0cmluZyBxdWVzdGlvbiwgaW50IHNpemUpIDogYmFzZSh0aXRsZSwgc2l6ZSwgcXVlc3Rpb24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSBJbnB1dChcImlucHV0Y29udHJvbFwiLCBJbnB1dFR5cGUuV2Vlayk7XHJcbiAgICAgICAgICAgIGlucHV0LklkID0gXCJEaWFsb2dBbnN3ZXJCb3hcIjtcclxuICAgICAgICAgICAgaW5wdXQuU2V0Qm91bmRzKFwiMTBweFwiLCBcIjBweFwiLCBcIjkwJVwiLCBcImF1dG9cIik7XHJcbiAgICAgICAgICAgIGlucHV0Lk9uQ2hhbmdlID0gZXYgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgUmVzdWx0ID0gaW5wdXQuVmFsdWU7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIEFuc3dlckRpdi5BcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICAgICAgICAgIENyZWF0ZShRdWVzdGlvblNpemUgKyAyNSArIDI1ICsgNzgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHN0cmluZyBSZXN1bHRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGdldDsgcHJpdmF0ZSBzZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzcyBJbnB1dERpYWxvZ01vbnRoIDogSW5wdXREaWFsb2dCYXNlXHJcbiAgICB7XHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgTW9udGggaW5wdXRcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIEVudGVyZWQgTW9udGhcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBpbiB0aGUgdGl0bGUgYmFyIG9mIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInF1ZXN0aW9uXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBhYm91dCB0aGUgaW5wdXQgYm94IG9uIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIHB1YmxpYyBJbnB1dERpYWxvZ01vbnRoKHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uKSA6IHRoaXModGl0bGUsIHF1ZXN0aW9uLCAzNjApXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgTW9udGggaW5wdXRcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIEVudGVyZWQgTW9udGhcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBpbiB0aGUgdGl0bGUgYmFyIG9mIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInF1ZXN0aW9uXCI+VGhlIG1lc3NhZ2UgdGhhdCB3aWxsIGFwcGVhciBhYm91dCB0aGUgaW5wdXQgYm94IG9uIHRoZSBkaWFsb2c8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInNpemVcIj5UaGUgd2lkdGggb2YgdGhpcyBkaWFsb2cuIFRoZSBkZWZhdWx0IHNpemUgaXMgMzYwPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dNb250aChzdHJpbmcgdGl0bGUsIHN0cmluZyBxdWVzdGlvbiwgaW50IHNpemUpIDogYmFzZSh0aXRsZSwgc2l6ZSwgcXVlc3Rpb24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSBJbnB1dChcImlucHV0Y29udHJvbFwiLCBJbnB1dFR5cGUuTW9udGgpO1xyXG4gICAgICAgICAgICBpbnB1dC5JZCA9IFwiRGlhbG9nQW5zd2VyQm94XCI7XHJcbiAgICAgICAgICAgIGlucHV0LlNldEJvdW5kcyhcIjEwcHhcIiwgXCIwcHhcIiwgXCI5MCVcIiwgXCJhdXRvXCIpO1xyXG4gICAgICAgICAgICBpbnB1dC5PbkNoYW5nZSA9IGV2ID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFJlc3VsdCA9IGlucHV0LlZhbHVlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBBbnN3ZXJEaXYuQXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgICAgICAgICBDcmVhdGUoUXVlc3Rpb25TaXplICsgMjUgKyAyNSArIDc4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgUmVzdWx0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBnZXQ7IHByaXZhdGUgc2V0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgSW5wdXREaWFsb2dOdW1iZXIgOiBJbnB1dERpYWxvZ0Jhc2VcclxuICAgIHtcclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYSBOdW1iZXIgU2VsZWN0b3JcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIHNlbGVjdGVkIHZhbHVlXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dOdW1iZXIoc3RyaW5nIHRpdGxlLCBzdHJpbmcgcXVlc3Rpb24pIDogdGhpcyh0aXRsZSwgcXVlc3Rpb24sIDM2MClcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vICAgICBDcmVhdGVzIGEgUXVlc3Rpb24gRGlhbG9nIHdpdGggYSBOdW1iZXIgU2VsZWN0b3JcclxuICAgICAgICAvLy8gICAgIFRoZSBSZXN1bHQgUHJvcGVydHkgY29udGFpbnMgdGhlIHNlbGVjdGVkIHZhbHVlXHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJzaXplXCI+VGhlIHdpZHRoIG9mIHRoaXMgZGlhbG9nLiBUaGUgZGVmYXVsdCBzaXplIGlzIDM2MDwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIElucHV0RGlhbG9nTnVtYmVyKHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uLCBpbnQgc2l6ZSkgOiBiYXNlKHRpdGxlLCBzaXplLCBxdWVzdGlvbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IElucHV0KFwiaW5wdXRjb250cm9sXCIsIElucHV0VHlwZS5OdW1iZXIpO1xyXG4gICAgICAgICAgICBpbnB1dC5JZCA9IFwiRGlhbG9nQW5zd2VyQm94XCI7XHJcbiAgICAgICAgICAgIGlucHV0LlNldEJvdW5kcyhcIjEwcHhcIiwgXCIwcHhcIiwgXCI5MCVcIiwgXCJhdXRvXCIpO1xyXG4gICAgICAgICAgICBpbnB1dC5PbkNoYW5nZSA9IGV2ID0+IHsgUmVzdWx0ID0gaW5wdXQuVmFsdWVBc051bWJlcjsgfTtcclxuICAgICAgICAgICAgQW5zd2VyRGl2LkFwcGVuZENoaWxkKGlucHV0KTtcclxuICAgICAgICAgICAgQ3JlYXRlKFF1ZXN0aW9uU2l6ZSArIDI1ICsgMjUgKyA3OCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZG91YmxlIFJlc3VsdCB7IGdldDsgcHJpdmF0ZSBzZXQ7IH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgSW5wdXREaWFsb2dUZXh0IDogSW5wdXREaWFsb2dCYXNlXHJcbiAgICB7XHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgVGV4dCBpbnB1dFxyXG4gICAgICAgIC8vLyAgICAgVGhlIFJlc3VsdCBQcm9wZXJ0eSBjb250YWlucyB0aGUgRW50ZXJlZCBUZXh0XHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgSW5wdXREaWFsb2dUZXh0KHN0cmluZyB0aXRsZSwgc3RyaW5nIHF1ZXN0aW9uKSA6IHRoaXModGl0bGUsIHF1ZXN0aW9uLCAzNjApXHJcbiAgICAgICAge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyAgICAgQ3JlYXRlcyBhIFF1ZXN0aW9uIERpYWxvZyB3aXRoIGEgVGV4dCBpbnB1dFxyXG4gICAgICAgIC8vLyAgICAgVGhlIFJlc3VsdCBQcm9wZXJ0eSBjb250YWlucyB0aGUgRW50ZXJlZCBUZXh0XHJcbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgaW4gdGhlIHRpdGxlIGJhciBvZiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJxdWVzdGlvblwiPlRoZSBtZXNzYWdlIHRoYXQgd2lsbCBhcHBlYXIgYWJvdXQgdGhlIGlucHV0IGJveCBvbiB0aGUgZGlhbG9nPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJzaXplXCI+VGhlIHdpZHRoIG9mIHRoaXMgZGlhbG9nLiBUaGUgZGVmYXVsdCBzaXplIGlzIDM2MDwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIElucHV0RGlhbG9nVGV4dChzdHJpbmcgdGl0bGUsIHN0cmluZyBxdWVzdGlvbiwgaW50IHNpemUpIDogYmFzZSh0aXRsZSwgc2l6ZSwgcXVlc3Rpb24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSBJbnB1dChcImlucHV0Y29udHJvbFwiLCBJbnB1dFR5cGUuVGV4dCk7XHJcbiAgICAgICAgICAgIGlucHV0LklkID0gXCJEaWFsb2dBbnN3ZXJCb3hcIjtcclxuICAgICAgICAgICAgaW5wdXQuU2V0Qm91bmRzKFwiMTBweFwiLCBcIjBweFwiLCBcIjkwJVwiLCBcImF1dG9cIik7XHJcbiAgICAgICAgICAgIGlucHV0Lk9uQ2hhbmdlID0gZXYgPT4geyBSZXN1bHQgPSBpbnB1dC5WYWx1ZTsgfTtcclxuICAgICAgICAgICAgQW5zd2VyRGl2LkFwcGVuZENoaWxkKGlucHV0KTtcclxuICAgICAgICAgICAgQ3JlYXRlKFF1ZXN0aW9uU2l6ZSArIDI1ICsgMjUgKyA3OCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgc3RyaW5nIFJlc3VsdCB7IGdldDsgcHJpdmF0ZSBzZXQ7IH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xhc3MgSW5wdXREaWFsb2dCYXNlIDogRGlhbG9nRm9ybVxyXG4gICAge1xyXG4gICAgICAgIHByb3RlY3RlZCBJbnB1dERpYWxvZ0Jhc2Uoc3RyaW5nIHRpdGxlLCBpbnQgd2lkdGgsIHN0cmluZyBxdWVzdGlvbikgOiBiYXNlKHRpdGxlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgV2lkdGggPSB3aWR0aC5Ub1B4KCk7XHJcbiAgICAgICAgICAgIFdyYXBwZXIgPSBEaXYoKTtcclxuICAgICAgICAgICAgUXVlc3Rpb25EaXYgPSBEaXYoKTtcclxuICAgICAgICAgICAgQW5zd2VyRGl2ID0gRGl2KCk7XHJcbiAgICAgICAgICAgIF9idXR0b25Db2xsZWN0aW9uID0gZ2xvYmFsOjpCcmlkZ2UuU2NyaXB0LkNhbGxGb3IobmV3IExpc3Q8U2ltcGxlRGlhbG9nQnV0dG9uPigpLChfbzEpPT57X28xLkFkZChuZXcgU2ltcGxlRGlhbG9nQnV0dG9uKHRoaXMsIERpYWxvZ1Jlc3VsdEVudW0uT0spIHtUZXh0ID0gXCJBY2NlcHRcIn0pO19vMS5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLkNhbmNlbCkge1RleHQgPSBcIkNhbmNlbFwifSk7cmV0dXJuIF9vMTt9KTtcclxuXHJcbiAgICAgICAgICAgIFdyYXBwZXIuU3R5bGUuT3ZlcmZsb3dZID0gT3ZlcmZsb3cuSGlkZGVuO1xyXG4gICAgICAgICAgICBXcmFwcGVyLlNldEJvdW5kcyhcIjBweFwiLCBcIjBweFwiLCBcIjEwMCVcIiwgXCIoMTAwJSAtIDYwcHgpXCIpO1xyXG4gICAgICAgICAgICBRdWVzdGlvbkRpdi5TdHlsZS5Qb3NpdGlvbiA9IFBvc2l0aW9uLlJlbGF0aXZlO1xyXG4gICAgICAgICAgICBRdWVzdGlvbkRpdi5TdHlsZS5IZWlnaHQgPSBcImF1dG9cIjtcclxuICAgICAgICAgICAgUXVlc3Rpb25EaXYuU3R5bGUuTWFyZ2luTGVmdCA9IFwiMTBweFwiO1xyXG4gICAgICAgICAgICBRdWVzdGlvbkRpdi5TdHlsZS5NYXJnaW5SaWdodCA9IFwiMTBweFwiO1xyXG4gICAgICAgICAgICBRdWVzdGlvbkRpdi5TdHlsZS5NYXJnaW5Ub3AgPSBcIjEwcHhcIjtcclxuICAgICAgICAgICAgQW5zd2VyRGl2LlN0eWxlLlBvc2l0aW9uID0gUG9zaXRpb24uUmVsYXRpdmU7XHJcbiAgICAgICAgICAgIEFuc3dlckRpdi5TdHlsZS5IZWlnaHQgPSBcImF1dG9cIjtcclxuICAgICAgICAgICAgX2J1dHRvbkNvbGxlY3Rpb25bMF0uU2V0TG9jYXRpb24oXCIoMTAwJSAtIDE3MHB4KVwiLCBcIigxMDAlIC0gMzVweClcIik7XHJcbiAgICAgICAgICAgIF9idXR0b25Db2xsZWN0aW9uWzFdLlNldExvY2F0aW9uKFwiKDEwMCUgLSA4NXB4KVwiLCBcIigxMDAlIC0gMzVweClcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgdGIgPSBuZXcgVGV4dEJsb2NrKHF1ZXN0aW9uLCB3aWR0aCAtIDI1KTtcclxuICAgICAgICAgICAgdGIuQ29tcHV0ZVN0cmluZygpO1xyXG5cclxuICAgICAgICAgICAgaWYoIXRiLkVsZWxlbXRzT3Zlck1heClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgd2lkdGggPSAoaW50KXRiLk1heENhbGN1bGF0ZWRXaWR0aCArIDY1ICsgMzc7XHJcbiAgICAgICAgICAgICAgICBpZih3aWR0aCA8IFNldHRpbmdzLk1lc3NhZ2VGb3JtTWluaW11bVdpZHRoSW5QeClcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IFNldHRpbmdzLk1lc3NhZ2VGb3JtTWluaW11bVdpZHRoSW5QeDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0Yi5Db21wdXRlZEhlaWdodCA+IFNldHRpbmdzLk1lc3NhZ2VGb3JtVGV4dE1heGltdW1IZWlnaHRJblB4KVxyXG4gICAgICAgICAgICAgICAgdGIuQ29tcHV0ZWRIZWlnaHQgPSBTZXR0aW5ncy5NZXNzYWdlRm9ybVRleHRNYXhpbXVtSGVpZ2h0SW5QeDtcclxuICAgICAgICAgICAgaWYodGIuQ29tcHV0ZWRIZWlnaHQgPCBTZXR0aW5ncy5NZXNzYWdlRm9ybVRleHRNaW5pbXVtSGVpZ2h0SW5QeClcclxuICAgICAgICAgICAgICAgIHRiLkNvbXB1dGVkSGVpZ2h0ID0gU2V0dGluZ3MuTWVzc2FnZUZvcm1UZXh0TWluaW11bUhlaWdodEluUHg7XHJcblxyXG4gICAgICAgICAgICBRdWVzdGlvbkRpdi5Jbm5lckhUTUwgPSBxdWVzdGlvbjtcclxuICAgICAgICAgICAgUXVlc3Rpb25TaXplID0gQ29udmVydC5Ub0ludDMyKHRiLkNvbXB1dGVkSGVpZ2h0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBpbnQgUXVlc3Rpb25TaXplIHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwcml2YXRlIEhUTUxEaXZFbGVtZW50IFdyYXBwZXIgeyBnZXQ7IHByaXZhdGUgc2V0OyB9XHJcbiAgICAgICAgcHJvdGVjdGVkIEhUTUxEaXZFbGVtZW50IFF1ZXN0aW9uRGl2IHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwcm90ZWN0ZWQgSFRNTERpdkVsZW1lbnQgQW5zd2VyRGl2IHsgZ2V0OyBzZXQ7IH1cclxuICAgICAgICBwcm90ZWN0ZWQgSFRNTERpdkVsZW1lbnQgSW1hZ2VEaXYgeyBnZXQ7IHNldDsgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgdm9pZCBDcmVhdGUoaW50IGhlaWdodClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFdyYXBwZXIuQXBwZW5kQ2hpbGQoUXVlc3Rpb25EaXYpO1xyXG4gICAgICAgICAgICBXcmFwcGVyLkFwcGVuZENoaWxkKG5ldyBIVE1MQlJFbGVtZW50KCkpO1xyXG4gICAgICAgICAgICBXcmFwcGVyLkFwcGVuZENoaWxkKEFuc3dlckRpdik7XHJcbiAgICAgICAgICAgIEJvZHkuQXBwZW5kQ2hpbGQoV3JhcHBlcik7XHJcblxyXG4gICAgICAgICAgICBCdXR0b25TZWN0aW9uLkFwcGVuZENoaWxkcmVuVGFiSW5kZXgoX2J1dHRvbkNvbGxlY3Rpb24uVG9BcnJheSgpKTtcclxuXHJcbiAgICAgICAgICAgIEhlaWdodCA9IGhlaWdodC5Ub1B4KCk7XHJcbiAgICAgICAgICAgIEFsbG93U2l6ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgU3lzdGVtO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIE1lc3NhZ2VCb3hGb3JtIDogRGlhbG9nRm9ybVxyXG4gICAge1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIEhUTUxBdWRpb0VsZW1lbnQgc25kID0gbnVsbDtcclxuICAgICAgICBwcml2YXRlIHN0cmluZyBfcHJvbXB0O1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgQmVlcCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighU2V0dGluZ3MuTWVzc2FnZUZvcm1CZWVwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZihzbmQgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHNuZCA9IG5ldyBIVE1MQXVkaW9FbGVtZW50KFJlc291cmNlTWFuYWdlci5HZXRSZXNvdXJjZVN0cmluZyhcImJlZXBTb3VuZFwiKSk7XHJcbiAgICAgICAgICAgIHNuZC5QbGF5KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IE1lc3NhZ2VCb3hCdXR0b25zIF9idXR0b25zO1xyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vIENyZWF0ZSBhIG5ldyBNZXNzYWdlIERpYWxvZ1xyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwicHJvbXB0XCI+VGhlIHRleHQgdG8gYmUgZGlzcGxheWVkIGluIHRoZSBtZXNzYWdlIGJveDwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidWlcIj5UaGUgVUkgc2V0dGluZ3MgdG8gYmUgYXBwbGllZCB0byB0aGUgZm9ybTwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIE1lc3NhZ2VCb3hGb3JtKHN0cmluZyBwcm9tcHQsIE1lc3NhZ2VCb3hMYXlvdXQgdWkpIDogdGhpcyhwcm9tcHQsIHVpLCBNZXNzYWdlQm94QnV0dG9ucy5BdXRvLCB1aS5Ub1N0cmluZygpKSB7IH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBDcmVhdGUgYSBuZXcgTWVzc2FnZSBEaWFsb2dcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInByb21wdFwiPlRoZSB0ZXh0IHRvIGJlIGRpc3BsYXllZCBpbiB0aGUgbWVzc2FnZSBib3g8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInVpXCI+VGhlIFVJIHNldHRpbmdzIHRvIGJlIGFwcGxpZWQgdG8gdGhlIGZvcm08L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInRpdGxlXCI+VGhlIHRpdGxlIG9mIHRoZSBtZXNzYWdlIGJveDwvcGFyYW0+XHJcbiAgICAgICAgcHVibGljIE1lc3NhZ2VCb3hGb3JtKHN0cmluZyBwcm9tcHQsIE1lc3NhZ2VCb3hMYXlvdXQgdWksIHN0cmluZyB0aXRsZSkgOiB0aGlzKHByb21wdCwgdWksIE1lc3NhZ2VCb3hCdXR0b25zLkF1dG8sIHRpdGxlKSB7IH1cclxuXHJcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxyXG4gICAgICAgIC8vLyBDcmVhdGUgYSBuZXcgTWVzc2FnZSBEaWFsb2dcclxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInByb21wdFwiPlRoZSB0ZXh0IHRvIGJlIGRpc3BsYXllZCBpbiB0aGUgbWVzc2FnZSBib3g8L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInVpXCI+VGhlIFVJIHNldHRpbmdzIHRvIGJlIGFwcGxpZWQgdG8gdGhlIGZvcm08L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cImJ1dHRvbnNcIj5UaGUgVHlwZSBvZiBidXR0b24gdG8gYmUgZGlzcGxheWVkIHdpdGggdGhpcyBtZXNzYWdlPC9wYXJhbT5cclxuICAgICAgICBwdWJsaWMgTWVzc2FnZUJveEZvcm0oc3RyaW5nIHByb21wdCwgTWVzc2FnZUJveExheW91dCB1aSwgTWVzc2FnZUJveEJ1dHRvbnMgYnV0dG9ucykgOiB0aGlzKHByb21wdCwgdWksIGJ1dHRvbnMsIHVpLlRvU3RyaW5nKCkpIHsgfVxyXG5cclxuICAgICAgICAvLy8gPHN1bW1hcnk+XHJcbiAgICAgICAgLy8vIENyZWF0ZSBhIG5ldyBNZXNzYWdlIERpYWxvZ1xyXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwicHJvbXB0XCI+VGhlIHRleHQgdG8gYmUgZGlzcGxheWVkIGluIHRoZSBtZXNzYWdlIGJveDwvcGFyYW0+XHJcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidWlcIj5UaGUgVUkgc2V0dGluZ3MgIHRvIGJlIGFwcGxpZWQgdG8gdGhlIGZvcm08L3BhcmFtPlxyXG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cImJ1dHRvbnNcIj5UaGUgVHlwZSBvZiBidXR0b24gdG8gYmUgZGlzcGxheWVkIHdpdGggdGhpcyBtZXNzYWdlPC9wYXJhbT5cclxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0aXRsZVwiPlRoZSB0aXRsZSBvZiB0aGUgbWVzc2FnZSBib3g8L3BhcmFtPlxyXG4gICAgICAgIHB1YmxpYyBNZXNzYWdlQm94Rm9ybShzdHJpbmcgcHJvbXB0LCBNZXNzYWdlQm94TGF5b3V0IHVpLCBNZXNzYWdlQm94QnV0dG9ucyBidXR0b25zLCBzdHJpbmcgdGl0bGUpIDogYmFzZSh0aXRsZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBzZWN0aW9uID0gRGl2KCk7XHJcbiAgICAgICAgICAgIHZhciBwaWMgPSBEaXYoXCJpbWFnZTMyXCIpO1xyXG4gICAgICAgICAgICB2YXIgdGV4dENvbnRlbnQgPSBEaXYoXCJtZXNzYWctYm94LWNvbnRlbnRcIik7XHJcbiAgICAgICAgICAgIF9wcm9tcHQgPSBwcm9tcHQ7XHJcbiAgICAgICAgICAgIF9idXR0b25zID0gYnV0dG9ucztcclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCh1aSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBNZXNzYWdlQm94TGF5b3V0LkV4Y2xhbWF0aW9uOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmKF9idXR0b25zID09IE1lc3NhZ2VCb3hCdXR0b25zLkF1dG8pXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYnV0dG9ucyA9IE1lc3NhZ2VCb3hCdXR0b25zLk9rO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwaWMuQ2xhc3NMaXN0LkFkZChcImltYWdld2FybmluZ1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIE1lc3NhZ2VCb3hMYXlvdXQuSW5mb3JtYXRpb246XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoX2J1dHRvbnMgPT0gTWVzc2FnZUJveEJ1dHRvbnMuQXV0bylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9idXR0b25zID0gTWVzc2FnZUJveEJ1dHRvbnMuT2s7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBpYy5DbGFzc0xpc3QuQWRkKFwiaW1hZ2VpbmZvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgTWVzc2FnZUJveExheW91dC5RdWVzdGlvbjpcclxuICAgICAgICAgICAgICAgICAgICBpZihfYnV0dG9ucyA9PSBNZXNzYWdlQm94QnV0dG9ucy5BdXRvKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2J1dHRvbnMgPSBNZXNzYWdlQm94QnV0dG9ucy5ZZXNObztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGljLkNsYXNzTGlzdC5BZGQoXCJpbWFnZWluZGV4XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgTWVzc2FnZUJveExheW91dC5FcnJvcjpcclxuICAgICAgICAgICAgICAgICAgICBpZihfYnV0dG9ucyA9PSBNZXNzYWdlQm94QnV0dG9ucy5BdXRvKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2J1dHRvbnMgPSBNZXNzYWdlQm94QnV0dG9ucy5BYm9ydFNlbmRDYW5jZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBpYy5DbGFzc0xpc3QuQWRkKFwiaW1hZ2VlcnJvclwiKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFeGNlcHRpb24oXCJ1aVwiLCB1aSwgbnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3RyaW5nIGhlaWdodENhbGMgPSBIZWxwZXIuTm90RGVza3RvcCA/IFwiKDEwMCUgLSA2MHB4KVwiIDogXCIoMTAwJSAtIDM1cHgpXCI7XHJcbiAgICAgICAgICAgIHN3aXRjaChfYnV0dG9ucylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBNZXNzYWdlQm94QnV0dG9ucy5PazpcclxuICAgICAgICAgICAgICAgICAgICBfYnV0dG9uQ29sbGVjdGlvbiA9IGdsb2JhbDo6QnJpZGdlLlNjcmlwdC5DYWxsRm9yKG5ldyBMaXN0PFNpbXBsZURpYWxvZ0J1dHRvbj4oKSwoX280KT0+e19vNC5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLk9LKSB7IFRleHQgPSBcIk9rXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoNTAlIC0gMzcuNXB4KVwiLCBoZWlnaHRDYWxjKX0pO3JldHVybiBfbzQ7fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSBNZXNzYWdlQm94QnV0dG9ucy5ZZXNObzpcclxuICAgICAgICAgICAgICAgICAgICBfYnV0dG9uQ29sbGVjdGlvbiA9IGdsb2JhbDo6QnJpZGdlLlNjcmlwdC5DYWxsRm9yKG5ldyBMaXN0PFNpbXBsZURpYWxvZ0J1dHRvbj4oKSwoX281KT0+e19vNS5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLk5vKSB7IFRleHQgPSBcIk5vXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDg1cHgpXCIsIGhlaWdodENhbGMpfSk7X281LkFkZChuZXcgU2ltcGxlRGlhbG9nQnV0dG9uKHRoaXMsIERpYWxvZ1Jlc3VsdEVudW0uWWVzKSB7IFRleHQgPSBcIlllc1wiLCBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKDEwMCUgLSAxNzBweClcIiwgaGVpZ2h0Q2FsYyl9KTtyZXR1cm4gX281O30pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgTWVzc2FnZUJveEJ1dHRvbnMuWWVzTm9DYW5jZWw6XHJcbiAgICAgICAgICAgICAgICAgICAgX2J1dHRvbkNvbGxlY3Rpb24gPSBnbG9iYWw6OkJyaWRnZS5TY3JpcHQuQ2FsbEZvcihuZXcgTGlzdDxTaW1wbGVEaWFsb2dCdXR0b24+KCksKF9vNik9PntfbzYuQWRkKG5ldyBTaW1wbGVEaWFsb2dCdXR0b24odGhpcywgRGlhbG9nUmVzdWx0RW51bS5DYW5jZWwpIHsgVGV4dCA9IFwiQ2FuY2VsXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDg1cHgpXCIsIGhlaWdodENhbGMpIH0pO19vNi5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLk5vKSB7IFRleHQgPSBcIk5vXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDE3MHB4KVwiLCBoZWlnaHRDYWxjKSB9KTtfbzYuQWRkKG5ldyBTaW1wbGVEaWFsb2dCdXR0b24odGhpcywgRGlhbG9nUmVzdWx0RW51bS5ZZXMpIHsgVGV4dCA9IFwiWWVzXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDI1NXB4KVwiLCBoZWlnaHRDYWxjKSB9KTtyZXR1cm4gX282O30pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgTWVzc2FnZUJveEJ1dHRvbnMuQWJvcnRTZW5kQ2FuY2VsOlxyXG4gICAgICAgICAgICAgICAgICAgIF9idXR0b25Db2xsZWN0aW9uID0gZ2xvYmFsOjpCcmlkZ2UuU2NyaXB0LkNhbGxGb3IobmV3IExpc3Q8U2ltcGxlRGlhbG9nQnV0dG9uPigpLChfbzcpPT57X283LkFkZChuZXcgU2ltcGxlRGlhbG9nQnV0dG9uKHRoaXMsIERpYWxvZ1Jlc3VsdEVudW0uQ2FuY2VsKSB7IFRleHQgPSBcIkNhbmNlbFwiLCBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKDEwMCUgLSA4NXB4KVwiLCBoZWlnaHRDYWxjKX0pO19vNy5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLlNlbmQpIHsgVGV4dCA9IFwiU2VuZFwiLCBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKDEwMCUgLSAxNzBweClcIiwgaGVpZ2h0Q2FsYyksIEl0ZW1DbGljayA9IChldikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoU2V0dGluZ3MuT25TZW5kRXJyb3IgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXR0aW5ncy5PblNlbmRFcnJvcihfcHJvbXB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSB9KTtfbzcuQWRkKG5ldyBTaW1wbGVEaWFsb2dCdXR0b24odGhpcywgRGlhbG9nUmVzdWx0RW51bS5BYm9ydCkgeyBUZXh0ID0gXCJBYm9ydFwiLCBMb2NhdGlvbiA9IG5ldyBWZWN0b3IyKFwiKDEwMCUgLSAyNTVweClcIiwgaGVpZ2h0Q2FsYyksIEl0ZW1DbGljayA9IChldikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBwcmUgPVNldHRpbmdzLkFsbG93Q2xvc2VXaXRob3V0UXVlc3Rpb247XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0dGluZ3MuQWxsb3dDbG9zZVdpdGhvdXRRdWVzdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb24uQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldHRpbmdzLkFsbG93Q2xvc2VXaXRob3V0UXVlc3Rpb24gPSBwcmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19KTtyZXR1cm4gX283O30pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUV4Y2VwdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFRleHRCbG9jayB0YiA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBpbnQgd2lkdGggPSA0ODA7XHJcblxyXG4gICAgICAgICAgICBpZighSGVscGVyLk5vdERlc2t0b3ApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRiID0gbmV3IFRleHRCbG9jayhwcm9tcHQsIDQ4MCAtIDI1KTtcclxuICAgICAgICAgICAgICAgIHRiLkNvbXB1dGVTdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgIGlmKF9idXR0b25Db2xsZWN0aW9uLkNvdW50ID4gMilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih3aWR0aCA8IDMyMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAzMjA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZighdGIuRWxlbGVtdHNPdmVyTWF4KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gKGludCl0Yi5NYXhDYWxjdWxhdGVkV2lkdGggKyA2NSArIDM3O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHdpZHRoIDwgU2V0dGluZ3MuTWVzc2FnZUZvcm1NaW5pbXVtV2lkdGhJblB4KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IFNldHRpbmdzLk1lc3NhZ2VGb3JtTWluaW11bVdpZHRoSW5QeDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGludCBjb3VudCA9IF9idXR0b25Db2xsZWN0aW9uLkNvdW50O1xyXG4gICAgICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGNvdW50OyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ1dCA9IF9idXR0b25Db2xsZWN0aW9uW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dC5IZWlnaHQgPSA0NTtcclxuICAgICAgICAgICAgICAgICAgICBidXQuU3R5bGUuQm9yZGVyUmFkaXVzID0gXCI0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICBidXQuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICBpZihidXQuRGlhbG9nUmVzdWx0ID09IERpYWxvZ1Jlc3VsdEVudW0uT0sgfHwgYnV0LkRpYWxvZ1Jlc3VsdCA9PSBEaWFsb2dSZXN1bHRFbnVtLlllcylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dC5DbGFzc0xpc3QuQWRkKFwicHJpbWFyeVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0LlN0eWxlLkNvbG9yID0gXCJ3aGl0ZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXQuU3R5bGUuQm9yZGVyID0gXCIwXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0ZXh0Q29udGVudC5Jbm5lckhUTUwgPSBwcm9tcHQ7XHJcblxyXG4gICAgICAgICAgICBzZWN0aW9uLlN0eWxlLk92ZXJmbG93WSA9IE92ZXJmbG93LkF1dG87XHJcbiAgICAgICAgICAgIHNlY3Rpb24uU3R5bGUuSGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgICAgIHNlY3Rpb24uU3R5bGUuTWF4SGVpZ2h0ID0gU2V0dGluZ3MuTWVzc2FnZUZvcm1UZXh0TWF4aW11bUhlaWdodEluUHguVG9QeCgpO1xyXG4gICAgICAgICAgICBzZWN0aW9uLkFwcGVuZENoaWxkKHRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgc2VjdGlvbi5TdHlsZS5Ub3AgPSBcIjMycHhcIjtcclxuICAgICAgICAgICAgc2VjdGlvbi5TdHlsZS5XaWR0aCA9IFwiOTAlXCI7XHJcblxyXG4gICAgICAgICAgICBiYXNlLkJvZHkuQXBwZW5kQ2hpbGRyZW4ocGljLCBzZWN0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIEJ1dHRvblNlY3Rpb24uQXBwZW5kQ2hpbGRyZW5UYWJJbmRleChfYnV0dG9uQ29sbGVjdGlvbi5Ub0FycmF5KCkpO1xyXG4gICAgICAgICAgICBpZihIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc2VjdGlvbi5TdHlsZS5UZXh0QWxpZ24gPSBUZXh0QWxpZ24uQ2VudGVyO1xyXG4gICAgICAgICAgICAgICAgc2VjdGlvbi5TdHlsZS5MaW5lSGVpZ2h0ID0gXCIxMDAlXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgV2luZG93U3RhdGUgPSBXaW5kb3dTdGF0ZVR5cGUuTWF4aW1pemVkO1xyXG4gICAgICAgICAgICAgICAgSGVhZGluZy5TdHlsZS5EaXNwbGF5ID0gRGlzcGxheS5Ob25lO1xyXG4gICAgICAgICAgICAgICAgQm9keS5TZXRMb2NhdGlvbigwLCAwKTtcclxuICAgICAgICAgICAgICAgIEJvZHkuU2V0U2l6ZShcIjEwMCVcIiwgXCIxMDAlXCIpO1xyXG4gICAgICAgICAgICAgICAgU3RhcnRQb3NpdGlvbiA9IEZvcm1TdGFydFBvc2l0aW9uLk1hbnVhbDtcclxuICAgICAgICAgICAgICAgIEFsbG93U2l6ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgQWxsb3dNb3ZlQ2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgU2hvd01heGltaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBTaG93TWluaW1pemUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIFNob3dDbG9zZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIHRleHRDb250ZW50LlN0eWxlLkRpc3BsYXkgPSBEaXNwbGF5LklubGluZUJsb2NrO1xyXG4gICAgICAgICAgICAgICAgdGV4dENvbnRlbnQuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgIHRleHRDb250ZW50LlN0eWxlLlZlcnRpY2FsQWxpZ24gPSBWZXJ0aWNhbEFsaWduLk1pZGRsZTtcclxuICAgICAgICAgICAgICAgIHRleHRDb250ZW50LlN0eWxlLkxpbmVIZWlnaHQgPSBcIm5vcm1hbFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYodGIuQ29tcHV0ZWRIZWlnaHQgPiBTZXR0aW5ncy5NZXNzYWdlRm9ybVRleHRNYXhpbXVtSGVpZ2h0SW5QeClcclxuICAgICAgICAgICAgICAgICAgICB0Yi5Db21wdXRlZEhlaWdodCA9IFNldHRpbmdzLk1lc3NhZ2VGb3JtVGV4dE1heGltdW1IZWlnaHRJblB4O1xyXG4gICAgICAgICAgICAgICAgaWYodGIuQ29tcHV0ZWRIZWlnaHQgPCBTZXR0aW5ncy5NZXNzYWdlRm9ybVRleHRNaW5pbXVtSGVpZ2h0SW5QeClcclxuICAgICAgICAgICAgICAgICAgICB0Yi5Db21wdXRlZEhlaWdodCA9IFNldHRpbmdzLk1lc3NhZ2VGb3JtVGV4dE1pbmltdW1IZWlnaHRJblB4O1xyXG5cclxuICAgICAgICAgICAgICAgIGJhc2UuSGVpZ2h0ID0gdGIuQ29tcHV0ZWRIZWlnaHQgKyA3NyArIDI5ICsgMzIgKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICBiYXNlLldpZHRoID0gd2lkdGguVG9QeCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBiYXNlLkFsbG93U2l6ZUNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25TaG93ZWQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgQmVlcCgpO1xyXG5cclxuICAgICAgICAgICAgYmFzZS5PblNob3dlZCgpO1xyXG4gICAgICAgICAgICBfYnV0dG9uQ29sbGVjdGlvblswXS5Db250ZW50LkZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBlbnVtIE1lc3NhZ2VCb3hMYXlvdXRcclxuICAgIHtcclxuICAgICAgICBJbmZvcm1hdGlvbixcclxuICAgICAgICBFeGNsYW1hdGlvbixcclxuICAgICAgICBRdWVzdGlvbixcclxuICAgICAgICBFcnJvclxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBlbnVtIE1lc3NhZ2VCb3hCdXR0b25zXHJcbiAgICB7XHJcbiAgICAgICAgQXV0byxcclxuICAgICAgICBPayxcclxuICAgICAgICBZZXNObyxcclxuICAgICAgICBZZXNOb0NhbmNlbCxcclxuICAgICAgICBBYm9ydFNlbmRDYW5jZWxcclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIE51bWJlcklucHV0IDogVGV4dElucHV0RHJvcERvd25cclxuICAgIHtcclxuICAgICAgICBwdWJsaWMgTnVtYmVySW5wdXQoKSA6IGJhc2UoSW5wdXRUeXBlLk51bWJlcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFVzZWRFZGl0LlNldEF0dHJpYnV0ZShcInN0ZXBcIiwgXCJhbnlcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBPbkRyb3BEb3duQ2xpY2tlZChNb3VzZUV2ZW50IG1vdXNlRXZlbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighUmVhZG9ubHkgJiYgRW5hYmxlZClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhbGNFZGl0ID0gbmV3IENhbGNGb3JtKHRoaXMuVXNlZEVkaXQpO1xyXG4gICAgICAgICAgICAgICAgY2FsY0VkaXQuXHJcbiAgICAgICAgICAgICAgICBTaG93UG9wdXAoRm9ybVBvcHVwLlxyXG4gICAgICAgICAgICAgICAgICAgIEdldFBvcHVwRGVmYXVsdExvY2F0aW9uKERyb3BEb3duQnV0dG9uLCB0cnVlKSk7XHJcbiAgICAgICAgICAgICAgICBjYWxjRWRpdC5PbkZvcm1DbG9zZWQgPSAoKSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFZhbGlkYXRlRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBTZWFyY2hJbnB1dCA6IFRleHRJbnB1dERyb3BEb3duXHJcbiAgICB7XHJcbiAgICAgICAgcHVibGljIG9iamVjdCBFZGl0VmFsdWUgeyBnZXQ7IHNldDsgfVxyXG4gICAgICAgIHB1YmxpYyBzdHJpbmcgRGlzcGxheU1lbWJlciB7IGdldDsgc2V0OyB9XHJcbiAgICAgICAgcHVibGljIHN0cmluZyBWYWx1ZU1lbWJlciB7IGdldDsgc2V0OyB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBTZWFyY2hJbnB1dCgpIDogYmFzZShJbnB1dFR5cGUuVGV4dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFVzZWRFZGl0Lk9uS2V5RG93biA9IChvYmosIGV2KSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihldi5LZXlDb2RlID09IDEzIHx8IGV2LktleUNvZGUgPT0gNDApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgT25Ecm9wRG93bkNsaWNrZWQobmV3IE1vdXNlRXZlbnQoXCJvbm1vdXNlZG93blwiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFVzZWRFZGl0LkNvbnRlbnQuT25Nb3VzZURvd24gPSAoZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIE9uRHJvcERvd25DbGlja2VkKG5ldyBNb3VzZUV2ZW50KFwib25tb3VzZWRvd25cIikpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIEFjdGlvbjxzdHJpbmcsIEdyaWRWaWV3PiBPblNlYXJjaDtcclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgYm9vbCBDbGVhck9uT3BlbigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIE9uUmVxdWVzdFNlYXJjaChzdHJpbmcgc2VhcmNoVmFsdWUsIEdyaWRWaWV3IGdyaWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihPblNlYXJjaCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgT25TZWFyY2goc2VhcmNoVmFsdWUsIGdyaWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgYm9vbCBTZWFyY2hPbkxvYWQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHZpcnR1YWwgdm9pZCBPbkFjY2VwdFJlc3VsdChEYXRhUm93IHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYodmFsdWUgPT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgRWRpdFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIFRleHQgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoVmFsdWVNZW1iZXIgIT0gXCJcIilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBFZGl0VmFsdWUgPSB2YWx1ZS5HZXRWYWx1ZShWYWx1ZU1lbWJlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihEaXNwbGF5TWVtYmVyICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9ICh2YWx1ZS5HZXRWYWx1ZShEaXNwbGF5TWVtYmVyKSArIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgdmlydHVhbCB2b2lkIE9uUmVxdWVzdE5ldyhHcmlkVmlldyBncmlkKVxyXG4gICAgICAgIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyB2aXJ0dWFsIHZvaWQgT25DbG9zZWQoRGF0YVJvdyB2YWx1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgdm9pZCBPbkRyb3BEb3duQ2xpY2tlZChNb3VzZUV2ZW50IG1vdXNlRXZlbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighUmVhZG9ubHkgJiYgRW5hYmxlZClcclxuICAgICAgICAgICAgICAgIChuZXcgU2VhcmNoTG9va3VwRm9ybSh0aGlzKSkuXHJcbiAgICAgICAgICAgICAgICBTaG93UG9wdXAoRm9ybVBvcHVwLlxyXG4gICAgICAgICAgICAgICAgICAgIEdldFBvcHVwRGVmYXVsdExvY2F0aW9uKERyb3BEb3duQnV0dG9uLCB0cnVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwidXNpbmcgQnJpZGdlLkh0bWw1O1xyXG5cclxubmFtZXNwYWNlIEV4cHJlc3NDcmFmdFxyXG57XHJcbiAgICBwdWJsaWMgY2xhc3MgU2VhcmNoTG9va3VwRm9ybSA6IEZvcm1Qb3B1cFxyXG4gICAge1xyXG4gICAgICAgIHB1YmxpYyBTZWFyY2hJbnB1dCBTZWFyY2hJbnB1dDtcclxuICAgICAgICBwdWJsaWMgRGF0YVJvdyBGb2N1c2VkUm93O1xyXG4gICAgICAgIHB1YmxpYyBHcmlkVmlldyBWaWV3O1xyXG5cclxuICAgICAgICBwdWJsaWMgVGV4dElucHV0IFNlYXJjaEVkaXQ7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5TZWFyY2g7XHJcbiAgICAgICAgcHVibGljIFNpbXBsZUJ1dHRvbiBidG5DbG9zZTtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bk5ldztcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0blVzZTtcclxuICAgICAgICBwdWJsaWMgU2ltcGxlQnV0dG9uIGJ0bkNsZWFyO1xyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPblNob3dlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uU2hvd2VkKCk7XHJcblxyXG4gICAgICAgICAgICBTZWFyY2hFZGl0LkZvY3VzKCk7XHJcblxyXG4gICAgICAgICAgICBpZihTZWFyY2hJbnB1dC5TZWFyY2hPbkxvYWQoKSlcclxuICAgICAgICAgICAgICAgIGJ0blNlYXJjaC5Db250ZW50LkNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgU2VhcmNoTG9va3VwRm9ybShTZWFyY2hJbnB1dCBzZWFyY2hJbnB1dCkgOiBiYXNlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHNlYXJjaElucHV0LkNvbnRlbnQuUGFyZW50RWxlbWVudCAhPSBudWxsICYmIHNlYXJjaElucHV0LkNvbnRlbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFByZXZpb3VzU2Nyb2xsVG9wID0gc2VhcmNoSW5wdXQuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQuU2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAgICAgUGFyZW50Q29udGFpbmVyID0gc2VhcmNoSW5wdXQuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHggPSBzZWFyY2hJbnB1dC5Db250ZW50LkdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICAgICAgTWluSGVpZ2h0ID0gMTAwO1xyXG4gICAgICAgICAgICBNaW5XaWR0aCA9IDE1MDtcclxuXHJcbiAgICAgICAgICAgIHZhciB3aWQgPSBzZWFyY2hJbnB1dC5HZXREcm9wZG93bldpZHRoKCk7XHJcbiAgICAgICAgICAgIGlmKHdpZCA8IDE1MClcclxuICAgICAgICAgICAgICAgIHdpZCA9IDE1MDtcclxuXHJcbiAgICAgICAgICAgIFNpemUgPSBuZXcgVmVjdG9yMih3aWQsIDI1MCk7XHJcblxyXG4gICAgICAgICAgICBBbGxvd1NpemVDaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgU2VhcmNoSW5wdXQgPSBzZWFyY2hJbnB1dDtcclxuXHJcbiAgICAgICAgICAgIHZhciBmcmFnID0gRG9jdW1lbnQuQ3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICAgICAgICAgICAgZnJhZy5BcHBlbmRDaGlsZHJlbihcclxuICAgICAgICAgICAgICAgIFNlYXJjaEVkaXQgPSBuZXcgVGV4dElucHV0KClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gc2VhcmNoSW5wdXQuQ2xlYXJPbk9wZW4oKSA/IFwiXCIgOiBTZWFyY2hJbnB1dC5UZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIE9uRm9jdXNEb250U2VsZWN0QWxsID0gdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBEaXNhYmxlRm9jdXNQb3B1cCA9IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgQm91bmRzID0gbmV3IFZlY3RvcjQoNCwgNCwgXCIoMTAwJSAtIDY4cHgpXCIsIDIwKSxcclxuICAgICAgICAgICAgICAgICAgICBUb29sVGlwID0gbmV3IFRvb2xUaXAoXCJIZWxwOlwiLCBcIltFbnRlcl0gdG8gU2VhcmNoLCBbQ1RSTF0gKyBbRW50ZXJdIHRvIFNlYXJjaCBhbmQgVXNlLCBbRVNDXSB0byBjbG9zZVwiKVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0blNlYXJjaCA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcIlNlYXJjaFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEJvdW5kcyA9IG5ldyBWZWN0b3I0KFwiKDEwMCUgLSA2NXB4KVwiLCA0LCA2MSwgMjApLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IChzKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2VhcmNoSW5wdXQuT25SZXF1ZXN0U2VhcmNoKFNlYXJjaEVkaXQuVGV4dCwgVmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIFZpZXcgPSBuZXcgR3JpZFZpZXcodHJ1ZSwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBBbGxvd011bHRpU2VsZWN0aW9uID0gZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVXNlRWRpdEZvcm0gPSBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBCb3VuZHMgPSBuZXcgVmVjdG9yNCg0LCAyOCwgXCIoMTAwJSAtIDEwcHgpXCIsIFwiKDEwMCUgLSA2MHB4KVwiKVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJ0bkNsb3NlID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiJnRpbWVzO1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIEJvdW5kcyA9IG5ldyBWZWN0b3I0KDQsIFwiKDEwMCUgLSAyNXB4KVwiLCAyMCwgMjApLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IChzKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuTmV3ID0gbmV3IFNpbXBsZUJ1dHRvbigpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IFwiTmV3XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgQm91bmRzID0gbmV3IFZlY3RvcjQoXCIoMTAwJSAtIDY1cHgpXCIsIFwiKDEwMCUgLSAyNXB4KVwiLCA2MSwgMjApLFxyXG4gICAgICAgICAgICAgICAgICAgIEl0ZW1DbGljayA9IChzKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2VhcmNoSW5wdXQuT25SZXF1ZXN0TmV3KFZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIGJ0blVzZSA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFRleHQgPSBcIlVzZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEJvdW5kcyA9IG5ldyBWZWN0b3I0KFwiKDEwMCUgLSAxMzJweClcIiwgXCIoMTAwJSAtIDI1cHgpXCIsIDYxLCAyMCksXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gKHMpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihWaWV3LkZvY3VzZWREYXRhSGFuZGxlID09IC0xICYmIFZpZXcuUm93Q291bnQoKSA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXcuRm9jdXNlZERhdGFIYW5kbGUgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKEZvY3VzZWRSb3cgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VhcmNoSW5wdXQuT25BY2NlcHRSZXN1bHQoRm9jdXNlZFJvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnRuQ2xlYXIgPSBuZXcgU2ltcGxlQnV0dG9uKClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBUZXh0ID0gXCJDbGVhclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIEJvdW5kcyA9IG5ldyBWZWN0b3I0KFwiKDEwMCUgLSAxOTlweClcIiwgXCIoMTAwJSAtIDI1cHgpXCIsIDYxLCAyMCksXHJcbiAgICAgICAgICAgICAgICAgICAgSXRlbUNsaWNrID0gKHMpID0+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBGb2N1c2VkUm93ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU2VhcmNoSW5wdXQuT25BY2NlcHRSZXN1bHQoRm9jdXNlZFJvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGJ0bkNsb3NlLlN0eWxlLkNvbG9yID0gXCJyZWRcIjtcclxuXHJcbiAgICAgICAgICAgIGlmKEhlbHBlci5Ob3REZXNrdG9wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTZWFyY2hFZGl0LlN0eWxlLkZvbnRTaXplID0gXCIxNHB4XCI7XHJcbiAgICAgICAgICAgICAgICBTZWFyY2hFZGl0LkhlaWdodCA9IFwiNDVweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blNlYXJjaC5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuU2VhcmNoLkhlaWdodCA9IDQ1O1xyXG5cclxuICAgICAgICAgICAgICAgIFZpZXcuVG9wID0gNTU7XHJcbiAgICAgICAgICAgICAgICBWaWV3LkhlaWdodCA9IFwiKDEwMCUgLSAxMTJweClcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBidG5DbGVhci5TdHlsZS5Gb250U2l6ZSA9IFwiMTRweFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuQ2xlYXIuSGVpZ2h0ID0gNDU7XHJcbiAgICAgICAgICAgICAgICBidG5DbGVhci5Ub3AgPSBcIigxMDAlIC0gNTFweClcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBidG5Vc2UuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgIGJ0blVzZS5IZWlnaHQgPSA0NTtcclxuICAgICAgICAgICAgICAgIGJ0blVzZS5Ub3AgPSBcIigxMDAlIC0gNTFweClcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBidG5OZXcuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgIGJ0bk5ldy5IZWlnaHQgPSA0NTtcclxuICAgICAgICAgICAgICAgIGJ0bk5ldy5Ub3AgPSBcIigxMDAlIC0gNTFweClcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBidG5DbG9zZS5TdHlsZS5Gb250U2l6ZSA9IFwiMjZweFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuQ2xvc2UuU3R5bGUuRm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgICAgICAgICAgICAgYnRuQ2xvc2UuSGVpZ2h0ID0gNDU7XHJcbiAgICAgICAgICAgICAgICBidG5DbG9zZS5XaWR0aCA9IDYxO1xyXG4gICAgICAgICAgICAgICAgYnRuQ2xvc2UuVG9wID0gXCIoMTAwJSAtIDUxcHgpXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFNlYXJjaEVkaXQuT25LZXlEb3duID0gKG9iaiwgZXYpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKGV2LktleUNvZGUgPT0gOSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBDbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKGV2LktleUNvZGUgPT0gMTMpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgU2VhcmNoSW5wdXQuT25SZXF1ZXN0U2VhcmNoKFNlYXJjaEVkaXQuVGV4dCwgVmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZXYuQ3RybEtleSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0blVzZS5Db250ZW50LkNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKGV2LktleUNvZGUgPT0gMjcpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgRm9jdXNlZFJvdyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LlByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBWaWV3Lk9uRm9jdXNlZFJvd0NoYW5nZWQgPSAocm93LCBjb2wpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKFZpZXcuRm9jdXNlZERhdGFIYW5kbGUgPiAtMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c2VkUm93ID0gVmlldy5EYXRhU291cmNlW1ZpZXcuR2V0RGF0YVNvdXJjZVJvdyhWaWV3LkZvY3VzZWREYXRhSGFuZGxlKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgRm9jdXNlZFJvdyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBTZWFyY2hJbnB1dC5PbkFjY2VwdFJlc3VsdChGb2N1c2VkUm93KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIFZpZXcuT25Sb3dEb3VibGVDbGljayA9IChyb3cpID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKFZpZXcuRm9jdXNlZERhdGFIYW5kbGUgPiAtMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c2VkUm93ID0gVmlldy5EYXRhU291cmNlW1ZpZXcuR2V0RGF0YVNvdXJjZVJvdyhWaWV3LkZvY3VzZWREYXRhSGFuZGxlKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgRm9jdXNlZFJvdyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBTZWFyY2hJbnB1dC5PbkFjY2VwdFJlc3VsdChGb2N1c2VkUm93KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuQ2xvc2UoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuQm9keS5BcHBlbmRDaGlsZChmcmFnKTtcclxuXHJcbiAgICAgICAgICAgIFNlYXJjaEVkaXQuT25Hb3RGb2N1cyA9IChvYmopID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFNlYXJjaEVkaXQuR2V0SW5wdXQoKS5TZWxlY3Rpb25TdGFydCA9IFNlYXJjaEVkaXQuVGV4dC5MZW5ndGg7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBMaW5rY2hpbGRUb0Zvcm0oVmlldyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPbkNsb3NlZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlLk9uQ2xvc2VkKCk7XHJcblxyXG4gICAgICAgICAgICBTZWFyY2hJbnB1dC5PbkNsb3NlZChGb2N1c2VkUm93KTtcclxuICAgICAgICAgICAgU2VhcmNoSW5wdXQuVmFsaWRhdGVEYXRhKCk7XHJcbiAgICAgICAgICAgIGlmKCFIZWxwZXIuTm90RGVza3RvcClcclxuICAgICAgICAgICAgICAgIFNlYXJjaElucHV0LkdldElucHV0KCkuRm9jdXMoKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBTZWFyY2hJbnB1dC5TY3JvbGwoUHJldmlvdXNTY3JvbGxUb3AsIFBhcmVudENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ1c2luZyBCcmlkZ2UuSHRtbDU7XHJcbnVzaW5nIEJyaWRnZS5qUXVlcnkyO1xyXG51c2luZyBTeXN0ZW07XHJcblxyXG5uYW1lc3BhY2UgRXhwcmVzc0NyYWZ0XHJcbntcclxuICAgIHB1YmxpYyBjbGFzcyBUZXh0Rm9ybSA6IEZvcm1Qb3B1cFxyXG4gICAge1xyXG4gICAgICAgIHByaXZhdGUgVGV4dElucHV0IFJlYWRJbnB1dDtcclxuICAgICAgICBwcml2YXRlIFRleHRJbnB1dCBFZGl0SW5wdXQ7XHJcbiAgICAgICAgcHJpdmF0ZSBTaW1wbGVCdXR0b24gYnRuRG9uZTtcclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25TaG93ZWQoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZS5PblNob3dlZCgpO1xyXG5cclxuICAgICAgICAgICAgc3RyaW5nIGRhdGFQID0gUmVhZElucHV0LkdldEF0dHJpYnV0ZShcImRhdGEtcGxhY2Vob2xkZXJcIik7XHJcbiAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKGRhdGFQKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgRWRpdElucHV0LlNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIGRhdGFQKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCFzdHJpbmcuSXNOdWxsT3JXaGl0ZVNwYWNlKFJlYWRJbnB1dC5HZXRBdHRyaWJ1dGUoXCJwbGFjZWhvbGRlclwiKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgRWRpdElucHV0LlNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIFJlYWRJbnB1dC5HZXRBdHRyaWJ1dGUoXCJwbGFjZWhvbGRlclwiKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIEVkaXRJbnB1dC5Gb2N1cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFRleHRGb3JtKFRleHRJbnB1dCBpbnB1dCkgOiBiYXNlKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGlucHV0LkNvbnRlbnQuUGFyZW50RWxlbWVudCAhPSBudWxsICYmIGlucHV0LkNvbnRlbnQuUGFyZW50RWxlbWVudC5QYXJlbnRFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFByZXZpb3VzU2Nyb2xsVG9wID0gaW5wdXQuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQuU2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAgICAgUGFyZW50Q29udGFpbmVyID0gaW5wdXQuQ29udGVudC5QYXJlbnRFbGVtZW50LlBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFdpbmRvd1N0YXRlID0gV2luZG93U3RhdGVUeXBlLk1heGltaXplZDtcclxuXHJcbiAgICAgICAgICAgIFJlYWRJbnB1dCA9IGlucHV0O1xyXG5cclxuICAgICAgICAgICAgaWYoUmVhZElucHV0IGlzIE1lbW9JbnB1dClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgRWRpdElucHV0ID0gbmV3IE1lbW9JbnB1dCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgRWRpdElucHV0ID0gbmV3IFRleHRJbnB1dChpbnB1dC5UeXBlKSB7IERpc3BsYXlGb3JtYXQgPSBSZWFkSW5wdXQuRGlzcGxheUZvcm1hdCB9O1xyXG4gICAgICAgICAgICAgICAgRWRpdElucHV0Lk9uS2V5RG93biA9IChzLCBldikgPT5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihldi5LZXlDb2RlID09IDEzKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuRG9uZS5Db250ZW50LkNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgRWRpdElucHV0LlRleHQgPSBpbnB1dC5UZXh0O1xyXG4gICAgICAgICAgICBFZGl0SW5wdXQuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuXHJcbiAgICAgICAgICAgIEVkaXRJbnB1dC5EaXNhYmxlRm9jdXNQb3B1cCA9IHRydWU7XHJcbiAgICAgICAgICAgIEVkaXRJbnB1dC5TaXplID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDExMnB4KVwiLCBcIjEwMCVcIik7XHJcbiAgICAgICAgICAgIEVkaXRJbnB1dC5Mb2NhdGlvbiA9IG5ldyBWZWN0b3IyKDAsIDApO1xyXG5cclxuICAgICAgICAgICAgYnRuRG9uZSA9IG5ldyBTaW1wbGVCdXR0b24oKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBUZXh0ID0gXCImdGltZXM7XCIsXHJcbiAgICAgICAgICAgICAgICBCb3VuZHMgPSBuZXcgVmVjdG9yNChcIigxMDAlIC0gMTA2cHgpXCIsIFwiKDUwJSAtIDIyLjVweClcIiwgMTAwLCA0NSksXHJcbiAgICAgICAgICAgICAgICBJdGVtQ2xpY2sgPSAoc2VuZGVyKSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihFZGl0SW5wdXQuR2V0RWRpdFZhbHVlKCkgIT0gUmVhZElucHV0LkdldEVkaXRWYWx1ZSgpKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUmVhZElucHV0LlRleHQgPSBFZGl0SW5wdXQuVGV4dDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFJlYWRJbnB1dC5Jc1N1Ym1pdClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHluYW1pYyBlID0galF1ZXJ5LkV2ZW50KFwia2V5cHJlc3NcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLndoaWNoID0gMTM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmtleUNvZGUgPSAxMztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeS5TZWxlY3QoUmVhZElucHV0LkNvbnRlbnQpLlRyaWdnZXIoKGpRdWVyeUV2ZW50KWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoUmVhZElucHV0LkdvTmV4dClcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBEb2N1bWVudC5RdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXQsIHRleHRhcmVhLCBidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgdGFiUGx1czEgPSBSZWFkSW5wdXQuQ29udGVudC5UYWJJbmRleCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgeC5MZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4W2ldLkFzPEhUTUxFbGVtZW50PigpLlRhYkluZGV4ID09IHRhYlBsdXMxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeFtpXS5BczxIVE1MRWxlbWVudD4oKS5Gb2N1c0VsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgYnRuRG9uZS5TdHlsZS5Cb3JkZXJSYWRpdXMgPSBcIjRweFwiO1xyXG4gICAgICAgICAgICBidG5Eb25lLkNsYXNzTGlzdC5BZGQoXCJwcmltYXJ5XCIpO1xyXG4gICAgICAgICAgICBidG5Eb25lLlN0eWxlLkJvcmRlcldpZHRoID0gXCIwXCI7XHJcblxyXG4gICAgICAgICAgICBidG5Eb25lLlRleHQgPSBcIiZ0aW1lcztcIjtcclxuICAgICAgICAgICAgYnRuRG9uZS5TdHlsZS5Gb250U2l6ZSA9IFwiMjZweFwiO1xyXG4gICAgICAgICAgICBidG5Eb25lLlN0eWxlLkNvbG9yID0gXCJ3aGl0ZVwiO1xyXG4gICAgICAgICAgICBidG5Eb25lLlN0eWxlLkZvbnRXZWlnaHQgPSBcImJvbGRcIjtcclxuXHJcbiAgICAgICAgICAgIEVkaXRJbnB1dC5PblRleHRDaGFuZ2VkID0gKHNlbmRlcikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoRWRpdElucHV0LkdldEVkaXRWYWx1ZSgpID09IFJlYWRJbnB1dC5HZXRFZGl0VmFsdWUoKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBidG5Eb25lLlRleHQgPSBcIiZ0aW1lcztcIjtcclxuICAgICAgICAgICAgICAgICAgICBidG5Eb25lLlN0eWxlLkZvbnRTaXplID0gXCIyNnB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuRG9uZS5TdHlsZS5Gb250V2VpZ2h0ID0gXCJib2xkXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuRG9uZS5UZXh0ID0gUmVhZElucHV0LklzU3VibWl0ID8gXCJTdWJtaXRcIiA6IFJlYWRJbnB1dC5Hb05leHQgPyBcIk5leHRcIiA6IFwiRG9uZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ0bkRvbmUuU3R5bGUuRm9udFNpemUgPSBcIjE0cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICBidG5Eb25lLlN0eWxlLkZvbnRXZWlnaHQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgQXBwZW5kQ2hpbGRyZW4oRWRpdElucHV0LCBidG5Eb25lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uQ2xvc2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFJlYWRJbnB1dC5TY3JvbGwoUHJldmlvdXNTY3JvbGxUb3AsIFBhcmVudENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIFJlYWRJbnB1dC5WYWxpZGF0ZURhdGEoKTtcclxuICAgICAgICAgICAgYmFzZS5PbkNsb3NlZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsInVzaW5nIEJyaWRnZS5IdG1sNTtcclxudXNpbmcgTmV3dG9uc29mdC5Kc29uO1xyXG51c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYztcclxuXHJcbm5hbWVzcGFjZSBFeHByZXNzQ3JhZnRcclxue1xyXG4gICAgcHVibGljIGNsYXNzIFRoZW1lRm9ybSA6IERpYWxvZ0Zvcm1cclxuICAgIHtcclxuICAgICAgICBwcml2YXRlIFRoZW1lIGN1cnJlbnRUaGVtZTtcclxuICAgICAgICBwcml2YXRlIFRoZW1lIHByZXZUaGVtZTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYm9vbCBfdGhlbWVWaXNpYmxlO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIFRoZW1lRm9ybSB0aGVtZUZvcm0gPSBudWxsO1xyXG5cclxuICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2hvd1RoZW1lRm9ybSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZighX3RoZW1lVmlzaWJsZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhlbWVGb3JtID0gbmV3IFRoZW1lRm9ybSgpO1xyXG4gICAgICAgICAgICAgICAgdGhlbWVGb3JtLlNob3codHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3RoZW1lVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uQ2xvc2VkKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2UuT25DbG9zZWQoKTtcclxuICAgICAgICAgICAgX3RoZW1lVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvdGVjdGVkIG92ZXJyaWRlIHZvaWQgT25Hb3RGb2N1cygpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihDb250ZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFN0eWxlLk9wYWNpdHkgPSBcIjFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiYXNlLk9uR290Rm9jdXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSB2b2lkIE9uTG9zdEZvY3VzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKENvbnRlbnQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgU3R5bGUuT3BhY2l0eSA9IFwiMC41XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYmFzZS5Pbkxvc3RGb2N1cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIFRoZW1lRm9ybSgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwcmV2VGhlbWUgPSBTZXR0aW5ncy5BY3RpdmVUaGVtZTtcclxuICAgICAgICAgICAgY3VycmVudFRoZW1lID0gSnNvbkNvbnZlcnQuRGVzZXJpYWxpemVPYmplY3Q8VGhlbWU+KEpzb25Db252ZXJ0LlNlcmlhbGl6ZU9iamVjdChwcmV2VGhlbWUsIG5ldyBKc29uU2VyaWFsaXplclNldHRpbmdzKCkgeyBUeXBlTmFtZUhhbmRsaW5nID0gVHlwZU5hbWVIYW5kbGluZy5PYmplY3RzIH0pLCBuZXcgSnNvblNlcmlhbGl6ZXJTZXR0aW5ncygpIHsgVHlwZU5hbWVIYW5kbGluZyA9IFR5cGVOYW1lSGFuZGxpbmcuT2JqZWN0cyB9KTtcclxuXHJcbiAgICAgICAgICAgIFNldHRpbmdzLkFjdGl2ZVRoZW1lID0gY3VycmVudFRoZW1lO1xyXG5cclxuICAgICAgICAgICAgX2J1dHRvbkNvbGxlY3Rpb24gPSBnbG9iYWw6OkJyaWRnZS5TY3JpcHQuQ2FsbEZvcihuZXcgTGlzdDxTaW1wbGVEaWFsb2dCdXR0b24+KCksKF9vMik9PntfbzIuQWRkKG5ldyBTaW1wbGVEaWFsb2dCdXR0b24odGhpcywgRGlhbG9nUmVzdWx0RW51bS5DYW5jZWwpIHsgVGV4dCA9IFwiQ2FuY2VsXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDg1cHgpXCIsIFwiKDEwMCUgLSAzNXB4KVwiKSwgSXRlbUNsaWNrID0gKGV2KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXR0aW5ncy5BY3RpdmVUaGVtZSA9IHByZXZUaGVtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfX0pO19vMi5BZGQobmV3IFNpbXBsZURpYWxvZ0J1dHRvbih0aGlzLCBEaWFsb2dSZXN1bHRFbnVtLk9LKSB7IFRleHQgPSBcIk9LXCIsIExvY2F0aW9uID0gbmV3IFZlY3RvcjIoXCIoMTAwJSAtIDE3MHB4KVwiLCBcIigxMDAlIC0gMzVweClcIiksIEl0ZW1DbGljayA9IChldikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0dGluZ3MuQXBwbHlBY3RpdmVUaGVtZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5DbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9fSk7cmV0dXJuIF9vMjt9KTtcclxuICAgICAgICAgICAgQnV0dG9uU2VjdGlvbi5BcHBlbmRDaGlsZHJlblRhYkluZGV4KF9idXR0b25Db2xsZWN0aW9uLlRvQXJyYXkoKSk7XHJcblxyXG4gICAgICAgICAgICBpbnQgbGVuZ3RoID0gY3VycmVudFRoZW1lLkNvbG9ycy5MZW5ndGg7XHJcbiAgICAgICAgICAgIGludCB5ID0gMjA7XHJcbiAgICAgICAgICAgIGludCB4ID0gMjA7XHJcblxyXG4gICAgICAgICAgICB2YXIgUGFuZWwgPSBEaXYoKTtcclxuICAgICAgICAgICAgUGFuZWwuU3R5bGUuT3ZlcmZsb3dZID0gT3ZlcmZsb3cuQXV0bztcclxuICAgICAgICAgICAgUGFuZWwuU2V0Qm91bmRzKDAsIDAsIFwiMTAwJVwiLCBcIigxMDAlIC0gNjBweClcIik7XHJcblxyXG4gICAgICAgICAgICBCb2R5LlN0eWxlLkJhY2tncm91bmRDb2xvciA9IENvbG9yLldoaXRlO1xyXG5cclxuICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBQYW5lbC5BcHBlbmRDaGlsZChuZXcgQ29sb3JJbnB1dCgpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGV4dCA9IGN1cnJlbnRUaGVtZS5Db2xvcnNbaV0uVG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICBUb29sVGlwID0gbmV3IFRvb2xUaXAoXCJUaGlzIGlzIGEgaGVhZGluZyB0ZXN0LlwiLCBcIlRoaXMgaXMgYSBkZXNjcmlwdGlvbiB0ZXN0LlwiKSxcclxuICAgICAgICAgICAgICAgICAgICBPblRleHRDaGFuZ2VkID0gKHR4KSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdHguR2V0QXR0cmlidXRlaShcImlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUaGVtZS5Db2xvcnNbaW5kZXhdID0gdHguVGV4dDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNldHRpbmdzLkFwcGx5QWN0aXZlVGhlbWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LlxyXG4gICAgICAgICAgICAgICAgU2V0QXR0cmlidXRlKFwiaVwiLCBpKS5cclxuICAgICAgICAgICAgICAgIFNldEJvdW5kcyh4LCB5LCA5NSwgMjApKTtcclxuXHJcbiAgICAgICAgICAgICAgICB4ICs9IDEwMDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihpICUgMiAhPSAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHkgKz0gMzA7XHJcbiAgICAgICAgICAgICAgICAgICAgeCA9IDIwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBCb2R5LkFwcGVuZENoaWxkKFBhbmVsKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuU2l6ZSA9IG5ldyBWZWN0b3IyKDI1MCwgMzAwKTtcclxuICAgICAgICAgICAgdGhpcy5UZXh0ID0gXCJUaGVtZSBGb3JtIEVkaXRvclwiO1xyXG5cclxuICAgICAgICAgICAgQWxsb3dNb3ZlQ2hhbmdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgQWxsb3dTaXplQ2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBTaG93Q2xvc2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgU2hvd01heGltaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFNob3dNaW5pbWl6ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdCn0K
